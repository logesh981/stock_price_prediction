[0m11:26:35.135431 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002502212E720>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000250258583E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000250258ADB20>]}


============================== 11:26:35.142794 | 329943a0-8c3f-4aeb-badc-fd4fbbdb2d7a ==============================
[0m11:26:35.142794 [info ] [MainThread]: Running with dbt=1.9.4
[0m11:26:35.144794 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'D:\\Stock_price\\stock_dbt_project\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\loges\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt debug', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:26:35.188841 [info ] [MainThread]: dbt version: 1.9.4
[0m11:26:35.189835 [info ] [MainThread]: python version: 3.12.3
[0m11:26:35.190832 [info ] [MainThread]: python path: C:\Users\loges\.virtualenvs\Stock_price-P2gocZed\Scripts\python.exe
[0m11:26:35.191832 [info ] [MainThread]: os info: Windows-11-10.0.22631-SP0
[0m11:26:35.609331 [info ] [MainThread]: Using profiles dir at C:\Users\loges\.dbt
[0m11:26:35.616279 [info ] [MainThread]: Using profiles.yml file at C:\Users\loges\.dbt\profiles.yml
[0m11:26:35.623814 [info ] [MainThread]: Using dbt_project.yml file at D:\Stock_price\stock_dbt_project\dbt_project.yml
[0m11:26:35.711921 [info ] [MainThread]: adapter type: duckdb
[0m11:26:35.717112 [info ] [MainThread]: adapter version: 1.9.2
[0m11:26:36.089469 [info ] [MainThread]: Configuration:
[0m11:26:36.091094 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m11:26:36.092206 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m11:26:36.093282 [info ] [MainThread]: Required dependencies:
[0m11:26:36.093809 [debug] [MainThread]: Executing "git --help"
[0m11:26:36.201965 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m11:26:36.203965 [debug] [MainThread]: STDERR: "b''"
[0m11:26:36.205974 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m11:26:36.207625 [info ] [MainThread]: Connection:
[0m11:26:36.209641 [info ] [MainThread]:   database: dev
[0m11:26:36.211638 [info ] [MainThread]:   schema: main
[0m11:26:36.213854 [info ] [MainThread]:   path: dev.duckdb
[0m11:26:36.216380 [info ] [MainThread]:   config_options: None
[0m11:26:36.218366 [info ] [MainThread]:   extensions: None
[0m11:26:36.221369 [info ] [MainThread]:   settings: {}
[0m11:26:36.223365 [info ] [MainThread]:   external_root: .
[0m11:26:36.224365 [info ] [MainThread]:   use_credential_provider: None
[0m11:26:36.225367 [info ] [MainThread]:   attach: None
[0m11:26:36.227365 [info ] [MainThread]:   filesystems: None
[0m11:26:36.229369 [info ] [MainThread]:   remote: None
[0m11:26:36.231371 [info ] [MainThread]:   plugins: None
[0m11:26:36.234748 [info ] [MainThread]:   disable_transactions: False
[0m11:26:36.237785 [info ] [MainThread]: Registered adapter: duckdb=1.9.2
[0m11:26:37.703648 [debug] [MainThread]: Acquiring new duckdb connection 'debug'
[0m11:26:45.832464 [debug] [MainThread]: Using duckdb connection "debug"
[0m11:26:45.833532 [debug] [MainThread]: On debug: select 1 as id
[0m11:26:45.834495 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:26:45.864991 [debug] [MainThread]: SQL status: OK in 0.030 seconds
[0m11:26:45.868018 [debug] [MainThread]: On debug: Close
[0m11:26:45.869026 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m11:26:45.869968 [info ] [MainThread]: [32mAll checks passed![0m
[0m11:26:45.872035 [debug] [MainThread]: Command `dbt debug` succeeded at 11:26:45.872035 after 11.26 seconds
[0m11:26:45.873032 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m11:26:45.874036 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002502212E720>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000250229C6E10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000250257608F0>]}
[0m11:26:45.874036 [debug] [MainThread]: Flushing usage events
[0m11:26:46.647397 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:43:01.070792 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000294CCB29460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000294CC8BB050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000294CC8B93D0>]}


============================== 08:43:01.094958 | cf2856b0-9463-4ca6-923d-ad7abb091daf ==============================
[0m08:43:01.094958 [info ] [MainThread]: Running with dbt=1.9.4
[0m08:43:01.101367 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'D:\\Stock_price\\stock_dbt_project\\logs', 'profiles_dir': 'C:\\Users\\loges\\.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --select stg_stock_data', 'send_anonymous_usage_stats': 'True'}
[0m08:43:01.841370 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cf2856b0-9463-4ca6-923d-ad7abb091daf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000294CCE03260>]}
[0m08:43:01.952024 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cf2856b0-9463-4ca6-923d-ad7abb091daf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000294CC974DA0>]}
[0m08:43:01.978901 [info ] [MainThread]: Registered adapter: duckdb=1.9.2
[0m08:43:02.694177 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m08:43:02.698791 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m08:43:02.701056 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'cf2856b0-9463-4ca6-923d-ad7abb091daf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000294CDFF4E30>]}
[0m08:43:10.483245 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.stock_dbt_project.marts
[0m08:43:10.493721 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cf2856b0-9463-4ca6-923d-ad7abb091daf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000294CCA5A6F0>]}
[0m08:43:10.684256 [debug] [MainThread]: Wrote artifact WritableManifest to D:\Stock_price\stock_dbt_project\target\manifest.json
[0m08:43:10.721185 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\Stock_price\stock_dbt_project\target\semantic_manifest.json
[0m08:43:10.825436 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cf2856b0-9463-4ca6-923d-ad7abb091daf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000294CE367AA0>]}
[0m08:43:10.827441 [info ] [MainThread]: Found 4 models, 9 operations, 4 data tests, 426 macros
[0m08:43:10.830451 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cf2856b0-9463-4ca6-923d-ad7abb091daf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000294CE3B96D0>]}
[0m08:43:10.836445 [info ] [MainThread]: 
[0m08:43:10.839322 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m08:43:10.841541 [info ] [MainThread]: 
[0m08:43:10.844549 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m08:43:10.849079 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m08:43:18.585889 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m08:43:18.587903 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m08:43:18.588912 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:43:18.806856 [debug] [ThreadPool]: SQL status: OK in 0.217 seconds
[0m08:43:18.815462 [debug] [ThreadPool]: On list_dev: Close
[0m08:43:18.818230 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m08:43:18.820441 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m08:43:18.843132 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m08:43:18.844819 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "create_dev_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m08:43:18.846614 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:43:18.851141 [debug] [ThreadPool]: SQL status: OK in 0.005 seconds
[0m08:43:18.854492 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m08:43:18.855411 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m08:43:18.856277 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m08:43:18.857328 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m08:43:18.858406 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "create_dev_main"} */

    
    
        create schema if not exists "dev"."main"
    
[0m08:43:18.863347 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m08:43:18.866631 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m08:43:18.867781 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m08:43:18.868328 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m08:43:18.869422 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m08:43:18.870528 [debug] [ThreadPool]: On create_dev_main: Close
[0m08:43:18.886582 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev_main'
[0m08:43:18.920498 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m08:43:18.922778 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m08:43:18.925671 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:43:18.931685 [debug] [ThreadPool]: SQL status: OK in 0.006 seconds
[0m08:43:18.935201 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m08:43:18.937436 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m08:43:19.056202 [debug] [ThreadPool]: SQL status: OK in 0.117 seconds
[0m08:43:19.059790 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m08:43:19.099898 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m08:43:19.102896 [debug] [ThreadPool]: On list_dev_main: Close
[0m08:43:19.106152 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cf2856b0-9463-4ca6-923d-ad7abb091daf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000294CE4E6180>]}
[0m08:43:19.109494 [debug] [MainThread]: Using duckdb connection "master"
[0m08:43:19.113498 [debug] [MainThread]: On master: BEGIN
[0m08:43:19.116018 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:43:19.119334 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m08:43:19.121475 [debug] [MainThread]: On master: COMMIT
[0m08:43:19.124100 [debug] [MainThread]: Using duckdb connection "master"
[0m08:43:19.126308 [debug] [MainThread]: On master: COMMIT
[0m08:43:19.130069 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m08:43:19.150771 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-0"
[0m08:43:19.164058 [info ] [MainThread]: 1 of 9 START hook: stock_dbt_project.on-run-start.0 ............................ [RUN]
[0m08:43:19.166062 [debug] [MainThread]: Using duckdb connection "master"
[0m08:43:19.168058 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
INSTALL httpfs;
[0m08:43:24.535382 [debug] [MainThread]: SQL status: OK in 5.366 seconds
[0m08:43:24.537385 [info ] [MainThread]: 1 of 9 OK hook: stock_dbt_project.on-run-start.0 ............................... [[32mOK[0m in 5.40s]
[0m08:43:24.542067 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-1"
[0m08:43:24.543041 [info ] [MainThread]: 2 of 9 START hook: stock_dbt_project.on-run-start.1 ............................ [RUN]
[0m08:43:24.546021 [debug] [MainThread]: Using duckdb connection "master"
[0m08:43:24.547081 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
INSTALL json;
[0m08:43:29.182171 [debug] [MainThread]: SQL status: OK in 4.634 seconds
[0m08:43:29.185951 [info ] [MainThread]: 2 of 9 OK hook: stock_dbt_project.on-run-start.1 ............................... [[32mOK[0m in 4.65s]
[0m08:43:29.197214 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-2"
[0m08:43:29.203306 [info ] [MainThread]: 3 of 9 START hook: stock_dbt_project.on-run-start.2 ............................ [RUN]
[0m08:43:29.207402 [debug] [MainThread]: Using duckdb connection "master"
[0m08:43:29.210546 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
LOAD httpfs;
[0m08:43:30.676501 [debug] [MainThread]: SQL status: OK in 1.460 seconds
[0m08:43:30.679452 [info ] [MainThread]: 3 of 9 OK hook: stock_dbt_project.on-run-start.2 ............................... [[32mOK[0m in 1.49s]
[0m08:43:30.684445 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-3"
[0m08:43:30.685442 [info ] [MainThread]: 4 of 9 START hook: stock_dbt_project.on-run-start.3 ............................ [RUN]
[0m08:43:30.687444 [debug] [MainThread]: Using duckdb connection "master"
[0m08:43:30.688443 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
LOAD json;
[0m08:43:30.689446 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m08:43:30.692447 [info ] [MainThread]: 4 of 9 OK hook: stock_dbt_project.on-run-start.3 ............................... [[32mOK[0m in 0.01s]
[0m08:43:30.698518 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-4"
[0m08:43:30.702035 [info ] [MainThread]: 5 of 9 START hook: stock_dbt_project.on-run-start.4 ............................ [RUN]
[0m08:43:30.704048 [debug] [MainThread]: Using duckdb connection "master"
[0m08:43:30.706055 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
SET s3_region='us-east-1';
[0m08:43:30.708180 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m08:43:30.709705 [info ] [MainThread]: 5 of 9 OK hook: stock_dbt_project.on-run-start.4 ............................... [[32mOK[0m in 0.02s]
[0m08:43:30.717586 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-5"
[0m08:43:30.720592 [info ] [MainThread]: 6 of 9 START hook: stock_dbt_project.on-run-start.5 ............................ [RUN]
[0m08:43:30.722590 [debug] [MainThread]: Using duckdb connection "master"
[0m08:43:30.724330 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
SET s3_access_key_id='minioadmin';
[0m08:43:30.727349 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m08:43:30.732353 [info ] [MainThread]: 6 of 9 OK hook: stock_dbt_project.on-run-start.5 ............................... [[32mOK[0m in 0.02s]
[0m08:43:30.740498 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-6"
[0m08:43:30.743488 [info ] [MainThread]: 7 of 9 START hook: stock_dbt_project.on-run-start.6 ............................ [RUN]
[0m08:43:30.747226 [debug] [MainThread]: Using duckdb connection "master"
[0m08:43:30.750223 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
SET s3_secret_access_key='minioadmin';
[0m08:43:30.753223 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m08:43:30.756791 [info ] [MainThread]: 7 of 9 OK hook: stock_dbt_project.on-run-start.6 ............................... [[32mOK[0m in 0.02s]
[0m08:43:30.763577 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-7"
[0m08:43:30.768715 [info ] [MainThread]: 8 of 9 START hook: stock_dbt_project.on-run-start.7 ............................ [RUN]
[0m08:43:30.771716 [debug] [MainThread]: Using duckdb connection "master"
[0m08:43:30.772712 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
SET s3_endpoint='http://localhost:9000';
[0m08:43:30.774193 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m08:43:30.776192 [info ] [MainThread]: 8 of 9 OK hook: stock_dbt_project.on-run-start.7 ............................... [[32mOK[0m in 0.02s]
[0m08:43:30.784205 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-8"
[0m08:43:30.787664 [info ] [MainThread]: 9 of 9 START hook: stock_dbt_project.on-run-start.8 ............................ [RUN]
[0m08:43:30.789610 [debug] [MainThread]: Using duckdb connection "master"
[0m08:43:30.791607 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
SET s3_url_style='path';
[0m08:43:30.793611 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m08:43:30.798613 [info ] [MainThread]: 9 of 9 OK hook: stock_dbt_project.on-run-start.8 ............................... [[32mOK[0m in 0.02s]
[0m08:43:30.802073 [info ] [MainThread]: 
[0m08:43:30.804865 [debug] [MainThread]: On master: Close
[0m08:43:30.834222 [debug] [Thread-1 (]: Began running node model.stock_dbt_project.stg_stock_data
[0m08:43:30.838494 [info ] [Thread-1 (]: 1 of 1 START sql view model main.stg_stock_data ................................ [RUN]
[0m08:43:30.842913 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.stock_dbt_project.stg_stock_data'
[0m08:43:30.847214 [debug] [Thread-1 (]: Began compiling node model.stock_dbt_project.stg_stock_data
[0m08:43:30.861903 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_dbt_project.stg_stock_data"
[0m08:43:30.867506 [debug] [Thread-1 (]: Began executing node model.stock_dbt_project.stg_stock_data
[0m08:43:31.104950 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_dbt_project.stg_stock_data"
[0m08:43:31.116585 [debug] [Thread-1 (]: Using duckdb connection "model.stock_dbt_project.stg_stock_data"
[0m08:43:31.122758 [debug] [Thread-1 (]: On model.stock_dbt_project.stg_stock_data: BEGIN
[0m08:43:31.129416 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m08:43:31.135934 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m08:43:31.137476 [debug] [Thread-1 (]: Using duckdb connection "model.stock_dbt_project.stg_stock_data"
[0m08:43:31.140629 [debug] [Thread-1 (]: On model.stock_dbt_project.stg_stock_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "node_id": "model.stock_dbt_project.stg_stock_data"} */

  
  create view "dev"."main"."stg_stock_data__dbt_tmp" as (
    

WITH raw AS (
    SELECT *
    FROM read_json_auto('s3://my-stock-data-bucket/stocks/*/*/*/*.json')
)

SELECT
    CAST(symbol AS TEXT) AS symbol,
    CAST(datetime AS TIMESTAMP) AS datetime,
    CAST(open AS DOUBLE) AS open,
    CAST(high AS DOUBLE) AS high,
    CAST(low AS DOUBLE) AS low,
    CAST(close AS DOUBLE) AS close,
    CAST(volume AS BIGINT) AS volume
FROM raw
WHERE symbol IS NOT NULL AND datetime IS NOT NULL
  );

[0m08:43:31.525852 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "node_id": "model.stock_dbt_project.stg_stock_data"} */

  
  create view "dev"."main"."stg_stock_data__dbt_tmp" as (
    

WITH raw AS (
    SELECT *
    FROM read_json_auto('s3://my-stock-data-bucket/stocks/*/*/*/*.json')
)

SELECT
    CAST(symbol AS TEXT) AS symbol,
    CAST(datetime AS TIMESTAMP) AS datetime,
    CAST(open AS DOUBLE) AS open,
    CAST(high AS DOUBLE) AS high,
    CAST(low AS DOUBLE) AS low,
    CAST(close AS DOUBLE) AS close,
    CAST(volume AS BIGINT) AS volume
FROM raw
WHERE symbol IS NOT NULL AND datetime IS NOT NULL
  );

[0m08:43:31.528050 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m08:43:31.530895 [debug] [Thread-1 (]: On model.stock_dbt_project.stg_stock_data: ROLLBACK
[0m08:43:31.868819 [debug] [Thread-1 (]: Failed to rollback 'model.stock_dbt_project.stg_stock_data'
[0m08:43:31.870641 [debug] [Thread-1 (]: On model.stock_dbt_project.stg_stock_data: Close
[0m08:43:31.883861 [debug] [Thread-1 (]: Runtime Error in model stg_stock_data (models\staging\stg_stock_data.sql)
  HTTP Error: HTTP GET error on '/?encoding-type=url&list-type=2&prefix=stocks%2F' (HTTP 403)
[0m08:43:31.892696 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cf2856b0-9463-4ca6-923d-ad7abb091daf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000294CC202660>]}
[0m08:43:31.895699 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model main.stg_stock_data ....................... [[31mERROR[0m in 1.04s]
[0m08:43:31.899701 [debug] [Thread-1 (]: Finished running node model.stock_dbt_project.stg_stock_data
[0m08:43:31.902700 [debug] [Thread-4 (]: Marking all children of 'model.stock_dbt_project.stg_stock_data' to be skipped because of status 'error'.  Reason: Runtime Error in model stg_stock_data (models\staging\stg_stock_data.sql)
  HTTP Error: HTTP GET error on '/?encoding-type=url&list-type=2&prefix=stocks%2F' (HTTP 403).
[0m08:43:31.913001 [debug] [MainThread]: Using duckdb connection "master"
[0m08:43:31.914999 [debug] [MainThread]: On master: BEGIN
[0m08:43:31.918292 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m08:43:31.920308 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m08:43:31.922305 [debug] [MainThread]: On master: COMMIT
[0m08:43:31.924307 [debug] [MainThread]: Using duckdb connection "master"
[0m08:43:31.926308 [debug] [MainThread]: On master: COMMIT
[0m08:43:31.928709 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m08:43:31.930935 [debug] [MainThread]: On master: Close
[0m08:43:31.933936 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:43:31.935951 [debug] [MainThread]: Connection 'create_dev_main' was properly closed.
[0m08:43:31.937951 [debug] [MainThread]: Connection 'list_dev_main' was properly closed.
[0m08:43:31.939782 [debug] [MainThread]: Connection 'model.stock_dbt_project.stg_stock_data' was properly closed.
[0m08:43:31.941849 [info ] [MainThread]: 
[0m08:43:31.944091 [info ] [MainThread]: Finished running 9 project hooks, 1 view model in 0 hours 0 minutes and 21.10 seconds (21.10s).
[0m08:43:31.954534 [debug] [MainThread]: Command end result
[0m08:43:32.015542 [debug] [MainThread]: Wrote artifact WritableManifest to D:\Stock_price\stock_dbt_project\target\manifest.json
[0m08:43:32.019554 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\Stock_price\stock_dbt_project\target\semantic_manifest.json
[0m08:43:32.039975 [debug] [MainThread]: Wrote artifact RunExecutionResult to D:\Stock_price\stock_dbt_project\target\run_results.json
[0m08:43:32.039975 [info ] [MainThread]: 
[0m08:43:32.043146 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m08:43:32.045311 [info ] [MainThread]: 
[0m08:43:32.047308 [error] [MainThread]:   Runtime Error in model stg_stock_data (models\staging\stg_stock_data.sql)
  HTTP Error: HTTP GET error on '/?encoding-type=url&list-type=2&prefix=stocks%2F' (HTTP 403)
[0m08:43:32.050313 [info ] [MainThread]: 
[0m08:43:32.051308 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=1 SKIP=0 TOTAL=10
[0m08:43:32.054309 [debug] [MainThread]: Command `dbt run` failed at 08:43:32.053306 after 31.45 seconds
[0m08:43:32.055306 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000294CC524CE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000294CC1E7AA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000294CC1E4AD0>]}
[0m08:43:32.056310 [debug] [MainThread]: Flushing usage events
[0m08:43:32.789817 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:27:02.420784 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A0E54F560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A113F9160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A113FBDA0>]}


============================== 09:27:02.444760 | 2163fb69-734d-4829-aa70-88823098d9cd ==============================
[0m09:27:02.444760 [info ] [MainThread]: Running with dbt=1.9.4
[0m09:27:02.449062 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'D:\\Stock_price\\stock_dbt_project\\logs', 'profiles_dir': 'C:\\Users\\loges\\.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run --select stg_stock_data', 'send_anonymous_usage_stats': 'True'}
[0m09:27:03.239385 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2163fb69-734d-4829-aa70-88823098d9cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A118E0770>]}
[0m09:27:03.390944 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2163fb69-734d-4829-aa70-88823098d9cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A119B1730>]}
[0m09:27:03.438492 [info ] [MainThread]: Registered adapter: duckdb=1.9.2
[0m09:27:04.506216 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m09:27:10.178074 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m09:27:10.180081 [debug] [MainThread]: Partial parsing: updated file: stock_dbt_project://models\staging\stg_stock_data.sql
[0m09:27:10.183080 [debug] [MainThread]: Partial parsing: updated file: stock_dbt_project://models\features_stock_data.sql
[0m09:27:11.644435 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.stock_dbt_project.marts
[0m09:27:11.668643 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2163fb69-734d-4829-aa70-88823098d9cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A1194C500>]}
[0m09:27:12.410569 [debug] [MainThread]: Wrote artifact WritableManifest to D:\Stock_price\stock_dbt_project\target\manifest.json
[0m09:27:12.481227 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\Stock_price\stock_dbt_project\target\semantic_manifest.json
[0m09:27:12.640958 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2163fb69-734d-4829-aa70-88823098d9cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A12DD58E0>]}
[0m09:27:12.644227 [info ] [MainThread]: Found 4 models, 9 operations, 4 data tests, 426 macros
[0m09:27:12.647100 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2163fb69-734d-4829-aa70-88823098d9cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A12E566F0>]}
[0m09:27:12.656498 [info ] [MainThread]: 
[0m09:27:12.659849 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m09:27:12.663521 [info ] [MainThread]: 
[0m09:27:12.673443 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m09:27:12.677864 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m09:27:19.455845 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m09:27:19.456370 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m09:27:19.456370 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:27:19.499879 [debug] [ThreadPool]: SQL status: OK in 0.041 seconds
[0m09:27:19.504258 [debug] [ThreadPool]: On list_dev: Close
[0m09:27:19.506433 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m09:27:19.508137 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m09:27:19.525066 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m09:27:19.525066 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "create_dev_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m09:27:19.525066 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:27:19.535314 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m09:27:19.539017 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m09:27:19.539017 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m09:27:19.539017 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m09:27:19.539017 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m09:27:19.539017 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "create_dev_main"} */

    
    
        create schema if not exists "dev"."main"
    
[0m09:27:19.539017 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m09:27:19.553006 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m09:27:19.555018 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m09:27:19.556023 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m09:27:19.558016 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m09:27:19.560749 [debug] [ThreadPool]: On create_dev_main: Close
[0m09:27:19.574709 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev_main'
[0m09:27:19.594482 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m09:27:19.603587 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m09:27:19.604585 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:27:19.606584 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m09:27:19.607579 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m09:27:19.608663 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m09:27:19.687835 [debug] [ThreadPool]: SQL status: OK in 0.078 seconds
[0m09:27:19.693711 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m09:27:19.738328 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m09:27:19.740746 [debug] [ThreadPool]: On list_dev_main: Close
[0m09:27:19.744540 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2163fb69-734d-4829-aa70-88823098d9cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A12E7D160>]}
[0m09:27:19.747204 [debug] [MainThread]: Using duckdb connection "master"
[0m09:27:19.750212 [debug] [MainThread]: On master: BEGIN
[0m09:27:19.752109 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:27:19.755306 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m09:27:19.757088 [debug] [MainThread]: On master: COMMIT
[0m09:27:19.758207 [debug] [MainThread]: Using duckdb connection "master"
[0m09:27:19.759614 [debug] [MainThread]: On master: COMMIT
[0m09:27:19.761605 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m09:27:19.787371 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-0"
[0m09:27:19.802321 [info ] [MainThread]: 1 of 9 START hook: stock_dbt_project.on-run-start.0 ............................ [RUN]
[0m09:27:19.804452 [debug] [MainThread]: Using duckdb connection "master"
[0m09:27:19.805545 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
INSTALL httpfs;
[0m09:27:19.825303 [debug] [MainThread]: SQL status: OK in 0.018 seconds
[0m09:27:19.829310 [info ] [MainThread]: 1 of 9 OK hook: stock_dbt_project.on-run-start.0 ............................... [[32mOK[0m in 0.07s]
[0m09:27:19.838070 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-1"
[0m09:27:19.841068 [info ] [MainThread]: 2 of 9 START hook: stock_dbt_project.on-run-start.1 ............................ [RUN]
[0m09:27:19.844447 [debug] [MainThread]: Using duckdb connection "master"
[0m09:27:19.846145 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
INSTALL json;
[0m09:27:19.863304 [debug] [MainThread]: SQL status: OK in 0.015 seconds
[0m09:27:19.867264 [info ] [MainThread]: 2 of 9 OK hook: stock_dbt_project.on-run-start.1 ............................... [[32mOK[0m in 0.03s]
[0m09:27:19.871973 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-2"
[0m09:27:19.871973 [info ] [MainThread]: 3 of 9 START hook: stock_dbt_project.on-run-start.2 ............................ [RUN]
[0m09:27:19.871973 [debug] [MainThread]: Using duckdb connection "master"
[0m09:27:19.879378 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
LOAD httpfs;
[0m09:27:21.779878 [debug] [MainThread]: SQL status: OK in 1.898 seconds
[0m09:27:21.787515 [info ] [MainThread]: 3 of 9 OK hook: stock_dbt_project.on-run-start.2 ............................... [[32mOK[0m in 1.92s]
[0m09:27:21.795750 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-3"
[0m09:27:21.806129 [info ] [MainThread]: 4 of 9 START hook: stock_dbt_project.on-run-start.3 ............................ [RUN]
[0m09:27:21.810066 [debug] [MainThread]: Using duckdb connection "master"
[0m09:27:21.812240 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
LOAD json;
[0m09:27:21.817153 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m09:27:21.823243 [info ] [MainThread]: 4 of 9 OK hook: stock_dbt_project.on-run-start.3 ............................... [[32mOK[0m in 0.03s]
[0m09:27:21.833666 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-4"
[0m09:27:21.840546 [info ] [MainThread]: 5 of 9 START hook: stock_dbt_project.on-run-start.4 ............................ [RUN]
[0m09:27:21.845450 [debug] [MainThread]: Using duckdb connection "master"
[0m09:27:21.852393 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
SET s3_region='us-east-1';
[0m09:27:21.856886 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m09:27:21.864044 [info ] [MainThread]: 5 of 9 OK hook: stock_dbt_project.on-run-start.4 ............................... [[32mOK[0m in 0.04s]
[0m09:27:21.875213 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-5"
[0m09:27:21.886042 [info ] [MainThread]: 6 of 9 START hook: stock_dbt_project.on-run-start.5 ............................ [RUN]
[0m09:27:21.891642 [debug] [MainThread]: Using duckdb connection "master"
[0m09:27:21.894662 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
SET s3_access_key_id='minioadmin';
[0m09:27:21.898772 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m09:27:21.912663 [info ] [MainThread]: 6 of 9 OK hook: stock_dbt_project.on-run-start.5 ............................... [[32mOK[0m in 0.04s]
[0m09:27:21.923520 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-6"
[0m09:27:21.932204 [info ] [MainThread]: 7 of 9 START hook: stock_dbt_project.on-run-start.6 ............................ [RUN]
[0m09:27:21.941926 [debug] [MainThread]: Using duckdb connection "master"
[0m09:27:21.944724 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
SET s3_secret_access_key='minioadmin';
[0m09:27:21.948911 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m09:27:21.960573 [info ] [MainThread]: 7 of 9 OK hook: stock_dbt_project.on-run-start.6 ............................... [[32mOK[0m in 0.04s]
[0m09:27:21.978549 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-7"
[0m09:27:21.991659 [info ] [MainThread]: 8 of 9 START hook: stock_dbt_project.on-run-start.7 ............................ [RUN]
[0m09:27:21.995076 [debug] [MainThread]: Using duckdb connection "master"
[0m09:27:21.998191 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
SET s3_endpoint='http://localhost:9000';
[0m09:27:22.005200 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m09:27:22.021258 [info ] [MainThread]: 8 of 9 OK hook: stock_dbt_project.on-run-start.7 ............................... [[32mOK[0m in 0.04s]
[0m09:27:22.040654 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-8"
[0m09:27:22.053353 [info ] [MainThread]: 9 of 9 START hook: stock_dbt_project.on-run-start.8 ............................ [RUN]
[0m09:27:22.060650 [debug] [MainThread]: Using duckdb connection "master"
[0m09:27:22.066510 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
SET s3_url_style='path';
[0m09:27:22.070124 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m09:27:22.073482 [info ] [MainThread]: 9 of 9 OK hook: stock_dbt_project.on-run-start.8 ............................... [[32mOK[0m in 0.05s]
[0m09:27:22.076361 [info ] [MainThread]: 
[0m09:27:22.079203 [debug] [MainThread]: On master: Close
[0m09:27:22.096196 [debug] [Thread-1 (]: Began running node model.stock_dbt_project.stg_stock_data
[0m09:27:22.101158 [info ] [Thread-1 (]: 1 of 1 START sql view model main.stg_stock_data ................................ [RUN]
[0m09:27:22.105507 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.stock_dbt_project.stg_stock_data'
[0m09:27:22.107764 [debug] [Thread-1 (]: Began compiling node model.stock_dbt_project.stg_stock_data
[0m09:27:22.123309 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_dbt_project.stg_stock_data"
[0m09:27:22.125319 [debug] [Thread-1 (]: Began executing node model.stock_dbt_project.stg_stock_data
[0m09:27:22.268015 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_dbt_project.stg_stock_data"
[0m09:27:22.272035 [debug] [Thread-1 (]: Using duckdb connection "model.stock_dbt_project.stg_stock_data"
[0m09:27:22.275026 [debug] [Thread-1 (]: On model.stock_dbt_project.stg_stock_data: BEGIN
[0m09:27:22.276029 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m09:27:22.283107 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m09:27:22.286597 [debug] [Thread-1 (]: Using duckdb connection "model.stock_dbt_project.stg_stock_data"
[0m09:27:22.288787 [debug] [Thread-1 (]: On model.stock_dbt_project.stg_stock_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "node_id": "model.stock_dbt_project.stg_stock_data"} */

  
  create view "dev"."main"."stg_stock_data__dbt_tmp" as (
    

SET s3_endpoint='http://minio:9000';
SET aws_access_key_id='minioadmin';
SET aws_secret_access_key='minioadmin';

WITH raw AS (
    SELECT *
    FROM read_json_auto('s3://my-stock-data-bucket/stocks/*/*/*/*.json')
)

SELECT
    CAST(symbol AS TEXT) AS symbol,
    CAST(datetime AS TIMESTAMP) AS datetime,
    CAST(open AS DOUBLE) AS open,
    CAST(high AS DOUBLE) AS high,
    CAST(low AS DOUBLE) AS low,
    CAST(close AS DOUBLE) AS close,
    CAST(volume AS BIGINT) AS volume
FROM raw
WHERE symbol IS NOT NULL AND datetime IS NOT NULL
  );

[0m09:27:22.302819 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "node_id": "model.stock_dbt_project.stg_stock_data"} */

  
  create view "dev"."main"."stg_stock_data__dbt_tmp" as (
    

SET s3_endpoint='http://minio:9000';
SET aws_access_key_id='minioadmin';
SET aws_secret_access_key='minioadmin';

WITH raw AS (
    SELECT *
    FROM read_json_auto('s3://my-stock-data-bucket/stocks/*/*/*/*.json')
)

SELECT
    CAST(symbol AS TEXT) AS symbol,
    CAST(datetime AS TIMESTAMP) AS datetime,
    CAST(open AS DOUBLE) AS open,
    CAST(high AS DOUBLE) AS high,
    CAST(low AS DOUBLE) AS low,
    CAST(close AS DOUBLE) AS close,
    CAST(volume AS BIGINT) AS volume
FROM raw
WHERE symbol IS NOT NULL AND datetime IS NOT NULL
  );

[0m09:27:22.304815 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m09:27:22.306818 [debug] [Thread-1 (]: On model.stock_dbt_project.stg_stock_data: ROLLBACK
[0m09:27:22.605353 [debug] [Thread-1 (]: Failed to rollback 'model.stock_dbt_project.stg_stock_data'
[0m09:27:22.606353 [debug] [Thread-1 (]: On model.stock_dbt_project.stg_stock_data: Close
[0m09:27:22.611360 [debug] [Thread-1 (]: Runtime Error in model stg_stock_data (models\staging\stg_stock_data.sql)
  Parser Error: syntax error at or near "SET"
[0m09:27:22.617679 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2163fb69-734d-4829-aa70-88823098d9cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A1370F800>]}
[0m09:27:22.619623 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model main.stg_stock_data ....................... [[31mERROR[0m in 0.51s]
[0m09:27:22.622628 [debug] [Thread-1 (]: Finished running node model.stock_dbt_project.stg_stock_data
[0m09:27:22.623627 [debug] [Thread-4 (]: Marking all children of 'model.stock_dbt_project.stg_stock_data' to be skipped because of status 'error'.  Reason: Runtime Error in model stg_stock_data (models\staging\stg_stock_data.sql)
  Parser Error: syntax error at or near "SET".
[0m09:27:22.627630 [debug] [MainThread]: Using duckdb connection "master"
[0m09:27:22.628633 [debug] [MainThread]: On master: BEGIN
[0m09:27:22.629979 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:27:22.633385 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m09:27:22.634457 [debug] [MainThread]: On master: COMMIT
[0m09:27:22.635475 [debug] [MainThread]: Using duckdb connection "master"
[0m09:27:22.637472 [debug] [MainThread]: On master: COMMIT
[0m09:27:22.638468 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m09:27:22.639476 [debug] [MainThread]: On master: Close
[0m09:27:22.640514 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:27:22.641478 [debug] [MainThread]: Connection 'create_dev_main' was properly closed.
[0m09:27:22.642481 [debug] [MainThread]: Connection 'list_dev_main' was properly closed.
[0m09:27:22.642481 [debug] [MainThread]: Connection 'model.stock_dbt_project.stg_stock_data' was properly closed.
[0m09:27:22.643474 [info ] [MainThread]: 
[0m09:27:22.644465 [info ] [MainThread]: Finished running 9 project hooks, 1 view model in 0 hours 0 minutes and 9.97 seconds (9.97s).
[0m09:27:22.650700 [debug] [MainThread]: Command end result
[0m09:27:22.772259 [debug] [MainThread]: Wrote artifact WritableManifest to D:\Stock_price\stock_dbt_project\target\manifest.json
[0m09:27:22.778238 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\Stock_price\stock_dbt_project\target\semantic_manifest.json
[0m09:27:22.805863 [debug] [MainThread]: Wrote artifact RunExecutionResult to D:\Stock_price\stock_dbt_project\target\run_results.json
[0m09:27:22.807857 [info ] [MainThread]: 
[0m09:27:22.809016 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m09:27:22.811013 [info ] [MainThread]: 
[0m09:27:22.814020 [error] [MainThread]:   Runtime Error in model stg_stock_data (models\staging\stg_stock_data.sql)
  Parser Error: syntax error at or near "SET"
[0m09:27:22.817370 [info ] [MainThread]: 
[0m09:27:22.820366 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=1 SKIP=0 TOTAL=10
[0m09:27:22.824360 [debug] [MainThread]: Command `dbt run` failed at 09:27:22.823361 after 21.22 seconds
[0m09:27:22.825363 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A113C6840>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A10D27E00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A10D24050>]}
[0m09:27:22.827373 [debug] [MainThread]: Flushing usage events
[0m09:27:23.641593 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:29:18.527354 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000220C89ABE60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000220C82F3860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000220C82F1E50>]}


============================== 09:29:18.546714 | 2cd956c3-420b-48fe-8af2-88a59f098f0f ==============================
[0m09:29:18.546714 [info ] [MainThread]: Running with dbt=1.9.4
[0m09:29:18.553518 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'D:\\Stock_price\\stock_dbt_project\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\loges\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --select stg_stock_data', 'send_anonymous_usage_stats': 'True'}
[0m09:29:19.078654 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2cd956c3-420b-48fe-8af2-88a59f098f0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000220C894E870>]}
[0m09:29:19.177256 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2cd956c3-420b-48fe-8af2-88a59f098f0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000220C50FE4E0>]}
[0m09:29:19.184757 [info ] [MainThread]: Registered adapter: duckdb=1.9.2
[0m09:29:19.503886 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m09:29:19.684216 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m09:29:19.687218 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '2cd956c3-420b-48fe-8af2-88a59f098f0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000220C89A9850>]}
[0m09:29:24.378608 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.stock_dbt_project.marts
[0m09:29:24.424016 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2cd956c3-420b-48fe-8af2-88a59f098f0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000220C8E40470>]}
[0m09:29:24.891321 [debug] [MainThread]: Wrote artifact WritableManifest to D:\Stock_price\stock_dbt_project\target\manifest.json
[0m09:29:24.896052 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\Stock_price\stock_dbt_project\target\semantic_manifest.json
[0m09:29:24.979470 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2cd956c3-420b-48fe-8af2-88a59f098f0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000220CA3B05C0>]}
[0m09:29:24.982484 [info ] [MainThread]: Found 4 models, 7 operations, 4 data tests, 426 macros
[0m09:29:24.985482 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2cd956c3-420b-48fe-8af2-88a59f098f0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000220CA621D30>]}
[0m09:29:24.991487 [info ] [MainThread]: 
[0m09:29:24.995002 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m09:29:24.997805 [info ] [MainThread]: 
[0m09:29:25.007798 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m09:29:25.011974 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m09:29:25.446970 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m09:29:25.459322 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m09:29:25.461720 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:29:25.542382 [debug] [ThreadPool]: SQL status: OK in 0.081 seconds
[0m09:29:25.551466 [debug] [ThreadPool]: On list_dev: Close
[0m09:29:25.555536 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m09:29:25.558094 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m09:29:25.593348 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m09:29:25.595856 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "create_dev_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m09:29:25.599740 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:29:25.604520 [debug] [ThreadPool]: SQL status: OK in 0.005 seconds
[0m09:29:25.610363 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m09:29:25.611382 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m09:29:25.617506 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m09:29:25.621492 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m09:29:25.623130 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "create_dev_main"} */

    
    
        create schema if not exists "dev"."main"
    
[0m09:29:25.626173 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m09:29:25.630195 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m09:29:25.633520 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m09:29:25.636875 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m09:29:25.638901 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m09:29:25.641428 [debug] [ThreadPool]: On create_dev_main: Close
[0m09:29:25.669171 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev_main'
[0m09:29:25.703116 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m09:29:25.706667 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m09:29:25.712315 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:29:25.719916 [debug] [ThreadPool]: SQL status: OK in 0.008 seconds
[0m09:29:25.725044 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m09:29:25.730843 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m09:29:25.845927 [debug] [ThreadPool]: SQL status: OK in 0.108 seconds
[0m09:29:25.852320 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m09:29:25.858537 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m09:29:25.862696 [debug] [ThreadPool]: On list_dev_main: Close
[0m09:29:25.866212 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2cd956c3-420b-48fe-8af2-88a59f098f0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000220C7B0A480>]}
[0m09:29:25.870658 [debug] [MainThread]: Using duckdb connection "master"
[0m09:29:25.872658 [debug] [MainThread]: On master: BEGIN
[0m09:29:25.873663 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:29:25.876984 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m09:29:25.878789 [debug] [MainThread]: On master: COMMIT
[0m09:29:25.882908 [debug] [MainThread]: Using duckdb connection "master"
[0m09:29:25.885449 [debug] [MainThread]: On master: COMMIT
[0m09:29:25.889544 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m09:29:25.925110 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-0"
[0m09:29:25.945283 [info ] [MainThread]: 1 of 7 START hook: stock_dbt_project.on-run-start.0 ............................ [RUN]
[0m09:29:25.954753 [debug] [MainThread]: Using duckdb connection "master"
[0m09:29:25.957288 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
INSTALL httpfs;
[0m09:29:25.962074 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m09:29:25.966919 [info ] [MainThread]: 1 of 7 OK hook: stock_dbt_project.on-run-start.0 ............................... [[32mOK[0m in 0.07s]
[0m09:29:25.975675 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-1"
[0m09:29:25.980250 [info ] [MainThread]: 2 of 7 START hook: stock_dbt_project.on-run-start.1 ............................ [RUN]
[0m09:29:25.986348 [debug] [MainThread]: Using duckdb connection "master"
[0m09:29:25.988884 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
INSTALL json;
[0m09:29:25.994451 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m09:29:26.003989 [info ] [MainThread]: 2 of 7 OK hook: stock_dbt_project.on-run-start.1 ............................... [[32mOK[0m in 0.03s]
[0m09:29:26.013649 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-2"
[0m09:29:26.021435 [info ] [MainThread]: 3 of 7 START hook: stock_dbt_project.on-run-start.2 ............................ [RUN]
[0m09:29:26.026433 [debug] [MainThread]: Using duckdb connection "master"
[0m09:29:26.028816 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
LOAD httpfs;
[0m09:29:26.572812 [debug] [MainThread]: SQL status: OK in 0.541 seconds
[0m09:29:26.577606 [info ] [MainThread]: 3 of 7 OK hook: stock_dbt_project.on-run-start.2 ............................... [[32mOK[0m in 0.57s]
[0m09:29:26.587140 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-3"
[0m09:29:26.590160 [info ] [MainThread]: 4 of 7 START hook: stock_dbt_project.on-run-start.3 ............................ [RUN]
[0m09:29:26.594416 [debug] [MainThread]: Using duckdb connection "master"
[0m09:29:26.597260 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
LOAD json;
[0m09:29:26.605230 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m09:29:26.610234 [info ] [MainThread]: 4 of 7 OK hook: stock_dbt_project.on-run-start.3 ............................... [[32mOK[0m in 0.03s]
[0m09:29:26.620690 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-4"
[0m09:29:26.626632 [info ] [MainThread]: 5 of 7 START hook: stock_dbt_project.on-run-start.4 ............................ [RUN]
[0m09:29:26.629555 [debug] [MainThread]: Using duckdb connection "master"
[0m09:29:26.633085 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
SET s3_access_key_id='minioadmin';
[0m09:29:26.637087 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m09:29:26.641090 [info ] [MainThread]: 5 of 7 OK hook: stock_dbt_project.on-run-start.4 ............................... [[32mOK[0m in 0.03s]
[0m09:29:26.650425 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-5"
[0m09:29:26.656608 [info ] [MainThread]: 6 of 7 START hook: stock_dbt_project.on-run-start.5 ............................ [RUN]
[0m09:29:26.659439 [debug] [MainThread]: Using duckdb connection "master"
[0m09:29:26.661080 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
SET s3_secret_access_key='minioadmin';
[0m09:29:26.664917 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m09:29:26.672219 [info ] [MainThread]: 6 of 7 OK hook: stock_dbt_project.on-run-start.5 ............................... [[32mOK[0m in 0.03s]
[0m09:29:26.680432 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-6"
[0m09:29:26.688141 [info ] [MainThread]: 7 of 7 START hook: stock_dbt_project.on-run-start.6 ............................ [RUN]
[0m09:29:26.691707 [debug] [MainThread]: Using duckdb connection "master"
[0m09:29:26.693703 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
SET s3_endpoint='http://localhost:9000';
[0m09:29:26.695705 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m09:29:26.703742 [info ] [MainThread]: 7 of 7 OK hook: stock_dbt_project.on-run-start.6 ............................... [[32mOK[0m in 0.03s]
[0m09:29:26.706772 [info ] [MainThread]: 
[0m09:29:26.711302 [debug] [MainThread]: On master: Close
[0m09:29:26.739394 [debug] [Thread-1 (]: Began running node model.stock_dbt_project.stg_stock_data
[0m09:29:26.742094 [info ] [Thread-1 (]: 1 of 1 START sql view model main.stg_stock_data ................................ [RUN]
[0m09:29:26.745498 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.stock_dbt_project.stg_stock_data'
[0m09:29:26.748323 [debug] [Thread-1 (]: Began compiling node model.stock_dbt_project.stg_stock_data
[0m09:29:26.763248 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_dbt_project.stg_stock_data"
[0m09:29:26.770019 [debug] [Thread-1 (]: Began executing node model.stock_dbt_project.stg_stock_data
[0m09:29:27.037277 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_dbt_project.stg_stock_data"
[0m09:29:27.041214 [debug] [Thread-1 (]: Using duckdb connection "model.stock_dbt_project.stg_stock_data"
[0m09:29:27.043884 [debug] [Thread-1 (]: On model.stock_dbt_project.stg_stock_data: BEGIN
[0m09:29:27.047364 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m09:29:27.054245 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m09:29:27.056876 [debug] [Thread-1 (]: Using duckdb connection "model.stock_dbt_project.stg_stock_data"
[0m09:29:27.059343 [debug] [Thread-1 (]: On model.stock_dbt_project.stg_stock_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "node_id": "model.stock_dbt_project.stg_stock_data"} */

  
  create view "dev"."main"."stg_stock_data__dbt_tmp" as (
    

SET s3_endpoint='http://minio:9000';
SET aws_access_key_id='minioadmin';
SET aws_secret_access_key='minioadmin';

WITH raw AS (
    SELECT *
    FROM read_json_auto('s3://my-stock-data-bucket/stocks/*/*/*/*.json')
)

SELECT
    CAST(symbol AS TEXT) AS symbol,
    CAST(datetime AS TIMESTAMP) AS datetime,
    CAST(open AS DOUBLE) AS open,
    CAST(high AS DOUBLE) AS high,
    CAST(low AS DOUBLE) AS low,
    CAST(close AS DOUBLE) AS close,
    CAST(volume AS BIGINT) AS volume
FROM raw
WHERE symbol IS NOT NULL AND datetime IS NOT NULL
  );

[0m09:29:27.063394 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "node_id": "model.stock_dbt_project.stg_stock_data"} */

  
  create view "dev"."main"."stg_stock_data__dbt_tmp" as (
    

SET s3_endpoint='http://minio:9000';
SET aws_access_key_id='minioadmin';
SET aws_secret_access_key='minioadmin';

WITH raw AS (
    SELECT *
    FROM read_json_auto('s3://my-stock-data-bucket/stocks/*/*/*/*.json')
)

SELECT
    CAST(symbol AS TEXT) AS symbol,
    CAST(datetime AS TIMESTAMP) AS datetime,
    CAST(open AS DOUBLE) AS open,
    CAST(high AS DOUBLE) AS high,
    CAST(low AS DOUBLE) AS low,
    CAST(close AS DOUBLE) AS close,
    CAST(volume AS BIGINT) AS volume
FROM raw
WHERE symbol IS NOT NULL AND datetime IS NOT NULL
  );

[0m09:29:27.066716 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m09:29:27.070885 [debug] [Thread-1 (]: On model.stock_dbt_project.stg_stock_data: ROLLBACK
[0m09:29:27.103145 [debug] [Thread-1 (]: Failed to rollback 'model.stock_dbt_project.stg_stock_data'
[0m09:29:27.105851 [debug] [Thread-1 (]: On model.stock_dbt_project.stg_stock_data: Close
[0m09:29:27.122757 [debug] [Thread-1 (]: Runtime Error in model stg_stock_data (models\staging\stg_stock_data.sql)
  Parser Error: syntax error at or near "SET"
[0m09:29:27.136375 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2cd956c3-420b-48fe-8af2-88a59f098f0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000220CA4E9430>]}
[0m09:29:27.139183 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model main.stg_stock_data ....................... [[31mERROR[0m in 0.38s]
[0m09:29:27.142707 [debug] [Thread-1 (]: Finished running node model.stock_dbt_project.stg_stock_data
[0m09:29:27.147528 [debug] [Thread-4 (]: Marking all children of 'model.stock_dbt_project.stg_stock_data' to be skipped because of status 'error'.  Reason: Runtime Error in model stg_stock_data (models\staging\stg_stock_data.sql)
  Parser Error: syntax error at or near "SET".
[0m09:29:27.159621 [debug] [MainThread]: Using duckdb connection "master"
[0m09:29:27.162353 [debug] [MainThread]: On master: BEGIN
[0m09:29:27.164740 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:29:27.169279 [debug] [MainThread]: SQL status: OK in 0.004 seconds
[0m09:29:27.173183 [debug] [MainThread]: On master: COMMIT
[0m09:29:27.176267 [debug] [MainThread]: Using duckdb connection "master"
[0m09:29:27.179994 [debug] [MainThread]: On master: COMMIT
[0m09:29:27.185607 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m09:29:27.188172 [debug] [MainThread]: On master: Close
[0m09:29:27.191116 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:29:27.193833 [debug] [MainThread]: Connection 'create_dev_main' was properly closed.
[0m09:29:27.196626 [debug] [MainThread]: Connection 'list_dev_main' was properly closed.
[0m09:29:27.198292 [debug] [MainThread]: Connection 'model.stock_dbt_project.stg_stock_data' was properly closed.
[0m09:29:27.201884 [info ] [MainThread]: 
[0m09:29:27.204170 [info ] [MainThread]: Finished running 7 project hooks, 1 view model in 0 hours 0 minutes and 2.20 seconds (2.20s).
[0m09:29:27.217397 [debug] [MainThread]: Command end result
[0m09:29:27.310838 [debug] [MainThread]: Wrote artifact WritableManifest to D:\Stock_price\stock_dbt_project\target\manifest.json
[0m09:29:27.320322 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\Stock_price\stock_dbt_project\target\semantic_manifest.json
[0m09:29:27.340193 [debug] [MainThread]: Wrote artifact RunExecutionResult to D:\Stock_price\stock_dbt_project\target\run_results.json
[0m09:29:27.342852 [info ] [MainThread]: 
[0m09:29:27.345765 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m09:29:27.347883 [info ] [MainThread]: 
[0m09:29:27.350391 [error] [MainThread]:   Runtime Error in model stg_stock_data (models\staging\stg_stock_data.sql)
  Parser Error: syntax error at or near "SET"
[0m09:29:27.352927 [info ] [MainThread]: 
[0m09:29:27.354598 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=1 SKIP=0 TOTAL=8
[0m09:29:27.358410 [debug] [MainThread]: Command `dbt run` failed at 09:29:27.357903 after 9.17 seconds
[0m09:29:27.359664 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000220C8553800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000220C8D16930>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000220C8D16F00>]}
[0m09:29:27.361677 [debug] [MainThread]: Flushing usage events
[0m09:29:28.113239 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:29:45.236765 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026A5F1F4FB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026A5F1F7680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026A5F9BCFB0>]}


============================== 09:29:45.254957 | e91cd0cb-cef3-4b65-8dee-97457a7b512c ==============================
[0m09:29:45.254957 [info ] [MainThread]: Running with dbt=1.9.4
[0m09:29:45.258443 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\loges\\.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'D:\\Stock_price\\stock_dbt_project\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run --select stg_stock_data', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m09:29:46.513265 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e91cd0cb-cef3-4b65-8dee-97457a7b512c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026A5FD31580>]}
[0m09:29:47.128399 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e91cd0cb-cef3-4b65-8dee-97457a7b512c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026A5F6A7C80>]}
[0m09:29:47.143589 [info ] [MainThread]: Registered adapter: duckdb=1.9.2
[0m09:29:47.701037 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m09:29:48.219475 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m09:29:48.221465 [debug] [MainThread]: Partial parsing: updated file: stock_dbt_project://models\staging\stg_stock_data.sql
[0m09:29:49.034762 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.stock_dbt_project.marts
[0m09:29:49.052701 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e91cd0cb-cef3-4b65-8dee-97457a7b512c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026A613E07D0>]}
[0m09:29:49.392901 [debug] [MainThread]: Wrote artifact WritableManifest to D:\Stock_price\stock_dbt_project\target\manifest.json
[0m09:29:49.400205 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\Stock_price\stock_dbt_project\target\semantic_manifest.json
[0m09:29:49.520155 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e91cd0cb-cef3-4b65-8dee-97457a7b512c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026A613921E0>]}
[0m09:29:49.522149 [info ] [MainThread]: Found 4 models, 7 operations, 4 data tests, 426 macros
[0m09:29:49.525105 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e91cd0cb-cef3-4b65-8dee-97457a7b512c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026A61189A30>]}
[0m09:29:49.530498 [info ] [MainThread]: 
[0m09:29:49.534043 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m09:29:49.538769 [info ] [MainThread]: 
[0m09:29:49.542329 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m09:29:49.546412 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m09:29:49.886057 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m09:29:49.888482 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m09:29:49.890807 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:29:49.951524 [debug] [ThreadPool]: SQL status: OK in 0.060 seconds
[0m09:29:49.957689 [debug] [ThreadPool]: On list_dev: Close
[0m09:29:49.960636 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m09:29:49.962741 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m09:29:49.990112 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m09:29:49.991973 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "create_dev_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m09:29:49.993048 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:29:49.995827 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m09:29:50.000515 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m09:29:50.001614 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m09:29:50.003315 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m09:29:50.004425 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m09:29:50.004970 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "create_dev_main"} */

    
    
        create schema if not exists "dev"."main"
    
[0m09:29:50.006112 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m09:29:50.008556 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m09:29:50.009561 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m09:29:50.009561 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m09:29:50.010560 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m09:29:50.011558 [debug] [ThreadPool]: On create_dev_main: Close
[0m09:29:50.022648 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev_main'
[0m09:29:50.032999 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m09:29:50.034000 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m09:29:50.035000 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:29:50.037111 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m09:29:50.038104 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m09:29:50.039111 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m09:29:50.072012 [debug] [ThreadPool]: SQL status: OK in 0.032 seconds
[0m09:29:50.074020 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m09:29:50.076009 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m09:29:50.077024 [debug] [ThreadPool]: On list_dev_main: Close
[0m09:29:50.078281 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e91cd0cb-cef3-4b65-8dee-97457a7b512c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026A613C0E00>]}
[0m09:29:50.079299 [debug] [MainThread]: Using duckdb connection "master"
[0m09:29:50.080331 [debug] [MainThread]: On master: BEGIN
[0m09:29:50.081288 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:29:50.082293 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m09:29:50.083297 [debug] [MainThread]: On master: COMMIT
[0m09:29:50.084761 [debug] [MainThread]: Using duckdb connection "master"
[0m09:29:50.085765 [debug] [MainThread]: On master: COMMIT
[0m09:29:50.086767 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m09:29:50.096038 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-0"
[0m09:29:50.105598 [info ] [MainThread]: 1 of 7 START hook: stock_dbt_project.on-run-start.0 ............................ [RUN]
[0m09:29:50.107612 [debug] [MainThread]: Using duckdb connection "master"
[0m09:29:50.108610 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
INSTALL httpfs;
[0m09:29:50.110614 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m09:29:50.113055 [info ] [MainThread]: 1 of 7 OK hook: stock_dbt_project.on-run-start.0 ............................... [[32mOK[0m in 0.03s]
[0m09:29:50.117289 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-1"
[0m09:29:50.120372 [info ] [MainThread]: 2 of 7 START hook: stock_dbt_project.on-run-start.1 ............................ [RUN]
[0m09:29:50.121932 [debug] [MainThread]: Using duckdb connection "master"
[0m09:29:50.123038 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
INSTALL json;
[0m09:29:50.125300 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m09:29:50.127510 [info ] [MainThread]: 2 of 7 OK hook: stock_dbt_project.on-run-start.1 ............................... [[32mOK[0m in 0.01s]
[0m09:29:50.133584 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-2"
[0m09:29:50.135590 [info ] [MainThread]: 3 of 7 START hook: stock_dbt_project.on-run-start.2 ............................ [RUN]
[0m09:29:50.136583 [debug] [MainThread]: Using duckdb connection "master"
[0m09:29:50.137592 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
LOAD httpfs;
[0m09:29:50.442464 [debug] [MainThread]: SQL status: OK in 0.304 seconds
[0m09:29:50.444453 [info ] [MainThread]: 3 of 7 OK hook: stock_dbt_project.on-run-start.2 ............................... [[32mOK[0m in 0.32s]
[0m09:29:50.449993 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-3"
[0m09:29:50.452993 [info ] [MainThread]: 4 of 7 START hook: stock_dbt_project.on-run-start.3 ............................ [RUN]
[0m09:29:50.454990 [debug] [MainThread]: Using duckdb connection "master"
[0m09:29:50.455991 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
LOAD json;
[0m09:29:50.457988 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m09:29:50.459992 [info ] [MainThread]: 4 of 7 OK hook: stock_dbt_project.on-run-start.3 ............................... [[32mOK[0m in 0.01s]
[0m09:29:50.462997 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-4"
[0m09:29:50.466387 [info ] [MainThread]: 5 of 7 START hook: stock_dbt_project.on-run-start.4 ............................ [RUN]
[0m09:29:50.469039 [debug] [MainThread]: Using duckdb connection "master"
[0m09:29:50.471039 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
SET s3_access_key_id='minioadmin';
[0m09:29:50.472038 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m09:29:50.474036 [info ] [MainThread]: 5 of 7 OK hook: stock_dbt_project.on-run-start.4 ............................... [[32mOK[0m in 0.01s]
[0m09:29:50.478201 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-5"
[0m09:29:50.480275 [info ] [MainThread]: 6 of 7 START hook: stock_dbt_project.on-run-start.5 ............................ [RUN]
[0m09:29:50.483099 [debug] [MainThread]: Using duckdb connection "master"
[0m09:29:50.485096 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
SET s3_secret_access_key='minioadmin';
[0m09:29:50.487248 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m09:29:50.490261 [info ] [MainThread]: 6 of 7 OK hook: stock_dbt_project.on-run-start.5 ............................... [[32mOK[0m in 0.01s]
[0m09:29:50.494252 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-6"
[0m09:29:50.497258 [info ] [MainThread]: 7 of 7 START hook: stock_dbt_project.on-run-start.6 ............................ [RUN]
[0m09:29:50.501271 [debug] [MainThread]: Using duckdb connection "master"
[0m09:29:50.503268 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
SET s3_endpoint='http://localhost:9000';
[0m09:29:50.505269 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m09:29:50.509268 [info ] [MainThread]: 7 of 7 OK hook: stock_dbt_project.on-run-start.6 ............................... [[32mOK[0m in 0.02s]
[0m09:29:50.511268 [info ] [MainThread]: 
[0m09:29:50.512277 [debug] [MainThread]: On master: Close
[0m09:29:50.526685 [debug] [Thread-1 (]: Began running node model.stock_dbt_project.stg_stock_data
[0m09:29:50.528405 [info ] [Thread-1 (]: 1 of 1 START sql view model main.stg_stock_data ................................ [RUN]
[0m09:29:50.530057 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.stock_dbt_project.stg_stock_data'
[0m09:29:50.531130 [debug] [Thread-1 (]: Began compiling node model.stock_dbt_project.stg_stock_data
[0m09:29:50.539400 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_dbt_project.stg_stock_data"
[0m09:29:50.541278 [debug] [Thread-1 (]: Began executing node model.stock_dbt_project.stg_stock_data
[0m09:29:50.700452 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_dbt_project.stg_stock_data"
[0m09:29:50.708450 [debug] [Thread-1 (]: Using duckdb connection "model.stock_dbt_project.stg_stock_data"
[0m09:29:50.711378 [debug] [Thread-1 (]: On model.stock_dbt_project.stg_stock_data: BEGIN
[0m09:29:50.714485 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m09:29:50.721062 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m09:29:50.723561 [debug] [Thread-1 (]: Using duckdb connection "model.stock_dbt_project.stg_stock_data"
[0m09:29:50.725566 [debug] [Thread-1 (]: On model.stock_dbt_project.stg_stock_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "node_id": "model.stock_dbt_project.stg_stock_data"} */

  
  create view "dev"."main"."stg_stock_data__dbt_tmp" as (
    



WITH raw AS (
    SELECT *
    FROM read_json_auto('s3://my-stock-data-bucket/stocks/*/*/*/*.json')
)

SELECT
    CAST(symbol AS TEXT) AS symbol,
    CAST(datetime AS TIMESTAMP) AS datetime,
    CAST(open AS DOUBLE) AS open,
    CAST(high AS DOUBLE) AS high,
    CAST(low AS DOUBLE) AS low,
    CAST(close AS DOUBLE) AS close,
    CAST(volume AS BIGINT) AS volume
FROM raw
WHERE symbol IS NOT NULL AND datetime IS NOT NULL
  );

[0m09:29:51.163371 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "node_id": "model.stock_dbt_project.stg_stock_data"} */

  
  create view "dev"."main"."stg_stock_data__dbt_tmp" as (
    



WITH raw AS (
    SELECT *
    FROM read_json_auto('s3://my-stock-data-bucket/stocks/*/*/*/*.json')
)

SELECT
    CAST(symbol AS TEXT) AS symbol,
    CAST(datetime AS TIMESTAMP) AS datetime,
    CAST(open AS DOUBLE) AS open,
    CAST(high AS DOUBLE) AS high,
    CAST(low AS DOUBLE) AS low,
    CAST(close AS DOUBLE) AS close,
    CAST(volume AS BIGINT) AS volume
FROM raw
WHERE symbol IS NOT NULL AND datetime IS NOT NULL
  );

[0m09:29:51.166290 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m09:29:51.169896 [debug] [Thread-1 (]: On model.stock_dbt_project.stg_stock_data: ROLLBACK
[0m09:29:51.188017 [debug] [Thread-1 (]: Failed to rollback 'model.stock_dbt_project.stg_stock_data'
[0m09:29:51.190546 [debug] [Thread-1 (]: On model.stock_dbt_project.stg_stock_data: Close
[0m09:29:51.199658 [debug] [Thread-1 (]: Runtime Error in model stg_stock_data (models\staging\stg_stock_data.sql)
  HTTP Error: HTTP GET error on '/?encoding-type=url&list-type=2&prefix=stocks%2F' (HTTP 403)
[0m09:29:51.207658 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e91cd0cb-cef3-4b65-8dee-97457a7b512c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026A61A1A660>]}
[0m09:29:51.210042 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model main.stg_stock_data ....................... [[31mERROR[0m in 0.67s]
[0m09:29:51.212027 [debug] [Thread-1 (]: Finished running node model.stock_dbt_project.stg_stock_data
[0m09:29:51.219350 [debug] [Thread-4 (]: Marking all children of 'model.stock_dbt_project.stg_stock_data' to be skipped because of status 'error'.  Reason: Runtime Error in model stg_stock_data (models\staging\stg_stock_data.sql)
  HTTP Error: HTTP GET error on '/?encoding-type=url&list-type=2&prefix=stocks%2F' (HTTP 403).
[0m09:29:51.226218 [debug] [MainThread]: Using duckdb connection "master"
[0m09:29:51.227054 [debug] [MainThread]: On master: BEGIN
[0m09:29:51.228567 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:29:51.231090 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m09:29:51.233173 [debug] [MainThread]: On master: COMMIT
[0m09:29:51.234191 [debug] [MainThread]: Using duckdb connection "master"
[0m09:29:51.235203 [debug] [MainThread]: On master: COMMIT
[0m09:29:51.238199 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m09:29:51.239193 [debug] [MainThread]: On master: Close
[0m09:29:51.240200 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:29:51.241260 [debug] [MainThread]: Connection 'create_dev_main' was properly closed.
[0m09:29:51.241774 [debug] [MainThread]: Connection 'list_dev_main' was properly closed.
[0m09:29:51.243794 [debug] [MainThread]: Connection 'model.stock_dbt_project.stg_stock_data' was properly closed.
[0m09:29:51.244793 [info ] [MainThread]: 
[0m09:29:51.245792 [info ] [MainThread]: Finished running 7 project hooks, 1 view model in 0 hours 0 minutes and 1.70 seconds (1.70s).
[0m09:29:51.253874 [debug] [MainThread]: Command end result
[0m09:29:51.340374 [debug] [MainThread]: Wrote artifact WritableManifest to D:\Stock_price\stock_dbt_project\target\manifest.json
[0m09:29:51.348162 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\Stock_price\stock_dbt_project\target\semantic_manifest.json
[0m09:29:51.375329 [debug] [MainThread]: Wrote artifact RunExecutionResult to D:\Stock_price\stock_dbt_project\target\run_results.json
[0m09:29:51.377033 [info ] [MainThread]: 
[0m09:29:51.378024 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m09:29:51.380026 [info ] [MainThread]: 
[0m09:29:51.385979 [error] [MainThread]:   Runtime Error in model stg_stock_data (models\staging\stg_stock_data.sql)
  HTTP Error: HTTP GET error on '/?encoding-type=url&list-type=2&prefix=stocks%2F' (HTTP 403)
[0m09:29:51.387973 [info ] [MainThread]: 
[0m09:29:51.390219 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=1 SKIP=0 TOTAL=8
[0m09:29:51.393786 [debug] [MainThread]: Command `dbt run` failed at 09:29:51.393786 after 6.84 seconds
[0m09:29:51.394782 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026A5F91D040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026A5F1306B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026A5F133620>]}
[0m09:29:51.399400 [debug] [MainThread]: Flushing usage events
[0m09:29:52.119892 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:32:08.222499 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013941D06FC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013941D06090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001393EA24920>]}


============================== 09:32:08.234593 | f940f7a5-832e-4edc-8cd5-20818a1ac9df ==============================
[0m09:32:08.234593 [info ] [MainThread]: Running with dbt=1.9.4
[0m09:32:08.237763 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\loges\\.dbt', 'log_path': 'D:\\Stock_price\\stock_dbt_project\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run --select stg_stock_data', 'send_anonymous_usage_stats': 'True'}
[0m09:32:08.629290 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f940f7a5-832e-4edc-8cd5-20818a1ac9df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013941E802F0>]}
[0m09:32:08.807363 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f940f7a5-832e-4edc-8cd5-20818a1ac9df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013941E80530>]}
[0m09:32:08.809017 [info ] [MainThread]: Registered adapter: duckdb=1.9.2
[0m09:32:09.165722 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m09:32:09.406762 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m09:32:09.408960 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'f940f7a5-832e-4edc-8cd5-20818a1ac9df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000139419998E0>]}
[0m09:32:13.124020 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.stock_dbt_project.marts
[0m09:32:13.124020 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f940f7a5-832e-4edc-8cd5-20818a1ac9df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000139421441D0>]}
[0m09:32:13.309155 [debug] [MainThread]: Wrote artifact WritableManifest to D:\Stock_price\stock_dbt_project\target\manifest.json
[0m09:32:13.314797 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\Stock_price\stock_dbt_project\target\semantic_manifest.json
[0m09:32:13.367904 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f940f7a5-832e-4edc-8cd5-20818a1ac9df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001394364C6E0>]}
[0m09:32:13.369903 [info ] [MainThread]: Found 4 models, 9 operations, 4 data tests, 426 macros
[0m09:32:13.370903 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f940f7a5-832e-4edc-8cd5-20818a1ac9df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001394344E6F0>]}
[0m09:32:13.373744 [info ] [MainThread]: 
[0m09:32:13.373744 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m09:32:13.373744 [info ] [MainThread]: 
[0m09:32:13.373744 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m09:32:13.378229 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m09:32:13.572193 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m09:32:13.573196 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m09:32:13.575736 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:32:13.609645 [debug] [ThreadPool]: SQL status: OK in 0.039 seconds
[0m09:32:13.620368 [debug] [ThreadPool]: On list_dev: Close
[0m09:32:13.623067 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m09:32:13.623847 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m09:32:13.644311 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m09:32:13.650766 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "create_dev_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m09:32:13.654135 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:32:13.657126 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m09:32:13.659409 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m09:32:13.659409 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m09:32:13.659409 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m09:32:13.659409 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m09:32:13.666866 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "create_dev_main"} */

    
    
        create schema if not exists "dev"."main"
    
[0m09:32:13.670515 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m09:32:13.673189 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m09:32:13.674204 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m09:32:13.676201 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m09:32:13.677918 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m09:32:13.679007 [debug] [ThreadPool]: On create_dev_main: Close
[0m09:32:13.702237 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev_main'
[0m09:32:13.721284 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m09:32:13.722311 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m09:32:13.724304 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:32:13.725304 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m09:32:13.728139 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m09:32:13.729854 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m09:32:13.804788 [debug] [ThreadPool]: SQL status: OK in 0.074 seconds
[0m09:32:13.808798 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m09:32:13.810911 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m09:32:13.810911 [debug] [ThreadPool]: On list_dev_main: Close
[0m09:32:13.818997 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f940f7a5-832e-4edc-8cd5-20818a1ac9df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000139436AD7F0>]}
[0m09:32:13.821999 [debug] [MainThread]: Using duckdb connection "master"
[0m09:32:13.823323 [debug] [MainThread]: On master: BEGIN
[0m09:32:13.824718 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:32:13.824718 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m09:32:13.824718 [debug] [MainThread]: On master: COMMIT
[0m09:32:13.824718 [debug] [MainThread]: Using duckdb connection "master"
[0m09:32:13.824718 [debug] [MainThread]: On master: COMMIT
[0m09:32:13.824718 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m09:32:13.845580 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-0"
[0m09:32:13.859378 [info ] [MainThread]: 1 of 9 START hook: stock_dbt_project.on-run-start.0 ............................ [RUN]
[0m09:32:13.859378 [debug] [MainThread]: Using duckdb connection "master"
[0m09:32:13.859378 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
INSTALL httpfs;
[0m09:32:13.868210 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m09:32:13.871194 [info ] [MainThread]: 1 of 9 OK hook: stock_dbt_project.on-run-start.0 ............................... [[32mOK[0m in 0.05s]
[0m09:32:13.878730 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-1"
[0m09:32:13.882524 [info ] [MainThread]: 2 of 9 START hook: stock_dbt_project.on-run-start.1 ............................ [RUN]
[0m09:32:13.891999 [debug] [MainThread]: Using duckdb connection "master"
[0m09:32:13.894578 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
INSTALL json;
[0m09:32:13.904779 [debug] [MainThread]: SQL status: OK in 0.009 seconds
[0m09:32:13.909142 [info ] [MainThread]: 2 of 9 OK hook: stock_dbt_project.on-run-start.1 ............................... [[32mOK[0m in 0.03s]
[0m09:32:13.914340 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-2"
[0m09:32:13.917449 [info ] [MainThread]: 3 of 9 START hook: stock_dbt_project.on-run-start.2 ............................ [RUN]
[0m09:32:13.925250 [debug] [MainThread]: Using duckdb connection "master"
[0m09:32:13.927254 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
LOAD httpfs;
[0m09:32:14.289716 [debug] [MainThread]: SQL status: OK in 0.361 seconds
[0m09:32:14.293007 [info ] [MainThread]: 3 of 9 OK hook: stock_dbt_project.on-run-start.2 ............................... [[32mOK[0m in 0.38s]
[0m09:32:14.299390 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-3"
[0m09:32:14.305189 [info ] [MainThread]: 4 of 9 START hook: stock_dbt_project.on-run-start.3 ............................ [RUN]
[0m09:32:14.308187 [debug] [MainThread]: Using duckdb connection "master"
[0m09:32:14.310322 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
LOAD json;
[0m09:32:14.311537 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m09:32:14.324275 [info ] [MainThread]: 4 of 9 OK hook: stock_dbt_project.on-run-start.3 ............................... [[32mOK[0m in 0.03s]
[0m09:32:14.340772 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-4"
[0m09:32:14.344868 [info ] [MainThread]: 5 of 9 START hook: stock_dbt_project.on-run-start.4 ............................ [RUN]
[0m09:32:14.346867 [debug] [MainThread]: Using duckdb connection "master"
[0m09:32:14.350235 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
SET s3_access_key_id='minioadmin';
[0m09:32:14.354990 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m09:32:14.360281 [info ] [MainThread]: 5 of 9 OK hook: stock_dbt_project.on-run-start.4 ............................... [[32mOK[0m in 0.03s]
[0m09:32:14.370135 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-5"
[0m09:32:14.373906 [info ] [MainThread]: 6 of 9 START hook: stock_dbt_project.on-run-start.5 ............................ [RUN]
[0m09:32:14.376899 [debug] [MainThread]: Using duckdb connection "master"
[0m09:32:14.377901 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
SET s3_secret_access_key='minioadmin';
[0m09:32:14.379910 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m09:32:14.383059 [info ] [MainThread]: 6 of 9 OK hook: stock_dbt_project.on-run-start.5 ............................... [[32mOK[0m in 0.02s]
[0m09:32:14.394152 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-6"
[0m09:32:14.400093 [info ] [MainThread]: 7 of 9 START hook: stock_dbt_project.on-run-start.6 ............................ [RUN]
[0m09:32:14.411523 [debug] [MainThread]: Using duckdb connection "master"
[0m09:32:14.415107 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
SET s3_endpoint='http://localhost:9000';
[0m09:32:14.419827 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m09:32:14.428461 [info ] [MainThread]: 7 of 9 OK hook: stock_dbt_project.on-run-start.6 ............................... [[32mOK[0m in 0.04s]
[0m09:32:14.440072 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-7"
[0m09:32:14.443360 [info ] [MainThread]: 8 of 9 START hook: stock_dbt_project.on-run-start.7 ............................ [RUN]
[0m09:32:14.447065 [debug] [MainThread]: Using duckdb connection "master"
[0m09:32:14.449728 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
SET MINIO_USERNAME='minioadmin';
[0m09:32:14.468398 [debug] [MainThread]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
SET MINIO_USERNAME='minioadmin';
[0m09:32:14.472117 [debug] [MainThread]: DuckDB adapter: Rolling back transaction.
[0m09:32:14.474114 [info ] [MainThread]: 8 of 9 ERROR hook: stock_dbt_project.on-run-start.7 ............................ [[31mERROR[0m in 0.04s]
[0m09:32:14.477449 [info ] [MainThread]: 9 of 9 SKIP hook: stock_dbt_project.on-run-start.8 ............................. [[33mSKIP[0m in 0.00s]
[0m09:32:14.479579 [info ] [MainThread]: 
[0m09:32:14.481710 [debug] [MainThread]: On master: Close
[0m09:32:14.497115 [debug] [Thread-1 (]: Began running node model.stock_dbt_project.stg_stock_data
[0m09:32:14.501256 [info ] [Thread-1 (]: 1 of 1 START sql view model main.stg_stock_data ................................ [RUN]
[0m09:32:14.506726 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.stock_dbt_project.stg_stock_data'
[0m09:32:14.508673 [debug] [Thread-1 (]: Began compiling node model.stock_dbt_project.stg_stock_data
[0m09:32:14.523887 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_dbt_project.stg_stock_data"
[0m09:32:14.527189 [debug] [Thread-1 (]: Began executing node model.stock_dbt_project.stg_stock_data
[0m09:32:14.647808 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_dbt_project.stg_stock_data"
[0m09:32:14.653166 [debug] [Thread-1 (]: Using duckdb connection "model.stock_dbt_project.stg_stock_data"
[0m09:32:14.655163 [debug] [Thread-1 (]: On model.stock_dbt_project.stg_stock_data: BEGIN
[0m09:32:14.656470 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m09:32:14.658696 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m09:32:14.658696 [debug] [Thread-1 (]: Using duckdb connection "model.stock_dbt_project.stg_stock_data"
[0m09:32:14.658696 [debug] [Thread-1 (]: On model.stock_dbt_project.stg_stock_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "node_id": "model.stock_dbt_project.stg_stock_data"} */

  
  create view "dev"."main"."stg_stock_data__dbt_tmp" as (
    



WITH raw AS (
    SELECT *
    FROM read_json_auto('s3://my-stock-data-bucket/stocks/*/*/*/*.json')
)

SELECT
    CAST(symbol AS TEXT) AS symbol,
    CAST(datetime AS TIMESTAMP) AS datetime,
    CAST(open AS DOUBLE) AS open,
    CAST(high AS DOUBLE) AS high,
    CAST(low AS DOUBLE) AS low,
    CAST(close AS DOUBLE) AS close,
    CAST(volume AS BIGINT) AS volume
FROM raw
WHERE symbol IS NOT NULL AND datetime IS NOT NULL
  );

[0m09:32:15.077474 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "node_id": "model.stock_dbt_project.stg_stock_data"} */

  
  create view "dev"."main"."stg_stock_data__dbt_tmp" as (
    



WITH raw AS (
    SELECT *
    FROM read_json_auto('s3://my-stock-data-bucket/stocks/*/*/*/*.json')
)

SELECT
    CAST(symbol AS TEXT) AS symbol,
    CAST(datetime AS TIMESTAMP) AS datetime,
    CAST(open AS DOUBLE) AS open,
    CAST(high AS DOUBLE) AS high,
    CAST(low AS DOUBLE) AS low,
    CAST(close AS DOUBLE) AS close,
    CAST(volume AS BIGINT) AS volume
FROM raw
WHERE symbol IS NOT NULL AND datetime IS NOT NULL
  );

[0m09:32:15.077474 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m09:32:15.080498 [debug] [Thread-1 (]: On model.stock_dbt_project.stg_stock_data: ROLLBACK
[0m09:32:15.104092 [debug] [Thread-1 (]: Failed to rollback 'model.stock_dbt_project.stg_stock_data'
[0m09:32:15.106316 [debug] [Thread-1 (]: On model.stock_dbt_project.stg_stock_data: Close
[0m09:32:15.119610 [debug] [Thread-1 (]: Runtime Error in model stg_stock_data (models\staging\stg_stock_data.sql)
  HTTP Error: HTTP GET error on '/?encoding-type=url&list-type=2&prefix=stocks%2F' (HTTP 403)
[0m09:32:15.129060 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f940f7a5-832e-4edc-8cd5-20818a1ac9df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000139412E2690>]}
[0m09:32:15.132688 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model main.stg_stock_data ....................... [[31mERROR[0m in 0.62s]
[0m09:32:15.138882 [debug] [Thread-1 (]: Finished running node model.stock_dbt_project.stg_stock_data
[0m09:32:15.141772 [debug] [Thread-4 (]: Marking all children of 'model.stock_dbt_project.stg_stock_data' to be skipped because of status 'error'.  Reason: Runtime Error in model stg_stock_data (models\staging\stg_stock_data.sql)
  HTTP Error: HTTP GET error on '/?encoding-type=url&list-type=2&prefix=stocks%2F' (HTTP 403).
[0m09:32:15.143948 [debug] [MainThread]: Using duckdb connection "master"
[0m09:32:15.151042 [debug] [MainThread]: On master: BEGIN
[0m09:32:15.153603 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:32:15.156136 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m09:32:15.158147 [debug] [MainThread]: On master: COMMIT
[0m09:32:15.159152 [debug] [MainThread]: Using duckdb connection "master"
[0m09:32:15.160152 [debug] [MainThread]: On master: COMMIT
[0m09:32:15.162520 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m09:32:15.164572 [debug] [MainThread]: On master: Close
[0m09:32:15.167317 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:32:15.170967 [debug] [MainThread]: Connection 'create_dev_main' was properly closed.
[0m09:32:15.173042 [debug] [MainThread]: Connection 'list_dev_main' was properly closed.
[0m09:32:15.175043 [debug] [MainThread]: Connection 'model.stock_dbt_project.stg_stock_data' was properly closed.
[0m09:32:15.177046 [info ] [MainThread]: 
[0m09:32:15.179140 [info ] [MainThread]: Finished running 9 project hooks, 1 view model in 0 hours 0 minutes and 1.80 seconds (1.80s).
[0m09:32:15.190294 [debug] [MainThread]: Command end result
[0m09:32:15.315747 [debug] [MainThread]: Wrote artifact WritableManifest to D:\Stock_price\stock_dbt_project\target\manifest.json
[0m09:32:15.326734 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\Stock_price\stock_dbt_project\target\semantic_manifest.json
[0m09:32:15.372555 [debug] [MainThread]: Wrote artifact RunExecutionResult to D:\Stock_price\stock_dbt_project\target\run_results.json
[0m09:32:15.375716 [info ] [MainThread]: 
[0m09:32:15.383888 [info ] [MainThread]: [31mCompleted with 3 errors, 0 partial successes, and 0 warnings:[0m
[0m09:32:15.390502 [info ] [MainThread]: 
[0m09:32:15.394571 [error] [MainThread]:   stock_dbt_project.on-run-start.7 failed, error:
 Catalog Error: unrecognized configuration parameter "MINIO_USERNAME"

Did you mean: "username"
[0m09:32:15.398232 [debug] [MainThread]: 
[0m09:32:15.403531 [debug] [MainThread]:   stock_dbt_project.on-run-start.8 skipped
[0m09:32:15.407217 [info ] [MainThread]: 
[0m09:32:15.409924 [error] [MainThread]:   Runtime Error in model stg_stock_data (models\staging\stg_stock_data.sql)
  HTTP Error: HTTP GET error on '/?encoding-type=url&list-type=2&prefix=stocks%2F' (HTTP 403)
[0m09:32:15.413540 [info ] [MainThread]: 
[0m09:32:15.419966 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=2 SKIP=1 TOTAL=10
[0m09:32:15.427716 [debug] [MainThread]: Command `dbt run` failed at 09:32:15.426652 after 7.67 seconds
[0m09:32:15.436685 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001393EA24920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001394199AF90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001394199AEA0>]}
[0m09:32:15.441062 [debug] [MainThread]: Flushing usage events
[0m09:32:16.274728 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:36:07.833817 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FC85DA9460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FC8585B920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FC85DAA1E0>]}


============================== 09:36:07.846473 | c4f07539-def2-448c-879f-c6510594f32c ==============================
[0m09:36:07.846473 [info ] [MainThread]: Running with dbt=1.9.4
[0m09:36:07.846473 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\loges\\.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': 'D:\\Stock_price\\stock_dbt_project\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run --select stg_stock_data', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m09:36:08.355925 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c4f07539-def2-448c-879f-c6510594f32c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FC862A19D0>]}
[0m09:36:08.442992 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c4f07539-def2-448c-879f-c6510594f32c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FC8626A660>]}
[0m09:36:08.452381 [info ] [MainThread]: Registered adapter: duckdb=1.9.2
[0m09:36:08.893921 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m09:36:09.074799 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m09:36:09.074799 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'c4f07539-def2-448c-879f-c6510594f32c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FC8572FD10>]}
[0m09:36:13.429381 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.stock_dbt_project.marts
[0m09:36:13.446311 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c4f07539-def2-448c-879f-c6510594f32c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FC8621A0C0>]}
[0m09:36:13.786181 [debug] [MainThread]: Wrote artifact WritableManifest to D:\Stock_price\stock_dbt_project\target\manifest.json
[0m09:36:13.791779 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\Stock_price\stock_dbt_project\target\semantic_manifest.json
[0m09:36:13.859815 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c4f07539-def2-448c-879f-c6510594f32c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FC879FE030>]}
[0m09:36:13.861012 [info ] [MainThread]: Found 4 models, 9 operations, 4 data tests, 426 macros
[0m09:36:13.862720 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c4f07539-def2-448c-879f-c6510594f32c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FC87A093D0>]}
[0m09:36:13.866568 [info ] [MainThread]: 
[0m09:36:13.868702 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m09:36:13.870930 [info ] [MainThread]: 
[0m09:36:13.873513 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m09:36:13.876259 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m09:36:14.023723 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m09:36:14.025951 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m09:36:14.026036 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:36:14.042390 [debug] [ThreadPool]: SQL status: OK in 0.022 seconds
[0m09:36:14.042390 [debug] [ThreadPool]: On list_dev: Close
[0m09:36:14.042390 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m09:36:14.042390 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m09:36:14.062127 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m09:36:14.062127 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "create_dev_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m09:36:14.062127 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:36:14.069423 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m09:36:14.076666 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m09:36:14.078374 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m09:36:14.080009 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m09:36:14.080544 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m09:36:14.081069 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "create_dev_main"} */

    
    
        create schema if not exists "dev"."main"
    
[0m09:36:14.082106 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m09:36:14.083691 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m09:36:14.085378 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m09:36:14.086540 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m09:36:14.087672 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m09:36:14.088816 [debug] [ThreadPool]: On create_dev_main: Close
[0m09:36:14.097492 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev_main'
[0m09:36:14.109374 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m09:36:14.110390 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m09:36:14.110729 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:36:14.110729 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m09:36:14.110729 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m09:36:14.110729 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m09:36:14.145498 [debug] [ThreadPool]: SQL status: OK in 0.035 seconds
[0m09:36:14.153695 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m09:36:14.156686 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m09:36:14.157834 [debug] [ThreadPool]: On list_dev_main: Close
[0m09:36:14.158897 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c4f07539-def2-448c-879f-c6510594f32c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FC86243D70>]}
[0m09:36:14.159305 [debug] [MainThread]: Using duckdb connection "master"
[0m09:36:14.159305 [debug] [MainThread]: On master: BEGIN
[0m09:36:14.159305 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:36:14.159305 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m09:36:14.159305 [debug] [MainThread]: On master: COMMIT
[0m09:36:14.159305 [debug] [MainThread]: Using duckdb connection "master"
[0m09:36:14.159305 [debug] [MainThread]: On master: COMMIT
[0m09:36:14.164839 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m09:36:14.176906 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-0"
[0m09:36:14.180136 [info ] [MainThread]: 1 of 9 START hook: stock_dbt_project.on-run-start.0 ............................ [RUN]
[0m09:36:14.187226 [debug] [MainThread]: Using duckdb connection "master"
[0m09:36:14.188249 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
INSTALL httpfs;
[0m09:36:14.190246 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m09:36:14.192444 [info ] [MainThread]: 1 of 9 OK hook: stock_dbt_project.on-run-start.0 ............................... [[32mOK[0m in 0.03s]
[0m09:36:14.194974 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-1"
[0m09:36:14.196964 [info ] [MainThread]: 2 of 9 START hook: stock_dbt_project.on-run-start.1 ............................ [RUN]
[0m09:36:14.198046 [debug] [MainThread]: Using duckdb connection "master"
[0m09:36:14.198046 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
INSTALL json;
[0m09:36:14.200442 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m09:36:14.203944 [info ] [MainThread]: 2 of 9 OK hook: stock_dbt_project.on-run-start.1 ............................... [[32mOK[0m in 0.01s]
[0m09:36:14.210339 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-2"
[0m09:36:14.212647 [info ] [MainThread]: 3 of 9 START hook: stock_dbt_project.on-run-start.2 ............................ [RUN]
[0m09:36:14.214687 [debug] [MainThread]: Using duckdb connection "master"
[0m09:36:14.215291 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
LOAD httpfs;
[0m09:36:14.513140 [debug] [MainThread]: SQL status: OK in 0.303 seconds
[0m09:36:14.524330 [info ] [MainThread]: 3 of 9 OK hook: stock_dbt_project.on-run-start.2 ............................... [[32mOK[0m in 0.32s]
[0m09:36:14.527383 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-3"
[0m09:36:14.527383 [info ] [MainThread]: 4 of 9 START hook: stock_dbt_project.on-run-start.3 ............................ [RUN]
[0m09:36:14.537336 [debug] [MainThread]: Using duckdb connection "master"
[0m09:36:14.539328 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
LOAD json;
[0m09:36:14.542327 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m09:36:14.545324 [info ] [MainThread]: 4 of 9 OK hook: stock_dbt_project.on-run-start.3 ............................... [[32mOK[0m in 0.02s]
[0m09:36:14.549686 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-4"
[0m09:36:14.553718 [info ] [MainThread]: 5 of 9 START hook: stock_dbt_project.on-run-start.4 ............................ [RUN]
[0m09:36:14.557124 [debug] [MainThread]: Using duckdb connection "master"
[0m09:36:14.559120 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
SET s3_access_key_id='minioadmin';
[0m09:36:14.561120 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m09:36:14.563119 [info ] [MainThread]: 5 of 9 OK hook: stock_dbt_project.on-run-start.4 ............................... [[32mOK[0m in 0.02s]
[0m09:36:14.570324 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-5"
[0m09:36:14.574322 [info ] [MainThread]: 6 of 9 START hook: stock_dbt_project.on-run-start.5 ............................ [RUN]
[0m09:36:14.576323 [debug] [MainThread]: Using duckdb connection "master"
[0m09:36:14.577329 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
SET s3_secret_access_key='minioadmin';
[0m09:36:14.579722 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m09:36:14.581888 [info ] [MainThread]: 6 of 9 OK hook: stock_dbt_project.on-run-start.5 ............................... [[32mOK[0m in 0.02s]
[0m09:36:14.592794 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-6"
[0m09:36:14.596924 [info ] [MainThread]: 7 of 9 START hook: stock_dbt_project.on-run-start.6 ............................ [RUN]
[0m09:36:14.604700 [debug] [MainThread]: Using duckdb connection "master"
[0m09:36:14.608573 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
SET s3_endpoint='http://localhost:9000';
[0m09:36:14.611511 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m09:36:14.614209 [info ] [MainThread]: 7 of 9 OK hook: stock_dbt_project.on-run-start.6 ............................... [[32mOK[0m in 0.03s]
[0m09:36:14.629625 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-7"
[0m09:36:14.633846 [info ] [MainThread]: 8 of 9 START hook: stock_dbt_project.on-run-start.7 ............................ [RUN]
[0m09:36:14.640267 [debug] [MainThread]: Using duckdb connection "master"
[0m09:36:14.643842 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
SET S3_bucket=stock-data';
[0m09:36:14.648523 [debug] [MainThread]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
SET S3_bucket=stock-data';
[0m09:36:14.651664 [debug] [MainThread]: DuckDB adapter: Rolling back transaction.
[0m09:36:14.656714 [info ] [MainThread]: 8 of 9 ERROR hook: stock_dbt_project.on-run-start.7 ............................ [[31mERROR[0m in 0.03s]
[0m09:36:14.661804 [info ] [MainThread]: 9 of 9 SKIP hook: stock_dbt_project.on-run-start.8 ............................. [[33mSKIP[0m in 0.00s]
[0m09:36:14.664283 [info ] [MainThread]: 
[0m09:36:14.667037 [debug] [MainThread]: On master: Close
[0m09:36:14.680828 [debug] [Thread-1 (]: Began running node model.stock_dbt_project.stg_stock_data
[0m09:36:14.688970 [info ] [Thread-1 (]: 1 of 1 START sql view model main.stg_stock_data ................................ [RUN]
[0m09:36:14.693249 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.stock_dbt_project.stg_stock_data'
[0m09:36:14.694017 [debug] [Thread-1 (]: Began compiling node model.stock_dbt_project.stg_stock_data
[0m09:36:14.712576 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_dbt_project.stg_stock_data"
[0m09:36:14.715727 [debug] [Thread-1 (]: Began executing node model.stock_dbt_project.stg_stock_data
[0m09:36:14.897807 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_dbt_project.stg_stock_data"
[0m09:36:14.905443 [debug] [Thread-1 (]: Using duckdb connection "model.stock_dbt_project.stg_stock_data"
[0m09:36:14.909155 [debug] [Thread-1 (]: On model.stock_dbt_project.stg_stock_data: BEGIN
[0m09:36:14.910895 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m09:36:14.912410 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m09:36:14.918049 [debug] [Thread-1 (]: Using duckdb connection "model.stock_dbt_project.stg_stock_data"
[0m09:36:14.918564 [debug] [Thread-1 (]: On model.stock_dbt_project.stg_stock_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "node_id": "model.stock_dbt_project.stg_stock_data"} */

  
  create view "dev"."main"."stg_stock_data__dbt_tmp" as (
    



WITH raw AS (
    SELECT *
    FROM read_json_auto('s3://my-stock-data-bucket/stocks/*/*/*/*.json')
)

SELECT
    CAST(symbol AS TEXT) AS symbol,
    CAST(datetime AS TIMESTAMP) AS datetime,
    CAST(open AS DOUBLE) AS open,
    CAST(high AS DOUBLE) AS high,
    CAST(low AS DOUBLE) AS low,
    CAST(close AS DOUBLE) AS close,
    CAST(volume AS BIGINT) AS volume
FROM raw
WHERE symbol IS NOT NULL AND datetime IS NOT NULL
  );

[0m09:36:15.293357 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "node_id": "model.stock_dbt_project.stg_stock_data"} */

  
  create view "dev"."main"."stg_stock_data__dbt_tmp" as (
    



WITH raw AS (
    SELECT *
    FROM read_json_auto('s3://my-stock-data-bucket/stocks/*/*/*/*.json')
)

SELECT
    CAST(symbol AS TEXT) AS symbol,
    CAST(datetime AS TIMESTAMP) AS datetime,
    CAST(open AS DOUBLE) AS open,
    CAST(high AS DOUBLE) AS high,
    CAST(low AS DOUBLE) AS low,
    CAST(close AS DOUBLE) AS close,
    CAST(volume AS BIGINT) AS volume
FROM raw
WHERE symbol IS NOT NULL AND datetime IS NOT NULL
  );

[0m09:36:15.295354 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m09:36:15.297073 [debug] [Thread-1 (]: On model.stock_dbt_project.stg_stock_data: ROLLBACK
[0m09:36:15.315825 [debug] [Thread-1 (]: Failed to rollback 'model.stock_dbt_project.stg_stock_data'
[0m09:36:15.319135 [debug] [Thread-1 (]: On model.stock_dbt_project.stg_stock_data: Close
[0m09:36:15.333002 [debug] [Thread-1 (]: Runtime Error in model stg_stock_data (models\staging\stg_stock_data.sql)
  HTTP Error: HTTP GET error on '/?encoding-type=url&list-type=2&prefix=stocks%2F' (HTTP 403)
[0m09:36:15.346054 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c4f07539-def2-448c-879f-c6510594f32c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FC856F2120>]}
[0m09:36:15.346054 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model main.stg_stock_data ....................... [[31mERROR[0m in 0.65s]
[0m09:36:15.355264 [debug] [Thread-1 (]: Finished running node model.stock_dbt_project.stg_stock_data
[0m09:36:15.358031 [debug] [Thread-4 (]: Marking all children of 'model.stock_dbt_project.stg_stock_data' to be skipped because of status 'error'.  Reason: Runtime Error in model stg_stock_data (models\staging\stg_stock_data.sql)
  HTTP Error: HTTP GET error on '/?encoding-type=url&list-type=2&prefix=stocks%2F' (HTTP 403).
[0m09:36:15.364692 [debug] [MainThread]: Using duckdb connection "master"
[0m09:36:15.366299 [debug] [MainThread]: On master: BEGIN
[0m09:36:15.368882 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:36:15.371331 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m09:36:15.374890 [debug] [MainThread]: On master: COMMIT
[0m09:36:15.376689 [debug] [MainThread]: Using duckdb connection "master"
[0m09:36:15.377688 [debug] [MainThread]: On master: COMMIT
[0m09:36:15.379970 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m09:36:15.381687 [debug] [MainThread]: On master: Close
[0m09:36:15.384403 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:36:15.384403 [debug] [MainThread]: Connection 'create_dev_main' was properly closed.
[0m09:36:15.389540 [debug] [MainThread]: Connection 'list_dev_main' was properly closed.
[0m09:36:15.390556 [debug] [MainThread]: Connection 'model.stock_dbt_project.stg_stock_data' was properly closed.
[0m09:36:15.392553 [info ] [MainThread]: 
[0m09:36:15.395174 [info ] [MainThread]: Finished running 9 project hooks, 1 view model in 0 hours 0 minutes and 1.52 seconds (1.52s).
[0m09:36:15.403069 [debug] [MainThread]: Command end result
[0m09:36:15.501608 [debug] [MainThread]: Wrote artifact WritableManifest to D:\Stock_price\stock_dbt_project\target\manifest.json
[0m09:36:15.513579 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\Stock_price\stock_dbt_project\target\semantic_manifest.json
[0m09:36:15.551547 [debug] [MainThread]: Wrote artifact RunExecutionResult to D:\Stock_price\stock_dbt_project\target\run_results.json
[0m09:36:15.554633 [info ] [MainThread]: 
[0m09:36:15.557698 [info ] [MainThread]: [31mCompleted with 3 errors, 0 partial successes, and 0 warnings:[0m
[0m09:36:15.558995 [info ] [MainThread]: 
[0m09:36:15.561323 [error] [MainThread]:   stock_dbt_project.on-run-start.7 failed, error:
 Parser Error: unterminated quoted string at or near "';"
[0m09:36:15.564702 [debug] [MainThread]: 
[0m09:36:15.568537 [debug] [MainThread]:   stock_dbt_project.on-run-start.8 skipped
[0m09:36:15.571767 [info ] [MainThread]: 
[0m09:36:15.576963 [error] [MainThread]:   Runtime Error in model stg_stock_data (models\staging\stg_stock_data.sql)
  HTTP Error: HTTP GET error on '/?encoding-type=url&list-type=2&prefix=stocks%2F' (HTTP 403)
[0m09:36:15.579922 [info ] [MainThread]: 
[0m09:36:15.582960 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=2 SKIP=1 TOTAL=10
[0m09:36:15.590919 [debug] [MainThread]: Command `dbt run` failed at 09:36:15.590003 after 8.00 seconds
[0m09:36:15.594081 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FC85E3BB00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FC85C65C40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FC85DAA1E0>]}
[0m09:36:15.596176 [debug] [MainThread]: Flushing usage events
[0m09:36:16.298986 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:36:51.426186 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002007FC43920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002007FC42D20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200011F3E30>]}


============================== 09:36:51.445145 | 3c57e55c-ddb9-43cf-b905-b91ac2771156 ==============================
[0m09:36:51.445145 [info ] [MainThread]: Running with dbt=1.9.4
[0m09:36:51.448259 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\loges\\.dbt', 'log_path': 'D:\\Stock_price\\stock_dbt_project\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run --select stg_stock_data', 'send_anonymous_usage_stats': 'True'}
[0m09:36:52.338796 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3c57e55c-ddb9-43cf-b905-b91ac2771156', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200018383B0>]}
[0m09:36:52.597688 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3c57e55c-ddb9-43cf-b905-b91ac2771156', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002007F39A510>]}
[0m09:36:52.611571 [info ] [MainThread]: Registered adapter: duckdb=1.9.2
[0m09:36:53.075248 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m09:36:53.253316 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m09:36:53.255327 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '3c57e55c-ddb9-43cf-b905-b91ac2771156', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200012D9D00>]}
[0m09:36:57.764706 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.stock_dbt_project.marts
[0m09:36:57.783364 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3c57e55c-ddb9-43cf-b905-b91ac2771156', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020001896810>]}
[0m09:36:58.223408 [debug] [MainThread]: Wrote artifact WritableManifest to D:\Stock_price\stock_dbt_project\target\manifest.json
[0m09:36:58.229132 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\Stock_price\stock_dbt_project\target\semantic_manifest.json
[0m09:36:58.279317 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3c57e55c-ddb9-43cf-b905-b91ac2771156', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020002FFE7B0>]}
[0m09:36:58.280301 [info ] [MainThread]: Found 4 models, 9 operations, 4 data tests, 426 macros
[0m09:36:58.280301 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3c57e55c-ddb9-43cf-b905-b91ac2771156', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020002E026F0>]}
[0m09:36:58.280301 [info ] [MainThread]: 
[0m09:36:58.280301 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m09:36:58.287117 [info ] [MainThread]: 
[0m09:36:58.289215 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m09:36:58.291743 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m09:36:58.523165 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m09:36:58.524366 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m09:36:58.525526 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:36:58.556205 [debug] [ThreadPool]: SQL status: OK in 0.031 seconds
[0m09:36:58.558849 [debug] [ThreadPool]: On list_dev: Close
[0m09:36:58.559834 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m09:36:58.561328 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m09:36:58.577279 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m09:36:58.578103 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "create_dev_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m09:36:58.579706 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:36:58.581955 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m09:36:58.584685 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m09:36:58.585615 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m09:36:58.587202 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m09:36:58.588202 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m09:36:58.589199 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "create_dev_main"} */

    
    
        create schema if not exists "dev"."main"
    
[0m09:36:58.590199 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m09:36:58.591194 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m09:36:58.592362 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m09:36:58.592362 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m09:36:58.592362 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m09:36:58.592362 [debug] [ThreadPool]: On create_dev_main: Close
[0m09:36:58.592362 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev_main'
[0m09:36:58.616440 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m09:36:58.618682 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m09:36:58.620673 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:36:58.622961 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m09:36:58.624549 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m09:36:58.625438 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m09:36:58.676836 [debug] [ThreadPool]: SQL status: OK in 0.051 seconds
[0m09:36:58.676836 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m09:36:58.676836 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m09:36:58.688571 [debug] [ThreadPool]: On list_dev_main: Close
[0m09:36:58.692242 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3c57e55c-ddb9-43cf-b905-b91ac2771156', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020002FBD2E0>]}
[0m09:36:58.693849 [debug] [MainThread]: Using duckdb connection "master"
[0m09:36:58.695282 [debug] [MainThread]: On master: BEGIN
[0m09:36:58.696684 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:36:58.698913 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m09:36:58.700008 [debug] [MainThread]: On master: COMMIT
[0m09:36:58.701072 [debug] [MainThread]: Using duckdb connection "master"
[0m09:36:58.703764 [debug] [MainThread]: On master: COMMIT
[0m09:36:58.705627 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m09:36:58.722734 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-0"
[0m09:36:58.737231 [info ] [MainThread]: 1 of 9 START hook: stock_dbt_project.on-run-start.0 ............................ [RUN]
[0m09:36:58.739274 [debug] [MainThread]: Using duckdb connection "master"
[0m09:36:58.740275 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
INSTALL httpfs;
[0m09:36:58.743706 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m09:36:58.747653 [info ] [MainThread]: 1 of 9 OK hook: stock_dbt_project.on-run-start.0 ............................... [[32mOK[0m in 0.04s]
[0m09:36:58.755169 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-1"
[0m09:36:58.758287 [info ] [MainThread]: 2 of 9 START hook: stock_dbt_project.on-run-start.1 ............................ [RUN]
[0m09:36:58.760971 [debug] [MainThread]: Using duckdb connection "master"
[0m09:36:58.762665 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
INSTALL json;
[0m09:36:58.764338 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m09:36:58.766561 [info ] [MainThread]: 2 of 9 OK hook: stock_dbt_project.on-run-start.1 ............................... [[32mOK[0m in 0.02s]
[0m09:36:58.771811 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-2"
[0m09:36:58.774829 [info ] [MainThread]: 3 of 9 START hook: stock_dbt_project.on-run-start.2 ............................ [RUN]
[0m09:36:58.775787 [debug] [MainThread]: Using duckdb connection "master"
[0m09:36:58.776791 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
LOAD httpfs;
[0m09:36:59.030390 [debug] [MainThread]: SQL status: OK in 0.254 seconds
[0m09:36:59.030390 [info ] [MainThread]: 3 of 9 OK hook: stock_dbt_project.on-run-start.2 ............................... [[32mOK[0m in 0.26s]
[0m09:36:59.038940 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-3"
[0m09:36:59.040108 [info ] [MainThread]: 4 of 9 START hook: stock_dbt_project.on-run-start.3 ............................ [RUN]
[0m09:36:59.041173 [debug] [MainThread]: Using duckdb connection "master"
[0m09:36:59.042278 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
LOAD json;
[0m09:36:59.043383 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m09:36:59.045043 [info ] [MainThread]: 4 of 9 OK hook: stock_dbt_project.on-run-start.3 ............................... [[32mOK[0m in 0.01s]
[0m09:36:59.047807 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-4"
[0m09:36:59.048906 [info ] [MainThread]: 5 of 9 START hook: stock_dbt_project.on-run-start.4 ............................ [RUN]
[0m09:36:59.050017 [debug] [MainThread]: Using duckdb connection "master"
[0m09:36:59.051046 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
SET s3_access_key_id='minioadmin';
[0m09:36:59.053262 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m09:36:59.055449 [info ] [MainThread]: 5 of 9 OK hook: stock_dbt_project.on-run-start.4 ............................... [[32mOK[0m in 0.01s]
[0m09:36:59.060336 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-5"
[0m09:36:59.062887 [info ] [MainThread]: 6 of 9 START hook: stock_dbt_project.on-run-start.5 ............................ [RUN]
[0m09:36:59.064597 [debug] [MainThread]: Using duckdb connection "master"
[0m09:36:59.066047 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
SET s3_secret_access_key='minioadmin';
[0m09:36:59.067821 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m09:36:59.070800 [info ] [MainThread]: 6 of 9 OK hook: stock_dbt_project.on-run-start.5 ............................... [[32mOK[0m in 0.01s]
[0m09:36:59.074380 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-6"
[0m09:36:59.075378 [info ] [MainThread]: 7 of 9 START hook: stock_dbt_project.on-run-start.6 ............................ [RUN]
[0m09:36:59.077376 [debug] [MainThread]: Using duckdb connection "master"
[0m09:36:59.078569 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
SET s3_endpoint='http://localhost:9000';
[0m09:36:59.079578 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m09:36:59.080573 [info ] [MainThread]: 7 of 9 OK hook: stock_dbt_project.on-run-start.6 ............................... [[32mOK[0m in 0.01s]
[0m09:36:59.083568 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-7"
[0m09:36:59.086233 [info ] [MainThread]: 8 of 9 START hook: stock_dbt_project.on-run-start.7 ............................ [RUN]
[0m09:36:59.088992 [debug] [MainThread]: Using duckdb connection "master"
[0m09:36:59.089918 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
SET s 3_bucket='stock-data';
[0m09:36:59.090920 [debug] [MainThread]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
SET s 3_bucket='stock-data';
[0m09:36:59.091929 [debug] [MainThread]: DuckDB adapter: Rolling back transaction.
[0m09:36:59.092917 [info ] [MainThread]: 8 of 9 ERROR hook: stock_dbt_project.on-run-start.7 ............................ [[31mERROR[0m in 0.01s]
[0m09:36:59.093916 [info ] [MainThread]: 9 of 9 SKIP hook: stock_dbt_project.on-run-start.8 ............................. [[33mSKIP[0m in 0.00s]
[0m09:36:59.094915 [info ] [MainThread]: 
[0m09:36:59.094915 [debug] [MainThread]: On master: Close
[0m09:36:59.103432 [debug] [Thread-1 (]: Began running node model.stock_dbt_project.stg_stock_data
[0m09:36:59.105432 [info ] [Thread-1 (]: 1 of 1 START sql view model main.stg_stock_data ................................ [RUN]
[0m09:36:59.107044 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.stock_dbt_project.stg_stock_data'
[0m09:36:59.108161 [debug] [Thread-1 (]: Began compiling node model.stock_dbt_project.stg_stock_data
[0m09:36:59.112760 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_dbt_project.stg_stock_data"
[0m09:36:59.113817 [debug] [Thread-1 (]: Began executing node model.stock_dbt_project.stg_stock_data
[0m09:36:59.175178 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_dbt_project.stg_stock_data"
[0m09:36:59.175178 [debug] [Thread-1 (]: Using duckdb connection "model.stock_dbt_project.stg_stock_data"
[0m09:36:59.175178 [debug] [Thread-1 (]: On model.stock_dbt_project.stg_stock_data: BEGIN
[0m09:36:59.175178 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m09:36:59.175178 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:36:59.175178 [debug] [Thread-1 (]: Using duckdb connection "model.stock_dbt_project.stg_stock_data"
[0m09:36:59.185620 [debug] [Thread-1 (]: On model.stock_dbt_project.stg_stock_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "node_id": "model.stock_dbt_project.stg_stock_data"} */

  
  create view "dev"."main"."stg_stock_data__dbt_tmp" as (
    



WITH raw AS (
    SELECT *
    FROM read_json_auto('s3://my-stock-data-bucket/stocks/*/*/*/*.json')
)

SELECT
    CAST(symbol AS TEXT) AS symbol,
    CAST(datetime AS TIMESTAMP) AS datetime,
    CAST(open AS DOUBLE) AS open,
    CAST(high AS DOUBLE) AS high,
    CAST(low AS DOUBLE) AS low,
    CAST(close AS DOUBLE) AS close,
    CAST(volume AS BIGINT) AS volume
FROM raw
WHERE symbol IS NOT NULL AND datetime IS NOT NULL
  );

[0m09:36:59.563713 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "node_id": "model.stock_dbt_project.stg_stock_data"} */

  
  create view "dev"."main"."stg_stock_data__dbt_tmp" as (
    



WITH raw AS (
    SELECT *
    FROM read_json_auto('s3://my-stock-data-bucket/stocks/*/*/*/*.json')
)

SELECT
    CAST(symbol AS TEXT) AS symbol,
    CAST(datetime AS TIMESTAMP) AS datetime,
    CAST(open AS DOUBLE) AS open,
    CAST(high AS DOUBLE) AS high,
    CAST(low AS DOUBLE) AS low,
    CAST(close AS DOUBLE) AS close,
    CAST(volume AS BIGINT) AS volume
FROM raw
WHERE symbol IS NOT NULL AND datetime IS NOT NULL
  );

[0m09:36:59.564789 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m09:36:59.566417 [debug] [Thread-1 (]: On model.stock_dbt_project.stg_stock_data: ROLLBACK
[0m09:36:59.583310 [debug] [Thread-1 (]: Failed to rollback 'model.stock_dbt_project.stg_stock_data'
[0m09:36:59.584902 [debug] [Thread-1 (]: On model.stock_dbt_project.stg_stock_data: Close
[0m09:36:59.591596 [debug] [Thread-1 (]: Runtime Error in model stg_stock_data (models\staging\stg_stock_data.sql)
  HTTP Error: HTTP GET error on '/?encoding-type=url&list-type=2&prefix=stocks%2F' (HTTP 403)
[0m09:36:59.594588 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3c57e55c-ddb9-43cf-b905-b91ac2771156', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002007FB82450>]}
[0m09:36:59.595595 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model main.stg_stock_data ....................... [[31mERROR[0m in 0.49s]
[0m09:36:59.597654 [debug] [Thread-1 (]: Finished running node model.stock_dbt_project.stg_stock_data
[0m09:36:59.598432 [debug] [Thread-4 (]: Marking all children of 'model.stock_dbt_project.stg_stock_data' to be skipped because of status 'error'.  Reason: Runtime Error in model stg_stock_data (models\staging\stg_stock_data.sql)
  HTTP Error: HTTP GET error on '/?encoding-type=url&list-type=2&prefix=stocks%2F' (HTTP 403).
[0m09:36:59.598432 [debug] [MainThread]: Using duckdb connection "master"
[0m09:36:59.598432 [debug] [MainThread]: On master: BEGIN
[0m09:36:59.598432 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:36:59.598432 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m09:36:59.606196 [debug] [MainThread]: On master: COMMIT
[0m09:36:59.606196 [debug] [MainThread]: Using duckdb connection "master"
[0m09:36:59.607274 [debug] [MainThread]: On master: COMMIT
[0m09:36:59.609209 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m09:36:59.610213 [debug] [MainThread]: On master: Close
[0m09:36:59.610213 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:36:59.611264 [debug] [MainThread]: Connection 'create_dev_main' was properly closed.
[0m09:36:59.612212 [debug] [MainThread]: Connection 'list_dev_main' was properly closed.
[0m09:36:59.612212 [debug] [MainThread]: Connection 'model.stock_dbt_project.stg_stock_data' was properly closed.
[0m09:36:59.613208 [info ] [MainThread]: 
[0m09:36:59.614269 [info ] [MainThread]: Finished running 9 project hooks, 1 view model in 0 hours 0 minutes and 1.32 seconds (1.32s).
[0m09:36:59.620351 [debug] [MainThread]: Command end result
[0m09:36:59.655907 [debug] [MainThread]: Wrote artifact WritableManifest to D:\Stock_price\stock_dbt_project\target\manifest.json
[0m09:36:59.659904 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\Stock_price\stock_dbt_project\target\semantic_manifest.json
[0m09:36:59.668906 [debug] [MainThread]: Wrote artifact RunExecutionResult to D:\Stock_price\stock_dbt_project\target\run_results.json
[0m09:36:59.669910 [info ] [MainThread]: 
[0m09:36:59.671903 [info ] [MainThread]: [31mCompleted with 3 errors, 0 partial successes, and 0 warnings:[0m
[0m09:36:59.673305 [info ] [MainThread]: 
[0m09:36:59.674309 [error] [MainThread]:   stock_dbt_project.on-run-start.7 failed, error:
 Parser Error: syntax error at or near "3"
[0m09:36:59.674794 [debug] [MainThread]: 
[0m09:36:59.675803 [debug] [MainThread]:   stock_dbt_project.on-run-start.8 skipped
[0m09:36:59.676799 [info ] [MainThread]: 
[0m09:36:59.677800 [error] [MainThread]:   Runtime Error in model stg_stock_data (models\staging\stg_stock_data.sql)
  HTTP Error: HTTP GET error on '/?encoding-type=url&list-type=2&prefix=stocks%2F' (HTTP 403)
[0m09:36:59.678798 [info ] [MainThread]: 
[0m09:36:59.679795 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=2 SKIP=1 TOTAL=10
[0m09:36:59.680794 [debug] [MainThread]: Command `dbt run` failed at 09:36:59.680794 after 8.76 seconds
[0m09:36:59.681804 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200011F3E30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002007FC43920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002007FC42D20>]}
[0m09:36:59.683873 [debug] [MainThread]: Flushing usage events
[0m09:37:00.273382 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:17:17.294632 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019B38C77740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019B3BBD0E00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019B3BBD3710>]}


============================== 11:17:17.302466 | 792d308d-da2d-4a6e-9846-74c54f3054d6 ==============================
[0m11:17:17.302466 [info ] [MainThread]: Running with dbt=1.9.4
[0m11:17:17.304462 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\loges\\.dbt', 'log_path': 'D:\\Stock_price\\stock_dbt_project\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run --select stg_stock_data', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:17:17.653069 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '792d308d-da2d-4a6e-9846-74c54f3054d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019B3C1754C0>]}
[0m11:17:17.753173 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '792d308d-da2d-4a6e-9846-74c54f3054d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019B3C1518B0>]}
[0m11:17:17.762044 [info ] [MainThread]: Registered adapter: duckdb=1.9.2
[0m11:17:18.118199 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m11:17:18.411365 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m11:17:18.414363 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '792d308d-da2d-4a6e-9846-74c54f3054d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019B3D65EE70>]}
[0m11:17:23.180655 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.stock_dbt_project.marts
[0m11:17:23.205430 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '792d308d-da2d-4a6e-9846-74c54f3054d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019B3D7182F0>]}
[0m11:17:23.606810 [debug] [MainThread]: Wrote artifact WritableManifest to D:\Stock_price\stock_dbt_project\target\manifest.json
[0m11:17:23.618528 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\Stock_price\stock_dbt_project\target\semantic_manifest.json
[0m11:17:23.794589 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '792d308d-da2d-4a6e-9846-74c54f3054d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019B3D7EAC00>]}
[0m11:17:23.797510 [info ] [MainThread]: Found 4 models, 8 operations, 4 data tests, 426 macros
[0m11:17:23.800820 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '792d308d-da2d-4a6e-9846-74c54f3054d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019B3D718470>]}
[0m11:17:23.810181 [info ] [MainThread]: 
[0m11:17:23.813769 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:17:23.816565 [info ] [MainThread]: 
[0m11:17:23.819446 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m11:17:23.826394 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m11:17:24.220796 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m11:17:24.223717 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m11:17:24.226272 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:17:24.283466 [debug] [ThreadPool]: SQL status: OK in 0.057 seconds
[0m11:17:24.292786 [debug] [ThreadPool]: On list_dev: Close
[0m11:17:24.296340 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m11:17:24.299651 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m11:17:24.349604 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m11:17:24.352138 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "create_dev_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m11:17:24.354595 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:17:24.361937 [debug] [ThreadPool]: SQL status: OK in 0.007 seconds
[0m11:17:24.368695 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m11:17:24.371514 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m11:17:24.378058 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m11:17:24.384045 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m11:17:24.388161 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "create_dev_main"} */

    
    
        create schema if not exists "dev"."main"
    
[0m11:17:24.393342 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m11:17:24.400762 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m11:17:24.405358 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m11:17:24.411791 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m11:17:24.414601 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m11:17:24.417670 [debug] [ThreadPool]: On create_dev_main: Close
[0m11:17:24.452547 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev_main'
[0m11:17:24.482197 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m11:17:24.484885 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m11:17:24.486412 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:17:24.489206 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m11:17:24.491536 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m11:17:24.494359 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m11:17:24.579781 [debug] [ThreadPool]: SQL status: OK in 0.084 seconds
[0m11:17:24.586111 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m11:17:24.592635 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m11:17:24.594179 [debug] [ThreadPool]: On list_dev_main: Close
[0m11:17:24.597165 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '792d308d-da2d-4a6e-9846-74c54f3054d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019B3D9481A0>]}
[0m11:17:24.599666 [debug] [MainThread]: Using duckdb connection "master"
[0m11:17:24.600691 [debug] [MainThread]: On master: BEGIN
[0m11:17:24.601971 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:17:24.603503 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m11:17:24.605837 [debug] [MainThread]: On master: COMMIT
[0m11:17:24.606850 [debug] [MainThread]: Using duckdb connection "master"
[0m11:17:24.608362 [debug] [MainThread]: On master: COMMIT
[0m11:17:24.611575 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m11:17:24.630812 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-0"
[0m11:17:24.651160 [info ] [MainThread]: 1 of 8 START hook: stock_dbt_project.on-run-start.0 ............................ [RUN]
[0m11:17:24.655846 [debug] [MainThread]: Using duckdb connection "master"
[0m11:17:24.658865 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
INSTALL httpfs;
[0m11:17:24.663905 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m11:17:24.668029 [info ] [MainThread]: 1 of 8 OK hook: stock_dbt_project.on-run-start.0 ............................... [[32mOK[0m in 0.06s]
[0m11:17:24.677884 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-1"
[0m11:17:24.681498 [info ] [MainThread]: 2 of 8 START hook: stock_dbt_project.on-run-start.1 ............................ [RUN]
[0m11:17:24.684120 [debug] [MainThread]: Using duckdb connection "master"
[0m11:17:24.685217 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
INSTALL json;
[0m11:17:24.693056 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m11:17:24.696699 [info ] [MainThread]: 2 of 8 OK hook: stock_dbt_project.on-run-start.1 ............................... [[32mOK[0m in 0.03s]
[0m11:17:24.702682 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-2"
[0m11:17:24.708427 [info ] [MainThread]: 3 of 8 START hook: stock_dbt_project.on-run-start.2 ............................ [RUN]
[0m11:17:24.713761 [debug] [MainThread]: Using duckdb connection "master"
[0m11:17:24.716084 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
LOAD httpfs;
[0m11:17:25.263530 [debug] [MainThread]: SQL status: OK in 0.545 seconds
[0m11:17:25.267532 [info ] [MainThread]: 3 of 8 OK hook: stock_dbt_project.on-run-start.2 ............................... [[32mOK[0m in 0.57s]
[0m11:17:25.276011 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-3"
[0m11:17:25.280671 [info ] [MainThread]: 4 of 8 START hook: stock_dbt_project.on-run-start.3 ............................ [RUN]
[0m11:17:25.284094 [debug] [MainThread]: Using duckdb connection "master"
[0m11:17:25.285709 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
LOAD json;
[0m11:17:25.289210 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m11:17:25.295595 [info ] [MainThread]: 4 of 8 OK hook: stock_dbt_project.on-run-start.3 ............................... [[32mOK[0m in 0.03s]
[0m11:17:25.301862 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-4"
[0m11:17:25.311056 [info ] [MainThread]: 5 of 8 START hook: stock_dbt_project.on-run-start.4 ............................ [RUN]
[0m11:17:25.315262 [debug] [MainThread]: Using duckdb connection "master"
[0m11:17:25.353082 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
SET s3_access_key_id='minioadmin';
[0m11:17:25.397781 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m11:17:25.430872 [info ] [MainThread]: 5 of 8 OK hook: stock_dbt_project.on-run-start.4 ............................... [[32mOK[0m in 0.13s]
[0m11:17:25.492361 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-5"
[0m11:17:25.501045 [info ] [MainThread]: 6 of 8 START hook: stock_dbt_project.on-run-start.5 ............................ [RUN]
[0m11:17:25.526983 [debug] [MainThread]: Using duckdb connection "master"
[0m11:17:25.529499 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
SET s3_secret_access_key='minioadmin';
[0m11:17:25.548920 [debug] [MainThread]: SQL status: OK in 0.005 seconds
[0m11:17:25.560964 [info ] [MainThread]: 6 of 8 OK hook: stock_dbt_project.on-run-start.5 ............................... [[32mOK[0m in 0.08s]
[0m11:17:25.572632 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-6"
[0m11:17:25.577886 [info ] [MainThread]: 7 of 8 START hook: stock_dbt_project.on-run-start.6 ............................ [RUN]
[0m11:17:25.593278 [debug] [MainThread]: Using duckdb connection "master"
[0m11:17:25.600244 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
SET s3_endpoint='http://localhost:9000';
[0m11:17:25.618422 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m11:17:25.627027 [info ] [MainThread]: 7 of 8 OK hook: stock_dbt_project.on-run-start.6 ............................... [[32mOK[0m in 0.06s]
[0m11:17:25.645507 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-7"
[0m11:17:25.651671 [info ] [MainThread]: 8 of 8 START hook: stock_dbt_project.on-run-start.7 ............................ [RUN]
[0m11:17:25.655351 [debug] [MainThread]: Using duckdb connection "master"
[0m11:17:25.664622 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
SET s3_bucket='my-stock-data-bucket';
[0m11:17:25.669741 [debug] [MainThread]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
SET s3_bucket='my-stock-data-bucket';
[0m11:17:25.674800 [debug] [MainThread]: DuckDB adapter: Rolling back transaction.
[0m11:17:25.678929 [info ] [MainThread]: 8 of 8 ERROR hook: stock_dbt_project.on-run-start.7 ............................ [[31mERROR[0m in 0.04s]
[0m11:17:25.683665 [info ] [MainThread]: 
[0m11:17:25.687374 [debug] [MainThread]: On master: Close
[0m11:17:25.712380 [debug] [Thread-1 (]: Began running node model.stock_dbt_project.stg_stock_data
[0m11:17:25.716437 [info ] [Thread-1 (]: 1 of 1 START sql view model main.stg_stock_data ................................ [RUN]
[0m11:17:25.721196 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.stock_dbt_project.stg_stock_data'
[0m11:17:25.724562 [debug] [Thread-1 (]: Began compiling node model.stock_dbt_project.stg_stock_data
[0m11:17:25.740860 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_dbt_project.stg_stock_data"
[0m11:17:25.746782 [debug] [Thread-1 (]: Began executing node model.stock_dbt_project.stg_stock_data
[0m11:17:25.937119 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_dbt_project.stg_stock_data"
[0m11:17:25.945776 [debug] [Thread-1 (]: Using duckdb connection "model.stock_dbt_project.stg_stock_data"
[0m11:17:25.949584 [debug] [Thread-1 (]: On model.stock_dbt_project.stg_stock_data: BEGIN
[0m11:17:25.951742 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m11:17:25.959288 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m11:17:25.963283 [debug] [Thread-1 (]: Using duckdb connection "model.stock_dbt_project.stg_stock_data"
[0m11:17:25.967570 [debug] [Thread-1 (]: On model.stock_dbt_project.stg_stock_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "node_id": "model.stock_dbt_project.stg_stock_data"} */

  
  create view "dev"."main"."stg_stock_data__dbt_tmp" as (
    



WITH raw AS (
    SELECT *
    FROM read_json_auto('s3://my-stock-data-bucket/stocks/*/*/*/*.json')
)

SELECT
    CAST(symbol AS TEXT) AS symbol,
    CAST(datetime AS TIMESTAMP) AS datetime,
    CAST(open AS DOUBLE) AS open,
    CAST(high AS DOUBLE) AS high,
    CAST(low AS DOUBLE) AS low,
    CAST(close AS DOUBLE) AS close,
    CAST(volume AS BIGINT) AS volume
FROM raw
WHERE symbol IS NOT NULL AND datetime IS NOT NULL
  );

[0m11:17:26.440309 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "node_id": "model.stock_dbt_project.stg_stock_data"} */

  
  create view "dev"."main"."stg_stock_data__dbt_tmp" as (
    



WITH raw AS (
    SELECT *
    FROM read_json_auto('s3://my-stock-data-bucket/stocks/*/*/*/*.json')
)

SELECT
    CAST(symbol AS TEXT) AS symbol,
    CAST(datetime AS TIMESTAMP) AS datetime,
    CAST(open AS DOUBLE) AS open,
    CAST(high AS DOUBLE) AS high,
    CAST(low AS DOUBLE) AS low,
    CAST(close AS DOUBLE) AS close,
    CAST(volume AS BIGINT) AS volume
FROM raw
WHERE symbol IS NOT NULL AND datetime IS NOT NULL
  );

[0m11:17:26.441316 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m11:17:26.442309 [debug] [Thread-1 (]: On model.stock_dbt_project.stg_stock_data: ROLLBACK
[0m11:17:26.451160 [debug] [Thread-1 (]: Failed to rollback 'model.stock_dbt_project.stg_stock_data'
[0m11:17:26.452155 [debug] [Thread-1 (]: On model.stock_dbt_project.stg_stock_data: Close
[0m11:17:26.456990 [debug] [Thread-1 (]: Runtime Error in model stg_stock_data (models\staging\stg_stock_data.sql)
  HTTP Error: HTTP GET error on '/?encoding-type=url&list-type=2&prefix=stocks%2F' (HTTP 403)
[0m11:17:26.463008 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '792d308d-da2d-4a6e-9846-74c54f3054d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019B3D71A180>]}
[0m11:17:26.465006 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model main.stg_stock_data ....................... [[31mERROR[0m in 0.74s]
[0m11:17:26.467013 [debug] [Thread-1 (]: Finished running node model.stock_dbt_project.stg_stock_data
[0m11:17:26.468016 [debug] [Thread-4 (]: Marking all children of 'model.stock_dbt_project.stg_stock_data' to be skipped because of status 'error'.  Reason: Runtime Error in model stg_stock_data (models\staging\stg_stock_data.sql)
  HTTP Error: HTTP GET error on '/?encoding-type=url&list-type=2&prefix=stocks%2F' (HTTP 403).
[0m11:17:26.470596 [debug] [MainThread]: Using duckdb connection "master"
[0m11:17:26.471644 [debug] [MainThread]: On master: BEGIN
[0m11:17:26.473647 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:17:26.475639 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m11:17:26.475639 [debug] [MainThread]: On master: COMMIT
[0m11:17:26.476636 [debug] [MainThread]: Using duckdb connection "master"
[0m11:17:26.477646 [debug] [MainThread]: On master: COMMIT
[0m11:17:26.478652 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m11:17:26.479653 [debug] [MainThread]: On master: Close
[0m11:17:26.480643 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:17:26.480643 [debug] [MainThread]: Connection 'create_dev_main' was properly closed.
[0m11:17:26.481642 [debug] [MainThread]: Connection 'list_dev_main' was properly closed.
[0m11:17:26.481642 [debug] [MainThread]: Connection 'model.stock_dbt_project.stg_stock_data' was properly closed.
[0m11:17:26.482644 [info ] [MainThread]: 
[0m11:17:26.484228 [info ] [MainThread]: Finished running 8 project hooks, 1 view model in 0 hours 0 minutes and 2.66 seconds (2.66s).
[0m11:17:26.487505 [debug] [MainThread]: Command end result
[0m11:17:26.531770 [debug] [MainThread]: Wrote artifact WritableManifest to D:\Stock_price\stock_dbt_project\target\manifest.json
[0m11:17:26.535763 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\Stock_price\stock_dbt_project\target\semantic_manifest.json
[0m11:17:26.552330 [debug] [MainThread]: Wrote artifact RunExecutionResult to D:\Stock_price\stock_dbt_project\target\run_results.json
[0m11:17:26.553365 [info ] [MainThread]: 
[0m11:17:26.555075 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m11:17:26.558075 [info ] [MainThread]: 
[0m11:17:26.560458 [error] [MainThread]:   stock_dbt_project.on-run-start.7 failed, error:
 Catalog Error: unrecognized configuration parameter "s3_bucket"

Did you mean: "s3_secret_access_key"
[0m11:17:26.562466 [info ] [MainThread]: 
[0m11:17:26.563982 [error] [MainThread]:   Runtime Error in model stg_stock_data (models\staging\stg_stock_data.sql)
  HTTP Error: HTTP GET error on '/?encoding-type=url&list-type=2&prefix=stocks%2F' (HTTP 403)
[0m11:17:26.565994 [info ] [MainThread]: 
[0m11:17:26.566996 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=2 SKIP=0 TOTAL=9
[0m11:17:26.569726 [debug] [MainThread]: Command `dbt run` failed at 11:17:26.569726 after 9.84 seconds
[0m11:17:26.571726 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019B3BCCEF30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019B3BE66FF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019B3BCB3320>]}
[0m11:17:26.572730 [debug] [MainThread]: Flushing usage events
[0m11:17:27.183073 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:23:51.657175 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000227340EC4A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000227346EA600>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022731C377D0>]}


============================== 11:23:51.664176 | 6e2dd0e2-f897-4f84-afb4-df2ca199668d ==============================
[0m11:23:51.664176 [info ] [MainThread]: Running with dbt=1.9.4
[0m11:23:51.666178 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\loges\\.dbt', 'log_path': 'D:\\Stock_price\\stock_dbt_project\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run --select stg_stock_data', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m11:23:52.034364 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6e2dd0e2-f897-4f84-afb4-df2ca199668d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000227350A2300>]}
[0m11:23:52.128696 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6e2dd0e2-f897-4f84-afb4-df2ca199668d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000227320B9880>]}
[0m11:23:52.136844 [info ] [MainThread]: Registered adapter: duckdb=1.9.2
[0m11:23:52.705904 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m11:23:53.122029 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:23:53.128021 [debug] [MainThread]: Partial parsing: updated file: stock_dbt_project://models\staging\stg_stock_data.sql
[0m11:23:54.195814 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.stock_dbt_project.marts
[0m11:23:54.236592 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6e2dd0e2-f897-4f84-afb4-df2ca199668d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000227367A0F80>]}
[0m11:23:54.656554 [debug] [MainThread]: Wrote artifact WritableManifest to D:\Stock_price\stock_dbt_project\target\manifest.json
[0m11:23:54.667092 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\Stock_price\stock_dbt_project\target\semantic_manifest.json
[0m11:23:54.804851 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6e2dd0e2-f897-4f84-afb4-df2ca199668d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022736756510>]}
[0m11:23:54.807494 [info ] [MainThread]: Found 4 models, 8 operations, 4 data tests, 426 macros
[0m11:23:54.812823 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6e2dd0e2-f897-4f84-afb4-df2ca199668d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022735136480>]}
[0m11:23:54.820399 [info ] [MainThread]: 
[0m11:23:54.823411 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:23:54.830255 [info ] [MainThread]: 
[0m11:23:54.835531 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m11:23:54.839550 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m11:23:55.155637 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m11:23:55.158469 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m11:23:55.162298 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:23:55.217962 [debug] [ThreadPool]: SQL status: OK in 0.056 seconds
[0m11:23:55.230659 [debug] [ThreadPool]: On list_dev: Close
[0m11:23:55.234851 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m11:23:55.237936 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m11:23:55.280787 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m11:23:55.284257 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "create_dev_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m11:23:55.286140 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:23:55.291830 [debug] [ThreadPool]: SQL status: OK in 0.005 seconds
[0m11:23:55.301559 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m11:23:55.306858 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m11:23:55.314258 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m11:23:55.318342 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m11:23:55.321158 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "create_dev_main"} */

    
    
        create schema if not exists "dev"."main"
    
[0m11:23:55.324723 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m11:23:55.331966 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m11:23:55.334420 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m11:23:55.336787 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m11:23:55.340835 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m11:23:55.343236 [debug] [ThreadPool]: On create_dev_main: Close
[0m11:23:55.367083 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev_main'
[0m11:23:55.389956 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m11:23:55.392717 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m11:23:55.395697 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:23:55.399020 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m11:23:55.400040 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m11:23:55.402812 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m11:23:55.498377 [debug] [ThreadPool]: SQL status: OK in 0.093 seconds
[0m11:23:55.502635 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m11:23:55.513762 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m11:23:55.516028 [debug] [ThreadPool]: On list_dev_main: Close
[0m11:23:55.518843 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6e2dd0e2-f897-4f84-afb4-df2ca199668d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022736626480>]}
[0m11:23:55.520707 [debug] [MainThread]: Using duckdb connection "master"
[0m11:23:55.522454 [debug] [MainThread]: On master: BEGIN
[0m11:23:55.523514 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:23:55.525653 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m11:23:55.528776 [debug] [MainThread]: On master: COMMIT
[0m11:23:55.529768 [debug] [MainThread]: Using duckdb connection "master"
[0m11:23:55.532148 [debug] [MainThread]: On master: COMMIT
[0m11:23:55.534363 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m11:23:55.551819 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-0"
[0m11:23:55.568990 [info ] [MainThread]: 1 of 8 START hook: stock_dbt_project.on-run-start.0 ............................ [RUN]
[0m11:23:55.571166 [debug] [MainThread]: Using duckdb connection "master"
[0m11:23:55.572237 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
INSTALL httpfs;
[0m11:23:55.576593 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m11:23:55.579589 [info ] [MainThread]: 1 of 8 OK hook: stock_dbt_project.on-run-start.0 ............................... [[32mOK[0m in 0.04s]
[0m11:23:55.585421 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-1"
[0m11:23:55.588654 [info ] [MainThread]: 2 of 8 START hook: stock_dbt_project.on-run-start.1 ............................ [RUN]
[0m11:23:55.591742 [debug] [MainThread]: Using duckdb connection "master"
[0m11:23:55.593782 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
INSTALL json;
[0m11:23:55.598744 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m11:23:55.602081 [info ] [MainThread]: 2 of 8 OK hook: stock_dbt_project.on-run-start.1 ............................... [[32mOK[0m in 0.02s]
[0m11:23:55.611682 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-2"
[0m11:23:55.616684 [info ] [MainThread]: 3 of 8 START hook: stock_dbt_project.on-run-start.2 ............................ [RUN]
[0m11:23:55.619685 [debug] [MainThread]: Using duckdb connection "master"
[0m11:23:55.621219 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
LOAD httpfs;
[0m11:23:55.970821 [debug] [MainThread]: SQL status: OK in 0.348 seconds
[0m11:23:55.974245 [info ] [MainThread]: 3 of 8 OK hook: stock_dbt_project.on-run-start.2 ............................... [[32mOK[0m in 0.37s]
[0m11:23:55.979712 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-3"
[0m11:23:55.981355 [info ] [MainThread]: 4 of 8 START hook: stock_dbt_project.on-run-start.3 ............................ [RUN]
[0m11:23:55.983531 [debug] [MainThread]: Using duckdb connection "master"
[0m11:23:55.983916 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
LOAD json;
[0m11:23:55.985931 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m11:23:55.987928 [info ] [MainThread]: 4 of 8 OK hook: stock_dbt_project.on-run-start.3 ............................... [[32mOK[0m in 0.01s]
[0m11:23:55.990923 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-4"
[0m11:23:55.995246 [info ] [MainThread]: 5 of 8 START hook: stock_dbt_project.on-run-start.4 ............................ [RUN]
[0m11:23:55.998252 [debug] [MainThread]: Using duckdb connection "master"
[0m11:23:56.000246 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
SET s3_access_key_id='minioadmin';
[0m11:23:56.001245 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m11:23:56.003754 [info ] [MainThread]: 5 of 8 OK hook: stock_dbt_project.on-run-start.4 ............................... [[32mOK[0m in 0.01s]
[0m11:23:56.007635 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-5"
[0m11:23:56.009643 [info ] [MainThread]: 6 of 8 START hook: stock_dbt_project.on-run-start.5 ............................ [RUN]
[0m11:23:56.011638 [debug] [MainThread]: Using duckdb connection "master"
[0m11:23:56.013645 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
SET s3_secret_access_key='minioadmin';
[0m11:23:56.015636 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m11:23:56.016636 [info ] [MainThread]: 6 of 8 OK hook: stock_dbt_project.on-run-start.5 ............................... [[32mOK[0m in 0.01s]
[0m11:23:56.020636 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-6"
[0m11:23:56.021644 [info ] [MainThread]: 7 of 8 START hook: stock_dbt_project.on-run-start.6 ............................ [RUN]
[0m11:23:56.023639 [debug] [MainThread]: Using duckdb connection "master"
[0m11:23:56.027421 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
SET s3_endpoint='http://localhost:9000';
[0m11:23:56.029401 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m11:23:56.031400 [info ] [MainThread]: 7 of 8 OK hook: stock_dbt_project.on-run-start.6 ............................... [[32mOK[0m in 0.01s]
[0m11:23:56.034867 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-7"
[0m11:23:56.036868 [info ] [MainThread]: 8 of 8 START hook: stock_dbt_project.on-run-start.7 ............................ [RUN]
[0m11:23:56.038868 [debug] [MainThread]: Using duckdb connection "master"
[0m11:23:56.040322 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
SET s3_bucket='my-stock-data-bucket';
[0m11:23:56.042329 [debug] [MainThread]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
SET s3_bucket='my-stock-data-bucket';
[0m11:23:56.043328 [debug] [MainThread]: DuckDB adapter: Rolling back transaction.
[0m11:23:56.044326 [info ] [MainThread]: 8 of 8 ERROR hook: stock_dbt_project.on-run-start.7 ............................ [[31mERROR[0m in 0.01s]
[0m11:23:56.045331 [info ] [MainThread]: 
[0m11:23:56.047326 [debug] [MainThread]: On master: Close
[0m11:23:56.054195 [debug] [Thread-1 (]: Began running node model.stock_dbt_project.stg_stock_data
[0m11:23:56.056214 [info ] [Thread-1 (]: 1 of 1 START sql view model main.stg_stock_data ................................ [RUN]
[0m11:23:56.058205 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.stock_dbt_project.stg_stock_data'
[0m11:23:56.059206 [debug] [Thread-1 (]: Began compiling node model.stock_dbt_project.stg_stock_data
[0m11:23:56.064271 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_dbt_project.stg_stock_data"
[0m11:23:56.066270 [debug] [Thread-1 (]: Began executing node model.stock_dbt_project.stg_stock_data
[0m11:23:56.119492 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_dbt_project.stg_stock_data"
[0m11:23:56.120490 [debug] [Thread-1 (]: Using duckdb connection "model.stock_dbt_project.stg_stock_data"
[0m11:23:56.121491 [debug] [Thread-1 (]: On model.stock_dbt_project.stg_stock_data: BEGIN
[0m11:23:56.122513 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m11:23:56.123906 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:23:56.124905 [debug] [Thread-1 (]: Using duckdb connection "model.stock_dbt_project.stg_stock_data"
[0m11:23:56.126905 [debug] [Thread-1 (]: On model.stock_dbt_project.stg_stock_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "node_id": "model.stock_dbt_project.stg_stock_data"} */

  
  create view "dev"."main"."stg_stock_data__dbt_tmp" as (
    



WITH raw AS (
    SELECT *
    FROM read_json_auto('s3:/stock-data/stocks/*/*/*/*.json')
)

SELECT
    CAST(symbol AS TEXT) AS symbol,
    CAST(datetime AS TIMESTAMP) AS datetime,
    CAST(open AS DOUBLE) AS open,
    CAST(high AS DOUBLE) AS high,
    CAST(low AS DOUBLE) AS low,
    CAST(close AS DOUBLE) AS close,
    CAST(volume AS BIGINT) AS volume
FROM raw
WHERE symbol IS NOT NULL AND datetime IS NOT NULL
  );

[0m11:23:56.140532 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "node_id": "model.stock_dbt_project.stg_stock_data"} */

  
  create view "dev"."main"."stg_stock_data__dbt_tmp" as (
    



WITH raw AS (
    SELECT *
    FROM read_json_auto('s3:/stock-data/stocks/*/*/*/*.json')
)

SELECT
    CAST(symbol AS TEXT) AS symbol,
    CAST(datetime AS TIMESTAMP) AS datetime,
    CAST(open AS DOUBLE) AS open,
    CAST(high AS DOUBLE) AS high,
    CAST(low AS DOUBLE) AS low,
    CAST(close AS DOUBLE) AS close,
    CAST(volume AS BIGINT) AS volume
FROM raw
WHERE symbol IS NOT NULL AND datetime IS NOT NULL
  );

[0m11:23:56.141536 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m11:23:56.142546 [debug] [Thread-1 (]: On model.stock_dbt_project.stg_stock_data: ROLLBACK
[0m11:23:56.152522 [debug] [Thread-1 (]: Failed to rollback 'model.stock_dbt_project.stg_stock_data'
[0m11:23:56.153518 [debug] [Thread-1 (]: On model.stock_dbt_project.stg_stock_data: Close
[0m11:23:56.157295 [debug] [Thread-1 (]: Runtime Error in model stg_stock_data (models\staging\stg_stock_data.sql)
  IO Error: No files found that match the pattern "s3:/stock-data/stocks/*/*/*/*.json"
[0m11:23:56.162524 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6e2dd0e2-f897-4f84-afb4-df2ca199668d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022736DA55B0>]}
[0m11:23:56.163523 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model main.stg_stock_data ....................... [[31mERROR[0m in 0.10s]
[0m11:23:56.165526 [debug] [Thread-1 (]: Finished running node model.stock_dbt_project.stg_stock_data
[0m11:23:56.166532 [debug] [Thread-4 (]: Marking all children of 'model.stock_dbt_project.stg_stock_data' to be skipped because of status 'error'.  Reason: Runtime Error in model stg_stock_data (models\staging\stg_stock_data.sql)
  IO Error: No files found that match the pattern "s3:/stock-data/stocks/*/*/*/*.json".
[0m11:23:56.169524 [debug] [MainThread]: Using duckdb connection "master"
[0m11:23:56.170523 [debug] [MainThread]: On master: BEGIN
[0m11:23:56.171091 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:23:56.172405 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m11:23:56.172464 [debug] [MainThread]: On master: COMMIT
[0m11:23:56.173462 [debug] [MainThread]: Using duckdb connection "master"
[0m11:23:56.174521 [debug] [MainThread]: On master: COMMIT
[0m11:23:56.176042 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m11:23:56.177038 [debug] [MainThread]: On master: Close
[0m11:23:56.178040 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:23:56.179044 [debug] [MainThread]: Connection 'create_dev_main' was properly closed.
[0m11:23:56.180043 [debug] [MainThread]: Connection 'list_dev_main' was properly closed.
[0m11:23:56.181038 [debug] [MainThread]: Connection 'model.stock_dbt_project.stg_stock_data' was properly closed.
[0m11:23:56.182041 [info ] [MainThread]: 
[0m11:23:56.183036 [info ] [MainThread]: Finished running 8 project hooks, 1 view model in 0 hours 0 minutes and 1.35 seconds (1.35s).
[0m11:23:56.186627 [debug] [MainThread]: Command end result
[0m11:23:56.223823 [debug] [MainThread]: Wrote artifact WritableManifest to D:\Stock_price\stock_dbt_project\target\manifest.json
[0m11:23:56.229386 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\Stock_price\stock_dbt_project\target\semantic_manifest.json
[0m11:23:56.249033 [debug] [MainThread]: Wrote artifact RunExecutionResult to D:\Stock_price\stock_dbt_project\target\run_results.json
[0m11:23:56.249597 [info ] [MainThread]: 
[0m11:23:56.250641 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m11:23:56.251703 [info ] [MainThread]: 
[0m11:23:56.252792 [error] [MainThread]:   stock_dbt_project.on-run-start.7 failed, error:
 Catalog Error: unrecognized configuration parameter "s3_bucket"

Did you mean: "s3_secret_access_key"
[0m11:23:56.253875 [info ] [MainThread]: 
[0m11:23:56.255515 [error] [MainThread]:   Runtime Error in model stg_stock_data (models\staging\stg_stock_data.sql)
  IO Error: No files found that match the pattern "s3:/stock-data/stocks/*/*/*/*.json"
[0m11:23:56.256046 [info ] [MainThread]: 
[0m11:23:56.257402 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=2 SKIP=0 TOTAL=9
[0m11:23:56.260413 [debug] [MainThread]: Command `dbt run` failed at 11:23:56.260413 after 4.89 seconds
[0m11:23:56.262413 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022734C8CFB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002273482ADB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022734902960>]}
[0m11:23:56.263421 [debug] [MainThread]: Flushing usage events
[0m11:23:56.721368 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:26:16.980997 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000299CDD2B680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000299CEB7A780>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000299CEB7BDA0>]}


============================== 11:26:16.996071 | 969fe3fa-5d66-43a9-b9b0-ecdf99cc5f94 ==============================
[0m11:26:16.996071 [info ] [MainThread]: Running with dbt=1.9.4
[0m11:26:16.999860 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'D:\\Stock_price\\stock_dbt_project\\logs', 'profiles_dir': 'C:\\Users\\loges\\.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select stg_stock_data', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m11:26:17.904354 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '969fe3fa-5d66-43a9-b9b0-ecdf99cc5f94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000299D08225A0>]}
[0m11:26:18.013551 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '969fe3fa-5d66-43a9-b9b0-ecdf99cc5f94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000299D12241D0>]}
[0m11:26:18.019910 [info ] [MainThread]: Registered adapter: duckdb=1.9.2
[0m11:26:18.340344 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m11:26:18.669708 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m11:26:18.672708 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '969fe3fa-5d66-43a9-b9b0-ecdf99cc5f94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000299D0C49A00>]}
[0m11:26:22.624817 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.stock_dbt_project.marts
[0m11:26:22.635532 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '969fe3fa-5d66-43a9-b9b0-ecdf99cc5f94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000299D28112B0>]}
[0m11:26:22.853573 [debug] [MainThread]: Wrote artifact WritableManifest to D:\Stock_price\stock_dbt_project\target\manifest.json
[0m11:26:22.863262 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\Stock_price\stock_dbt_project\target\semantic_manifest.json
[0m11:26:22.953844 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '969fe3fa-5d66-43a9-b9b0-ecdf99cc5f94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000299D1426840>]}
[0m11:26:22.955858 [info ] [MainThread]: Found 4 models, 9 operations, 4 data tests, 426 macros
[0m11:26:22.960185 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '969fe3fa-5d66-43a9-b9b0-ecdf99cc5f94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000299D13D9B80>]}
[0m11:26:22.966628 [info ] [MainThread]: 
[0m11:26:22.970628 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:26:22.973629 [info ] [MainThread]: 
[0m11:26:22.980945 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m11:26:22.986643 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m11:26:23.352532 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m11:26:23.354129 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m11:26:23.355142 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:26:23.393814 [debug] [ThreadPool]: SQL status: OK in 0.038 seconds
[0m11:26:23.398128 [debug] [ThreadPool]: On list_dev: Close
[0m11:26:23.401061 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m11:26:23.403077 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m11:26:23.422030 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m11:26:23.424042 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "create_dev_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m11:26:23.425038 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:26:23.428050 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m11:26:23.432041 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m11:26:23.433551 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m11:26:23.436068 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m11:26:23.437592 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m11:26:23.438591 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "create_dev_main"} */

    
    
        create schema if not exists "dev"."main"
    
[0m11:26:23.440592 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m11:26:23.444574 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m11:26:23.446526 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m11:26:23.447539 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m11:26:23.449542 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m11:26:23.451055 [debug] [ThreadPool]: On create_dev_main: Close
[0m11:26:23.470117 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev_main'
[0m11:26:23.486919 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m11:26:23.487920 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m11:26:23.488920 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:26:23.491305 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m11:26:23.492312 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m11:26:23.494317 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m11:26:23.555116 [debug] [ThreadPool]: SQL status: OK in 0.059 seconds
[0m11:26:23.559114 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m11:26:23.564112 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m11:26:23.566124 [debug] [ThreadPool]: On list_dev_main: Close
[0m11:26:23.567628 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '969fe3fa-5d66-43a9-b9b0-ecdf99cc5f94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000299D2A1EF60>]}
[0m11:26:23.569700 [debug] [MainThread]: Using duckdb connection "master"
[0m11:26:23.570694 [debug] [MainThread]: On master: BEGIN
[0m11:26:23.571698 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:26:23.574162 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m11:26:23.575785 [debug] [MainThread]: On master: COMMIT
[0m11:26:23.577789 [debug] [MainThread]: Using duckdb connection "master"
[0m11:26:23.579298 [debug] [MainThread]: On master: COMMIT
[0m11:26:23.581320 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m11:26:23.598853 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-0"
[0m11:26:23.612414 [info ] [MainThread]: 1 of 9 START hook: stock_dbt_project.on-run-start.0 ............................ [RUN]
[0m11:26:23.615628 [debug] [MainThread]: Using duckdb connection "master"
[0m11:26:23.616635 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
INSTALL httpfs;
[0m11:26:23.619634 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m11:26:23.623635 [info ] [MainThread]: 1 of 9 OK hook: stock_dbt_project.on-run-start.0 ............................... [[32mOK[0m in 0.04s]
[0m11:26:23.631251 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-1"
[0m11:26:23.634249 [info ] [MainThread]: 2 of 9 START hook: stock_dbt_project.on-run-start.1 ............................ [RUN]
[0m11:26:23.637326 [debug] [MainThread]: Using duckdb connection "master"
[0m11:26:23.638860 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
INSTALL json;
[0m11:26:23.641854 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m11:26:23.646767 [info ] [MainThread]: 2 of 9 OK hook: stock_dbt_project.on-run-start.1 ............................... [[32mOK[0m in 0.02s]
[0m11:26:23.653779 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-2"
[0m11:26:23.655770 [info ] [MainThread]: 3 of 9 START hook: stock_dbt_project.on-run-start.2 ............................ [RUN]
[0m11:26:23.660603 [debug] [MainThread]: Using duckdb connection "master"
[0m11:26:23.663627 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
LOAD httpfs;
[0m11:26:24.299863 [debug] [MainThread]: SQL status: OK in 0.634 seconds
[0m11:26:24.305238 [info ] [MainThread]: 3 of 9 OK hook: stock_dbt_project.on-run-start.2 ............................... [[32mOK[0m in 0.65s]
[0m11:26:24.317717 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-3"
[0m11:26:24.322389 [info ] [MainThread]: 4 of 9 START hook: stock_dbt_project.on-run-start.3 ............................ [RUN]
[0m11:26:24.327908 [debug] [MainThread]: Using duckdb connection "master"
[0m11:26:24.333050 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
LOAD json;
[0m11:26:24.337248 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m11:26:24.342660 [info ] [MainThread]: 4 of 9 OK hook: stock_dbt_project.on-run-start.3 ............................... [[32mOK[0m in 0.03s]
[0m11:26:24.357950 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-4"
[0m11:26:24.363305 [info ] [MainThread]: 5 of 9 START hook: stock_dbt_project.on-run-start.4 ............................ [RUN]
[0m11:26:24.371934 [debug] [MainThread]: Using duckdb connection "master"
[0m11:26:24.374189 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
SET s3_access_key_id='minioadmin';
[0m11:26:24.380923 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m11:26:24.387177 [info ] [MainThread]: 5 of 9 OK hook: stock_dbt_project.on-run-start.4 ............................... [[32mOK[0m in 0.04s]
[0m11:26:24.397160 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-5"
[0m11:26:24.403290 [info ] [MainThread]: 6 of 9 START hook: stock_dbt_project.on-run-start.5 ............................ [RUN]
[0m11:26:24.404310 [debug] [MainThread]: Using duckdb connection "master"
[0m11:26:24.408312 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
SET s3_secret_access_key='minioadmin';
[0m11:26:24.414143 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m11:26:24.421695 [info ] [MainThread]: 6 of 9 OK hook: stock_dbt_project.on-run-start.5 ............................... [[32mOK[0m in 0.03s]
[0m11:26:24.432517 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-6"
[0m11:26:24.436608 [info ] [MainThread]: 7 of 9 START hook: stock_dbt_project.on-run-start.6 ............................ [RUN]
[0m11:26:24.439659 [debug] [MainThread]: Using duckdb connection "master"
[0m11:26:24.443624 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
SET s3_endpoint='http://localhost:9000';
[0m11:26:24.449435 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m11:26:24.454473 [info ] [MainThread]: 7 of 9 OK hook: stock_dbt_project.on-run-start.6 ............................... [[32mOK[0m in 0.03s]
[0m11:26:24.467846 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-7"
[0m11:26:24.471898 [info ] [MainThread]: 8 of 9 START hook: stock_dbt_project.on-run-start.7 ............................ [RUN]
[0m11:26:24.477689 [debug] [MainThread]: Using duckdb connection "master"
[0m11:26:24.481779 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
SET s3_bucket='my-stock-data-bucket';
[0m11:26:24.486338 [debug] [MainThread]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
SET s3_bucket='my-stock-data-bucket';
[0m11:26:24.489877 [debug] [MainThread]: DuckDB adapter: Rolling back transaction.
[0m11:26:24.495698 [info ] [MainThread]: 8 of 9 ERROR hook: stock_dbt_project.on-run-start.7 ............................ [[31mERROR[0m in 0.04s]
[0m11:26:24.499810 [info ] [MainThread]: 9 of 9 SKIP hook: stock_dbt_project.on-run-start.8 ............................. [[33mSKIP[0m in 0.00s]
[0m11:26:24.502858 [info ] [MainThread]: 
[0m11:26:24.505153 [debug] [MainThread]: On master: Close
[0m11:26:24.524090 [debug] [Thread-1 (]: Began running node model.stock_dbt_project.stg_stock_data
[0m11:26:24.529861 [info ] [Thread-1 (]: 1 of 1 START sql view model main.stg_stock_data ................................ [RUN]
[0m11:26:24.536198 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.stock_dbt_project.stg_stock_data'
[0m11:26:24.539073 [debug] [Thread-1 (]: Began compiling node model.stock_dbt_project.stg_stock_data
[0m11:26:24.552965 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_dbt_project.stg_stock_data"
[0m11:26:24.557013 [debug] [Thread-1 (]: Began executing node model.stock_dbt_project.stg_stock_data
[0m11:26:24.770302 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_dbt_project.stg_stock_data"
[0m11:26:24.774360 [debug] [Thread-1 (]: Using duckdb connection "model.stock_dbt_project.stg_stock_data"
[0m11:26:24.779484 [debug] [Thread-1 (]: On model.stock_dbt_project.stg_stock_data: BEGIN
[0m11:26:24.783454 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m11:26:24.787205 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m11:26:24.791008 [debug] [Thread-1 (]: Using duckdb connection "model.stock_dbt_project.stg_stock_data"
[0m11:26:24.794043 [debug] [Thread-1 (]: On model.stock_dbt_project.stg_stock_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "node_id": "model.stock_dbt_project.stg_stock_data"} */

  
  create view "dev"."main"."stg_stock_data__dbt_tmp" as (
    



WITH raw AS (
    SELECT *
    FROM read_json_auto('s3:/my-stock-data-bucket/stocks/*/*/*/*.json')
)

SELECT
    CAST(symbol AS TEXT) AS symbol,
    CAST(datetime AS TIMESTAMP) AS datetime,
    CAST(open AS DOUBLE) AS open,
    CAST(high AS DOUBLE) AS high,
    CAST(low AS DOUBLE) AS low,
    CAST(close AS DOUBLE) AS close,
    CAST(volume AS BIGINT) AS volume
FROM raw
WHERE symbol IS NOT NULL AND datetime IS NOT NULL
  );

[0m11:26:24.801050 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "node_id": "model.stock_dbt_project.stg_stock_data"} */

  
  create view "dev"."main"."stg_stock_data__dbt_tmp" as (
    



WITH raw AS (
    SELECT *
    FROM read_json_auto('s3:/my-stock-data-bucket/stocks/*/*/*/*.json')
)

SELECT
    CAST(symbol AS TEXT) AS symbol,
    CAST(datetime AS TIMESTAMP) AS datetime,
    CAST(open AS DOUBLE) AS open,
    CAST(high AS DOUBLE) AS high,
    CAST(low AS DOUBLE) AS low,
    CAST(close AS DOUBLE) AS close,
    CAST(volume AS BIGINT) AS volume
FROM raw
WHERE symbol IS NOT NULL AND datetime IS NOT NULL
  );

[0m11:26:24.805085 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m11:26:24.807293 [debug] [Thread-1 (]: On model.stock_dbt_project.stg_stock_data: ROLLBACK
[0m11:26:24.837593 [debug] [Thread-1 (]: Failed to rollback 'model.stock_dbt_project.stg_stock_data'
[0m11:26:24.840004 [debug] [Thread-1 (]: On model.stock_dbt_project.stg_stock_data: Close
[0m11:26:24.858007 [debug] [Thread-1 (]: Runtime Error in model stg_stock_data (models\staging\stg_stock_data.sql)
  IO Error: No files found that match the pattern "s3:/my-stock-data-bucket/stocks/*/*/*/*.json"
[0m11:26:24.871305 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '969fe3fa-5d66-43a9-b9b0-ecdf99cc5f94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000299D05921E0>]}
[0m11:26:24.875769 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model main.stg_stock_data ....................... [[31mERROR[0m in 0.33s]
[0m11:26:24.882745 [debug] [Thread-1 (]: Finished running node model.stock_dbt_project.stg_stock_data
[0m11:26:24.887128 [debug] [Thread-4 (]: Marking all children of 'model.stock_dbt_project.stg_stock_data' to be skipped because of status 'error'.  Reason: Runtime Error in model stg_stock_data (models\staging\stg_stock_data.sql)
  IO Error: No files found that match the pattern "s3:/my-stock-data-bucket/stocks/*/*/*/*.json".
[0m11:26:24.895655 [debug] [MainThread]: Using duckdb connection "master"
[0m11:26:24.898509 [debug] [MainThread]: On master: BEGIN
[0m11:26:24.901577 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:26:24.905180 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m11:26:24.908535 [debug] [MainThread]: On master: COMMIT
[0m11:26:24.911161 [debug] [MainThread]: Using duckdb connection "master"
[0m11:26:24.915680 [debug] [MainThread]: On master: COMMIT
[0m11:26:24.919927 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m11:26:24.922379 [debug] [MainThread]: On master: Close
[0m11:26:24.925295 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:26:24.928806 [debug] [MainThread]: Connection 'create_dev_main' was properly closed.
[0m11:26:24.932202 [debug] [MainThread]: Connection 'list_dev_main' was properly closed.
[0m11:26:24.934247 [debug] [MainThread]: Connection 'model.stock_dbt_project.stg_stock_data' was properly closed.
[0m11:26:24.936445 [info ] [MainThread]: 
[0m11:26:24.938599 [info ] [MainThread]: Finished running 9 project hooks, 1 view model in 0 hours 0 minutes and 1.96 seconds (1.96s).
[0m11:26:24.952028 [debug] [MainThread]: Command end result
[0m11:26:25.044185 [debug] [MainThread]: Wrote artifact WritableManifest to D:\Stock_price\stock_dbt_project\target\manifest.json
[0m11:26:25.054454 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\Stock_price\stock_dbt_project\target\semantic_manifest.json
[0m11:26:25.082109 [debug] [MainThread]: Wrote artifact RunExecutionResult to D:\Stock_price\stock_dbt_project\target\run_results.json
[0m11:26:25.085335 [info ] [MainThread]: 
[0m11:26:25.088835 [info ] [MainThread]: [31mCompleted with 3 errors, 0 partial successes, and 0 warnings:[0m
[0m11:26:25.091468 [info ] [MainThread]: 
[0m11:26:25.098135 [error] [MainThread]:   stock_dbt_project.on-run-start.7 failed, error:
 Catalog Error: unrecognized configuration parameter "s3_bucket"

Did you mean: "s3_secret_access_key"
[0m11:26:25.102618 [debug] [MainThread]: 
[0m11:26:25.105092 [debug] [MainThread]:   stock_dbt_project.on-run-start.8 skipped
[0m11:26:25.107293 [info ] [MainThread]: 
[0m11:26:25.116672 [error] [MainThread]:   Runtime Error in model stg_stock_data (models\staging\stg_stock_data.sql)
  IO Error: No files found that match the pattern "s3:/my-stock-data-bucket/stocks/*/*/*/*.json"
[0m11:26:25.119224 [info ] [MainThread]: 
[0m11:26:25.122274 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=2 SKIP=1 TOTAL=10
[0m11:26:25.130210 [debug] [MainThread]: Command `dbt run` failed at 11:26:25.129203 after 8.50 seconds
[0m11:26:25.132741 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000299D083E3C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000299D2A38F50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000299D0BEF6E0>]}
[0m11:26:25.135422 [debug] [MainThread]: Flushing usage events
[0m11:26:25.795587 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:28:42.091928 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000245A0F33260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000245A058FF80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000245A058FEF0>]}


============================== 11:28:42.102790 | e47cce6c-8d28-453b-8534-b2961d15e6a9 ==============================
[0m11:28:42.102790 [info ] [MainThread]: Running with dbt=1.9.4
[0m11:28:42.104251 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'D:\\Stock_price\\stock_dbt_project\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\loges\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run --select stg_stock_data', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:28:42.724984 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e47cce6c-8d28-453b-8534-b2961d15e6a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000245A0C0BE00>]}
[0m11:28:42.972295 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e47cce6c-8d28-453b-8534-b2961d15e6a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002459EB392E0>]}
[0m11:28:42.978372 [info ] [MainThread]: Registered adapter: duckdb=1.9.2
[0m11:28:44.056901 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m11:28:45.411414 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:28:45.414223 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:28:45.438649 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.stock_dbt_project.marts
[0m11:28:45.623406 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e47cce6c-8d28-453b-8534-b2961d15e6a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000245A0F98C50>]}
[0m11:28:46.070708 [debug] [MainThread]: Wrote artifact WritableManifest to D:\Stock_price\stock_dbt_project\target\manifest.json
[0m11:28:46.082437 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\Stock_price\stock_dbt_project\target\semantic_manifest.json
[0m11:28:46.225554 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e47cce6c-8d28-453b-8534-b2961d15e6a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000245A267DE50>]}
[0m11:28:46.228272 [info ] [MainThread]: Found 4 models, 9 operations, 4 data tests, 426 macros
[0m11:28:46.233181 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e47cce6c-8d28-453b-8534-b2961d15e6a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000245A07E28A0>]}
[0m11:28:46.239661 [info ] [MainThread]: 
[0m11:28:46.241863 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:28:46.245402 [info ] [MainThread]: 
[0m11:28:46.251267 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m11:28:46.255585 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m11:28:46.589407 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m11:28:46.590408 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m11:28:46.591408 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:28:46.644995 [debug] [ThreadPool]: SQL status: OK in 0.052 seconds
[0m11:28:46.653513 [debug] [ThreadPool]: On list_dev: Close
[0m11:28:46.657106 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m11:28:46.658995 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m11:28:46.674037 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m11:28:46.674037 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "create_dev_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m11:28:46.675038 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:28:46.677378 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m11:28:46.680380 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m11:28:46.681378 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m11:28:46.682378 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:28:46.682378 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m11:28:46.683372 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "create_dev_main"} */

    
    
        create schema if not exists "dev"."main"
    
[0m11:28:46.684886 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:28:46.685906 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m11:28:46.686907 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m11:28:46.686907 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m11:28:46.687904 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:28:46.688907 [debug] [ThreadPool]: On create_dev_main: Close
[0m11:28:46.700543 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev_main'
[0m11:28:46.710084 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m11:28:46.711485 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m11:28:46.713224 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:28:46.714448 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m11:28:46.715578 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m11:28:46.716162 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m11:28:46.758608 [debug] [ThreadPool]: SQL status: OK in 0.041 seconds
[0m11:28:46.762381 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m11:28:46.765128 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m11:28:46.766221 [debug] [ThreadPool]: On list_dev_main: Close
[0m11:28:46.767910 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e47cce6c-8d28-453b-8534-b2961d15e6a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000245A116A1E0>]}
[0m11:28:46.769010 [debug] [MainThread]: Using duckdb connection "master"
[0m11:28:46.769603 [debug] [MainThread]: On master: BEGIN
[0m11:28:46.770108 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:28:46.771161 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m11:28:46.771694 [debug] [MainThread]: On master: COMMIT
[0m11:28:46.772245 [debug] [MainThread]: Using duckdb connection "master"
[0m11:28:46.773369 [debug] [MainThread]: On master: COMMIT
[0m11:28:46.773920 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m11:28:46.785654 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-0"
[0m11:28:46.792706 [info ] [MainThread]: 1 of 9 START hook: stock_dbt_project.on-run-start.0 ............................ [RUN]
[0m11:28:46.794379 [debug] [MainThread]: Using duckdb connection "master"
[0m11:28:46.796385 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
INSTALL httpfs;
[0m11:28:46.798391 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m11:28:46.800393 [info ] [MainThread]: 1 of 9 OK hook: stock_dbt_project.on-run-start.0 ............................... [[32mOK[0m in 0.03s]
[0m11:28:46.803388 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-1"
[0m11:28:46.804380 [info ] [MainThread]: 2 of 9 START hook: stock_dbt_project.on-run-start.1 ............................ [RUN]
[0m11:28:46.805388 [debug] [MainThread]: Using duckdb connection "master"
[0m11:28:46.806387 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
INSTALL json;
[0m11:28:46.808388 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m11:28:46.811393 [info ] [MainThread]: 2 of 9 OK hook: stock_dbt_project.on-run-start.1 ............................... [[32mOK[0m in 0.01s]
[0m11:28:46.817394 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-2"
[0m11:28:46.819906 [info ] [MainThread]: 3 of 9 START hook: stock_dbt_project.on-run-start.2 ............................ [RUN]
[0m11:28:46.821699 [debug] [MainThread]: Using duckdb connection "master"
[0m11:28:46.823918 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
LOAD httpfs;
[0m11:28:47.190744 [debug] [MainThread]: SQL status: OK in 0.365 seconds
[0m11:28:47.195321 [info ] [MainThread]: 3 of 9 OK hook: stock_dbt_project.on-run-start.2 ............................... [[32mOK[0m in 0.38s]
[0m11:28:47.204919 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-3"
[0m11:28:47.208273 [info ] [MainThread]: 4 of 9 START hook: stock_dbt_project.on-run-start.3 ............................ [RUN]
[0m11:28:47.216590 [debug] [MainThread]: Using duckdb connection "master"
[0m11:28:47.218611 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
LOAD json;
[0m11:28:47.221608 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m11:28:47.225350 [info ] [MainThread]: 4 of 9 OK hook: stock_dbt_project.on-run-start.3 ............................... [[32mOK[0m in 0.03s]
[0m11:28:47.242114 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-4"
[0m11:28:47.251943 [info ] [MainThread]: 5 of 9 START hook: stock_dbt_project.on-run-start.4 ............................ [RUN]
[0m11:28:47.257086 [debug] [MainThread]: Using duckdb connection "master"
[0m11:28:47.260632 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
SET s3_access_key_id='minioadmin';
[0m11:28:47.268399 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m11:28:47.284795 [info ] [MainThread]: 5 of 9 OK hook: stock_dbt_project.on-run-start.4 ............................... [[32mOK[0m in 0.05s]
[0m11:28:47.308496 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-5"
[0m11:28:47.320242 [info ] [MainThread]: 6 of 9 START hook: stock_dbt_project.on-run-start.5 ............................ [RUN]
[0m11:28:47.324069 [debug] [MainThread]: Using duckdb connection "master"
[0m11:28:47.325659 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
SET s3_secret_access_key='minioadmin';
[0m11:28:47.331864 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m11:28:47.336485 [info ] [MainThread]: 6 of 9 OK hook: stock_dbt_project.on-run-start.5 ............................... [[32mOK[0m in 0.04s]
[0m11:28:47.342173 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-6"
[0m11:28:47.346889 [info ] [MainThread]: 7 of 9 START hook: stock_dbt_project.on-run-start.6 ............................ [RUN]
[0m11:28:47.350351 [debug] [MainThread]: Using duckdb connection "master"
[0m11:28:47.352466 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
SET s3_endpoint='http://localhost:9000';
[0m11:28:47.354773 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m11:28:47.359507 [info ] [MainThread]: 7 of 9 OK hook: stock_dbt_project.on-run-start.6 ............................... [[32mOK[0m in 0.02s]
[0m11:28:47.374632 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-7"
[0m11:28:47.380615 [info ] [MainThread]: 8 of 9 START hook: stock_dbt_project.on-run-start.7 ............................ [RUN]
[0m11:28:47.386941 [debug] [MainThread]: Using duckdb connection "master"
[0m11:28:47.391959 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
SET s3_bucket='my-stock-data-bucket';
[0m11:28:47.407271 [debug] [MainThread]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
SET s3_bucket='my-stock-data-bucket';
[0m11:28:47.413680 [debug] [MainThread]: DuckDB adapter: Rolling back transaction.
[0m11:28:47.422172 [info ] [MainThread]: 8 of 9 ERROR hook: stock_dbt_project.on-run-start.7 ............................ [[31mERROR[0m in 0.06s]
[0m11:28:47.427510 [info ] [MainThread]: 9 of 9 SKIP hook: stock_dbt_project.on-run-start.8 ............................. [[33mSKIP[0m in 0.00s]
[0m11:28:47.435695 [info ] [MainThread]: 
[0m11:28:47.439962 [debug] [MainThread]: On master: Close
[0m11:28:47.472814 [debug] [Thread-1 (]: Began running node model.stock_dbt_project.stg_stock_data
[0m11:28:47.480949 [info ] [Thread-1 (]: 1 of 1 START sql view model main.stg_stock_data ................................ [RUN]
[0m11:28:47.484973 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.stock_dbt_project.stg_stock_data'
[0m11:28:47.489071 [debug] [Thread-1 (]: Began compiling node model.stock_dbt_project.stg_stock_data
[0m11:28:47.503944 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_dbt_project.stg_stock_data"
[0m11:28:47.508701 [debug] [Thread-1 (]: Began executing node model.stock_dbt_project.stg_stock_data
[0m11:28:47.653008 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_dbt_project.stg_stock_data"
[0m11:28:47.655966 [debug] [Thread-1 (]: Using duckdb connection "model.stock_dbt_project.stg_stock_data"
[0m11:28:47.657068 [debug] [Thread-1 (]: On model.stock_dbt_project.stg_stock_data: BEGIN
[0m11:28:47.659072 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m11:28:47.662515 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m11:28:47.663754 [debug] [Thread-1 (]: Using duckdb connection "model.stock_dbt_project.stg_stock_data"
[0m11:28:47.665748 [debug] [Thread-1 (]: On model.stock_dbt_project.stg_stock_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "node_id": "model.stock_dbt_project.stg_stock_data"} */

  
  create view "dev"."main"."stg_stock_data__dbt_tmp" as (
    



WITH raw AS (
    SELECT *
    FROM read_json_auto('s3:/my-stock-data-bucket/stocks/*/*/*/*.json')
)

SELECT
    CAST(symbol AS TEXT) AS symbol,
    CAST(datetime AS TIMESTAMP) AS datetime,
    CAST(open AS DOUBLE) AS open,
    CAST(high AS DOUBLE) AS high,
    CAST(low AS DOUBLE) AS low,
    CAST(close AS DOUBLE) AS close,
    CAST(volume AS BIGINT) AS volume
FROM raw
WHERE symbol IS NOT NULL AND datetime IS NOT NULL
  );

[0m11:28:47.668893 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "node_id": "model.stock_dbt_project.stg_stock_data"} */

  
  create view "dev"."main"."stg_stock_data__dbt_tmp" as (
    



WITH raw AS (
    SELECT *
    FROM read_json_auto('s3:/my-stock-data-bucket/stocks/*/*/*/*.json')
)

SELECT
    CAST(symbol AS TEXT) AS symbol,
    CAST(datetime AS TIMESTAMP) AS datetime,
    CAST(open AS DOUBLE) AS open,
    CAST(high AS DOUBLE) AS high,
    CAST(low AS DOUBLE) AS low,
    CAST(close AS DOUBLE) AS close,
    CAST(volume AS BIGINT) AS volume
FROM raw
WHERE symbol IS NOT NULL AND datetime IS NOT NULL
  );

[0m11:28:47.670894 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m11:28:47.671895 [debug] [Thread-1 (]: On model.stock_dbt_project.stg_stock_data: ROLLBACK
[0m11:28:47.687410 [debug] [Thread-1 (]: Failed to rollback 'model.stock_dbt_project.stg_stock_data'
[0m11:28:47.689782 [debug] [Thread-1 (]: On model.stock_dbt_project.stg_stock_data: Close
[0m11:28:47.699179 [debug] [Thread-1 (]: Runtime Error in model stg_stock_data (models\staging\stg_stock_data.sql)
  IO Error: No files found that match the pattern "s3:/my-stock-data-bucket/stocks/*/*/*/*.json"
[0m11:28:47.705822 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e47cce6c-8d28-453b-8534-b2961d15e6a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000245A055E420>]}
[0m11:28:47.707822 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model main.stg_stock_data ....................... [[31mERROR[0m in 0.22s]
[0m11:28:47.710428 [debug] [Thread-1 (]: Finished running node model.stock_dbt_project.stg_stock_data
[0m11:28:47.714690 [debug] [Thread-4 (]: Marking all children of 'model.stock_dbt_project.stg_stock_data' to be skipped because of status 'error'.  Reason: Runtime Error in model stg_stock_data (models\staging\stg_stock_data.sql)
  IO Error: No files found that match the pattern "s3:/my-stock-data-bucket/stocks/*/*/*/*.json".
[0m11:28:47.720877 [debug] [MainThread]: Using duckdb connection "master"
[0m11:28:47.721881 [debug] [MainThread]: On master: BEGIN
[0m11:28:47.723875 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:28:47.726193 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m11:28:47.731129 [debug] [MainThread]: On master: COMMIT
[0m11:28:47.734187 [debug] [MainThread]: Using duckdb connection "master"
[0m11:28:47.736836 [debug] [MainThread]: On master: COMMIT
[0m11:28:47.739196 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m11:28:47.741212 [debug] [MainThread]: On master: Close
[0m11:28:47.742210 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:28:47.744717 [debug] [MainThread]: Connection 'create_dev_main' was properly closed.
[0m11:28:47.747467 [debug] [MainThread]: Connection 'list_dev_main' was properly closed.
[0m11:28:47.748470 [debug] [MainThread]: Connection 'model.stock_dbt_project.stg_stock_data' was properly closed.
[0m11:28:47.749993 [info ] [MainThread]: 
[0m11:28:47.752235 [info ] [MainThread]: Finished running 9 project hooks, 1 view model in 0 hours 0 minutes and 1.50 seconds (1.50s).
[0m11:28:47.757147 [debug] [MainThread]: Command end result
[0m11:28:47.805598 [debug] [MainThread]: Wrote artifact WritableManifest to D:\Stock_price\stock_dbt_project\target\manifest.json
[0m11:28:47.808595 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\Stock_price\stock_dbt_project\target\semantic_manifest.json
[0m11:28:47.827793 [debug] [MainThread]: Wrote artifact RunExecutionResult to D:\Stock_price\stock_dbt_project\target\run_results.json
[0m11:28:47.829847 [info ] [MainThread]: 
[0m11:28:47.831839 [info ] [MainThread]: [31mCompleted with 3 errors, 0 partial successes, and 0 warnings:[0m
[0m11:28:47.833845 [info ] [MainThread]: 
[0m11:28:47.834839 [error] [MainThread]:   stock_dbt_project.on-run-start.7 failed, error:
 Catalog Error: unrecognized configuration parameter "s3_bucket"

Did you mean: "s3_secret_access_key"
[0m11:28:47.835844 [debug] [MainThread]: 
[0m11:28:47.836836 [debug] [MainThread]:   stock_dbt_project.on-run-start.8 skipped
[0m11:28:47.837842 [info ] [MainThread]: 
[0m11:28:47.838845 [error] [MainThread]:   Runtime Error in model stg_stock_data (models\staging\stg_stock_data.sql)
  IO Error: No files found that match the pattern "s3:/my-stock-data-bucket/stocks/*/*/*/*.json"
[0m11:28:47.839839 [info ] [MainThread]: 
[0m11:28:47.840841 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=2 SKIP=1 TOTAL=10
[0m11:28:47.842851 [debug] [MainThread]: Command `dbt run` failed at 11:28:47.841837 after 6.04 seconds
[0m11:28:47.843840 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000245A081C470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000245A0CC3C80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000245A0DDD040>]}
[0m11:28:47.846277 [debug] [MainThread]: Flushing usage events
[0m11:28:48.295703 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:29:08.073081 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B457CFA2D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B457D60470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B457CFAB10>]}


============================== 11:29:08.081790 | 58fe3aff-5976-421f-bece-6d8121c55a30 ==============================
[0m11:29:08.081790 [info ] [MainThread]: Running with dbt=1.9.4
[0m11:29:08.082817 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\loges\\.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'D:\\Stock_price\\stock_dbt_project\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --select stg_stock_data', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m11:29:08.567426 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '58fe3aff-5976-421f-bece-6d8121c55a30', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B45827D4C0>]}
[0m11:29:08.671271 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '58fe3aff-5976-421f-bece-6d8121c55a30', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B4582E41D0>]}
[0m11:29:08.679298 [info ] [MainThread]: Registered adapter: duckdb=1.9.2
[0m11:29:09.041405 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m11:29:09.410390 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m11:29:09.414433 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '58fe3aff-5976-421f-bece-6d8121c55a30', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B457D29B50>]}
[0m11:29:13.469873 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.stock_dbt_project.marts
[0m11:29:13.487040 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '58fe3aff-5976-421f-bece-6d8121c55a30', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B4581CAC30>]}
[0m11:29:13.776509 [debug] [MainThread]: Wrote artifact WritableManifest to D:\Stock_price\stock_dbt_project\target\manifest.json
[0m11:29:13.784580 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\Stock_price\stock_dbt_project\target\semantic_manifest.json
[0m11:29:13.885030 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '58fe3aff-5976-421f-bece-6d8121c55a30', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B4583064B0>]}
[0m11:29:13.887029 [info ] [MainThread]: Found 4 models, 8 operations, 4 data tests, 426 macros
[0m11:29:13.888029 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '58fe3aff-5976-421f-bece-6d8121c55a30', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B4581C83E0>]}
[0m11:29:13.893532 [info ] [MainThread]: 
[0m11:29:13.897201 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:29:13.899396 [info ] [MainThread]: 
[0m11:29:13.902392 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m11:29:13.906572 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m11:29:14.173737 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m11:29:14.175728 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m11:29:14.176734 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:29:14.218919 [debug] [ThreadPool]: SQL status: OK in 0.042 seconds
[0m11:29:14.222361 [debug] [ThreadPool]: On list_dev: Close
[0m11:29:14.225367 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m11:29:14.226453 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m11:29:14.256024 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m11:29:14.257049 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "create_dev_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m11:29:14.260144 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:29:14.266984 [debug] [ThreadPool]: SQL status: OK in 0.007 seconds
[0m11:29:14.273832 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m11:29:14.275843 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m11:29:14.278849 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m11:29:14.282186 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m11:29:14.284415 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "create_dev_main"} */

    
    
        create schema if not exists "dev"."main"
    
[0m11:29:14.287204 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m11:29:14.290321 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m11:29:14.292317 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m11:29:14.294475 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m11:29:14.298559 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m11:29:14.300231 [debug] [ThreadPool]: On create_dev_main: Close
[0m11:29:14.323943 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev_main'
[0m11:29:14.369338 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m11:29:14.371853 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m11:29:14.372948 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:29:14.375186 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m11:29:14.376963 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m11:29:14.380353 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m11:29:14.510293 [debug] [ThreadPool]: SQL status: OK in 0.128 seconds
[0m11:29:14.524351 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m11:29:14.536751 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m11:29:14.538778 [debug] [ThreadPool]: On list_dev_main: Close
[0m11:29:14.543003 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '58fe3aff-5976-421f-bece-6d8121c55a30', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B457CF8050>]}
[0m11:29:14.550338 [debug] [MainThread]: Using duckdb connection "master"
[0m11:29:14.553506 [debug] [MainThread]: On master: BEGIN
[0m11:29:14.556422 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:29:14.559885 [debug] [MainThread]: SQL status: OK in 0.004 seconds
[0m11:29:14.564595 [debug] [MainThread]: On master: COMMIT
[0m11:29:14.567701 [debug] [MainThread]: Using duckdb connection "master"
[0m11:29:14.570167 [debug] [MainThread]: On master: COMMIT
[0m11:29:14.574229 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m11:29:14.618297 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-0"
[0m11:29:14.637501 [info ] [MainThread]: 1 of 8 START hook: stock_dbt_project.on-run-start.0 ............................ [RUN]
[0m11:29:14.640845 [debug] [MainThread]: Using duckdb connection "master"
[0m11:29:14.643180 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
INSTALL httpfs;
[0m11:29:14.651106 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m11:29:14.656770 [info ] [MainThread]: 1 of 8 OK hook: stock_dbt_project.on-run-start.0 ............................... [[32mOK[0m in 0.08s]
[0m11:29:14.667874 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-1"
[0m11:29:14.671406 [info ] [MainThread]: 2 of 8 START hook: stock_dbt_project.on-run-start.1 ............................ [RUN]
[0m11:29:14.674260 [debug] [MainThread]: Using duckdb connection "master"
[0m11:29:14.676302 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
INSTALL json;
[0m11:29:14.682316 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m11:29:14.686989 [info ] [MainThread]: 2 of 8 OK hook: stock_dbt_project.on-run-start.1 ............................... [[32mOK[0m in 0.03s]
[0m11:29:14.695873 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-2"
[0m11:29:14.700306 [info ] [MainThread]: 3 of 8 START hook: stock_dbt_project.on-run-start.2 ............................ [RUN]
[0m11:29:14.703665 [debug] [MainThread]: Using duckdb connection "master"
[0m11:29:14.705854 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
LOAD httpfs;
[0m11:29:15.149728 [debug] [MainThread]: SQL status: OK in 0.443 seconds
[0m11:29:15.153929 [info ] [MainThread]: 3 of 8 OK hook: stock_dbt_project.on-run-start.2 ............................... [[32mOK[0m in 0.46s]
[0m11:29:15.163662 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-3"
[0m11:29:15.167816 [info ] [MainThread]: 4 of 8 START hook: stock_dbt_project.on-run-start.3 ............................ [RUN]
[0m11:29:15.171343 [debug] [MainThread]: Using duckdb connection "master"
[0m11:29:15.172343 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
LOAD json;
[0m11:29:15.177395 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m11:29:15.184265 [info ] [MainThread]: 4 of 8 OK hook: stock_dbt_project.on-run-start.3 ............................... [[32mOK[0m in 0.03s]
[0m11:29:15.192838 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-4"
[0m11:29:15.200451 [info ] [MainThread]: 5 of 8 START hook: stock_dbt_project.on-run-start.4 ............................ [RUN]
[0m11:29:15.203793 [debug] [MainThread]: Using duckdb connection "master"
[0m11:29:15.206364 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
SET s3_access_key_id='minioadmin';
[0m11:29:15.208832 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m11:29:15.217989 [info ] [MainThread]: 5 of 8 OK hook: stock_dbt_project.on-run-start.4 ............................... [[32mOK[0m in 0.03s]
[0m11:29:15.225453 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-5"
[0m11:29:15.228506 [info ] [MainThread]: 6 of 8 START hook: stock_dbt_project.on-run-start.5 ............................ [RUN]
[0m11:29:15.233070 [debug] [MainThread]: Using duckdb connection "master"
[0m11:29:15.235151 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
SET s3_secret_access_key='minioadmin';
[0m11:29:15.238622 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m11:29:15.242452 [info ] [MainThread]: 6 of 8 OK hook: stock_dbt_project.on-run-start.5 ............................... [[32mOK[0m in 0.02s]
[0m11:29:15.253016 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-6"
[0m11:29:15.257625 [info ] [MainThread]: 7 of 8 START hook: stock_dbt_project.on-run-start.6 ............................ [RUN]
[0m11:29:15.260923 [debug] [MainThread]: Using duckdb connection "master"
[0m11:29:15.264717 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
SET s3_endpoint='http://localhost:9000';
[0m11:29:15.267736 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m11:29:15.274931 [info ] [MainThread]: 7 of 8 OK hook: stock_dbt_project.on-run-start.6 ............................... [[32mOK[0m in 0.03s]
[0m11:29:15.286689 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-7"
[0m11:29:15.291141 [info ] [MainThread]: 8 of 8 START hook: stock_dbt_project.on-run-start.7 ............................ [RUN]
[0m11:29:15.294692 [debug] [MainThread]: Using duckdb connection "master"
[0m11:29:15.299214 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
SET s3_use_ssl=false;
[0m11:29:15.315238 [debug] [MainThread]: SQL status: OK in 0.013 seconds
[0m11:29:15.321262 [info ] [MainThread]: 8 of 8 OK hook: stock_dbt_project.on-run-start.7 ............................... [[32mOK[0m in 0.04s]
[0m11:29:15.323278 [info ] [MainThread]: 
[0m11:29:15.325324 [debug] [MainThread]: On master: Close
[0m11:29:15.340936 [debug] [Thread-1 (]: Began running node model.stock_dbt_project.stg_stock_data
[0m11:29:15.343473 [info ] [Thread-1 (]: 1 of 1 START sql view model main.stg_stock_data ................................ [RUN]
[0m11:29:15.349020 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.stock_dbt_project.stg_stock_data'
[0m11:29:15.351825 [debug] [Thread-1 (]: Began compiling node model.stock_dbt_project.stg_stock_data
[0m11:29:15.362366 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_dbt_project.stg_stock_data"
[0m11:29:15.367115 [debug] [Thread-1 (]: Began executing node model.stock_dbt_project.stg_stock_data
[0m11:29:15.481021 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_dbt_project.stg_stock_data"
[0m11:29:15.483016 [debug] [Thread-1 (]: Using duckdb connection "model.stock_dbt_project.stg_stock_data"
[0m11:29:15.485017 [debug] [Thread-1 (]: On model.stock_dbt_project.stg_stock_data: BEGIN
[0m11:29:15.486790 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m11:29:15.488287 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m11:29:15.489285 [debug] [Thread-1 (]: Using duckdb connection "model.stock_dbt_project.stg_stock_data"
[0m11:29:15.491284 [debug] [Thread-1 (]: On model.stock_dbt_project.stg_stock_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "node_id": "model.stock_dbt_project.stg_stock_data"} */

  
  create view "dev"."main"."stg_stock_data__dbt_tmp" as (
    



WITH raw AS (
    SELECT *
    FROM read_json_auto('s3:/my-stock-data-bucket/stocks/*/*/*/*.json')
)

SELECT
    CAST(symbol AS TEXT) AS symbol,
    CAST(datetime AS TIMESTAMP) AS datetime,
    CAST(open AS DOUBLE) AS open,
    CAST(high AS DOUBLE) AS high,
    CAST(low AS DOUBLE) AS low,
    CAST(close AS DOUBLE) AS close,
    CAST(volume AS BIGINT) AS volume
FROM raw
WHERE symbol IS NOT NULL AND datetime IS NOT NULL
  );

[0m11:29:15.495049 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "node_id": "model.stock_dbt_project.stg_stock_data"} */

  
  create view "dev"."main"."stg_stock_data__dbt_tmp" as (
    



WITH raw AS (
    SELECT *
    FROM read_json_auto('s3:/my-stock-data-bucket/stocks/*/*/*/*.json')
)

SELECT
    CAST(symbol AS TEXT) AS symbol,
    CAST(datetime AS TIMESTAMP) AS datetime,
    CAST(open AS DOUBLE) AS open,
    CAST(high AS DOUBLE) AS high,
    CAST(low AS DOUBLE) AS low,
    CAST(close AS DOUBLE) AS close,
    CAST(volume AS BIGINT) AS volume
FROM raw
WHERE symbol IS NOT NULL AND datetime IS NOT NULL
  );

[0m11:29:15.497045 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m11:29:15.499045 [debug] [Thread-1 (]: On model.stock_dbt_project.stg_stock_data: ROLLBACK
[0m11:29:15.517325 [debug] [Thread-1 (]: Failed to rollback 'model.stock_dbt_project.stg_stock_data'
[0m11:29:15.519322 [debug] [Thread-1 (]: On model.stock_dbt_project.stg_stock_data: Close
[0m11:29:15.525193 [debug] [Thread-1 (]: Runtime Error in model stg_stock_data (models\staging\stg_stock_data.sql)
  IO Error: No files found that match the pattern "s3:/my-stock-data-bucket/stocks/*/*/*/*.json"
[0m11:29:15.533186 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '58fe3aff-5976-421f-bece-6d8121c55a30', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B459FA9DC0>]}
[0m11:29:15.535642 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model main.stg_stock_data ....................... [[31mERROR[0m in 0.18s]
[0m11:29:15.537648 [debug] [Thread-1 (]: Finished running node model.stock_dbt_project.stg_stock_data
[0m11:29:15.539652 [debug] [Thread-4 (]: Marking all children of 'model.stock_dbt_project.stg_stock_data' to be skipped because of status 'error'.  Reason: Runtime Error in model stg_stock_data (models\staging\stg_stock_data.sql)
  IO Error: No files found that match the pattern "s3:/my-stock-data-bucket/stocks/*/*/*/*.json".
[0m11:29:15.546278 [debug] [MainThread]: Using duckdb connection "master"
[0m11:29:15.548413 [debug] [MainThread]: On master: BEGIN
[0m11:29:15.550571 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:29:15.552202 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m11:29:15.554216 [debug] [MainThread]: On master: COMMIT
[0m11:29:15.556254 [debug] [MainThread]: Using duckdb connection "master"
[0m11:29:15.557081 [debug] [MainThread]: On master: COMMIT
[0m11:29:15.559700 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m11:29:15.564919 [debug] [MainThread]: On master: Close
[0m11:29:15.567944 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:29:15.569184 [debug] [MainThread]: Connection 'create_dev_main' was properly closed.
[0m11:29:15.570441 [debug] [MainThread]: Connection 'list_dev_main' was properly closed.
[0m11:29:15.571627 [debug] [MainThread]: Connection 'model.stock_dbt_project.stg_stock_data' was properly closed.
[0m11:29:15.572737 [info ] [MainThread]: 
[0m11:29:15.573965 [info ] [MainThread]: Finished running 8 project hooks, 1 view model in 0 hours 0 minutes and 1.67 seconds (1.67s).
[0m11:29:15.581608 [debug] [MainThread]: Command end result
[0m11:29:15.651119 [debug] [MainThread]: Wrote artifact WritableManifest to D:\Stock_price\stock_dbt_project\target\manifest.json
[0m11:29:15.657624 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\Stock_price\stock_dbt_project\target\semantic_manifest.json
[0m11:29:15.674861 [debug] [MainThread]: Wrote artifact RunExecutionResult to D:\Stock_price\stock_dbt_project\target\run_results.json
[0m11:29:15.676854 [info ] [MainThread]: 
[0m11:29:15.678860 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m11:29:15.681860 [info ] [MainThread]: 
[0m11:29:15.683856 [error] [MainThread]:   Runtime Error in model stg_stock_data (models\staging\stg_stock_data.sql)
  IO Error: No files found that match the pattern "s3:/my-stock-data-bucket/stocks/*/*/*/*.json"
[0m11:29:15.685858 [info ] [MainThread]: 
[0m11:29:15.686859 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=1 SKIP=0 TOTAL=9
[0m11:29:15.689852 [debug] [MainThread]: Command `dbt run` failed at 11:29:15.689852 after 7.97 seconds
[0m11:29:15.690857 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B457EC4CE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B455129700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B45827FDD0>]}
[0m11:29:15.692857 [debug] [MainThread]: Flushing usage events
[0m11:29:16.115059 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:34:38.091328 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000203705C06E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020373728410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000203734F9190>]}


============================== 11:34:38.099327 | d375a4b5-4a1f-404e-b860-85c6d0e3460b ==============================
[0m11:34:38.099327 [info ] [MainThread]: Running with dbt=1.9.4
[0m11:34:38.100849 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\loges\\.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'D:\\Stock_price\\stock_dbt_project\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run --select stg_stock_data', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m11:34:38.623769 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd375a4b5-4a1f-404e-b860-85c6d0e3460b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000203739BBDD0>]}
[0m11:34:39.002325 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd375a4b5-4a1f-404e-b860-85c6d0e3460b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000203733B4C20>]}
[0m11:34:39.024490 [info ] [MainThread]: Registered adapter: duckdb=1.9.2
[0m11:34:39.824474 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m11:34:40.637263 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:34:40.639642 [debug] [MainThread]: Partial parsing: updated file: stock_dbt_project://models\staging\stg_stock_data.sql
[0m11:34:41.732162 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.stock_dbt_project.marts
[0m11:34:41.755607 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd375a4b5-4a1f-404e-b860-85c6d0e3460b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000203750E4A40>]}
[0m11:34:42.301989 [debug] [MainThread]: Wrote artifact WritableManifest to D:\Stock_price\stock_dbt_project\target\manifest.json
[0m11:34:42.307361 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\Stock_price\stock_dbt_project\target\semantic_manifest.json
[0m11:34:42.370868 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd375a4b5-4a1f-404e-b860-85c6d0e3460b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020375096360>]}
[0m11:34:42.371860 [info ] [MainThread]: Found 4 models, 8 operations, 4 data tests, 426 macros
[0m11:34:42.372960 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd375a4b5-4a1f-404e-b860-85c6d0e3460b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000203750E5640>]}
[0m11:34:42.377714 [info ] [MainThread]: 
[0m11:34:42.379305 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:34:42.381480 [info ] [MainThread]: 
[0m11:34:42.383098 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m11:34:42.384106 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m11:34:42.565685 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m11:34:42.567686 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m11:34:42.569735 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:34:42.616764 [debug] [ThreadPool]: SQL status: OK in 0.047 seconds
[0m11:34:42.621228 [debug] [ThreadPool]: On list_dev: Close
[0m11:34:42.623694 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m11:34:42.626627 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m11:34:42.652779 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m11:34:42.654567 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "create_dev_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m11:34:42.655743 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:34:42.662200 [debug] [ThreadPool]: SQL status: OK in 0.006 seconds
[0m11:34:42.668416 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m11:34:42.669664 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m11:34:42.670724 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:34:42.672338 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m11:34:42.674042 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "create_dev_main"} */

    
    
        create schema if not exists "dev"."main"
    
[0m11:34:42.680497 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m11:34:42.686128 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m11:34:42.689584 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m11:34:42.698958 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m11:34:42.703579 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m11:34:42.706963 [debug] [ThreadPool]: On create_dev_main: Close
[0m11:34:42.739308 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev_main'
[0m11:34:42.759114 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m11:34:42.762367 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m11:34:42.764976 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:34:42.767015 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m11:34:42.769161 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m11:34:42.770363 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m11:34:42.811086 [debug] [ThreadPool]: SQL status: OK in 0.039 seconds
[0m11:34:42.814071 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m11:34:42.818359 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m11:34:42.819424 [debug] [ThreadPool]: On list_dev_main: Close
[0m11:34:42.821422 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd375a4b5-4a1f-404e-b860-85c6d0e3460b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020370831F70>]}
[0m11:34:42.822431 [debug] [MainThread]: Using duckdb connection "master"
[0m11:34:42.823432 [debug] [MainThread]: On master: BEGIN
[0m11:34:42.824761 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:34:42.827189 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m11:34:42.829190 [debug] [MainThread]: On master: COMMIT
[0m11:34:42.830186 [debug] [MainThread]: Using duckdb connection "master"
[0m11:34:42.831195 [debug] [MainThread]: On master: COMMIT
[0m11:34:42.833201 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m11:34:42.851393 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-0"
[0m11:34:42.881370 [info ] [MainThread]: 1 of 8 START hook: stock_dbt_project.on-run-start.0 ............................ [RUN]
[0m11:34:42.884372 [debug] [MainThread]: Using duckdb connection "master"
[0m11:34:42.886363 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
INSTALL httpfs;
[0m11:34:42.892085 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m11:34:42.901267 [info ] [MainThread]: 1 of 8 OK hook: stock_dbt_project.on-run-start.0 ............................... [[32mOK[0m in 0.06s]
[0m11:34:42.916183 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-1"
[0m11:34:42.920456 [info ] [MainThread]: 2 of 8 START hook: stock_dbt_project.on-run-start.1 ............................ [RUN]
[0m11:34:42.924146 [debug] [MainThread]: Using duckdb connection "master"
[0m11:34:42.927555 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
INSTALL json;
[0m11:34:42.934335 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m11:34:42.940394 [info ] [MainThread]: 2 of 8 OK hook: stock_dbt_project.on-run-start.1 ............................... [[32mOK[0m in 0.04s]
[0m11:34:42.955351 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-2"
[0m11:34:42.960361 [info ] [MainThread]: 3 of 8 START hook: stock_dbt_project.on-run-start.2 ............................ [RUN]
[0m11:34:42.966153 [debug] [MainThread]: Using duckdb connection "master"
[0m11:34:42.970538 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
LOAD httpfs;
[0m11:34:43.517005 [debug] [MainThread]: SQL status: OK in 0.544 seconds
[0m11:34:43.519031 [info ] [MainThread]: 3 of 8 OK hook: stock_dbt_project.on-run-start.2 ............................... [[32mOK[0m in 0.57s]
[0m11:34:43.522631 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-3"
[0m11:34:43.523642 [info ] [MainThread]: 4 of 8 START hook: stock_dbt_project.on-run-start.3 ............................ [RUN]
[0m11:34:43.525509 [debug] [MainThread]: Using duckdb connection "master"
[0m11:34:43.527525 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
LOAD json;
[0m11:34:43.529520 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m11:34:43.530519 [info ] [MainThread]: 4 of 8 OK hook: stock_dbt_project.on-run-start.3 ............................... [[32mOK[0m in 0.01s]
[0m11:34:43.534530 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-4"
[0m11:34:43.536518 [info ] [MainThread]: 5 of 8 START hook: stock_dbt_project.on-run-start.4 ............................ [RUN]
[0m11:34:43.537518 [debug] [MainThread]: Using duckdb connection "master"
[0m11:34:43.537518 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
SET s3_access_key_id='minioadmin';
[0m11:34:43.539844 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m11:34:43.540909 [info ] [MainThread]: 5 of 8 OK hook: stock_dbt_project.on-run-start.4 ............................... [[32mOK[0m in 0.01s]
[0m11:34:43.545905 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-5"
[0m11:34:43.547898 [info ] [MainThread]: 6 of 8 START hook: stock_dbt_project.on-run-start.5 ............................ [RUN]
[0m11:34:43.548910 [debug] [MainThread]: Using duckdb connection "master"
[0m11:34:43.549907 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
SET s3_secret_access_key='minioadmin';
[0m11:34:43.550927 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m11:34:43.553650 [info ] [MainThread]: 6 of 8 OK hook: stock_dbt_project.on-run-start.5 ............................... [[32mOK[0m in 0.01s]
[0m11:34:43.557324 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-6"
[0m11:34:43.559323 [info ] [MainThread]: 7 of 8 START hook: stock_dbt_project.on-run-start.6 ............................ [RUN]
[0m11:34:43.563320 [debug] [MainThread]: Using duckdb connection "master"
[0m11:34:43.564317 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
SET s3_endpoint='http://localhost:9000';
[0m11:34:43.565330 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m11:34:43.568004 [info ] [MainThread]: 7 of 8 OK hook: stock_dbt_project.on-run-start.6 ............................... [[32mOK[0m in 0.01s]
[0m11:34:43.570638 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-7"
[0m11:34:43.571630 [info ] [MainThread]: 8 of 8 START hook: stock_dbt_project.on-run-start.7 ............................ [RUN]
[0m11:34:43.572631 [debug] [MainThread]: Using duckdb connection "master"
[0m11:34:43.574922 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
SET s3_use_ssl=false;
[0m11:34:43.577923 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m11:34:43.580919 [info ] [MainThread]: 8 of 8 OK hook: stock_dbt_project.on-run-start.7 ............................... [[32mOK[0m in 0.01s]
[0m11:34:43.582549 [info ] [MainThread]: 
[0m11:34:43.583438 [debug] [MainThread]: On master: Close
[0m11:34:43.591876 [debug] [Thread-1 (]: Began running node model.stock_dbt_project.stg_stock_data
[0m11:34:43.593756 [info ] [Thread-1 (]: 1 of 1 START sql view model main.stg_stock_data ................................ [RUN]
[0m11:34:43.597304 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.stock_dbt_project.stg_stock_data'
[0m11:34:43.598357 [debug] [Thread-1 (]: Began compiling node model.stock_dbt_project.stg_stock_data
[0m11:34:43.603358 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_dbt_project.stg_stock_data"
[0m11:34:43.604316 [debug] [Thread-1 (]: Began executing node model.stock_dbt_project.stg_stock_data
[0m11:34:43.668034 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_dbt_project.stg_stock_data"
[0m11:34:43.669033 [debug] [Thread-1 (]: Using duckdb connection "model.stock_dbt_project.stg_stock_data"
[0m11:34:43.670028 [debug] [Thread-1 (]: On model.stock_dbt_project.stg_stock_data: BEGIN
[0m11:34:43.671087 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m11:34:43.672795 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m11:34:43.673793 [debug] [Thread-1 (]: Using duckdb connection "model.stock_dbt_project.stg_stock_data"
[0m11:34:43.673793 [debug] [Thread-1 (]: On model.stock_dbt_project.stg_stock_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "node_id": "model.stock_dbt_project.stg_stock_data"} */

  
  create view "dev"."main"."stg_stock_data__dbt_tmp" as (
    



WITH raw AS (
    SELECT *
    FROM read_json_auto('s3:/my-stock-data-bucket/stocks/*/*/*/*/*.json')
)

SELECT
    CAST(symbol AS TEXT) AS symbol,
    CAST(datetime AS TIMESTAMP) AS datetime,
    CAST(open AS DOUBLE) AS open,
    CAST(high AS DOUBLE) AS high,
    CAST(low AS DOUBLE) AS low,
    CAST(close AS DOUBLE) AS close,
    CAST(volume AS BIGINT) AS volume
FROM raw
WHERE symbol IS NOT NULL AND datetime IS NOT NULL
  );

[0m11:34:43.678135 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "node_id": "model.stock_dbt_project.stg_stock_data"} */

  
  create view "dev"."main"."stg_stock_data__dbt_tmp" as (
    



WITH raw AS (
    SELECT *
    FROM read_json_auto('s3:/my-stock-data-bucket/stocks/*/*/*/*/*.json')
)

SELECT
    CAST(symbol AS TEXT) AS symbol,
    CAST(datetime AS TIMESTAMP) AS datetime,
    CAST(open AS DOUBLE) AS open,
    CAST(high AS DOUBLE) AS high,
    CAST(low AS DOUBLE) AS low,
    CAST(close AS DOUBLE) AS close,
    CAST(volume AS BIGINT) AS volume
FROM raw
WHERE symbol IS NOT NULL AND datetime IS NOT NULL
  );

[0m11:34:43.680140 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m11:34:43.682148 [debug] [Thread-1 (]: On model.stock_dbt_project.stg_stock_data: ROLLBACK
[0m11:34:43.693152 [debug] [Thread-1 (]: Failed to rollback 'model.stock_dbt_project.stg_stock_data'
[0m11:34:43.695134 [debug] [Thread-1 (]: On model.stock_dbt_project.stg_stock_data: Close
[0m11:34:43.701134 [debug] [Thread-1 (]: Runtime Error in model stg_stock_data (models\staging\stg_stock_data.sql)
  IO Error: No files found that match the pattern "s3:/my-stock-data-bucket/stocks/*/*/*/*/*.json"
[0m11:34:43.704506 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd375a4b5-4a1f-404e-b860-85c6d0e3460b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000203756F15B0>]}
[0m11:34:43.706685 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model main.stg_stock_data ....................... [[31mERROR[0m in 0.11s]
[0m11:34:43.710100 [debug] [Thread-1 (]: Finished running node model.stock_dbt_project.stg_stock_data
[0m11:34:43.713789 [debug] [Thread-4 (]: Marking all children of 'model.stock_dbt_project.stg_stock_data' to be skipped because of status 'error'.  Reason: Runtime Error in model stg_stock_data (models\staging\stg_stock_data.sql)
  IO Error: No files found that match the pattern "s3:/my-stock-data-bucket/stocks/*/*/*/*/*.json".
[0m11:34:43.719018 [debug] [MainThread]: Using duckdb connection "master"
[0m11:34:43.720646 [debug] [MainThread]: On master: BEGIN
[0m11:34:43.721279 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:34:43.722809 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m11:34:43.723808 [debug] [MainThread]: On master: COMMIT
[0m11:34:43.723808 [debug] [MainThread]: Using duckdb connection "master"
[0m11:34:43.724807 [debug] [MainThread]: On master: COMMIT
[0m11:34:43.726765 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m11:34:43.727841 [debug] [MainThread]: On master: Close
[0m11:34:43.729782 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:34:43.730780 [debug] [MainThread]: Connection 'create_dev_main' was properly closed.
[0m11:34:43.731775 [debug] [MainThread]: Connection 'list_dev_main' was properly closed.
[0m11:34:43.731775 [debug] [MainThread]: Connection 'model.stock_dbt_project.stg_stock_data' was properly closed.
[0m11:34:43.732783 [info ] [MainThread]: 
[0m11:34:43.733776 [info ] [MainThread]: Finished running 8 project hooks, 1 view model in 0 hours 0 minutes and 1.35 seconds (1.35s).
[0m11:34:43.738628 [debug] [MainThread]: Command end result
[0m11:34:43.784102 [debug] [MainThread]: Wrote artifact WritableManifest to D:\Stock_price\stock_dbt_project\target\manifest.json
[0m11:34:43.789258 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\Stock_price\stock_dbt_project\target\semantic_manifest.json
[0m11:34:43.802002 [debug] [MainThread]: Wrote artifact RunExecutionResult to D:\Stock_price\stock_dbt_project\target\run_results.json
[0m11:34:43.802889 [info ] [MainThread]: 
[0m11:34:43.803711 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m11:34:43.804720 [info ] [MainThread]: 
[0m11:34:43.805719 [error] [MainThread]:   Runtime Error in model stg_stock_data (models\staging\stg_stock_data.sql)
  IO Error: No files found that match the pattern "s3:/my-stock-data-bucket/stocks/*/*/*/*/*.json"
[0m11:34:43.806719 [info ] [MainThread]: 
[0m11:34:43.806719 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=1 SKIP=0 TOTAL=9
[0m11:34:43.808721 [debug] [MainThread]: Command `dbt run` failed at 11:34:43.808721 after 6.00 seconds
[0m11:34:43.810726 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000203734F9190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000203734F9F40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000203734FB1D0>]}
[0m11:34:43.811735 [debug] [MainThread]: Flushing usage events
[0m11:34:44.218182 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:35:30.058109 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022541DFFD40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002254162ACC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000225416285F0>]}


============================== 11:35:30.073750 | ff82505e-4429-4cf1-b3ee-d5f2ceb314f4 ==============================
[0m11:35:30.073750 [info ] [MainThread]: Running with dbt=1.9.4
[0m11:35:30.080044 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'D:\\Stock_price\\stock_dbt_project\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\loges\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run --select stg_stock_data', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m11:35:30.958336 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ff82505e-4429-4cf1-b3ee-d5f2ceb314f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022542603740>]}
[0m11:35:31.301040 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ff82505e-4429-4cf1-b3ee-d5f2ceb314f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022542603140>]}
[0m11:35:31.309371 [info ] [MainThread]: Registered adapter: duckdb=1.9.2
[0m11:35:32.076003 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m11:35:32.501930 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:35:32.503903 [debug] [MainThread]: Partial parsing: updated file: stock_dbt_project://models\staging\stg_stock_data.sql
[0m11:35:33.317001 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.stock_dbt_project.marts
[0m11:35:33.336978 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ff82505e-4429-4cf1-b3ee-d5f2ceb314f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022543D20CE0>]}
[0m11:35:33.522291 [debug] [MainThread]: Wrote artifact WritableManifest to D:\Stock_price\stock_dbt_project\target\manifest.json
[0m11:35:33.525665 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\Stock_price\stock_dbt_project\target\semantic_manifest.json
[0m11:35:33.568950 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ff82505e-4429-4cf1-b3ee-d5f2ceb314f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022543CD2600>]}
[0m11:35:33.570650 [info ] [MainThread]: Found 4 models, 8 operations, 4 data tests, 426 macros
[0m11:35:33.571614 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ff82505e-4429-4cf1-b3ee-d5f2ceb314f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022543B7DFD0>]}
[0m11:35:33.574614 [info ] [MainThread]: 
[0m11:35:33.575621 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:35:33.576618 [info ] [MainThread]: 
[0m11:35:33.578622 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m11:35:33.581619 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m11:35:33.713566 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m11:35:33.714567 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m11:35:33.715561 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:35:33.737589 [debug] [ThreadPool]: SQL status: OK in 0.022 seconds
[0m11:35:33.740154 [debug] [ThreadPool]: On list_dev: Close
[0m11:35:33.742172 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m11:35:33.743176 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m11:35:33.754420 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m11:35:33.754420 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "create_dev_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m11:35:33.755430 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:35:33.756430 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m11:35:33.760665 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m11:35:33.762645 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m11:35:33.763645 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:35:33.764644 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m11:35:33.765644 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "create_dev_main"} */

    
    
        create schema if not exists "dev"."main"
    
[0m11:35:33.766645 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:35:33.767644 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m11:35:33.768642 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m11:35:33.768642 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m11:35:33.769642 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:35:33.770643 [debug] [ThreadPool]: On create_dev_main: Close
[0m11:35:33.782617 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev_main'
[0m11:35:33.794448 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m11:35:33.795466 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m11:35:33.796466 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:35:33.797466 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m11:35:33.798457 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m11:35:33.799649 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m11:35:33.828489 [debug] [ThreadPool]: SQL status: OK in 0.028 seconds
[0m11:35:33.832486 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m11:35:33.835389 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m11:35:33.837403 [debug] [ThreadPool]: On list_dev_main: Close
[0m11:35:33.839401 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ff82505e-4429-4cf1-b3ee-d5f2ceb314f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022543C0D2E0>]}
[0m11:35:33.840400 [debug] [MainThread]: Using duckdb connection "master"
[0m11:35:33.841402 [debug] [MainThread]: On master: BEGIN
[0m11:35:33.842401 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:35:33.845857 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m11:35:33.847842 [debug] [MainThread]: On master: COMMIT
[0m11:35:33.848851 [debug] [MainThread]: Using duckdb connection "master"
[0m11:35:33.850842 [debug] [MainThread]: On master: COMMIT
[0m11:35:33.851842 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m11:35:33.866850 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-0"
[0m11:35:33.881915 [info ] [MainThread]: 1 of 8 START hook: stock_dbt_project.on-run-start.0 ............................ [RUN]
[0m11:35:33.884125 [debug] [MainThread]: Using duckdb connection "master"
[0m11:35:33.886120 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
INSTALL httpfs;
[0m11:35:33.888119 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m11:35:33.890065 [info ] [MainThread]: 1 of 8 OK hook: stock_dbt_project.on-run-start.0 ............................... [[32mOK[0m in 0.04s]
[0m11:35:33.895619 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-1"
[0m11:35:33.898624 [info ] [MainThread]: 2 of 8 START hook: stock_dbt_project.on-run-start.1 ............................ [RUN]
[0m11:35:33.899614 [debug] [MainThread]: Using duckdb connection "master"
[0m11:35:33.900613 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
INSTALL json;
[0m11:35:33.902620 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m11:35:33.904620 [info ] [MainThread]: 2 of 8 OK hook: stock_dbt_project.on-run-start.1 ............................... [[32mOK[0m in 0.01s]
[0m11:35:33.911209 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-2"
[0m11:35:33.914199 [info ] [MainThread]: 3 of 8 START hook: stock_dbt_project.on-run-start.2 ............................ [RUN]
[0m11:35:33.915199 [debug] [MainThread]: Using duckdb connection "master"
[0m11:35:33.916198 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
LOAD httpfs;
[0m11:35:34.249495 [debug] [MainThread]: SQL status: OK in 0.331 seconds
[0m11:35:34.253753 [info ] [MainThread]: 3 of 8 OK hook: stock_dbt_project.on-run-start.2 ............................... [[32mOK[0m in 0.35s]
[0m11:35:34.263678 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-3"
[0m11:35:34.268017 [info ] [MainThread]: 4 of 8 START hook: stock_dbt_project.on-run-start.3 ............................ [RUN]
[0m11:35:34.271014 [debug] [MainThread]: Using duckdb connection "master"
[0m11:35:34.274011 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
LOAD json;
[0m11:35:34.279160 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m11:35:34.285649 [info ] [MainThread]: 4 of 8 OK hook: stock_dbt_project.on-run-start.3 ............................... [[32mOK[0m in 0.03s]
[0m11:35:34.291747 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-4"
[0m11:35:34.296832 [info ] [MainThread]: 5 of 8 START hook: stock_dbt_project.on-run-start.4 ............................ [RUN]
[0m11:35:34.301043 [debug] [MainThread]: Using duckdb connection "master"
[0m11:35:34.303568 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
SET s3_access_key_id='minioadmin';
[0m11:35:34.305571 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m11:35:34.307571 [info ] [MainThread]: 5 of 8 OK hook: stock_dbt_project.on-run-start.4 ............................... [[32mOK[0m in 0.02s]
[0m11:35:34.317219 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-5"
[0m11:35:34.320815 [info ] [MainThread]: 6 of 8 START hook: stock_dbt_project.on-run-start.5 ............................ [RUN]
[0m11:35:34.325119 [debug] [MainThread]: Using duckdb connection "master"
[0m11:35:34.329148 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
SET s3_secret_access_key='minioadmin';
[0m11:35:34.332397 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m11:35:34.336305 [info ] [MainThread]: 6 of 8 OK hook: stock_dbt_project.on-run-start.5 ............................... [[32mOK[0m in 0.02s]
[0m11:35:34.341602 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-6"
[0m11:35:34.348607 [info ] [MainThread]: 7 of 8 START hook: stock_dbt_project.on-run-start.6 ............................ [RUN]
[0m11:35:34.351381 [debug] [MainThread]: Using duckdb connection "master"
[0m11:35:34.353395 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
SET s3_endpoint='http://localhost:9000';
[0m11:35:34.355407 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m11:35:34.357405 [info ] [MainThread]: 7 of 8 OK hook: stock_dbt_project.on-run-start.6 ............................... [[32mOK[0m in 0.02s]
[0m11:35:34.366236 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-7"
[0m11:35:34.369541 [info ] [MainThread]: 8 of 8 START hook: stock_dbt_project.on-run-start.7 ............................ [RUN]
[0m11:35:34.371658 [debug] [MainThread]: Using duckdb connection "master"
[0m11:35:34.372661 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
SET s3_use_ssl=false;
[0m11:35:34.374738 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m11:35:34.383509 [info ] [MainThread]: 8 of 8 OK hook: stock_dbt_project.on-run-start.7 ............................... [[32mOK[0m in 0.02s]
[0m11:35:34.385508 [info ] [MainThread]: 
[0m11:35:34.387507 [debug] [MainThread]: On master: Close
[0m11:35:34.401788 [debug] [Thread-1 (]: Began running node model.stock_dbt_project.stg_stock_data
[0m11:35:34.405280 [info ] [Thread-1 (]: 1 of 1 START sql view model main.stg_stock_data ................................ [RUN]
[0m11:35:34.408428 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.stock_dbt_project.stg_stock_data'
[0m11:35:34.412713 [debug] [Thread-1 (]: Began compiling node model.stock_dbt_project.stg_stock_data
[0m11:35:34.422259 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_dbt_project.stg_stock_data"
[0m11:35:34.424478 [debug] [Thread-1 (]: Began executing node model.stock_dbt_project.stg_stock_data
[0m11:35:34.523180 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_dbt_project.stg_stock_data"
[0m11:35:34.524181 [debug] [Thread-1 (]: Using duckdb connection "model.stock_dbt_project.stg_stock_data"
[0m11:35:34.526198 [debug] [Thread-1 (]: On model.stock_dbt_project.stg_stock_data: BEGIN
[0m11:35:34.528183 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m11:35:34.529181 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m11:35:34.530188 [debug] [Thread-1 (]: Using duckdb connection "model.stock_dbt_project.stg_stock_data"
[0m11:35:34.531183 [debug] [Thread-1 (]: On model.stock_dbt_project.stg_stock_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "node_id": "model.stock_dbt_project.stg_stock_data"} */

  
  create view "dev"."main"."stg_stock_data__dbt_tmp" as (
    



WITH raw AS (
    SELECT *
    FROM read_json_auto('s3://my-stock-data-bucket/stocks/*/*/*/*/*.json')
)

SELECT
    CAST(symbol AS TEXT) AS symbol,
    CAST(datetime AS TIMESTAMP) AS datetime,
    CAST(open AS DOUBLE) AS open,
    CAST(high AS DOUBLE) AS high,
    CAST(low AS DOUBLE) AS low,
    CAST(close AS DOUBLE) AS close,
    CAST(volume AS BIGINT) AS volume
FROM raw
WHERE symbol IS NOT NULL AND datetime IS NOT NULL
  );

[0m11:35:34.758163 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "node_id": "model.stock_dbt_project.stg_stock_data"} */

  
  create view "dev"."main"."stg_stock_data__dbt_tmp" as (
    



WITH raw AS (
    SELECT *
    FROM read_json_auto('s3://my-stock-data-bucket/stocks/*/*/*/*/*.json')
)

SELECT
    CAST(symbol AS TEXT) AS symbol,
    CAST(datetime AS TIMESTAMP) AS datetime,
    CAST(open AS DOUBLE) AS open,
    CAST(high AS DOUBLE) AS high,
    CAST(low AS DOUBLE) AS low,
    CAST(close AS DOUBLE) AS close,
    CAST(volume AS BIGINT) AS volume
FROM raw
WHERE symbol IS NOT NULL AND datetime IS NOT NULL
  );

[0m11:35:34.761103 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m11:35:34.764102 [debug] [Thread-1 (]: On model.stock_dbt_project.stg_stock_data: ROLLBACK
[0m11:35:34.783452 [debug] [Thread-1 (]: Failed to rollback 'model.stock_dbt_project.stg_stock_data'
[0m11:35:34.785377 [debug] [Thread-1 (]: On model.stock_dbt_project.stg_stock_data: Close
[0m11:35:34.797778 [debug] [Thread-1 (]: Runtime Error in model stg_stock_data (models\staging\stg_stock_data.sql)
  HTTP Error: HTTP GET error on '/?encoding-type=url&list-type=2&prefix=stocks%2F' (HTTP 403)
[0m11:35:34.805783 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ff82505e-4429-4cf1-b3ee-d5f2ceb314f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022544323D10>]}
[0m11:35:34.808853 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model main.stg_stock_data ....................... [[31mERROR[0m in 0.39s]
[0m11:35:34.812931 [debug] [Thread-1 (]: Finished running node model.stock_dbt_project.stg_stock_data
[0m11:35:34.816398 [debug] [Thread-4 (]: Marking all children of 'model.stock_dbt_project.stg_stock_data' to be skipped because of status 'error'.  Reason: Runtime Error in model stg_stock_data (models\staging\stg_stock_data.sql)
  HTTP Error: HTTP GET error on '/?encoding-type=url&list-type=2&prefix=stocks%2F' (HTTP 403).
[0m11:35:34.822053 [debug] [MainThread]: Using duckdb connection "master"
[0m11:35:34.823105 [debug] [MainThread]: On master: BEGIN
[0m11:35:34.824119 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:35:34.830645 [debug] [MainThread]: SQL status: OK in 0.006 seconds
[0m11:35:34.833401 [debug] [MainThread]: On master: COMMIT
[0m11:35:34.835688 [debug] [MainThread]: Using duckdb connection "master"
[0m11:35:34.836274 [debug] [MainThread]: On master: COMMIT
[0m11:35:34.838297 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m11:35:34.839827 [debug] [MainThread]: On master: Close
[0m11:35:34.842376 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:35:34.847430 [debug] [MainThread]: Connection 'create_dev_main' was properly closed.
[0m11:35:34.849616 [debug] [MainThread]: Connection 'list_dev_main' was properly closed.
[0m11:35:34.850717 [debug] [MainThread]: Connection 'model.stock_dbt_project.stg_stock_data' was properly closed.
[0m11:35:34.852394 [info ] [MainThread]: 
[0m11:35:34.854714 [info ] [MainThread]: Finished running 8 project hooks, 1 view model in 0 hours 0 minutes and 1.27 seconds (1.27s).
[0m11:35:34.870505 [debug] [MainThread]: Command end result
[0m11:35:34.950116 [debug] [MainThread]: Wrote artifact WritableManifest to D:\Stock_price\stock_dbt_project\target\manifest.json
[0m11:35:34.956117 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\Stock_price\stock_dbt_project\target\semantic_manifest.json
[0m11:35:34.977868 [debug] [MainThread]: Wrote artifact RunExecutionResult to D:\Stock_price\stock_dbt_project\target\run_results.json
[0m11:35:34.980175 [info ] [MainThread]: 
[0m11:35:34.983172 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m11:35:34.985172 [info ] [MainThread]: 
[0m11:35:34.987485 [error] [MainThread]:   Runtime Error in model stg_stock_data (models\staging\stg_stock_data.sql)
  HTTP Error: HTTP GET error on '/?encoding-type=url&list-type=2&prefix=stocks%2F' (HTTP 403)
[0m11:35:34.989027 [info ] [MainThread]: 
[0m11:35:34.992012 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=1 SKIP=0 TOTAL=9
[0m11:35:34.999354 [debug] [MainThread]: Command `dbt run` failed at 11:35:34.998451 after 5.45 seconds
[0m11:35:35.002712 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022541F06FF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000225422583E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000225419DA2D0>]}
[0m11:35:35.004642 [debug] [MainThread]: Flushing usage events
[0m11:35:35.391434 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:36:54.311689 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022040D26A20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022040DE8AD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022040DE8A70>]}


============================== 11:36:54.328412 | f96860fe-f54a-4c9a-afea-51e7a008e5dd ==============================
[0m11:36:54.328412 [info ] [MainThread]: Running with dbt=1.9.4
[0m11:36:54.331070 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\loges\\.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'D:\\Stock_price\\stock_dbt_project\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select stg_stock_data', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m11:36:55.571691 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f96860fe-f54a-4c9a-afea-51e7a008e5dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000220410354C0>]}
[0m11:36:55.791497 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f96860fe-f54a-4c9a-afea-51e7a008e5dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022040FAD730>]}
[0m11:36:55.803500 [info ] [MainThread]: Registered adapter: duckdb=1.9.2
[0m11:36:56.391269 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m11:36:56.927703 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:36:56.930116 [debug] [MainThread]: Partial parsing: updated file: stock_dbt_project://models\staging\stg_stock_data.sql
[0m11:36:57.586117 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.stock_dbt_project.marts
[0m11:36:57.598838 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f96860fe-f54a-4c9a-afea-51e7a008e5dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000220427010A0>]}
[0m11:36:57.755234 [debug] [MainThread]: Wrote artifact WritableManifest to D:\Stock_price\stock_dbt_project\target\manifest.json
[0m11:36:57.759284 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\Stock_price\stock_dbt_project\target\semantic_manifest.json
[0m11:36:57.805577 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f96860fe-f54a-4c9a-afea-51e7a008e5dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000220426B2750>]}
[0m11:36:57.806577 [info ] [MainThread]: Found 4 models, 8 operations, 4 data tests, 426 macros
[0m11:36:57.807577 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f96860fe-f54a-4c9a-afea-51e7a008e5dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022042700E90>]}
[0m11:36:57.811115 [info ] [MainThread]: 
[0m11:36:57.813101 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:36:57.814102 [info ] [MainThread]: 
[0m11:36:57.815631 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m11:36:57.817633 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m11:36:58.098718 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m11:36:58.100722 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m11:36:58.101718 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:36:58.146497 [debug] [ThreadPool]: SQL status: OK in 0.044 seconds
[0m11:36:58.149279 [debug] [ThreadPool]: On list_dev: Close
[0m11:36:58.150931 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m11:36:58.152047 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m11:36:58.163501 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m11:36:58.164499 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "create_dev_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m11:36:58.165505 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:36:58.167498 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m11:36:58.169494 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m11:36:58.169494 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m11:36:58.171343 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:36:58.171343 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m11:36:58.172363 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "create_dev_main"} */

    
    
        create schema if not exists "dev"."main"
    
[0m11:36:58.173362 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:36:58.174354 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m11:36:58.175529 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m11:36:58.176355 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m11:36:58.178364 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m11:36:58.179366 [debug] [ThreadPool]: On create_dev_main: Close
[0m11:36:58.190134 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev_main'
[0m11:36:58.207257 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m11:36:58.208362 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m11:36:58.208895 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:36:58.209969 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m11:36:58.211036 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m11:36:58.212227 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m11:36:58.244326 [debug] [ThreadPool]: SQL status: OK in 0.032 seconds
[0m11:36:58.248323 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m11:36:58.250323 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m11:36:58.251326 [debug] [ThreadPool]: On list_dev_main: Close
[0m11:36:58.252322 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f96860fe-f54a-4c9a-afea-51e7a008e5dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000220425C10A0>]}
[0m11:36:58.253320 [debug] [MainThread]: Using duckdb connection "master"
[0m11:36:58.254459 [debug] [MainThread]: On master: BEGIN
[0m11:36:58.254459 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:36:58.255468 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m11:36:58.256467 [debug] [MainThread]: On master: COMMIT
[0m11:36:58.257466 [debug] [MainThread]: Using duckdb connection "master"
[0m11:36:58.257466 [debug] [MainThread]: On master: COMMIT
[0m11:36:58.258465 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m11:36:58.270402 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-0"
[0m11:36:58.280909 [info ] [MainThread]: 1 of 8 START hook: stock_dbt_project.on-run-start.0 ............................ [RUN]
[0m11:36:58.282749 [debug] [MainThread]: Using duckdb connection "master"
[0m11:36:58.283830 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
INSTALL httpfs;
[0m11:36:58.285761 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m11:36:58.287764 [info ] [MainThread]: 1 of 8 OK hook: stock_dbt_project.on-run-start.0 ............................... [[32mOK[0m in 0.03s]
[0m11:36:58.290701 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-1"
[0m11:36:58.292697 [info ] [MainThread]: 2 of 8 START hook: stock_dbt_project.on-run-start.1 ............................ [RUN]
[0m11:36:58.295810 [debug] [MainThread]: Using duckdb connection "master"
[0m11:36:58.297465 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
INSTALL json;
[0m11:36:58.300355 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m11:36:58.302567 [info ] [MainThread]: 2 of 8 OK hook: stock_dbt_project.on-run-start.1 ............................... [[32mOK[0m in 0.01s]
[0m11:36:58.307722 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-2"
[0m11:36:58.310099 [info ] [MainThread]: 3 of 8 START hook: stock_dbt_project.on-run-start.2 ............................ [RUN]
[0m11:36:58.313985 [debug] [MainThread]: Using duckdb connection "master"
[0m11:36:58.316284 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
LOAD httpfs;
[0m11:36:58.651705 [debug] [MainThread]: SQL status: OK in 0.335 seconds
[0m11:36:58.654700 [info ] [MainThread]: 3 of 8 OK hook: stock_dbt_project.on-run-start.2 ............................... [[32mOK[0m in 0.35s]
[0m11:36:58.658825 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-3"
[0m11:36:58.662835 [info ] [MainThread]: 4 of 8 START hook: stock_dbt_project.on-run-start.3 ............................ [RUN]
[0m11:36:58.665831 [debug] [MainThread]: Using duckdb connection "master"
[0m11:36:58.667827 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
LOAD json;
[0m11:36:58.669828 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m11:36:58.673368 [info ] [MainThread]: 4 of 8 OK hook: stock_dbt_project.on-run-start.3 ............................... [[32mOK[0m in 0.02s]
[0m11:36:58.680913 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-4"
[0m11:36:58.683917 [info ] [MainThread]: 5 of 8 START hook: stock_dbt_project.on-run-start.4 ............................ [RUN]
[0m11:36:58.687992 [debug] [MainThread]: Using duckdb connection "master"
[0m11:36:58.690114 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
SET s3_access_key_id='minioadmin';
[0m11:36:58.693115 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m11:36:58.700111 [info ] [MainThread]: 5 of 8 OK hook: stock_dbt_project.on-run-start.4 ............................... [[32mOK[0m in 0.02s]
[0m11:36:58.707512 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-5"
[0m11:36:58.714046 [info ] [MainThread]: 6 of 8 START hook: stock_dbt_project.on-run-start.5 ............................ [RUN]
[0m11:36:58.718355 [debug] [MainThread]: Using duckdb connection "master"
[0m11:36:58.721796 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
SET s3_secret_access_key='minioadmin';
[0m11:36:58.724659 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m11:36:58.730741 [info ] [MainThread]: 6 of 8 OK hook: stock_dbt_project.on-run-start.5 ............................... [[32mOK[0m in 0.03s]
[0m11:36:58.739501 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-6"
[0m11:36:58.742499 [info ] [MainThread]: 7 of 8 START hook: stock_dbt_project.on-run-start.6 ............................ [RUN]
[0m11:36:58.746862 [debug] [MainThread]: Using duckdb connection "master"
[0m11:36:58.749409 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
SET s3_endpoint='http://localhost:9000';
[0m11:36:58.752415 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m11:36:58.757428 [info ] [MainThread]: 7 of 8 OK hook: stock_dbt_project.on-run-start.6 ............................... [[32mOK[0m in 0.02s]
[0m11:36:58.765454 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-7"
[0m11:36:58.768971 [info ] [MainThread]: 8 of 8 START hook: stock_dbt_project.on-run-start.7 ............................ [RUN]
[0m11:36:58.771981 [debug] [MainThread]: Using duckdb connection "master"
[0m11:36:58.773976 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
SET s3_use_ssl=false;
[0m11:36:58.776973 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m11:36:58.782705 [info ] [MainThread]: 8 of 8 OK hook: stock_dbt_project.on-run-start.7 ............................... [[32mOK[0m in 0.02s]
[0m11:36:58.784704 [info ] [MainThread]: 
[0m11:36:58.785701 [debug] [MainThread]: On master: Close
[0m11:36:58.798154 [debug] [Thread-1 (]: Began running node model.stock_dbt_project.stg_stock_data
[0m11:36:58.801154 [info ] [Thread-1 (]: 1 of 1 START sql view model main.stg_stock_data ................................ [RUN]
[0m11:36:58.804167 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.stock_dbt_project.stg_stock_data'
[0m11:36:58.805187 [debug] [Thread-1 (]: Began compiling node model.stock_dbt_project.stg_stock_data
[0m11:36:58.815378 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_dbt_project.stg_stock_data"
[0m11:36:58.818600 [debug] [Thread-1 (]: Began executing node model.stock_dbt_project.stg_stock_data
[0m11:36:58.938865 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_dbt_project.stg_stock_data"
[0m11:36:58.939866 [debug] [Thread-1 (]: Using duckdb connection "model.stock_dbt_project.stg_stock_data"
[0m11:36:58.940867 [debug] [Thread-1 (]: On model.stock_dbt_project.stg_stock_data: BEGIN
[0m11:36:58.942587 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m11:36:58.945193 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m11:36:58.946191 [debug] [Thread-1 (]: Using duckdb connection "model.stock_dbt_project.stg_stock_data"
[0m11:36:58.947762 [debug] [Thread-1 (]: On model.stock_dbt_project.stg_stock_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "node_id": "model.stock_dbt_project.stg_stock_data"} */

  
  create view "dev"."main"."stg_stock_data__dbt_tmp" as (
    



WITH raw AS (
    SELECT *
    FROM read_json_auto('s3:/my-stock-data-bucket/stocks/*/*/*/*.json')
)

SELECT
    CAST(symbol AS TEXT) AS symbol,
    CAST(datetime AS TIMESTAMP) AS datetime,
    CAST(open AS DOUBLE) AS open,
    CAST(high AS DOUBLE) AS high,
    CAST(low AS DOUBLE) AS low,
    CAST(close AS DOUBLE) AS close,
    CAST(volume AS BIGINT) AS volume
FROM raw
WHERE symbol IS NOT NULL AND datetime IS NOT NULL
  );

[0m11:36:58.950772 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "node_id": "model.stock_dbt_project.stg_stock_data"} */

  
  create view "dev"."main"."stg_stock_data__dbt_tmp" as (
    



WITH raw AS (
    SELECT *
    FROM read_json_auto('s3:/my-stock-data-bucket/stocks/*/*/*/*.json')
)

SELECT
    CAST(symbol AS TEXT) AS symbol,
    CAST(datetime AS TIMESTAMP) AS datetime,
    CAST(open AS DOUBLE) AS open,
    CAST(high AS DOUBLE) AS high,
    CAST(low AS DOUBLE) AS low,
    CAST(close AS DOUBLE) AS close,
    CAST(volume AS BIGINT) AS volume
FROM raw
WHERE symbol IS NOT NULL AND datetime IS NOT NULL
  );

[0m11:36:58.952773 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m11:36:58.953772 [debug] [Thread-1 (]: On model.stock_dbt_project.stg_stock_data: ROLLBACK
[0m11:36:58.968575 [debug] [Thread-1 (]: Failed to rollback 'model.stock_dbt_project.stg_stock_data'
[0m11:36:58.969840 [debug] [Thread-1 (]: On model.stock_dbt_project.stg_stock_data: Close
[0m11:36:58.974847 [debug] [Thread-1 (]: Runtime Error in model stg_stock_data (models\staging\stg_stock_data.sql)
  IO Error: No files found that match the pattern "s3:/my-stock-data-bucket/stocks/*/*/*/*.json"
[0m11:36:58.981737 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f96860fe-f54a-4c9a-afea-51e7a008e5dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022042D2AD80>]}
[0m11:36:58.984734 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model main.stg_stock_data ....................... [[31mERROR[0m in 0.17s]
[0m11:36:58.987738 [debug] [Thread-1 (]: Finished running node model.stock_dbt_project.stg_stock_data
[0m11:36:58.989739 [debug] [Thread-4 (]: Marking all children of 'model.stock_dbt_project.stg_stock_data' to be skipped because of status 'error'.  Reason: Runtime Error in model stg_stock_data (models\staging\stg_stock_data.sql)
  IO Error: No files found that match the pattern "s3:/my-stock-data-bucket/stocks/*/*/*/*.json".
[0m11:36:58.999240 [debug] [MainThread]: Using duckdb connection "master"
[0m11:36:59.001434 [debug] [MainThread]: On master: BEGIN
[0m11:36:59.003778 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:36:59.006321 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m11:36:59.009332 [debug] [MainThread]: On master: COMMIT
[0m11:36:59.012220 [debug] [MainThread]: Using duckdb connection "master"
[0m11:36:59.014864 [debug] [MainThread]: On master: COMMIT
[0m11:36:59.017380 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m11:36:59.019400 [debug] [MainThread]: On master: Close
[0m11:36:59.020400 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:36:59.022086 [debug] [MainThread]: Connection 'create_dev_main' was properly closed.
[0m11:36:59.023099 [debug] [MainThread]: Connection 'list_dev_main' was properly closed.
[0m11:36:59.025359 [debug] [MainThread]: Connection 'model.stock_dbt_project.stg_stock_data' was properly closed.
[0m11:36:59.028285 [info ] [MainThread]: 
[0m11:36:59.032820 [info ] [MainThread]: Finished running 8 project hooks, 1 view model in 0 hours 0 minutes and 1.21 seconds (1.21s).
[0m11:36:59.042209 [debug] [MainThread]: Command end result
[0m11:36:59.166561 [debug] [MainThread]: Wrote artifact WritableManifest to D:\Stock_price\stock_dbt_project\target\manifest.json
[0m11:36:59.179551 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\Stock_price\stock_dbt_project\target\semantic_manifest.json
[0m11:36:59.221334 [debug] [MainThread]: Wrote artifact RunExecutionResult to D:\Stock_price\stock_dbt_project\target\run_results.json
[0m11:36:59.223112 [info ] [MainThread]: 
[0m11:36:59.226535 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m11:36:59.230370 [info ] [MainThread]: 
[0m11:36:59.234489 [error] [MainThread]:   Runtime Error in model stg_stock_data (models\staging\stg_stock_data.sql)
  IO Error: No files found that match the pattern "s3:/my-stock-data-bucket/stocks/*/*/*/*.json"
[0m11:36:59.237508 [info ] [MainThread]: 
[0m11:36:59.240382 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=1 SKIP=0 TOTAL=9
[0m11:36:59.246795 [debug] [MainThread]: Command `dbt run` failed at 11:36:59.244729 after 5.58 seconds
[0m11:36:59.248810 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000220403A3C80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000220403A2840>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000220403A0680>]}
[0m11:36:59.250812 [debug] [MainThread]: Flushing usage events
[0m11:36:59.714725 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:37:32.514248 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000269EFD02420>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000269ED3FCC50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000269F0379160>]}


============================== 11:37:32.521653 | 45e1d531-af92-4a37-8039-66728bc9d4f8 ==============================
[0m11:37:32.521653 [info ] [MainThread]: Running with dbt=1.9.4
[0m11:37:32.522648 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'D:\\Stock_price\\stock_dbt_project\\logs', 'profiles_dir': 'C:\\Users\\loges\\.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --select stg_stock_data', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m11:37:32.898037 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '45e1d531-af92-4a37-8039-66728bc9d4f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000269F083E2D0>]}
[0m11:37:33.064650 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '45e1d531-af92-4a37-8039-66728bc9d4f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000269F01E4F80>]}
[0m11:37:33.080413 [info ] [MainThread]: Registered adapter: duckdb=1.9.2
[0m11:37:33.878909 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m11:37:34.689404 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:37:34.694441 [debug] [MainThread]: Partial parsing: updated file: stock_dbt_project://models\staging\stg_stock_data.sql
[0m11:37:35.810399 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.stock_dbt_project.marts
[0m11:37:35.853901 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '45e1d531-af92-4a37-8039-66728bc9d4f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000269F0BB5100>]}
[0m11:37:36.619227 [debug] [MainThread]: Wrote artifact WritableManifest to D:\Stock_price\stock_dbt_project\target\manifest.json
[0m11:37:36.623097 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\Stock_price\stock_dbt_project\target\semantic_manifest.json
[0m11:37:36.702553 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '45e1d531-af92-4a37-8039-66728bc9d4f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000269F20823F0>]}
[0m11:37:36.703400 [info ] [MainThread]: Found 4 models, 8 operations, 4 data tests, 426 macros
[0m11:37:36.705396 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '45e1d531-af92-4a37-8039-66728bc9d4f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000269F1E995E0>]}
[0m11:37:36.708110 [info ] [MainThread]: 
[0m11:37:36.710124 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:37:36.712140 [info ] [MainThread]: 
[0m11:37:36.714132 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m11:37:36.717179 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m11:37:36.840133 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m11:37:36.840298 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m11:37:36.841356 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:37:36.864881 [debug] [ThreadPool]: SQL status: OK in 0.023 seconds
[0m11:37:36.866748 [debug] [ThreadPool]: On list_dev: Close
[0m11:37:36.868798 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m11:37:36.869791 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m11:37:36.882397 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m11:37:36.883402 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "create_dev_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m11:37:36.883402 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:37:36.885396 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m11:37:36.887647 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m11:37:36.888951 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m11:37:36.889601 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:37:36.890673 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m11:37:36.890673 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "create_dev_main"} */

    
    
        create schema if not exists "dev"."main"
    
[0m11:37:36.891642 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:37:36.893606 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m11:37:36.894664 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m11:37:36.896677 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m11:37:36.897675 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:37:36.898682 [debug] [ThreadPool]: On create_dev_main: Close
[0m11:37:36.906486 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev_main'
[0m11:37:36.918598 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m11:37:36.918598 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m11:37:36.919540 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:37:36.920537 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m11:37:36.921538 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m11:37:36.921538 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m11:37:36.954061 [debug] [ThreadPool]: SQL status: OK in 0.032 seconds
[0m11:37:36.956064 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m11:37:36.958055 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m11:37:36.959213 [debug] [ThreadPool]: On list_dev_main: Close
[0m11:37:36.962061 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '45e1d531-af92-4a37-8039-66728bc9d4f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000269F211D3A0>]}
[0m11:37:36.963056 [debug] [MainThread]: Using duckdb connection "master"
[0m11:37:36.964057 [debug] [MainThread]: On master: BEGIN
[0m11:37:36.965055 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:37:36.966057 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m11:37:36.967062 [debug] [MainThread]: On master: COMMIT
[0m11:37:36.968063 [debug] [MainThread]: Using duckdb connection "master"
[0m11:37:36.968063 [debug] [MainThread]: On master: COMMIT
[0m11:37:36.969054 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m11:37:36.980357 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-0"
[0m11:37:36.995845 [info ] [MainThread]: 1 of 8 START hook: stock_dbt_project.on-run-start.0 ............................ [RUN]
[0m11:37:36.999392 [debug] [MainThread]: Using duckdb connection "master"
[0m11:37:37.000924 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
INSTALL httpfs;
[0m11:37:37.003919 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m11:37:37.007762 [info ] [MainThread]: 1 of 8 OK hook: stock_dbt_project.on-run-start.0 ............................... [[32mOK[0m in 0.04s]
[0m11:37:37.018694 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-1"
[0m11:37:37.022930 [info ] [MainThread]: 2 of 8 START hook: stock_dbt_project.on-run-start.1 ............................ [RUN]
[0m11:37:37.025640 [debug] [MainThread]: Using duckdb connection "master"
[0m11:37:37.028946 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
INSTALL json;
[0m11:37:37.033941 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m11:37:37.036941 [info ] [MainThread]: 2 of 8 OK hook: stock_dbt_project.on-run-start.1 ............................... [[32mOK[0m in 0.03s]
[0m11:37:37.048252 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-2"
[0m11:37:37.052315 [info ] [MainThread]: 3 of 8 START hook: stock_dbt_project.on-run-start.2 ............................ [RUN]
[0m11:37:37.056174 [debug] [MainThread]: Using duckdb connection "master"
[0m11:37:37.057194 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
LOAD httpfs;
[0m11:37:37.433127 [debug] [MainThread]: SQL status: OK in 0.374 seconds
[0m11:37:37.436568 [info ] [MainThread]: 3 of 8 OK hook: stock_dbt_project.on-run-start.2 ............................... [[32mOK[0m in 0.40s]
[0m11:37:37.440932 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-3"
[0m11:37:37.444803 [info ] [MainThread]: 4 of 8 START hook: stock_dbt_project.on-run-start.3 ............................ [RUN]
[0m11:37:37.447944 [debug] [MainThread]: Using duckdb connection "master"
[0m11:37:37.450227 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
LOAD json;
[0m11:37:37.452481 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m11:37:37.454480 [info ] [MainThread]: 4 of 8 OK hook: stock_dbt_project.on-run-start.3 ............................... [[32mOK[0m in 0.02s]
[0m11:37:37.460858 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-4"
[0m11:37:37.465860 [info ] [MainThread]: 5 of 8 START hook: stock_dbt_project.on-run-start.4 ............................ [RUN]
[0m11:37:37.467866 [debug] [MainThread]: Using duckdb connection "master"
[0m11:37:37.468859 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
SET s3_access_key_id='minioadmin';
[0m11:37:37.471168 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m11:37:37.474865 [info ] [MainThread]: 5 of 8 OK hook: stock_dbt_project.on-run-start.4 ............................... [[32mOK[0m in 0.02s]
[0m11:37:37.488794 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-5"
[0m11:37:37.496573 [info ] [MainThread]: 6 of 8 START hook: stock_dbt_project.on-run-start.5 ............................ [RUN]
[0m11:37:37.502289 [debug] [MainThread]: Using duckdb connection "master"
[0m11:37:37.504857 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
SET s3_secret_access_key='minioadmin';
[0m11:37:37.507659 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m11:37:37.511078 [info ] [MainThread]: 6 of 8 OK hook: stock_dbt_project.on-run-start.5 ............................... [[32mOK[0m in 0.03s]
[0m11:37:37.519009 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-6"
[0m11:37:37.523590 [info ] [MainThread]: 7 of 8 START hook: stock_dbt_project.on-run-start.6 ............................ [RUN]
[0m11:37:37.527177 [debug] [MainThread]: Using duckdb connection "master"
[0m11:37:37.531418 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
SET s3_endpoint='http://localhost:9000';
[0m11:37:37.536763 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m11:37:37.540916 [info ] [MainThread]: 7 of 8 OK hook: stock_dbt_project.on-run-start.6 ............................... [[32mOK[0m in 0.03s]
[0m11:37:37.551270 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-7"
[0m11:37:37.555978 [info ] [MainThread]: 8 of 8 START hook: stock_dbt_project.on-run-start.7 ............................ [RUN]
[0m11:37:37.558995 [debug] [MainThread]: Using duckdb connection "master"
[0m11:37:37.561269 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
SET s3_use_ssl=false;
[0m11:37:37.565355 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m11:37:37.569978 [info ] [MainThread]: 8 of 8 OK hook: stock_dbt_project.on-run-start.7 ............................... [[32mOK[0m in 0.03s]
[0m11:37:37.572139 [info ] [MainThread]: 
[0m11:37:37.574671 [debug] [MainThread]: On master: Close
[0m11:37:37.592236 [debug] [Thread-1 (]: Began running node model.stock_dbt_project.stg_stock_data
[0m11:37:37.595900 [info ] [Thread-1 (]: 1 of 1 START sql view model main.stg_stock_data ................................ [RUN]
[0m11:37:37.600983 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.stock_dbt_project.stg_stock_data'
[0m11:37:37.602514 [debug] [Thread-1 (]: Began compiling node model.stock_dbt_project.stg_stock_data
[0m11:37:37.610648 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_dbt_project.stg_stock_data"
[0m11:37:37.614663 [debug] [Thread-1 (]: Began executing node model.stock_dbt_project.stg_stock_data
[0m11:37:37.816055 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_dbt_project.stg_stock_data"
[0m11:37:37.817648 [debug] [Thread-1 (]: Using duckdb connection "model.stock_dbt_project.stg_stock_data"
[0m11:37:37.818703 [debug] [Thread-1 (]: On model.stock_dbt_project.stg_stock_data: BEGIN
[0m11:37:37.819703 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m11:37:37.820690 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:37:37.821699 [debug] [Thread-1 (]: Using duckdb connection "model.stock_dbt_project.stg_stock_data"
[0m11:37:37.822690 [debug] [Thread-1 (]: On model.stock_dbt_project.stg_stock_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "node_id": "model.stock_dbt_project.stg_stock_data"} */

  
  create view "dev"."main"."stg_stock_data__dbt_tmp" as (
    



WITH raw AS (
    SELECT *
    FROM read_json_auto('s3://my-stock-data-bucket/stocks/*/*/*/*.json')
)

SELECT
    CAST(symbol AS TEXT) AS symbol,
    CAST(datetime AS TIMESTAMP) AS datetime,
    CAST(open AS DOUBLE) AS open,
    CAST(high AS DOUBLE) AS high,
    CAST(low AS DOUBLE) AS low,
    CAST(close AS DOUBLE) AS close,
    CAST(volume AS BIGINT) AS volume
FROM raw
WHERE symbol IS NOT NULL AND datetime IS NOT NULL
  );

[0m11:37:38.235215 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "node_id": "model.stock_dbt_project.stg_stock_data"} */

  
  create view "dev"."main"."stg_stock_data__dbt_tmp" as (
    



WITH raw AS (
    SELECT *
    FROM read_json_auto('s3://my-stock-data-bucket/stocks/*/*/*/*.json')
)

SELECT
    CAST(symbol AS TEXT) AS symbol,
    CAST(datetime AS TIMESTAMP) AS datetime,
    CAST(open AS DOUBLE) AS open,
    CAST(high AS DOUBLE) AS high,
    CAST(low AS DOUBLE) AS low,
    CAST(close AS DOUBLE) AS close,
    CAST(volume AS BIGINT) AS volume
FROM raw
WHERE symbol IS NOT NULL AND datetime IS NOT NULL
  );

[0m11:37:38.237007 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m11:37:38.237007 [debug] [Thread-1 (]: On model.stock_dbt_project.stg_stock_data: ROLLBACK
[0m11:37:38.245497 [debug] [Thread-1 (]: Failed to rollback 'model.stock_dbt_project.stg_stock_data'
[0m11:37:38.245497 [debug] [Thread-1 (]: On model.stock_dbt_project.stg_stock_data: Close
[0m11:37:38.249497 [debug] [Thread-1 (]: Runtime Error in model stg_stock_data (models\staging\stg_stock_data.sql)
  HTTP Error: HTTP GET error on '/?encoding-type=url&list-type=2&prefix=stocks%2F' (HTTP 403)
[0m11:37:38.252499 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '45e1d531-af92-4a37-8039-66728bc9d4f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000269F2706C00>]}
[0m11:37:38.253514 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model main.stg_stock_data ....................... [[31mERROR[0m in 0.65s]
[0m11:37:38.255672 [debug] [Thread-1 (]: Finished running node model.stock_dbt_project.stg_stock_data
[0m11:37:38.256729 [debug] [Thread-4 (]: Marking all children of 'model.stock_dbt_project.stg_stock_data' to be skipped because of status 'error'.  Reason: Runtime Error in model stg_stock_data (models\staging\stg_stock_data.sql)
  HTTP Error: HTTP GET error on '/?encoding-type=url&list-type=2&prefix=stocks%2F' (HTTP 403).
[0m11:37:38.259678 [debug] [MainThread]: Using duckdb connection "master"
[0m11:37:38.259678 [debug] [MainThread]: On master: BEGIN
[0m11:37:38.260676 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:37:38.262683 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m11:37:38.263683 [debug] [MainThread]: On master: COMMIT
[0m11:37:38.263683 [debug] [MainThread]: Using duckdb connection "master"
[0m11:37:38.264679 [debug] [MainThread]: On master: COMMIT
[0m11:37:38.265683 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m11:37:38.266683 [debug] [MainThread]: On master: Close
[0m11:37:38.267674 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:37:38.268289 [debug] [MainThread]: Connection 'create_dev_main' was properly closed.
[0m11:37:38.268515 [debug] [MainThread]: Connection 'list_dev_main' was properly closed.
[0m11:37:38.269528 [debug] [MainThread]: Connection 'model.stock_dbt_project.stg_stock_data' was properly closed.
[0m11:37:38.270525 [info ] [MainThread]: 
[0m11:37:38.271525 [info ] [MainThread]: Finished running 8 project hooks, 1 view model in 0 hours 0 minutes and 1.56 seconds (1.56s).
[0m11:37:38.274526 [debug] [MainThread]: Command end result
[0m11:37:38.326235 [debug] [MainThread]: Wrote artifact WritableManifest to D:\Stock_price\stock_dbt_project\target\manifest.json
[0m11:37:38.332249 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\Stock_price\stock_dbt_project\target\semantic_manifest.json
[0m11:37:38.341245 [debug] [MainThread]: Wrote artifact RunExecutionResult to D:\Stock_price\stock_dbt_project\target\run_results.json
[0m11:37:38.342833 [info ] [MainThread]: 
[0m11:37:38.343760 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m11:37:38.345763 [info ] [MainThread]: 
[0m11:37:38.347764 [error] [MainThread]:   Runtime Error in model stg_stock_data (models\staging\stg_stock_data.sql)
  HTTP Error: HTTP GET error on '/?encoding-type=url&list-type=2&prefix=stocks%2F' (HTTP 403)
[0m11:37:38.349313 [info ] [MainThread]: 
[0m11:37:38.350311 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=1 SKIP=0 TOTAL=9
[0m11:37:38.352308 [debug] [MainThread]: Command `dbt run` failed at 11:37:38.352308 after 6.09 seconds
[0m11:37:38.353304 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000269ED7D9C40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000269EF4B54C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000269F020CCE0>]}
[0m11:37:38.354305 [debug] [MainThread]: Flushing usage events
[0m11:37:38.908787 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:40:29.868420 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E1B59712E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E1B8BD3F80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E1B822EDB0>]}


============================== 11:40:29.874180 | 3b9159d7-eff8-4b49-baa8-1a3026de9ab1 ==============================
[0m11:40:29.874180 [info ] [MainThread]: Running with dbt=1.9.4
[0m11:40:29.875180 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\loges\\.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': 'D:\\Stock_price\\stock_dbt_project\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run --select stg_stock_data', 'send_anonymous_usage_stats': 'True'}
[0m11:40:30.371717 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3b9159d7-eff8-4b49-baa8-1a3026de9ab1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E1B8D900B0>]}
[0m11:40:30.474597 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3b9159d7-eff8-4b49-baa8-1a3026de9ab1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E1B81FBE90>]}
[0m11:40:30.482444 [info ] [MainThread]: Registered adapter: duckdb=1.9.2
[0m11:40:30.809353 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m11:40:31.060558 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m11:40:31.062953 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '3b9159d7-eff8-4b49-baa8-1a3026de9ab1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E1BA23EF60>]}
[0m11:40:35.693346 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.stock_dbt_project.marts
[0m11:40:35.721509 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3b9159d7-eff8-4b49-baa8-1a3026de9ab1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E1B7D75BB0>]}
[0m11:40:36.161796 [debug] [MainThread]: Wrote artifact WritableManifest to D:\Stock_price\stock_dbt_project\target\manifest.json
[0m11:40:36.173232 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\Stock_price\stock_dbt_project\target\semantic_manifest.json
[0m11:40:36.305701 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3b9159d7-eff8-4b49-baa8-1a3026de9ab1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E1B8D45EE0>]}
[0m11:40:36.308949 [info ] [MainThread]: Found 4 models, 9 operations, 4 data tests, 426 macros
[0m11:40:36.311655 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3b9159d7-eff8-4b49-baa8-1a3026de9ab1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E1B8D6A3C0>]}
[0m11:40:36.318996 [info ] [MainThread]: 
[0m11:40:36.321161 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:40:36.323223 [info ] [MainThread]: 
[0m11:40:36.325727 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m11:40:36.331781 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m11:40:36.696639 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m11:40:36.701056 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m11:40:36.703054 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:40:36.752730 [debug] [ThreadPool]: SQL status: OK in 0.050 seconds
[0m11:40:36.758498 [debug] [ThreadPool]: On list_dev: Close
[0m11:40:36.761502 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m11:40:36.766597 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m11:40:36.807101 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m11:40:36.811588 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "create_dev_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m11:40:36.817027 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:40:36.822501 [debug] [ThreadPool]: SQL status: OK in 0.006 seconds
[0m11:40:36.831492 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m11:40:36.833647 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m11:40:36.835093 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:40:36.835615 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m11:40:36.836771 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "create_dev_main"} */

    
    
        create schema if not exists "dev"."main"
    
[0m11:40:36.837821 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:40:36.840182 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m11:40:36.841654 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m11:40:36.842845 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m11:40:36.843905 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:40:36.845597 [debug] [ThreadPool]: On create_dev_main: Close
[0m11:40:36.857663 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev_main'
[0m11:40:36.868333 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m11:40:36.869947 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m11:40:36.870478 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:40:36.872092 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m11:40:36.872623 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m11:40:36.873230 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m11:40:36.917388 [debug] [ThreadPool]: SQL status: OK in 0.043 seconds
[0m11:40:36.920418 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m11:40:36.924904 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m11:40:36.925909 [debug] [ThreadPool]: On list_dev_main: Close
[0m11:40:36.928910 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3b9159d7-eff8-4b49-baa8-1a3026de9ab1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E1BA4BFD10>]}
[0m11:40:36.930908 [debug] [MainThread]: Using duckdb connection "master"
[0m11:40:36.932918 [debug] [MainThread]: On master: BEGIN
[0m11:40:36.933911 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:40:36.935905 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m11:40:36.937471 [debug] [MainThread]: On master: COMMIT
[0m11:40:36.938411 [debug] [MainThread]: Using duckdb connection "master"
[0m11:40:36.940427 [debug] [MainThread]: On master: COMMIT
[0m11:40:36.941423 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m11:40:36.959100 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-0"
[0m11:40:36.977439 [info ] [MainThread]: 1 of 9 START hook: stock_dbt_project.on-run-start.0 ............................ [RUN]
[0m11:40:36.984042 [debug] [MainThread]: Using duckdb connection "master"
[0m11:40:36.987062 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
INSTALL httpfs;
[0m11:40:36.991208 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m11:40:36.997204 [info ] [MainThread]: 1 of 9 OK hook: stock_dbt_project.on-run-start.0 ............................... [[32mOK[0m in 0.05s]
[0m11:40:37.008826 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-1"
[0m11:40:37.019111 [info ] [MainThread]: 2 of 9 START hook: stock_dbt_project.on-run-start.1 ............................ [RUN]
[0m11:40:37.022716 [debug] [MainThread]: Using duckdb connection "master"
[0m11:40:37.024409 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
INSTALL json;
[0m11:40:37.030909 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m11:40:37.036215 [info ] [MainThread]: 2 of 9 OK hook: stock_dbt_project.on-run-start.1 ............................... [[32mOK[0m in 0.03s]
[0m11:40:37.043101 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-2"
[0m11:40:37.049485 [info ] [MainThread]: 3 of 9 START hook: stock_dbt_project.on-run-start.2 ............................ [RUN]
[0m11:40:37.052810 [debug] [MainThread]: Using duckdb connection "master"
[0m11:40:37.055375 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
LOAD httpfs;
[0m11:40:37.465823 [debug] [MainThread]: SQL status: OK in 0.408 seconds
[0m11:40:37.467825 [info ] [MainThread]: 3 of 9 OK hook: stock_dbt_project.on-run-start.2 ............................... [[32mOK[0m in 0.43s]
[0m11:40:37.471645 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-3"
[0m11:40:37.472541 [info ] [MainThread]: 4 of 9 START hook: stock_dbt_project.on-run-start.3 ............................ [RUN]
[0m11:40:37.474565 [debug] [MainThread]: Using duckdb connection "master"
[0m11:40:37.475549 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
LOAD json;
[0m11:40:37.476551 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m11:40:37.481547 [info ] [MainThread]: 4 of 9 OK hook: stock_dbt_project.on-run-start.3 ............................... [[32mOK[0m in 0.01s]
[0m11:40:37.487715 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-4"
[0m11:40:37.489704 [info ] [MainThread]: 5 of 9 START hook: stock_dbt_project.on-run-start.4 ............................ [RUN]
[0m11:40:37.490710 [debug] [MainThread]: Using duckdb connection "master"
[0m11:40:37.491708 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
SET s3_access_key_id='minioadmin';
[0m11:40:37.493719 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m11:40:37.496725 [info ] [MainThread]: 5 of 9 OK hook: stock_dbt_project.on-run-start.4 ............................... [[32mOK[0m in 0.01s]
[0m11:40:37.503309 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-5"
[0m11:40:37.504700 [info ] [MainThread]: 6 of 9 START hook: stock_dbt_project.on-run-start.5 ............................ [RUN]
[0m11:40:37.505716 [debug] [MainThread]: Using duckdb connection "master"
[0m11:40:37.508238 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
SET s3_secret_access_key='minioadmin';
[0m11:40:37.509235 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m11:40:37.511240 [info ] [MainThread]: 6 of 9 OK hook: stock_dbt_project.on-run-start.5 ............................... [[32mOK[0m in 0.01s]
[0m11:40:37.516684 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-6"
[0m11:40:37.519305 [info ] [MainThread]: 7 of 9 START hook: stock_dbt_project.on-run-start.6 ............................ [RUN]
[0m11:40:37.521323 [debug] [MainThread]: Using duckdb connection "master"
[0m11:40:37.522322 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
SET s3_endpoint='http://localhost:9000';
[0m11:40:37.524322 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m11:40:37.525320 [info ] [MainThread]: 7 of 9 OK hook: stock_dbt_project.on-run-start.6 ............................... [[32mOK[0m in 0.01s]
[0m11:40:37.531904 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-7"
[0m11:40:37.534057 [info ] [MainThread]: 8 of 9 START hook: stock_dbt_project.on-run-start.7 ............................ [RUN]
[0m11:40:37.536058 [debug] [MainThread]: Using duckdb connection "master"
[0m11:40:37.537066 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
SET s3_use_ssl=false;
[0m11:40:37.539056 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m11:40:37.540055 [info ] [MainThread]: 8 of 9 OK hook: stock_dbt_project.on-run-start.7 ............................... [[32mOK[0m in 0.01s]
[0m11:40:37.544055 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-8"
[0m11:40:37.546739 [info ] [MainThread]: 9 of 9 START hook: stock_dbt_project.on-run-start.8 ............................ [RUN]
[0m11:40:37.549271 [debug] [MainThread]: Using duckdb connection "master"
[0m11:40:37.551276 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
SET s3_url_style='path';
[0m11:40:37.553264 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m11:40:37.554275 [info ] [MainThread]: 9 of 9 OK hook: stock_dbt_project.on-run-start.8 ............................... [[32mOK[0m in 0.01s]
[0m11:40:37.555267 [info ] [MainThread]: 
[0m11:40:37.556268 [debug] [MainThread]: On master: Close
[0m11:40:37.563897 [debug] [Thread-1 (]: Began running node model.stock_dbt_project.stg_stock_data
[0m11:40:37.565899 [info ] [Thread-1 (]: 1 of 1 START sql view model main.stg_stock_data ................................ [RUN]
[0m11:40:37.567897 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.stock_dbt_project.stg_stock_data'
[0m11:40:37.568891 [debug] [Thread-1 (]: Began compiling node model.stock_dbt_project.stg_stock_data
[0m11:40:37.577848 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_dbt_project.stg_stock_data"
[0m11:40:37.586241 [debug] [Thread-1 (]: Began executing node model.stock_dbt_project.stg_stock_data
[0m11:40:37.710177 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_dbt_project.stg_stock_data"
[0m11:40:37.713471 [debug] [Thread-1 (]: Using duckdb connection "model.stock_dbt_project.stg_stock_data"
[0m11:40:37.715823 [debug] [Thread-1 (]: On model.stock_dbt_project.stg_stock_data: BEGIN
[0m11:40:37.717676 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m11:40:37.719296 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m11:40:37.720398 [debug] [Thread-1 (]: Using duckdb connection "model.stock_dbt_project.stg_stock_data"
[0m11:40:37.721421 [debug] [Thread-1 (]: On model.stock_dbt_project.stg_stock_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "node_id": "model.stock_dbt_project.stg_stock_data"} */

  
  create view "dev"."main"."stg_stock_data__dbt_tmp" as (
    



WITH raw AS (
    SELECT *
    FROM read_json_auto('s3://my-stock-data-bucket/stocks/*/*/*/*/*.json')
)

SELECT
    CAST(symbol AS TEXT) AS symbol,
    CAST(datetime AS TIMESTAMP) AS datetime,
    CAST(open AS DOUBLE) AS open,
    CAST(high AS DOUBLE) AS high,
    CAST(low AS DOUBLE) AS low,
    CAST(close AS DOUBLE) AS close,
    CAST(volume AS BIGINT) AS volume
FROM raw
WHERE symbol IS NOT NULL AND datetime IS NOT NULL
  );

[0m11:40:37.926262 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "node_id": "model.stock_dbt_project.stg_stock_data"} */

  
  create view "dev"."main"."stg_stock_data__dbt_tmp" as (
    



WITH raw AS (
    SELECT *
    FROM read_json_auto('s3://my-stock-data-bucket/stocks/*/*/*/*/*.json')
)

SELECT
    CAST(symbol AS TEXT) AS symbol,
    CAST(datetime AS TIMESTAMP) AS datetime,
    CAST(open AS DOUBLE) AS open,
    CAST(high AS DOUBLE) AS high,
    CAST(low AS DOUBLE) AS low,
    CAST(close AS DOUBLE) AS close,
    CAST(volume AS BIGINT) AS volume
FROM raw
WHERE symbol IS NOT NULL AND datetime IS NOT NULL
  );

[0m11:40:37.928257 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m11:40:37.930417 [debug] [Thread-1 (]: On model.stock_dbt_project.stg_stock_data: ROLLBACK
[0m11:40:37.940023 [debug] [Thread-1 (]: Failed to rollback 'model.stock_dbt_project.stg_stock_data'
[0m11:40:37.941023 [debug] [Thread-1 (]: On model.stock_dbt_project.stg_stock_data: Close
[0m11:40:37.945228 [debug] [Thread-1 (]: Runtime Error in model stg_stock_data (models\staging\stg_stock_data.sql)
  HTTP Error: HTTP GET error on '/?encoding-type=url&list-type=2&prefix=stocks%2F' (HTTP 403)
[0m11:40:37.948232 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3b9159d7-eff8-4b49-baa8-1a3026de9ab1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E1B81FA210>]}
[0m11:40:37.949221 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model main.stg_stock_data ....................... [[31mERROR[0m in 0.38s]
[0m11:40:37.950222 [debug] [Thread-1 (]: Finished running node model.stock_dbt_project.stg_stock_data
[0m11:40:37.951222 [debug] [Thread-4 (]: Marking all children of 'model.stock_dbt_project.stg_stock_data' to be skipped because of status 'error'.  Reason: Runtime Error in model stg_stock_data (models\staging\stg_stock_data.sql)
  HTTP Error: HTTP GET error on '/?encoding-type=url&list-type=2&prefix=stocks%2F' (HTTP 403).
[0m11:40:37.953231 [debug] [MainThread]: Using duckdb connection "master"
[0m11:40:37.954238 [debug] [MainThread]: On master: BEGIN
[0m11:40:37.955231 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:40:37.956230 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m11:40:37.957246 [debug] [MainThread]: On master: COMMIT
[0m11:40:37.957883 [debug] [MainThread]: Using duckdb connection "master"
[0m11:40:37.959893 [debug] [MainThread]: On master: COMMIT
[0m11:40:37.960892 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m11:40:37.964371 [debug] [MainThread]: On master: Close
[0m11:40:37.966392 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:40:37.966913 [debug] [MainThread]: Connection 'create_dev_main' was properly closed.
[0m11:40:37.967922 [debug] [MainThread]: Connection 'list_dev_main' was properly closed.
[0m11:40:37.968931 [debug] [MainThread]: Connection 'model.stock_dbt_project.stg_stock_data' was properly closed.
[0m11:40:37.969921 [info ] [MainThread]: 
[0m11:40:37.970923 [info ] [MainThread]: Finished running 9 project hooks, 1 view model in 0 hours 0 minutes and 1.64 seconds (1.64s).
[0m11:40:37.974237 [debug] [MainThread]: Command end result
[0m11:40:38.015279 [debug] [MainThread]: Wrote artifact WritableManifest to D:\Stock_price\stock_dbt_project\target\manifest.json
[0m11:40:38.018284 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\Stock_price\stock_dbt_project\target\semantic_manifest.json
[0m11:40:38.027679 [debug] [MainThread]: Wrote artifact RunExecutionResult to D:\Stock_price\stock_dbt_project\target\run_results.json
[0m11:40:38.028693 [info ] [MainThread]: 
[0m11:40:38.030699 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m11:40:38.031691 [info ] [MainThread]: 
[0m11:40:38.033691 [error] [MainThread]:   Runtime Error in model stg_stock_data (models\staging\stg_stock_data.sql)
  HTTP Error: HTTP GET error on '/?encoding-type=url&list-type=2&prefix=stocks%2F' (HTTP 403)
[0m11:40:38.034701 [info ] [MainThread]: 
[0m11:40:38.035696 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=1 SKIP=0 TOTAL=10
[0m11:40:38.037713 [debug] [MainThread]: Command `dbt run` failed at 11:40:38.037713 after 8.55 seconds
[0m11:40:38.038715 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E1B59712E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E1B8450500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E1BA297680>]}
[0m11:40:38.039708 [debug] [MainThread]: Flushing usage events
[0m11:40:38.485259 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:41:54.992048 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001827AC6B5C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001827D463200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001827D463DD0>]}


============================== 11:41:55.012862 | 7db340bd-13e7-4af0-8832-5c746d3673a3 ==============================
[0m11:41:55.012862 [info ] [MainThread]: Running with dbt=1.9.4
[0m11:41:55.017418 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\loges\\.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'D:\\Stock_price\\stock_dbt_project\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run --select stg_stock_data', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:41:56.087294 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7db340bd-13e7-4af0-8832-5c746d3673a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001827E000230>]}
[0m11:41:56.734227 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7db340bd-13e7-4af0-8832-5c746d3673a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001827E062030>]}
[0m11:41:56.784369 [info ] [MainThread]: Registered adapter: duckdb=1.9.2
[0m11:41:57.732807 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m11:41:58.023154 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:41:58.024147 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:41:58.035221 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.stock_dbt_project.marts
[0m11:41:58.121776 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7db340bd-13e7-4af0-8832-5c746d3673a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001827D4CE5D0>]}
[0m11:41:58.255500 [debug] [MainThread]: Wrote artifact WritableManifest to D:\Stock_price\stock_dbt_project\target\manifest.json
[0m11:41:58.259549 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\Stock_price\stock_dbt_project\target\semantic_manifest.json
[0m11:41:58.307149 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7db340bd-13e7-4af0-8832-5c746d3673a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001827F4D77A0>]}
[0m11:41:58.307766 [info ] [MainThread]: Found 4 models, 9 operations, 4 data tests, 426 macros
[0m11:41:58.308699 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7db340bd-13e7-4af0-8832-5c746d3673a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001827F64B380>]}
[0m11:41:58.314647 [info ] [MainThread]: 
[0m11:41:58.316336 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:41:58.317987 [info ] [MainThread]: 
[0m11:41:58.319060 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m11:41:58.321242 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m11:41:58.449906 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m11:41:58.450914 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m11:41:58.451907 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:41:58.475309 [debug] [ThreadPool]: SQL status: OK in 0.023 seconds
[0m11:41:58.478166 [debug] [ThreadPool]: On list_dev: Close
[0m11:41:58.480964 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m11:41:58.482694 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m11:41:58.496348 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m11:41:58.497338 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "create_dev_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m11:41:58.498281 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:41:58.500288 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m11:41:58.503283 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m11:41:58.503283 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m11:41:58.504286 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:41:58.505278 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m11:41:58.506283 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "create_dev_main"} */

    
    
        create schema if not exists "dev"."main"
    
[0m11:41:58.507283 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:41:58.509372 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m11:41:58.509372 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m11:41:58.510371 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m11:41:58.511378 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:41:58.511378 [debug] [ThreadPool]: On create_dev_main: Close
[0m11:41:58.521177 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev_main'
[0m11:41:58.530183 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m11:41:58.531178 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m11:41:58.532176 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:41:58.533191 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m11:41:58.534190 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m11:41:58.535189 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m11:41:58.586747 [debug] [ThreadPool]: SQL status: OK in 0.051 seconds
[0m11:41:58.593261 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m11:41:58.611030 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m11:41:58.615586 [debug] [ThreadPool]: On list_dev_main: Close
[0m11:41:58.620916 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7db340bd-13e7-4af0-8832-5c746d3673a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001827F65B5C0>]}
[0m11:41:58.623160 [debug] [MainThread]: Using duckdb connection "master"
[0m11:41:58.624887 [debug] [MainThread]: On master: BEGIN
[0m11:41:58.625911 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:41:58.627904 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m11:41:58.629903 [debug] [MainThread]: On master: COMMIT
[0m11:41:58.631903 [debug] [MainThread]: Using duckdb connection "master"
[0m11:41:58.634268 [debug] [MainThread]: On master: COMMIT
[0m11:41:58.635905 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m11:41:58.655897 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-0"
[0m11:41:58.676897 [info ] [MainThread]: 1 of 9 START hook: stock_dbt_project.on-run-start.0 ............................ [RUN]
[0m11:41:58.682572 [debug] [MainThread]: Using duckdb connection "master"
[0m11:41:58.684893 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
INSTALL httpfs;
[0m11:41:58.689082 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m11:41:58.696622 [info ] [MainThread]: 1 of 9 OK hook: stock_dbt_project.on-run-start.0 ............................... [[32mOK[0m in 0.06s]
[0m11:41:58.703059 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-1"
[0m11:41:58.707804 [info ] [MainThread]: 2 of 9 START hook: stock_dbt_project.on-run-start.1 ............................ [RUN]
[0m11:41:58.709833 [debug] [MainThread]: Using duckdb connection "master"
[0m11:41:58.711426 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
INSTALL json;
[0m11:41:58.716971 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m11:41:58.719968 [info ] [MainThread]: 2 of 9 OK hook: stock_dbt_project.on-run-start.1 ............................... [[32mOK[0m in 0.02s]
[0m11:41:58.725302 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-2"
[0m11:41:58.729312 [info ] [MainThread]: 3 of 9 START hook: stock_dbt_project.on-run-start.2 ............................ [RUN]
[0m11:41:58.732705 [debug] [MainThread]: Using duckdb connection "master"
[0m11:41:58.734692 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
LOAD httpfs;
[0m11:41:59.227872 [debug] [MainThread]: SQL status: OK in 0.490 seconds
[0m11:41:59.236894 [info ] [MainThread]: 3 of 9 OK hook: stock_dbt_project.on-run-start.2 ............................... [[32mOK[0m in 0.51s]
[0m11:41:59.248242 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-3"
[0m11:41:59.254665 [info ] [MainThread]: 4 of 9 START hook: stock_dbt_project.on-run-start.3 ............................ [RUN]
[0m11:41:59.260797 [debug] [MainThread]: Using duckdb connection "master"
[0m11:41:59.264221 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
LOAD json;
[0m11:41:59.269249 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m11:41:59.274492 [info ] [MainThread]: 4 of 9 OK hook: stock_dbt_project.on-run-start.3 ............................... [[32mOK[0m in 0.03s]
[0m11:41:59.286465 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-4"
[0m11:41:59.291454 [info ] [MainThread]: 5 of 9 START hook: stock_dbt_project.on-run-start.4 ............................ [RUN]
[0m11:41:59.297658 [debug] [MainThread]: Using duckdb connection "master"
[0m11:41:59.302918 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
SET s3_access_key_id='minioadmin';
[0m11:41:59.307655 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m11:41:59.316788 [info ] [MainThread]: 5 of 9 OK hook: stock_dbt_project.on-run-start.4 ............................... [[32mOK[0m in 0.04s]
[0m11:41:59.326291 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-5"
[0m11:41:59.333843 [info ] [MainThread]: 6 of 9 START hook: stock_dbt_project.on-run-start.5 ............................ [RUN]
[0m11:41:59.339388 [debug] [MainThread]: Using duckdb connection "master"
[0m11:41:59.341387 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
SET s3_secret_access_key='minioadmin';
[0m11:41:59.344900 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m11:41:59.352593 [info ] [MainThread]: 6 of 9 OK hook: stock_dbt_project.on-run-start.5 ............................... [[32mOK[0m in 0.03s]
[0m11:41:59.368642 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-6"
[0m11:41:59.377358 [info ] [MainThread]: 7 of 9 START hook: stock_dbt_project.on-run-start.6 ............................ [RUN]
[0m11:41:59.389258 [debug] [MainThread]: Using duckdb connection "master"
[0m11:41:59.396667 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
SET s3_endpoint='http://localhost:9000';
[0m11:41:59.404524 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m11:41:59.410101 [info ] [MainThread]: 7 of 9 OK hook: stock_dbt_project.on-run-start.6 ............................... [[32mOK[0m in 0.05s]
[0m11:41:59.421469 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-7"
[0m11:41:59.426574 [info ] [MainThread]: 8 of 9 START hook: stock_dbt_project.on-run-start.7 ............................ [RUN]
[0m11:41:59.431820 [debug] [MainThread]: Using duckdb connection "master"
[0m11:41:59.435877 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
SET s3_use_ssl=false;
[0m11:41:59.439890 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m11:41:59.450242 [info ] [MainThread]: 8 of 9 OK hook: stock_dbt_project.on-run-start.7 ............................... [[32mOK[0m in 0.03s]
[0m11:41:59.467460 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-8"
[0m11:41:59.474479 [info ] [MainThread]: 9 of 9 START hook: stock_dbt_project.on-run-start.8 ............................ [RUN]
[0m11:41:59.482832 [debug] [MainThread]: Using duckdb connection "master"
[0m11:41:59.488362 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
SET s3_url_style='path';
[0m11:41:59.492474 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m11:41:59.501336 [info ] [MainThread]: 9 of 9 OK hook: stock_dbt_project.on-run-start.8 ............................... [[32mOK[0m in 0.04s]
[0m11:41:59.504281 [info ] [MainThread]: 
[0m11:41:59.507594 [debug] [MainThread]: On master: Close
[0m11:41:59.526557 [debug] [Thread-1 (]: Began running node model.stock_dbt_project.stg_stock_data
[0m11:41:59.531038 [info ] [Thread-1 (]: 1 of 1 START sql view model main.stg_stock_data ................................ [RUN]
[0m11:41:59.537540 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.stock_dbt_project.stg_stock_data'
[0m11:41:59.540555 [debug] [Thread-1 (]: Began compiling node model.stock_dbt_project.stg_stock_data
[0m11:41:59.556720 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_dbt_project.stg_stock_data"
[0m11:41:59.561018 [debug] [Thread-1 (]: Began executing node model.stock_dbt_project.stg_stock_data
[0m11:41:59.721761 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_dbt_project.stg_stock_data"
[0m11:41:59.723765 [debug] [Thread-1 (]: Using duckdb connection "model.stock_dbt_project.stg_stock_data"
[0m11:41:59.724746 [debug] [Thread-1 (]: On model.stock_dbt_project.stg_stock_data: BEGIN
[0m11:41:59.726815 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m11:41:59.729433 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m11:41:59.731432 [debug] [Thread-1 (]: Using duckdb connection "model.stock_dbt_project.stg_stock_data"
[0m11:41:59.732440 [debug] [Thread-1 (]: On model.stock_dbt_project.stg_stock_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "node_id": "model.stock_dbt_project.stg_stock_data"} */

  
  create view "dev"."main"."stg_stock_data__dbt_tmp" as (
    



WITH raw AS (
    SELECT *
    FROM read_json_auto('s3://my-stock-data-bucket/stocks/*/*/*/*/*.json')
)

SELECT
    CAST(symbol AS TEXT) AS symbol,
    CAST(datetime AS TIMESTAMP) AS datetime,
    CAST(open AS DOUBLE) AS open,
    CAST(high AS DOUBLE) AS high,
    CAST(low AS DOUBLE) AS low,
    CAST(close AS DOUBLE) AS close,
    CAST(volume AS BIGINT) AS volume
FROM raw
WHERE symbol IS NOT NULL AND datetime IS NOT NULL
  );

[0m11:41:59.959803 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "node_id": "model.stock_dbt_project.stg_stock_data"} */

  
  create view "dev"."main"."stg_stock_data__dbt_tmp" as (
    



WITH raw AS (
    SELECT *
    FROM read_json_auto('s3://my-stock-data-bucket/stocks/*/*/*/*/*.json')
)

SELECT
    CAST(symbol AS TEXT) AS symbol,
    CAST(datetime AS TIMESTAMP) AS datetime,
    CAST(open AS DOUBLE) AS open,
    CAST(high AS DOUBLE) AS high,
    CAST(low AS DOUBLE) AS low,
    CAST(close AS DOUBLE) AS close,
    CAST(volume AS BIGINT) AS volume
FROM raw
WHERE symbol IS NOT NULL AND datetime IS NOT NULL
  );

[0m11:41:59.965237 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m11:41:59.970461 [debug] [Thread-1 (]: On model.stock_dbt_project.stg_stock_data: ROLLBACK
[0m11:42:00.019317 [debug] [Thread-1 (]: Failed to rollback 'model.stock_dbt_project.stg_stock_data'
[0m11:42:00.022678 [debug] [Thread-1 (]: On model.stock_dbt_project.stg_stock_data: Close
[0m11:42:00.039543 [debug] [Thread-1 (]: Runtime Error in model stg_stock_data (models\staging\stg_stock_data.sql)
  HTTP Error: HTTP GET error on '/?encoding-type=url&list-type=2&prefix=stocks%2F' (HTTP 403)
[0m11:42:00.057205 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7db340bd-13e7-4af0-8832-5c746d3673a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001827FC95D90>]}
[0m11:42:00.068908 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model main.stg_stock_data ....................... [[31mERROR[0m in 0.51s]
[0m11:42:00.120251 [debug] [Thread-1 (]: Finished running node model.stock_dbt_project.stg_stock_data
[0m11:42:00.135218 [debug] [Thread-4 (]: Marking all children of 'model.stock_dbt_project.stg_stock_data' to be skipped because of status 'error'.  Reason: Runtime Error in model stg_stock_data (models\staging\stg_stock_data.sql)
  HTTP Error: HTTP GET error on '/?encoding-type=url&list-type=2&prefix=stocks%2F' (HTTP 403).
[0m11:42:00.145929 [debug] [MainThread]: Using duckdb connection "master"
[0m11:42:00.149126 [debug] [MainThread]: On master: BEGIN
[0m11:42:00.152150 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:42:00.155439 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m11:42:00.158728 [debug] [MainThread]: On master: COMMIT
[0m11:42:00.160715 [debug] [MainThread]: Using duckdb connection "master"
[0m11:42:00.167286 [debug] [MainThread]: On master: COMMIT
[0m11:42:00.171915 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m11:42:00.173713 [debug] [MainThread]: On master: Close
[0m11:42:00.177728 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:42:00.187949 [debug] [MainThread]: Connection 'create_dev_main' was properly closed.
[0m11:42:00.190243 [debug] [MainThread]: Connection 'list_dev_main' was properly closed.
[0m11:42:00.209108 [debug] [MainThread]: Connection 'model.stock_dbt_project.stg_stock_data' was properly closed.
[0m11:42:00.216123 [info ] [MainThread]: 
[0m11:42:00.224677 [info ] [MainThread]: Finished running 9 project hooks, 1 view model in 0 hours 0 minutes and 1.90 seconds (1.90s).
[0m11:42:00.255659 [debug] [MainThread]: Command end result
[0m11:42:00.427961 [debug] [MainThread]: Wrote artifact WritableManifest to D:\Stock_price\stock_dbt_project\target\manifest.json
[0m11:42:00.436819 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\Stock_price\stock_dbt_project\target\semantic_manifest.json
[0m11:42:00.459729 [debug] [MainThread]: Wrote artifact RunExecutionResult to D:\Stock_price\stock_dbt_project\target\run_results.json
[0m11:42:00.462753 [info ] [MainThread]: 
[0m11:42:00.466528 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m11:42:00.470981 [info ] [MainThread]: 
[0m11:42:00.472984 [error] [MainThread]:   Runtime Error in model stg_stock_data (models\staging\stg_stock_data.sql)
  HTTP Error: HTTP GET error on '/?encoding-type=url&list-type=2&prefix=stocks%2F' (HTTP 403)
[0m11:42:00.476287 [info ] [MainThread]: 
[0m11:42:00.478283 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=1 SKIP=0 TOTAL=10
[0m11:42:00.488106 [debug] [MainThread]: Command `dbt run` failed at 11:42:00.487107 after 6.20 seconds
[0m11:42:00.490104 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001827DDE6FF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001827ABA0A40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001827B4F00E0>]}
[0m11:42:00.492105 [debug] [MainThread]: Flushing usage events
[0m11:42:00.941198 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:54:47.653931 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF3EC4B530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF41AFE030>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF41AFF8F0>]}


============================== 23:54:47.664565 | 3b3498a0-d96d-46b7-8ca1-d290e72bcdef ==============================
[0m23:54:47.664565 [info ] [MainThread]: Running with dbt=1.9.4
[0m23:54:47.665501 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\loges\\.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'D:\\Stock_price\\stock_dbt_project\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select stg_stock_data', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:54:48.233557 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3b3498a0-d96d-46b7-8ca1-d290e72bcdef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF3EF29100>]}
[0m23:54:48.403092 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3b3498a0-d96d-46b7-8ca1-d290e72bcdef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF41FB8950>]}
[0m23:54:48.439120 [info ] [MainThread]: Registered adapter: duckdb=1.9.2
[0m23:54:49.097614 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m23:54:52.160102 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:54:52.162908 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:54:52.186027 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.stock_dbt_project.marts
[0m23:54:52.472094 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3b3498a0-d96d-46b7-8ca1-d290e72bcdef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF4343CA70>]}
[0m23:54:52.889487 [debug] [MainThread]: Wrote artifact WritableManifest to D:\Stock_price\stock_dbt_project\target\manifest.json
[0m23:54:52.931157 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\Stock_price\stock_dbt_project\target\semantic_manifest.json
[0m23:54:53.120628 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3b3498a0-d96d-46b7-8ca1-d290e72bcdef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF4361B080>]}
[0m23:54:53.125720 [info ] [MainThread]: Found 4 models, 9 operations, 4 data tests, 426 macros
[0m23:54:53.129650 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3b3498a0-d96d-46b7-8ca1-d290e72bcdef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF4362E510>]}
[0m23:54:53.140110 [info ] [MainThread]: 
[0m23:54:53.142542 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:54:53.145557 [info ] [MainThread]: 
[0m23:54:53.152479 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m23:54:53.158384 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m23:55:01.949047 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m23:55:01.952363 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m23:55:01.955154 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:55:02.194338 [debug] [ThreadPool]: SQL status: OK in 0.239 seconds
[0m23:55:02.205389 [debug] [ThreadPool]: On list_dev: Close
[0m23:55:02.209687 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m23:55:02.213871 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m23:55:02.260612 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m23:55:02.263786 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "create_dev_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m23:55:02.267826 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:55:02.275550 [debug] [ThreadPool]: SQL status: OK in 0.008 seconds
[0m23:55:02.285279 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m23:55:02.288416 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m23:55:02.291815 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m23:55:02.294251 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m23:55:02.299695 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "create_dev_main"} */

    
    
        create schema if not exists "dev"."main"
    
[0m23:55:02.305320 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m23:55:02.310926 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m23:55:02.316744 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m23:55:02.326914 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m23:55:02.338222 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m23:55:02.341808 [debug] [ThreadPool]: On create_dev_main: Close
[0m23:55:02.416752 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev_main'
[0m23:55:02.479739 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m23:55:02.486030 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m23:55:02.491738 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:55:02.497107 [debug] [ThreadPool]: SQL status: OK in 0.005 seconds
[0m23:55:02.518162 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m23:55:02.522507 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m23:55:02.664330 [debug] [ThreadPool]: SQL status: OK in 0.139 seconds
[0m23:55:02.672592 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m23:55:02.731076 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m23:55:02.734873 [debug] [ThreadPool]: On list_dev_main: Close
[0m23:55:02.738364 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3b3498a0-d96d-46b7-8ca1-d290e72bcdef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF4343C230>]}
[0m23:55:02.741423 [debug] [MainThread]: Using duckdb connection "master"
[0m23:55:02.743545 [debug] [MainThread]: On master: BEGIN
[0m23:55:02.747023 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:55:02.750535 [debug] [MainThread]: SQL status: OK in 0.004 seconds
[0m23:55:02.753961 [debug] [MainThread]: On master: COMMIT
[0m23:55:02.756364 [debug] [MainThread]: Using duckdb connection "master"
[0m23:55:02.759174 [debug] [MainThread]: On master: COMMIT
[0m23:55:02.763650 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m23:55:02.800263 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-0"
[0m23:55:02.829411 [info ] [MainThread]: 1 of 9 START hook: stock_dbt_project.on-run-start.0 ............................ [RUN]
[0m23:55:02.835369 [debug] [MainThread]: Using duckdb connection "master"
[0m23:55:02.839486 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
INSTALL httpfs;
[0m23:55:02.880059 [debug] [MainThread]: SQL status: OK in 0.036 seconds
[0m23:55:02.889535 [info ] [MainThread]: 1 of 9 OK hook: stock_dbt_project.on-run-start.0 ............................... [[32mOK[0m in 0.12s]
[0m23:55:02.901317 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-1"
[0m23:55:02.906305 [info ] [MainThread]: 2 of 9 START hook: stock_dbt_project.on-run-start.1 ............................ [RUN]
[0m23:55:02.911559 [debug] [MainThread]: Using duckdb connection "master"
[0m23:55:02.914517 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
INSTALL json;
[0m23:55:02.959806 [debug] [MainThread]: SQL status: OK in 0.040 seconds
[0m23:55:02.968547 [info ] [MainThread]: 2 of 9 OK hook: stock_dbt_project.on-run-start.1 ............................... [[32mOK[0m in 0.07s]
[0m23:55:02.977255 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-2"
[0m23:55:02.983433 [info ] [MainThread]: 3 of 9 START hook: stock_dbt_project.on-run-start.2 ............................ [RUN]
[0m23:55:02.988425 [debug] [MainThread]: Using duckdb connection "master"
[0m23:55:02.991020 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
LOAD httpfs;
[0m23:55:07.521101 [debug] [MainThread]: SQL status: OK in 4.527 seconds
[0m23:55:07.529618 [info ] [MainThread]: 3 of 9 OK hook: stock_dbt_project.on-run-start.2 ............................... [[32mOK[0m in 4.56s]
[0m23:55:07.542028 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-3"
[0m23:55:07.547117 [info ] [MainThread]: 4 of 9 START hook: stock_dbt_project.on-run-start.3 ............................ [RUN]
[0m23:55:07.556166 [debug] [MainThread]: Using duckdb connection "master"
[0m23:55:07.559536 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
LOAD json;
[0m23:55:07.563088 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m23:55:07.571006 [info ] [MainThread]: 4 of 9 OK hook: stock_dbt_project.on-run-start.3 ............................... [[32mOK[0m in 0.03s]
[0m23:55:07.582083 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-4"
[0m23:55:07.589020 [info ] [MainThread]: 5 of 9 START hook: stock_dbt_project.on-run-start.4 ............................ [RUN]
[0m23:55:07.594094 [debug] [MainThread]: Using duckdb connection "master"
[0m23:55:07.597057 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
SET s3_access_key_id='minioadmin';
[0m23:55:07.603885 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m23:55:07.610237 [info ] [MainThread]: 5 of 9 OK hook: stock_dbt_project.on-run-start.4 ............................... [[32mOK[0m in 0.03s]
[0m23:55:07.628900 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-5"
[0m23:55:07.637043 [info ] [MainThread]: 6 of 9 START hook: stock_dbt_project.on-run-start.5 ............................ [RUN]
[0m23:55:07.641105 [debug] [MainThread]: Using duckdb connection "master"
[0m23:55:07.644396 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
SET s3_secret_access_key='minioadmin';
[0m23:55:07.650411 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m23:55:07.656826 [info ] [MainThread]: 6 of 9 OK hook: stock_dbt_project.on-run-start.5 ............................... [[32mOK[0m in 0.04s]
[0m23:55:07.668803 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-6"
[0m23:55:07.674551 [info ] [MainThread]: 7 of 9 START hook: stock_dbt_project.on-run-start.6 ............................ [RUN]
[0m23:55:07.679094 [debug] [MainThread]: Using duckdb connection "master"
[0m23:55:07.689177 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
SET s3_endpoint='http://localhost:9000';
[0m23:55:07.693961 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m23:55:07.703573 [info ] [MainThread]: 7 of 9 OK hook: stock_dbt_project.on-run-start.6 ............................... [[32mOK[0m in 0.04s]
[0m23:55:07.712481 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-7"
[0m23:55:07.719549 [info ] [MainThread]: 8 of 9 START hook: stock_dbt_project.on-run-start.7 ............................ [RUN]
[0m23:55:07.724115 [debug] [MainThread]: Using duckdb connection "master"
[0m23:55:07.726897 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
SET s3_use_ssl=false;
[0m23:55:07.733635 [debug] [MainThread]: SQL status: OK in 0.004 seconds
[0m23:55:07.739641 [info ] [MainThread]: 8 of 9 OK hook: stock_dbt_project.on-run-start.7 ............................... [[32mOK[0m in 0.03s]
[0m23:55:07.751981 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-8"
[0m23:55:07.756524 [info ] [MainThread]: 9 of 9 START hook: stock_dbt_project.on-run-start.8 ............................ [RUN]
[0m23:55:07.770361 [debug] [MainThread]: Using duckdb connection "master"
[0m23:55:07.773211 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
SET s3_url_style='path';
[0m23:55:07.776700 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m23:55:07.782670 [info ] [MainThread]: 9 of 9 OK hook: stock_dbt_project.on-run-start.8 ............................... [[32mOK[0m in 0.04s]
[0m23:55:07.785192 [info ] [MainThread]: 
[0m23:55:07.787205 [debug] [MainThread]: On master: Close
[0m23:55:07.800751 [debug] [Thread-1 (]: Began running node model.stock_dbt_project.stg_stock_data
[0m23:55:07.804739 [info ] [Thread-1 (]: 1 of 1 START sql view model main.stg_stock_data ................................ [RUN]
[0m23:55:07.807319 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.stock_dbt_project.stg_stock_data'
[0m23:55:07.808322 [debug] [Thread-1 (]: Began compiling node model.stock_dbt_project.stg_stock_data
[0m23:55:07.819007 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_dbt_project.stg_stock_data"
[0m23:55:07.822505 [debug] [Thread-1 (]: Began executing node model.stock_dbt_project.stg_stock_data
[0m23:55:07.981881 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_dbt_project.stg_stock_data"
[0m23:55:07.985663 [debug] [Thread-1 (]: Using duckdb connection "model.stock_dbt_project.stg_stock_data"
[0m23:55:07.988655 [debug] [Thread-1 (]: On model.stock_dbt_project.stg_stock_data: BEGIN
[0m23:55:07.990656 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m23:55:07.994655 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m23:55:07.996632 [debug] [Thread-1 (]: Using duckdb connection "model.stock_dbt_project.stg_stock_data"
[0m23:55:07.999641 [debug] [Thread-1 (]: On model.stock_dbt_project.stg_stock_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "node_id": "model.stock_dbt_project.stg_stock_data"} */

  
  create view "dev"."main"."stg_stock_data__dbt_tmp" as (
    



WITH raw AS (
    SELECT *
    FROM read_json_auto('s3://my-stock-data-bucket/stocks/*/*/*/*/*.json')
)

SELECT
    CAST(symbol AS TEXT) AS symbol,
    CAST(datetime AS TIMESTAMP) AS datetime,
    CAST(open AS DOUBLE) AS open,
    CAST(high AS DOUBLE) AS high,
    CAST(low AS DOUBLE) AS low,
    CAST(close AS DOUBLE) AS close,
    CAST(volume AS BIGINT) AS volume
FROM raw
WHERE symbol IS NOT NULL AND datetime IS NOT NULL
  );

[0m23:55:08.417151 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "node_id": "model.stock_dbt_project.stg_stock_data"} */

  
  create view "dev"."main"."stg_stock_data__dbt_tmp" as (
    



WITH raw AS (
    SELECT *
    FROM read_json_auto('s3://my-stock-data-bucket/stocks/*/*/*/*/*.json')
)

SELECT
    CAST(symbol AS TEXT) AS symbol,
    CAST(datetime AS TIMESTAMP) AS datetime,
    CAST(open AS DOUBLE) AS open,
    CAST(high AS DOUBLE) AS high,
    CAST(low AS DOUBLE) AS low,
    CAST(close AS DOUBLE) AS close,
    CAST(volume AS BIGINT) AS volume
FROM raw
WHERE symbol IS NOT NULL AND datetime IS NOT NULL
  );

[0m23:55:08.419464 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m23:55:08.423174 [debug] [Thread-1 (]: On model.stock_dbt_project.stg_stock_data: ROLLBACK
[0m23:55:08.786633 [debug] [Thread-1 (]: Failed to rollback 'model.stock_dbt_project.stg_stock_data'
[0m23:55:08.789725 [debug] [Thread-1 (]: On model.stock_dbt_project.stg_stock_data: Close
[0m23:55:08.804248 [debug] [Thread-1 (]: Runtime Error in model stg_stock_data (models\staging\stg_stock_data.sql)
  HTTP Error: HTTP GET error on '/?encoding-type=url&list-type=2&prefix=stocks%2F' (HTTP 400)
[0m23:55:08.816310 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3b3498a0-d96d-46b7-8ca1-d290e72bcdef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF41442450>]}
[0m23:55:08.819110 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model main.stg_stock_data ....................... [[31mERROR[0m in 1.00s]
[0m23:55:08.824388 [debug] [Thread-1 (]: Finished running node model.stock_dbt_project.stg_stock_data
[0m23:55:08.828115 [debug] [Thread-4 (]: Marking all children of 'model.stock_dbt_project.stg_stock_data' to be skipped because of status 'error'.  Reason: Runtime Error in model stg_stock_data (models\staging\stg_stock_data.sql)
  HTTP Error: HTTP GET error on '/?encoding-type=url&list-type=2&prefix=stocks%2F' (HTTP 400).
[0m23:55:08.839303 [debug] [MainThread]: Using duckdb connection "master"
[0m23:55:08.841815 [debug] [MainThread]: On master: BEGIN
[0m23:55:08.843833 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:55:08.849507 [debug] [MainThread]: SQL status: OK in 0.004 seconds
[0m23:55:08.853349 [debug] [MainThread]: On master: COMMIT
[0m23:55:08.855412 [debug] [MainThread]: Using duckdb connection "master"
[0m23:55:08.859148 [debug] [MainThread]: On master: COMMIT
[0m23:55:08.862290 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m23:55:08.867735 [debug] [MainThread]: On master: Close
[0m23:55:08.871058 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:55:08.873710 [debug] [MainThread]: Connection 'create_dev_main' was properly closed.
[0m23:55:08.876103 [debug] [MainThread]: Connection 'list_dev_main' was properly closed.
[0m23:55:08.879580 [debug] [MainThread]: Connection 'model.stock_dbt_project.stg_stock_data' was properly closed.
[0m23:55:08.883925 [info ] [MainThread]: 
[0m23:55:08.887791 [info ] [MainThread]: Finished running 9 project hooks, 1 view model in 0 hours 0 minutes and 15.73 seconds (15.73s).
[0m23:55:08.902330 [debug] [MainThread]: Command end result
[0m23:55:09.013848 [debug] [MainThread]: Wrote artifact WritableManifest to D:\Stock_price\stock_dbt_project\target\manifest.json
[0m23:55:09.023009 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\Stock_price\stock_dbt_project\target\semantic_manifest.json
[0m23:55:09.048334 [debug] [MainThread]: Wrote artifact RunExecutionResult to D:\Stock_price\stock_dbt_project\target\run_results.json
[0m23:55:09.050853 [info ] [MainThread]: 
[0m23:55:09.053868 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m23:55:09.055400 [info ] [MainThread]: 
[0m23:55:09.058505 [error] [MainThread]:   Runtime Error in model stg_stock_data (models\staging\stg_stock_data.sql)
  HTTP Error: HTTP GET error on '/?encoding-type=url&list-type=2&prefix=stocks%2F' (HTTP 400)
[0m23:55:09.060969 [info ] [MainThread]: 
[0m23:55:09.070516 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=1 SKIP=0 TOTAL=10
[0m23:55:09.076914 [debug] [MainThread]: Command `dbt run` failed at 23:55:09.076376 after 21.92 seconds
[0m23:55:09.081016 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF3EC4B530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF4361AC60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF4147F110>]}
[0m23:55:09.087418 [debug] [MainThread]: Flushing usage events
[0m23:55:09.924138 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:14:21.496811 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020043EA2810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020043567FB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020043565B20>]}


============================== 01:14:21.504812 | 8f5efae4-a342-4956-87db-587c31b1214b ==============================
[0m01:14:21.504812 [info ] [MainThread]: Running with dbt=1.9.4
[0m01:14:21.505680 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'D:\\Stock_price\\stock_dbt_project\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\loges\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run --select stg_stock_data', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m01:14:21.902507 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8f5efae4-a342-4956-87db-587c31b1214b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002004419E8D0>]}
[0m01:14:22.113884 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8f5efae4-a342-4956-87db-587c31b1214b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020043D2FEC0>]}
[0m01:14:22.125543 [info ] [MainThread]: Registered adapter: duckdb=1.9.2
[0m01:14:22.919936 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m01:14:24.363279 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:14:24.367164 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:14:24.408790 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.stock_dbt_project.marts
[0m01:14:24.648626 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8f5efae4-a342-4956-87db-587c31b1214b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020044452E10>]}
[0m01:14:25.180747 [debug] [MainThread]: Wrote artifact WritableManifest to D:\Stock_price\stock_dbt_project\target\manifest.json
[0m01:14:25.201518 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\Stock_price\stock_dbt_project\target\semantic_manifest.json
[0m01:14:25.339947 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8f5efae4-a342-4956-87db-587c31b1214b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200459BE360>]}
[0m01:14:25.342154 [info ] [MainThread]: Found 4 models, 9 operations, 4 data tests, 426 macros
[0m01:14:25.346693 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8f5efae4-a342-4956-87db-587c31b1214b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020044353110>]}
[0m01:14:25.353957 [info ] [MainThread]: 
[0m01:14:25.357286 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:14:25.360351 [info ] [MainThread]: 
[0m01:14:25.365650 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m01:14:25.368837 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m01:14:25.577061 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m01:14:25.579076 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m01:14:25.580066 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:14:25.604170 [debug] [ThreadPool]: SQL status: OK in 0.024 seconds
[0m01:14:25.607222 [debug] [ThreadPool]: On list_dev: Close
[0m01:14:25.608839 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m01:14:25.609944 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m01:14:25.620971 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m01:14:25.621966 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "create_dev_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m01:14:25.621966 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:14:25.623968 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m01:14:25.625966 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m01:14:25.626771 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m01:14:25.627495 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m01:14:25.627495 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m01:14:25.628504 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "create_dev_main"} */

    
    
        create schema if not exists "dev"."main"
    
[0m01:14:25.629512 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m01:14:25.631509 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m01:14:25.632508 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m01:14:25.632508 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m01:14:25.633335 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m01:14:25.634355 [debug] [ThreadPool]: On create_dev_main: Close
[0m01:14:25.642011 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev_main'
[0m01:14:25.651095 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m01:14:25.652108 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m01:14:25.652108 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:14:25.653104 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m01:14:25.654217 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m01:14:25.654733 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m01:14:25.684052 [debug] [ThreadPool]: SQL status: OK in 0.029 seconds
[0m01:14:25.686046 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m01:14:25.688050 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m01:14:25.689431 [debug] [ThreadPool]: On list_dev_main: Close
[0m01:14:25.690908 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8f5efae4-a342-4956-87db-587c31b1214b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002004567B590>]}
[0m01:14:25.691907 [debug] [MainThread]: Using duckdb connection "master"
[0m01:14:25.691907 [debug] [MainThread]: On master: BEGIN
[0m01:14:25.692913 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:14:25.693908 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m01:14:25.694913 [debug] [MainThread]: On master: COMMIT
[0m01:14:25.696912 [debug] [MainThread]: Using duckdb connection "master"
[0m01:14:25.697913 [debug] [MainThread]: On master: COMMIT
[0m01:14:25.698910 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m01:14:25.709709 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-0"
[0m01:14:25.720481 [info ] [MainThread]: 1 of 9 START hook: stock_dbt_project.on-run-start.0 ............................ [RUN]
[0m01:14:25.722481 [debug] [MainThread]: Using duckdb connection "master"
[0m01:14:25.723481 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
INSTALL httpfs;
[0m01:14:25.725496 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m01:14:25.728494 [info ] [MainThread]: 1 of 9 OK hook: stock_dbt_project.on-run-start.0 ............................... [[32mOK[0m in 0.03s]
[0m01:14:25.732487 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-1"
[0m01:14:25.733486 [info ] [MainThread]: 2 of 9 START hook: stock_dbt_project.on-run-start.1 ............................ [RUN]
[0m01:14:25.735483 [debug] [MainThread]: Using duckdb connection "master"
[0m01:14:25.736481 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
INSTALL json;
[0m01:14:25.737994 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m01:14:25.740012 [info ] [MainThread]: 2 of 9 OK hook: stock_dbt_project.on-run-start.1 ............................... [[32mOK[0m in 0.01s]
[0m01:14:25.742008 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-2"
[0m01:14:25.744005 [info ] [MainThread]: 3 of 9 START hook: stock_dbt_project.on-run-start.2 ............................ [RUN]
[0m01:14:25.748308 [debug] [MainThread]: Using duckdb connection "master"
[0m01:14:25.749300 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
LOAD httpfs;
[0m01:14:26.030367 [debug] [MainThread]: SQL status: OK in 0.279 seconds
[0m01:14:26.032371 [info ] [MainThread]: 3 of 9 OK hook: stock_dbt_project.on-run-start.2 ............................... [[32mOK[0m in 0.29s]
[0m01:14:26.035368 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-3"
[0m01:14:26.036891 [info ] [MainThread]: 4 of 9 START hook: stock_dbt_project.on-run-start.3 ............................ [RUN]
[0m01:14:26.037904 [debug] [MainThread]: Using duckdb connection "master"
[0m01:14:26.038908 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
LOAD json;
[0m01:14:26.040432 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m01:14:26.042438 [info ] [MainThread]: 4 of 9 OK hook: stock_dbt_project.on-run-start.3 ............................... [[32mOK[0m in 0.01s]
[0m01:14:26.046449 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-4"
[0m01:14:26.049320 [info ] [MainThread]: 5 of 9 START hook: stock_dbt_project.on-run-start.4 ............................ [RUN]
[0m01:14:26.051332 [debug] [MainThread]: Using duckdb connection "master"
[0m01:14:26.052341 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
SET s3_access_key_id='minioadmin';
[0m01:14:26.054332 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m01:14:26.056597 [info ] [MainThread]: 5 of 9 OK hook: stock_dbt_project.on-run-start.4 ............................... [[32mOK[0m in 0.01s]
[0m01:14:26.060600 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-5"
[0m01:14:26.063603 [info ] [MainThread]: 6 of 9 START hook: stock_dbt_project.on-run-start.5 ............................ [RUN]
[0m01:14:26.067971 [debug] [MainThread]: Using duckdb connection "master"
[0m01:14:26.071366 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
SET s3_secret_access_key='minioadmin';
[0m01:14:26.074728 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m01:14:26.080087 [info ] [MainThread]: 6 of 9 OK hook: stock_dbt_project.on-run-start.5 ............................... [[32mOK[0m in 0.02s]
[0m01:14:26.086086 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-6"
[0m01:14:26.089236 [info ] [MainThread]: 7 of 9 START hook: stock_dbt_project.on-run-start.6 ............................ [RUN]
[0m01:14:26.091367 [debug] [MainThread]: Using duckdb connection "master"
[0m01:14:26.094612 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
SET s3_endpoint='http://localhost:9000';
[0m01:14:26.099330 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m01:14:26.103630 [info ] [MainThread]: 7 of 9 OK hook: stock_dbt_project.on-run-start.6 ............................... [[32mOK[0m in 0.02s]
[0m01:14:26.116504 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-7"
[0m01:14:26.123048 [info ] [MainThread]: 8 of 9 START hook: stock_dbt_project.on-run-start.7 ............................ [RUN]
[0m01:14:26.126206 [debug] [MainThread]: Using duckdb connection "master"
[0m01:14:26.129223 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
SET s3_use_ssl=false;
[0m01:14:26.134410 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m01:14:26.140277 [info ] [MainThread]: 8 of 9 OK hook: stock_dbt_project.on-run-start.7 ............................... [[32mOK[0m in 0.03s]
[0m01:14:26.158468 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-8"
[0m01:14:26.165920 [info ] [MainThread]: 9 of 9 START hook: stock_dbt_project.on-run-start.8 ............................ [RUN]
[0m01:14:26.170470 [debug] [MainThread]: Using duckdb connection "master"
[0m01:14:26.173477 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
SET s3_url_style='path';
[0m01:14:26.179103 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m01:14:26.187838 [info ] [MainThread]: 9 of 9 OK hook: stock_dbt_project.on-run-start.8 ............................... [[32mOK[0m in 0.03s]
[0m01:14:26.198182 [info ] [MainThread]: 
[0m01:14:26.204056 [debug] [MainThread]: On master: Close
[0m01:14:26.233888 [debug] [Thread-1 (]: Began running node model.stock_dbt_project.stg_stock_data
[0m01:14:26.238666 [info ] [Thread-1 (]: 1 of 1 START sql view model main.stg_stock_data ................................ [RUN]
[0m01:14:26.242998 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.stock_dbt_project.stg_stock_data'
[0m01:14:26.247365 [debug] [Thread-1 (]: Began compiling node model.stock_dbt_project.stg_stock_data
[0m01:14:26.271306 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_dbt_project.stg_stock_data"
[0m01:14:26.277430 [debug] [Thread-1 (]: Began executing node model.stock_dbt_project.stg_stock_data
[0m01:14:26.406680 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_dbt_project.stg_stock_data"
[0m01:14:26.408269 [debug] [Thread-1 (]: Using duckdb connection "model.stock_dbt_project.stg_stock_data"
[0m01:14:26.409334 [debug] [Thread-1 (]: On model.stock_dbt_project.stg_stock_data: BEGIN
[0m01:14:26.410197 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m01:14:26.412439 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m01:14:26.413447 [debug] [Thread-1 (]: Using duckdb connection "model.stock_dbt_project.stg_stock_data"
[0m01:14:26.414449 [debug] [Thread-1 (]: On model.stock_dbt_project.stg_stock_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "node_id": "model.stock_dbt_project.stg_stock_data"} */

  
  create view "dev"."main"."stg_stock_data__dbt_tmp" as (
    



WITH raw AS (
    SELECT *
    FROM read_json_auto('s3://my-stock-data-bucket/stocks/*/*/*/*/*.json')
)

SELECT
    CAST(symbol AS TEXT) AS symbol,
    CAST(datetime AS TIMESTAMP) AS datetime,
    CAST(open AS DOUBLE) AS open,
    CAST(high AS DOUBLE) AS high,
    CAST(low AS DOUBLE) AS low,
    CAST(close AS DOUBLE) AS close,
    CAST(volume AS BIGINT) AS volume
FROM raw
WHERE symbol IS NOT NULL AND datetime IS NOT NULL
  );

[0m01:14:26.798920 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "node_id": "model.stock_dbt_project.stg_stock_data"} */

  
  create view "dev"."main"."stg_stock_data__dbt_tmp" as (
    



WITH raw AS (
    SELECT *
    FROM read_json_auto('s3://my-stock-data-bucket/stocks/*/*/*/*/*.json')
)

SELECT
    CAST(symbol AS TEXT) AS symbol,
    CAST(datetime AS TIMESTAMP) AS datetime,
    CAST(open AS DOUBLE) AS open,
    CAST(high AS DOUBLE) AS high,
    CAST(low AS DOUBLE) AS low,
    CAST(close AS DOUBLE) AS close,
    CAST(volume AS BIGINT) AS volume
FROM raw
WHERE symbol IS NOT NULL AND datetime IS NOT NULL
  );

[0m01:14:26.801185 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m01:14:26.802848 [debug] [Thread-1 (]: On model.stock_dbt_project.stg_stock_data: ROLLBACK
[0m01:14:26.817007 [debug] [Thread-1 (]: Failed to rollback 'model.stock_dbt_project.stg_stock_data'
[0m01:14:26.818865 [debug] [Thread-1 (]: On model.stock_dbt_project.stg_stock_data: Close
[0m01:14:26.820359 [debug] [Thread-1 (]: Runtime Error in model stg_stock_data (models\staging\stg_stock_data.sql)
  HTTP Error: HTTP GET error on '/?encoding-type=url&list-type=2&prefix=stocks%2F' (HTTP 400)
[0m01:14:26.842511 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8f5efae4-a342-4956-87db-587c31b1214b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020046016030>]}
[0m01:14:26.848756 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model main.stg_stock_data ....................... [[31mERROR[0m in 0.59s]
[0m01:14:26.856132 [debug] [Thread-1 (]: Finished running node model.stock_dbt_project.stg_stock_data
[0m01:14:26.860060 [debug] [Thread-4 (]: Marking all children of 'model.stock_dbt_project.stg_stock_data' to be skipped because of status 'error'.  Reason: Runtime Error in model stg_stock_data (models\staging\stg_stock_data.sql)
  HTTP Error: HTTP GET error on '/?encoding-type=url&list-type=2&prefix=stocks%2F' (HTTP 400).
[0m01:14:26.873215 [debug] [MainThread]: Using duckdb connection "master"
[0m01:14:26.876602 [debug] [MainThread]: On master: BEGIN
[0m01:14:26.881533 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:14:26.887048 [debug] [MainThread]: SQL status: OK in 0.006 seconds
[0m01:14:26.892045 [debug] [MainThread]: On master: COMMIT
[0m01:14:26.894282 [debug] [MainThread]: Using duckdb connection "master"
[0m01:14:26.898640 [debug] [MainThread]: On master: COMMIT
[0m01:14:26.902312 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m01:14:26.906246 [debug] [MainThread]: On master: Close
[0m01:14:26.910101 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:14:26.914334 [debug] [MainThread]: Connection 'create_dev_main' was properly closed.
[0m01:14:26.918524 [debug] [MainThread]: Connection 'list_dev_main' was properly closed.
[0m01:14:26.920285 [debug] [MainThread]: Connection 'model.stock_dbt_project.stg_stock_data' was properly closed.
[0m01:14:26.922481 [info ] [MainThread]: 
[0m01:14:26.924739 [info ] [MainThread]: Finished running 9 project hooks, 1 view model in 0 hours 0 minutes and 1.56 seconds (1.56s).
[0m01:14:26.935101 [debug] [MainThread]: Command end result
[0m01:14:27.020796 [debug] [MainThread]: Wrote artifact WritableManifest to D:\Stock_price\stock_dbt_project\target\manifest.json
[0m01:14:27.026665 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\Stock_price\stock_dbt_project\target\semantic_manifest.json
[0m01:14:27.050458 [debug] [MainThread]: Wrote artifact RunExecutionResult to D:\Stock_price\stock_dbt_project\target\run_results.json
[0m01:14:27.052456 [info ] [MainThread]: 
[0m01:14:27.053464 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m01:14:27.054974 [info ] [MainThread]: 
[0m01:14:27.056114 [error] [MainThread]:   Runtime Error in model stg_stock_data (models\staging\stg_stock_data.sql)
  HTTP Error: HTTP GET error on '/?encoding-type=url&list-type=2&prefix=stocks%2F' (HTTP 400)
[0m01:14:27.056568 [info ] [MainThread]: 
[0m01:14:27.057608 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=1 SKIP=0 TOTAL=10
[0m01:14:27.058627 [debug] [MainThread]: Command `dbt run` failed at 01:14:27.058627 after 5.82 seconds
[0m01:14:27.060609 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020040724F50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020044039E50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002004403B6E0>]}
[0m01:14:27.063610 [debug] [MainThread]: Flushing usage events
[0m01:14:27.874099 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:16:51.071404 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018D615C3CE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018D6430F200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018D64481C10>]}


============================== 01:16:51.077919 | 47e778e5-ff20-4833-885f-9c3940cf56d2 ==============================
[0m01:16:51.077919 [info ] [MainThread]: Running with dbt=1.9.4
[0m01:16:51.079928 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\loges\\.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'D:\\Stock_price\\stock_dbt_project\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --select stg_stock_data', 'send_anonymous_usage_stats': 'True'}
[0m01:16:51.472541 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '47e778e5-ff20-4833-885f-9c3940cf56d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018D64A4C260>]}
[0m01:16:51.585165 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '47e778e5-ff20-4833-885f-9c3940cf56d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018D64A32270>]}
[0m01:16:51.593667 [info ] [MainThread]: Registered adapter: duckdb=1.9.2
[0m01:16:52.666209 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m01:16:53.545530 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m01:16:53.550786 [debug] [MainThread]: Partial parsing: updated file: stock_dbt_project://models\staging\stg_stock_data.sql
[0m01:16:54.744729 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.stock_dbt_project.marts
[0m01:16:54.767762 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '47e778e5-ff20-4833-885f-9c3940cf56d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018D661DD9A0>]}
[0m01:16:55.274220 [debug] [MainThread]: Wrote artifact WritableManifest to D:\Stock_price\stock_dbt_project\target\manifest.json
[0m01:16:55.279882 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\Stock_price\stock_dbt_project\target\semantic_manifest.json
[0m01:16:55.334130 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '47e778e5-ff20-4833-885f-9c3940cf56d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018D641C1D90>]}
[0m01:16:55.335985 [info ] [MainThread]: Found 4 models, 9 operations, 4 data tests, 426 macros
[0m01:16:55.338021 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '47e778e5-ff20-4833-885f-9c3940cf56d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018D660539E0>]}
[0m01:16:55.342727 [info ] [MainThread]: 
[0m01:16:55.349861 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:16:55.352555 [info ] [MainThread]: 
[0m01:16:55.355450 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m01:16:55.358500 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m01:16:55.496740 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m01:16:55.498750 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m01:16:55.499749 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:16:55.524079 [debug] [ThreadPool]: SQL status: OK in 0.024 seconds
[0m01:16:55.526239 [debug] [ThreadPool]: On list_dev: Close
[0m01:16:55.527847 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m01:16:55.528861 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m01:16:55.539395 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m01:16:55.540815 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "create_dev_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m01:16:55.541295 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:16:55.542299 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m01:16:55.544303 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m01:16:55.545298 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m01:16:55.546308 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m01:16:55.547298 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m01:16:55.547788 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "create_dev_main"} */

    
    
        create schema if not exists "dev"."main"
    
[0m01:16:55.549311 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m01:16:55.551309 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m01:16:55.551309 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m01:16:55.552301 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m01:16:55.553311 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m01:16:55.553311 [debug] [ThreadPool]: On create_dev_main: Close
[0m01:16:55.561977 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev_main'
[0m01:16:55.572040 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m01:16:55.573057 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m01:16:55.574059 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:16:55.575476 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m01:16:55.575962 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m01:16:55.577008 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m01:16:55.621542 [debug] [ThreadPool]: SQL status: OK in 0.044 seconds
[0m01:16:55.624150 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m01:16:55.626767 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m01:16:55.626767 [debug] [ThreadPool]: On list_dev_main: Close
[0m01:16:55.627771 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '47e778e5-ff20-4833-885f-9c3940cf56d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018D649C26F0>]}
[0m01:16:55.628785 [debug] [MainThread]: Using duckdb connection "master"
[0m01:16:55.630899 [debug] [MainThread]: On master: BEGIN
[0m01:16:55.632000 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:16:55.632999 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m01:16:55.634006 [debug] [MainThread]: On master: COMMIT
[0m01:16:55.634999 [debug] [MainThread]: Using duckdb connection "master"
[0m01:16:55.634999 [debug] [MainThread]: On master: COMMIT
[0m01:16:55.635998 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m01:16:55.647568 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-0"
[0m01:16:55.656795 [info ] [MainThread]: 1 of 9 START hook: stock_dbt_project.on-run-start.0 ............................ [RUN]
[0m01:16:55.658781 [debug] [MainThread]: Using duckdb connection "master"
[0m01:16:55.658781 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
INSTALL httpfs;
[0m01:16:55.661663 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m01:16:55.664665 [info ] [MainThread]: 1 of 9 OK hook: stock_dbt_project.on-run-start.0 ............................... [[32mOK[0m in 0.03s]
[0m01:16:55.668658 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-1"
[0m01:16:55.670659 [info ] [MainThread]: 2 of 9 START hook: stock_dbt_project.on-run-start.1 ............................ [RUN]
[0m01:16:55.671660 [debug] [MainThread]: Using duckdb connection "master"
[0m01:16:55.672662 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
INSTALL json;
[0m01:16:55.674193 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m01:16:55.677191 [info ] [MainThread]: 2 of 9 OK hook: stock_dbt_project.on-run-start.1 ............................... [[32mOK[0m in 0.01s]
[0m01:16:55.682172 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-2"
[0m01:16:55.684173 [info ] [MainThread]: 3 of 9 START hook: stock_dbt_project.on-run-start.2 ............................ [RUN]
[0m01:16:55.686635 [debug] [MainThread]: Using duckdb connection "master"
[0m01:16:55.687388 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
LOAD httpfs;
[0m01:16:56.015999 [debug] [MainThread]: SQL status: OK in 0.325 seconds
[0m01:16:56.021393 [info ] [MainThread]: 3 of 9 OK hook: stock_dbt_project.on-run-start.2 ............................... [[32mOK[0m in 0.34s]
[0m01:16:56.026427 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-3"
[0m01:16:56.030284 [info ] [MainThread]: 4 of 9 START hook: stock_dbt_project.on-run-start.3 ............................ [RUN]
[0m01:16:56.033281 [debug] [MainThread]: Using duckdb connection "master"
[0m01:16:56.035286 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
LOAD json;
[0m01:16:56.037282 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m01:16:56.040822 [info ] [MainThread]: 4 of 9 OK hook: stock_dbt_project.on-run-start.3 ............................... [[32mOK[0m in 0.02s]
[0m01:16:56.046081 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-4"
[0m01:16:56.049263 [info ] [MainThread]: 5 of 9 START hook: stock_dbt_project.on-run-start.4 ............................ [RUN]
[0m01:16:56.051253 [debug] [MainThread]: Using duckdb connection "master"
[0m01:16:56.053250 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
SET s3_access_key_id='minioadmin';
[0m01:16:56.054249 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m01:16:56.056251 [info ] [MainThread]: 5 of 9 OK hook: stock_dbt_project.on-run-start.4 ............................... [[32mOK[0m in 0.01s]
[0m01:16:56.059253 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-5"
[0m01:16:56.061271 [info ] [MainThread]: 6 of 9 START hook: stock_dbt_project.on-run-start.5 ............................ [RUN]
[0m01:16:56.062707 [debug] [MainThread]: Using duckdb connection "master"
[0m01:16:56.064719 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
SET s3_secret_access_key='minioadmin';
[0m01:16:56.066714 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m01:16:56.068711 [info ] [MainThread]: 6 of 9 OK hook: stock_dbt_project.on-run-start.5 ............................... [[32mOK[0m in 0.01s]
[0m01:16:56.072712 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-6"
[0m01:16:56.073854 [info ] [MainThread]: 7 of 9 START hook: stock_dbt_project.on-run-start.6 ............................ [RUN]
[0m01:16:56.076122 [debug] [MainThread]: Using duckdb connection "master"
[0m01:16:56.077364 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
SET s3_endpoint='http://localhost:9000';
[0m01:16:56.079097 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m01:16:56.081327 [info ] [MainThread]: 7 of 9 OK hook: stock_dbt_project.on-run-start.6 ............................... [[32mOK[0m in 0.01s]
[0m01:16:56.086181 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-7"
[0m01:16:56.088172 [info ] [MainThread]: 8 of 9 START hook: stock_dbt_project.on-run-start.7 ............................ [RUN]
[0m01:16:56.089820 [debug] [MainThread]: Using duckdb connection "master"
[0m01:16:56.090837 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
SET s3_use_ssl=false;
[0m01:16:56.091835 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m01:16:56.093834 [info ] [MainThread]: 8 of 9 OK hook: stock_dbt_project.on-run-start.7 ............................... [[32mOK[0m in 0.01s]
[0m01:16:56.098744 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-8"
[0m01:16:56.100747 [info ] [MainThread]: 9 of 9 START hook: stock_dbt_project.on-run-start.8 ............................ [RUN]
[0m01:16:56.102736 [debug] [MainThread]: Using duckdb connection "master"
[0m01:16:56.104768 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
SET s3_url_style='path';
[0m01:16:56.105764 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m01:16:56.107767 [info ] [MainThread]: 9 of 9 OK hook: stock_dbt_project.on-run-start.8 ............................... [[32mOK[0m in 0.01s]
[0m01:16:56.109749 [info ] [MainThread]: 
[0m01:16:56.110776 [debug] [MainThread]: On master: Close
[0m01:16:56.123529 [debug] [Thread-1 (]: Began running node model.stock_dbt_project.stg_stock_data
[0m01:16:56.125812 [info ] [Thread-1 (]: 1 of 1 START sql view model main.stg_stock_data ................................ [RUN]
[0m01:16:56.129131 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.stock_dbt_project.stg_stock_data'
[0m01:16:56.131715 [debug] [Thread-1 (]: Began compiling node model.stock_dbt_project.stg_stock_data
[0m01:16:56.141796 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_dbt_project.stg_stock_data"
[0m01:16:56.144659 [debug] [Thread-1 (]: Began executing node model.stock_dbt_project.stg_stock_data
[0m01:16:56.291346 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_dbt_project.stg_stock_data"
[0m01:16:56.299019 [debug] [Thread-1 (]: Using duckdb connection "model.stock_dbt_project.stg_stock_data"
[0m01:16:56.303051 [debug] [Thread-1 (]: On model.stock_dbt_project.stg_stock_data: BEGIN
[0m01:16:56.308899 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m01:16:56.314751 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m01:16:56.319061 [debug] [Thread-1 (]: Using duckdb connection "model.stock_dbt_project.stg_stock_data"
[0m01:16:56.321258 [debug] [Thread-1 (]: On model.stock_dbt_project.stg_stock_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "node_id": "model.stock_dbt_project.stg_stock_data"} */

  
  create view "dev"."main"."stg_stock_data__dbt_tmp" as (
    



WITH raw AS (
    SELECT *
    FROM read_json_auto('s3://my-stock-data-bucket/stocks/CVX/2025/4/13/CVX_20250413_113945_jz58k4.json')
)

SELECT
    CAST(symbol AS TEXT) AS symbol,
    CAST(datetime AS TIMESTAMP) AS datetime,
    CAST(open AS DOUBLE) AS open,
    CAST(high AS DOUBLE) AS high,
    CAST(low AS DOUBLE) AS low,
    CAST(close AS DOUBLE) AS close,
    CAST(volume AS BIGINT) AS volume
FROM raw
WHERE symbol IS NOT NULL AND datetime IS NOT NULL
  );

[0m01:16:59.047218 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "node_id": "model.stock_dbt_project.stg_stock_data"} */

  
  create view "dev"."main"."stg_stock_data__dbt_tmp" as (
    



WITH raw AS (
    SELECT *
    FROM read_json_auto('s3://my-stock-data-bucket/stocks/CVX/2025/4/13/CVX_20250413_113945_jz58k4.json')
)

SELECT
    CAST(symbol AS TEXT) AS symbol,
    CAST(datetime AS TIMESTAMP) AS datetime,
    CAST(open AS DOUBLE) AS open,
    CAST(high AS DOUBLE) AS high,
    CAST(low AS DOUBLE) AS low,
    CAST(close AS DOUBLE) AS close,
    CAST(volume AS BIGINT) AS volume
FROM raw
WHERE symbol IS NOT NULL AND datetime IS NOT NULL
  );

[0m01:16:59.052754 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m01:16:59.055752 [debug] [Thread-1 (]: On model.stock_dbt_project.stg_stock_data: ROLLBACK
[0m01:16:59.077246 [debug] [Thread-1 (]: Failed to rollback 'model.stock_dbt_project.stg_stock_data'
[0m01:16:59.083310 [debug] [Thread-1 (]: On model.stock_dbt_project.stg_stock_data: Close
[0m01:16:59.093823 [debug] [Thread-1 (]: Runtime Error in model stg_stock_data (models\staging\stg_stock_data.sql)
  HTTP Error: HTTP GET error on 'https://my-stock-data-bucket.s3.amazonaws.com/stocks/CVX/2025/4/13/CVX_20250413_113945_jz58k4.json' (HTTP 400)
[0m01:16:59.106695 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '47e778e5-ff20-4833-885f-9c3940cf56d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018D63DCB9E0>]}
[0m01:16:59.109709 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model main.stg_stock_data ....................... [[31mERROR[0m in 2.97s]
[0m01:16:59.116276 [debug] [Thread-1 (]: Finished running node model.stock_dbt_project.stg_stock_data
[0m01:16:59.120113 [debug] [Thread-4 (]: Marking all children of 'model.stock_dbt_project.stg_stock_data' to be skipped because of status 'error'.  Reason: Runtime Error in model stg_stock_data (models\staging\stg_stock_data.sql)
  HTTP Error: HTTP GET error on 'https://my-stock-data-bucket.s3.amazonaws.com/stocks/CVX/2025/4/13/CVX_20250413_113945_jz58k4.json' (HTTP 400).
[0m01:16:59.127914 [debug] [MainThread]: Using duckdb connection "master"
[0m01:16:59.131314 [debug] [MainThread]: On master: BEGIN
[0m01:16:59.134278 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:16:59.137783 [debug] [MainThread]: SQL status: OK in 0.004 seconds
[0m01:16:59.139504 [debug] [MainThread]: On master: COMMIT
[0m01:16:59.141752 [debug] [MainThread]: Using duckdb connection "master"
[0m01:16:59.142770 [debug] [MainThread]: On master: COMMIT
[0m01:16:59.145767 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m01:16:59.150551 [debug] [MainThread]: On master: Close
[0m01:16:59.153930 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:16:59.157347 [debug] [MainThread]: Connection 'create_dev_main' was properly closed.
[0m01:16:59.159349 [debug] [MainThread]: Connection 'list_dev_main' was properly closed.
[0m01:16:59.160890 [debug] [MainThread]: Connection 'model.stock_dbt_project.stg_stock_data' was properly closed.
[0m01:16:59.164013 [info ] [MainThread]: 
[0m01:16:59.167055 [info ] [MainThread]: Finished running 9 project hooks, 1 view model in 0 hours 0 minutes and 3.81 seconds (3.81s).
[0m01:16:59.173189 [debug] [MainThread]: Command end result
[0m01:16:59.282645 [debug] [MainThread]: Wrote artifact WritableManifest to D:\Stock_price\stock_dbt_project\target\manifest.json
[0m01:16:59.290845 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\Stock_price\stock_dbt_project\target\semantic_manifest.json
[0m01:16:59.334443 [debug] [MainThread]: Wrote artifact RunExecutionResult to D:\Stock_price\stock_dbt_project\target\run_results.json
[0m01:16:59.336457 [info ] [MainThread]: 
[0m01:16:59.339165 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m01:16:59.341283 [info ] [MainThread]: 
[0m01:16:59.344316 [error] [MainThread]:   Runtime Error in model stg_stock_data (models\staging\stg_stock_data.sql)
  HTTP Error: HTTP GET error on 'https://my-stock-data-bucket.s3.amazonaws.com/stocks/CVX/2025/4/13/CVX_20250413_113945_jz58k4.json' (HTTP 400)
[0m01:16:59.348353 [info ] [MainThread]: 
[0m01:16:59.353877 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=1 SKIP=0 TOTAL=10
[0m01:16:59.359962 [debug] [MainThread]: Command `dbt run` failed at 01:16:59.358712 after 8.52 seconds
[0m01:16:59.364009 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018D64593170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018D64427410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018D63E7D7F0>]}
[0m01:16:59.368405 [debug] [MainThread]: Flushing usage events
[0m01:17:00.155117 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:18:16.346200 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000247F1762990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000247EF7E86E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000247EF7E86B0>]}


============================== 01:18:16.357349 | 680d4740-aaab-48ff-a0fa-aac596ae5bbe ==============================
[0m01:18:16.357349 [info ] [MainThread]: Running with dbt=1.9.4
[0m01:18:16.359352 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'D:\\Stock_price\\stock_dbt_project\\logs', 'profiles_dir': 'C:\\Users\\loges\\.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select stg_stock_data', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m01:18:16.771313 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '680d4740-aaab-48ff-a0fa-aac596ae5bbe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000247F1C9DF70>]}
[0m01:18:16.865003 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '680d4740-aaab-48ff-a0fa-aac596ae5bbe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000247F1AC8EC0>]}
[0m01:18:16.871366 [info ] [MainThread]: Registered adapter: duckdb=1.9.2
[0m01:18:17.242634 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m01:18:17.775518 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m01:18:17.777513 [debug] [MainThread]: Partial parsing: updated file: stock_dbt_project://models\staging\stg_stock_data.sql
[0m01:18:19.111022 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.stock_dbt_project.marts
[0m01:18:19.150136 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '680d4740-aaab-48ff-a0fa-aac596ae5bbe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000247F349DB50>]}
[0m01:18:19.560296 [debug] [MainThread]: Wrote artifact WritableManifest to D:\Stock_price\stock_dbt_project\target\manifest.json
[0m01:18:19.569413 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\Stock_price\stock_dbt_project\target\semantic_manifest.json
[0m01:18:19.705881 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '680d4740-aaab-48ff-a0fa-aac596ae5bbe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000247F319C470>]}
[0m01:18:19.708390 [info ] [MainThread]: Found 4 models, 9 operations, 4 data tests, 426 macros
[0m01:18:19.711006 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '680d4740-aaab-48ff-a0fa-aac596ae5bbe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000247F32090A0>]}
[0m01:18:19.721041 [info ] [MainThread]: 
[0m01:18:19.723046 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:18:19.726043 [info ] [MainThread]: 
[0m01:18:19.728048 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m01:18:19.733513 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m01:18:20.087533 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m01:18:20.089534 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m01:18:20.092216 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:18:20.173594 [debug] [ThreadPool]: SQL status: OK in 0.081 seconds
[0m01:18:20.181227 [debug] [ThreadPool]: On list_dev: Close
[0m01:18:20.186904 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m01:18:20.195200 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m01:18:20.238471 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m01:18:20.241413 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "create_dev_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m01:18:20.243926 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:18:20.249997 [debug] [ThreadPool]: SQL status: OK in 0.006 seconds
[0m01:18:20.259691 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m01:18:20.262495 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m01:18:20.266677 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m01:18:20.269388 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m01:18:20.271670 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "create_dev_main"} */

    
    
        create schema if not exists "dev"."main"
    
[0m01:18:20.275233 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m01:18:20.282140 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m01:18:20.285088 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m01:18:20.290954 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m01:18:20.295631 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m01:18:20.299798 [debug] [ThreadPool]: On create_dev_main: Close
[0m01:18:20.332261 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev_main'
[0m01:18:20.365762 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m01:18:20.368734 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m01:18:20.371545 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:18:20.374499 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m01:18:20.375561 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m01:18:20.377886 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m01:18:20.491739 [debug] [ThreadPool]: SQL status: OK in 0.112 seconds
[0m01:18:20.498250 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m01:18:20.504250 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m01:18:20.505247 [debug] [ThreadPool]: On list_dev_main: Close
[0m01:18:20.511298 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '680d4740-aaab-48ff-a0fa-aac596ae5bbe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000247F1CDA900>]}
[0m01:18:20.516199 [debug] [MainThread]: Using duckdb connection "master"
[0m01:18:20.518640 [debug] [MainThread]: On master: BEGIN
[0m01:18:20.520450 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:18:20.523276 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m01:18:20.524993 [debug] [MainThread]: On master: COMMIT
[0m01:18:20.527016 [debug] [MainThread]: Using duckdb connection "master"
[0m01:18:20.528007 [debug] [MainThread]: On master: COMMIT
[0m01:18:20.531906 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m01:18:20.565498 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-0"
[0m01:18:20.583202 [info ] [MainThread]: 1 of 9 START hook: stock_dbt_project.on-run-start.0 ............................ [RUN]
[0m01:18:20.586730 [debug] [MainThread]: Using duckdb connection "master"
[0m01:18:20.588744 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
INSTALL httpfs;
[0m01:18:20.591742 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m01:18:20.595959 [info ] [MainThread]: 1 of 9 OK hook: stock_dbt_project.on-run-start.0 ............................... [[32mOK[0m in 0.06s]
[0m01:18:20.604960 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-1"
[0m01:18:20.608297 [info ] [MainThread]: 2 of 9 START hook: stock_dbt_project.on-run-start.1 ............................ [RUN]
[0m01:18:20.611294 [debug] [MainThread]: Using duckdb connection "master"
[0m01:18:20.616374 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
INSTALL json;
[0m01:18:20.622159 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m01:18:20.626159 [info ] [MainThread]: 2 of 9 OK hook: stock_dbt_project.on-run-start.1 ............................... [[32mOK[0m in 0.02s]
[0m01:18:20.636733 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-2"
[0m01:18:20.640595 [info ] [MainThread]: 3 of 9 START hook: stock_dbt_project.on-run-start.2 ............................ [RUN]
[0m01:18:20.643552 [debug] [MainThread]: Using duckdb connection "master"
[0m01:18:20.645566 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
LOAD httpfs;
[0m01:18:21.029091 [debug] [MainThread]: SQL status: OK in 0.380 seconds
[0m01:18:21.031824 [info ] [MainThread]: 3 of 9 OK hook: stock_dbt_project.on-run-start.2 ............................... [[32mOK[0m in 0.40s]
[0m01:18:21.035819 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-3"
[0m01:18:21.037822 [info ] [MainThread]: 4 of 9 START hook: stock_dbt_project.on-run-start.3 ............................ [RUN]
[0m01:18:21.038815 [debug] [MainThread]: Using duckdb connection "master"
[0m01:18:21.040824 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
LOAD json;
[0m01:18:21.041832 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m01:18:21.043821 [info ] [MainThread]: 4 of 9 OK hook: stock_dbt_project.on-run-start.3 ............................... [[32mOK[0m in 0.01s]
[0m01:18:21.049380 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-4"
[0m01:18:21.052855 [info ] [MainThread]: 5 of 9 START hook: stock_dbt_project.on-run-start.4 ............................ [RUN]
[0m01:18:21.055076 [debug] [MainThread]: Using duckdb connection "master"
[0m01:18:21.056203 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
SET s3_access_key_id='minioadmin';
[0m01:18:21.057926 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m01:18:21.060151 [info ] [MainThread]: 5 of 9 OK hook: stock_dbt_project.on-run-start.4 ............................... [[32mOK[0m in 0.01s]
[0m01:18:21.063166 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-5"
[0m01:18:21.066167 [info ] [MainThread]: 6 of 9 START hook: stock_dbt_project.on-run-start.5 ............................ [RUN]
[0m01:18:21.068169 [debug] [MainThread]: Using duckdb connection "master"
[0m01:18:21.069166 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
SET s3_secret_access_key='minioadmin';
[0m01:18:21.071149 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m01:18:21.073157 [info ] [MainThread]: 6 of 9 OK hook: stock_dbt_project.on-run-start.5 ............................... [[32mOK[0m in 0.01s]
[0m01:18:21.076153 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-6"
[0m01:18:21.078195 [info ] [MainThread]: 7 of 9 START hook: stock_dbt_project.on-run-start.6 ............................ [RUN]
[0m01:18:21.081203 [debug] [MainThread]: Using duckdb connection "master"
[0m01:18:21.083199 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
SET s3_endpoint='http://localhost:9000';
[0m01:18:21.085387 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m01:18:21.088389 [info ] [MainThread]: 7 of 9 OK hook: stock_dbt_project.on-run-start.6 ............................... [[32mOK[0m in 0.01s]
[0m01:18:21.091390 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-7"
[0m01:18:21.093393 [info ] [MainThread]: 8 of 9 START hook: stock_dbt_project.on-run-start.7 ............................ [RUN]
[0m01:18:21.095394 [debug] [MainThread]: Using duckdb connection "master"
[0m01:18:21.096393 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
SET s3_use_ssl=false;
[0m01:18:21.099492 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m01:18:21.103477 [info ] [MainThread]: 8 of 9 OK hook: stock_dbt_project.on-run-start.7 ............................... [[32mOK[0m in 0.01s]
[0m01:18:21.108492 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-8"
[0m01:18:21.110479 [info ] [MainThread]: 9 of 9 START hook: stock_dbt_project.on-run-start.8 ............................ [RUN]
[0m01:18:21.114594 [debug] [MainThread]: Using duckdb connection "master"
[0m01:18:21.116830 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
SET s3_url_style='path';
[0m01:18:21.120648 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m01:18:21.123472 [info ] [MainThread]: 9 of 9 OK hook: stock_dbt_project.on-run-start.8 ............................... [[32mOK[0m in 0.02s]
[0m01:18:21.124558 [info ] [MainThread]: 
[0m01:18:21.126098 [debug] [MainThread]: On master: Close
[0m01:18:21.136376 [debug] [Thread-1 (]: Began running node model.stock_dbt_project.stg_stock_data
[0m01:18:21.138381 [info ] [Thread-1 (]: 1 of 1 START sql view model main.stg_stock_data ................................ [RUN]
[0m01:18:21.140779 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.stock_dbt_project.stg_stock_data'
[0m01:18:21.141796 [debug] [Thread-1 (]: Began compiling node model.stock_dbt_project.stg_stock_data
[0m01:18:21.148841 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_dbt_project.stg_stock_data"
[0m01:18:21.152828 [debug] [Thread-1 (]: Began executing node model.stock_dbt_project.stg_stock_data
[0m01:18:21.231112 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_dbt_project.stg_stock_data"
[0m01:18:21.233110 [debug] [Thread-1 (]: Using duckdb connection "model.stock_dbt_project.stg_stock_data"
[0m01:18:21.234101 [debug] [Thread-1 (]: On model.stock_dbt_project.stg_stock_data: BEGIN
[0m01:18:21.235112 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m01:18:21.237105 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m01:18:21.238110 [debug] [Thread-1 (]: Using duckdb connection "model.stock_dbt_project.stg_stock_data"
[0m01:18:21.239105 [debug] [Thread-1 (]: On model.stock_dbt_project.stg_stock_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "node_id": "model.stock_dbt_project.stg_stock_data"} */

  
  create view "dev"."main"."stg_stock_data__dbt_tmp" as (
    



WITH raw AS (
    SELECT *
    FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/CVX/2025/4/13/CVX_20250413_113945_jz58k4.json')
)

SELECT
    CAST(symbol AS TEXT) AS symbol,
    CAST(datetime AS TIMESTAMP) AS datetime,
    CAST(open AS DOUBLE) AS open,
    CAST(high AS DOUBLE) AS high,
    CAST(low AS DOUBLE) AS low,
    CAST(close AS DOUBLE) AS close,
    CAST(volume AS BIGINT) AS volume
FROM raw
WHERE symbol IS NOT NULL AND datetime IS NOT NULL
  );

[0m01:18:21.829729 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "node_id": "model.stock_dbt_project.stg_stock_data"} */

  
  create view "dev"."main"."stg_stock_data__dbt_tmp" as (
    



WITH raw AS (
    SELECT *
    FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/CVX/2025/4/13/CVX_20250413_113945_jz58k4.json')
)

SELECT
    CAST(symbol AS TEXT) AS symbol,
    CAST(datetime AS TIMESTAMP) AS datetime,
    CAST(open AS DOUBLE) AS open,
    CAST(high AS DOUBLE) AS high,
    CAST(low AS DOUBLE) AS low,
    CAST(close AS DOUBLE) AS close,
    CAST(volume AS BIGINT) AS volume
FROM raw
WHERE symbol IS NOT NULL AND datetime IS NOT NULL
  );

[0m01:18:21.830765 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m01:18:21.831798 [debug] [Thread-1 (]: On model.stock_dbt_project.stg_stock_data: ROLLBACK
[0m01:18:21.839928 [debug] [Thread-1 (]: Failed to rollback 'model.stock_dbt_project.stg_stock_data'
[0m01:18:21.841064 [debug] [Thread-1 (]: On model.stock_dbt_project.stg_stock_data: Close
[0m01:18:21.845155 [debug] [Thread-1 (]: Runtime Error in model stg_stock_data (models\staging\stg_stock_data.sql)
  HTTP Error: HTTP GET error on 'http://localhost:9000/my-stock-data-bucket/stocks/CVX/2025/4/13/CVX_20250413_113945_jz58k4.json' (HTTP 403)
[0m01:18:21.849144 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '680d4740-aaab-48ff-a0fa-aac596ae5bbe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000247F10AB980>]}
[0m01:18:21.851151 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model main.stg_stock_data ....................... [[31mERROR[0m in 0.71s]
[0m01:18:21.853142 [debug] [Thread-1 (]: Finished running node model.stock_dbt_project.stg_stock_data
[0m01:18:21.854783 [debug] [Thread-4 (]: Marking all children of 'model.stock_dbt_project.stg_stock_data' to be skipped because of status 'error'.  Reason: Runtime Error in model stg_stock_data (models\staging\stg_stock_data.sql)
  HTTP Error: HTTP GET error on 'http://localhost:9000/my-stock-data-bucket/stocks/CVX/2025/4/13/CVX_20250413_113945_jz58k4.json' (HTTP 403).
[0m01:18:21.857826 [debug] [MainThread]: Using duckdb connection "master"
[0m01:18:21.858828 [debug] [MainThread]: On master: BEGIN
[0m01:18:21.860830 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:18:21.864440 [debug] [MainThread]: SQL status: OK in 0.004 seconds
[0m01:18:21.867426 [debug] [MainThread]: On master: COMMIT
[0m01:18:21.869425 [debug] [MainThread]: Using duckdb connection "master"
[0m01:18:21.871425 [debug] [MainThread]: On master: COMMIT
[0m01:18:21.873418 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m01:18:21.874419 [debug] [MainThread]: On master: Close
[0m01:18:21.876318 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:18:21.877329 [debug] [MainThread]: Connection 'create_dev_main' was properly closed.
[0m01:18:21.878332 [debug] [MainThread]: Connection 'list_dev_main' was properly closed.
[0m01:18:21.880210 [debug] [MainThread]: Connection 'model.stock_dbt_project.stg_stock_data' was properly closed.
[0m01:18:21.883475 [info ] [MainThread]: 
[0m01:18:21.886468 [info ] [MainThread]: Finished running 9 project hooks, 1 view model in 0 hours 0 minutes and 2.15 seconds (2.15s).
[0m01:18:21.901088 [debug] [MainThread]: Command end result
[0m01:18:22.023846 [debug] [MainThread]: Wrote artifact WritableManifest to D:\Stock_price\stock_dbt_project\target\manifest.json
[0m01:18:22.032060 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\Stock_price\stock_dbt_project\target\semantic_manifest.json
[0m01:18:22.056585 [debug] [MainThread]: Wrote artifact RunExecutionResult to D:\Stock_price\stock_dbt_project\target\run_results.json
[0m01:18:22.057693 [info ] [MainThread]: 
[0m01:18:22.060226 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m01:18:22.062657 [info ] [MainThread]: 
[0m01:18:22.067979 [error] [MainThread]:   Runtime Error in model stg_stock_data (models\staging\stg_stock_data.sql)
  HTTP Error: HTTP GET error on 'http://localhost:9000/my-stock-data-bucket/stocks/CVX/2025/4/13/CVX_20250413_113945_jz58k4.json' (HTTP 403)
[0m01:18:22.071165 [info ] [MainThread]: 
[0m01:18:22.073404 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=1 SKIP=0 TOTAL=10
[0m01:18:22.077993 [debug] [MainThread]: Command `dbt run` failed at 01:18:22.077408 after 6.06 seconds
[0m01:18:22.081964 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000247F10D4740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000247F10D4F20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000247F172B260>]}
[0m01:18:22.086348 [debug] [MainThread]: Flushing usage events
[0m01:18:23.032631 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:21:37.588674 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D5F15E8560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D5F1A391F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D5F1A3A4E0>]}


============================== 01:21:37.599807 | 675eb6d2-c3a4-405c-b968-2bd274b46829 ==============================
[0m01:21:37.599807 [info ] [MainThread]: Running with dbt=1.9.4
[0m01:21:37.603320 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'D:\\Stock_price\\stock_dbt_project\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\loges\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --select stg_stock_data', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m01:21:38.094536 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '675eb6d2-c3a4-405c-b968-2bd274b46829', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D5F1BF22D0>]}
[0m01:21:38.423678 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '675eb6d2-c3a4-405c-b968-2bd274b46829', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D5F1B1B9E0>]}
[0m01:21:38.440351 [info ] [MainThread]: Registered adapter: duckdb=1.9.2
[0m01:21:39.269143 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m01:21:40.043871 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:21:40.044957 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:21:40.061279 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.stock_dbt_project.marts
[0m01:21:40.192188 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '675eb6d2-c3a4-405c-b968-2bd274b46829', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D5F1F28620>]}
[0m01:21:40.443841 [debug] [MainThread]: Wrote artifact WritableManifest to D:\Stock_price\stock_dbt_project\target\manifest.json
[0m01:21:40.450733 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\Stock_price\stock_dbt_project\target\semantic_manifest.json
[0m01:21:40.552500 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '675eb6d2-c3a4-405c-b968-2bd274b46829', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D5F32EA8A0>]}
[0m01:21:40.555459 [info ] [MainThread]: Found 4 models, 9 operations, 4 data tests, 426 macros
[0m01:21:40.557724 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '675eb6d2-c3a4-405c-b968-2bd274b46829', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D5F1E9F890>]}
[0m01:21:40.564416 [info ] [MainThread]: 
[0m01:21:40.568138 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:21:40.569866 [info ] [MainThread]: 
[0m01:21:40.572448 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m01:21:40.575442 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m01:21:40.708270 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m01:21:40.709266 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m01:21:40.710272 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:21:40.733835 [debug] [ThreadPool]: SQL status: OK in 0.023 seconds
[0m01:21:40.735851 [debug] [ThreadPool]: On list_dev: Close
[0m01:21:40.737851 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m01:21:40.739293 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m01:21:40.747583 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m01:21:40.750107 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "create_dev_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m01:21:40.750107 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:21:40.752637 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m01:21:40.754646 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m01:21:40.755661 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m01:21:40.756654 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m01:21:40.756654 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m01:21:40.757660 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "create_dev_main"} */

    
    
        create schema if not exists "dev"."main"
    
[0m01:21:40.758657 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m01:21:40.760479 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m01:21:40.761696 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m01:21:40.762768 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m01:21:40.763823 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m01:21:40.764871 [debug] [ThreadPool]: On create_dev_main: Close
[0m01:21:40.775797 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev_main'
[0m01:21:40.787479 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m01:21:40.789482 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m01:21:40.790489 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:21:40.791480 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m01:21:40.792493 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m01:21:40.792493 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m01:21:40.830080 [debug] [ThreadPool]: SQL status: OK in 0.036 seconds
[0m01:21:40.835087 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m01:21:40.840084 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m01:21:40.841084 [debug] [ThreadPool]: On list_dev_main: Close
[0m01:21:40.843216 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '675eb6d2-c3a4-405c-b968-2bd274b46829', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D5F1B9C3E0>]}
[0m01:21:40.843939 [debug] [MainThread]: Using duckdb connection "master"
[0m01:21:40.844962 [debug] [MainThread]: On master: BEGIN
[0m01:21:40.845947 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:21:40.846950 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m01:21:40.848949 [debug] [MainThread]: On master: COMMIT
[0m01:21:40.849953 [debug] [MainThread]: Using duckdb connection "master"
[0m01:21:40.850958 [debug] [MainThread]: On master: COMMIT
[0m01:21:40.852957 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m01:21:40.861996 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-0"
[0m01:21:40.874151 [info ] [MainThread]: 1 of 9 START hook: stock_dbt_project.on-run-start.0 ............................ [RUN]
[0m01:21:40.875232 [debug] [MainThread]: Using duckdb connection "master"
[0m01:21:40.875769 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
INSTALL httpfs;
[0m01:21:40.878114 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m01:21:40.880076 [info ] [MainThread]: 1 of 9 OK hook: stock_dbt_project.on-run-start.0 ............................... [[32mOK[0m in 0.03s]
[0m01:21:40.884641 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-1"
[0m01:21:40.888156 [info ] [MainThread]: 2 of 9 START hook: stock_dbt_project.on-run-start.1 ............................ [RUN]
[0m01:21:40.889168 [debug] [MainThread]: Using duckdb connection "master"
[0m01:21:40.890169 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
INSTALL json;
[0m01:21:40.894466 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m01:21:40.898854 [info ] [MainThread]: 2 of 9 OK hook: stock_dbt_project.on-run-start.1 ............................... [[32mOK[0m in 0.02s]
[0m01:21:40.907261 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-2"
[0m01:21:40.910266 [info ] [MainThread]: 3 of 9 START hook: stock_dbt_project.on-run-start.2 ............................ [RUN]
[0m01:21:40.913339 [debug] [MainThread]: Using duckdb connection "master"
[0m01:21:40.916352 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
LOAD httpfs;
[0m01:21:41.297138 [debug] [MainThread]: SQL status: OK in 0.378 seconds
[0m01:21:41.304451 [info ] [MainThread]: 3 of 9 OK hook: stock_dbt_project.on-run-start.2 ............................... [[32mOK[0m in 0.40s]
[0m01:21:41.313096 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-3"
[0m01:21:41.319386 [info ] [MainThread]: 4 of 9 START hook: stock_dbt_project.on-run-start.3 ............................ [RUN]
[0m01:21:41.322636 [debug] [MainThread]: Using duckdb connection "master"
[0m01:21:41.325350 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
LOAD json;
[0m01:21:41.328829 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m01:21:41.337618 [info ] [MainThread]: 4 of 9 OK hook: stock_dbt_project.on-run-start.3 ............................... [[32mOK[0m in 0.03s]
[0m01:21:41.345725 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-4"
[0m01:21:41.352654 [info ] [MainThread]: 5 of 9 START hook: stock_dbt_project.on-run-start.4 ............................ [RUN]
[0m01:21:41.356647 [debug] [MainThread]: Using duckdb connection "master"
[0m01:21:41.359648 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
SET s3_access_key_id='minioadmin';
[0m01:21:41.363277 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m01:21:41.368438 [info ] [MainThread]: 5 of 9 OK hook: stock_dbt_project.on-run-start.4 ............................... [[32mOK[0m in 0.03s]
[0m01:21:41.376606 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-5"
[0m01:21:41.379662 [info ] [MainThread]: 6 of 9 START hook: stock_dbt_project.on-run-start.5 ............................ [RUN]
[0m01:21:41.382672 [debug] [MainThread]: Using duckdb connection "master"
[0m01:21:41.385666 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
SET s3_secret_access_key='minioadmin';
[0m01:21:41.388664 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m01:21:41.393356 [info ] [MainThread]: 6 of 9 OK hook: stock_dbt_project.on-run-start.5 ............................... [[32mOK[0m in 0.02s]
[0m01:21:41.402254 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-6"
[0m01:21:41.406970 [info ] [MainThread]: 7 of 9 START hook: stock_dbt_project.on-run-start.6 ............................ [RUN]
[0m01:21:41.410077 [debug] [MainThread]: Using duckdb connection "master"
[0m01:21:41.411073 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
SET s3_endpoint='http://localhost:9000';
[0m01:21:41.413069 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m01:21:41.420511 [info ] [MainThread]: 7 of 9 OK hook: stock_dbt_project.on-run-start.6 ............................... [[32mOK[0m in 0.02s]
[0m01:21:41.426501 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-7"
[0m01:21:41.428505 [info ] [MainThread]: 8 of 9 START hook: stock_dbt_project.on-run-start.7 ............................ [RUN]
[0m01:21:41.434260 [debug] [MainThread]: Using duckdb connection "master"
[0m01:21:41.437255 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
SET s3_use_ssl=false;
[0m01:21:41.440325 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m01:21:41.443367 [info ] [MainThread]: 8 of 9 OK hook: stock_dbt_project.on-run-start.7 ............................... [[32mOK[0m in 0.02s]
[0m01:21:41.453372 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-8"
[0m01:21:41.456901 [info ] [MainThread]: 9 of 9 START hook: stock_dbt_project.on-run-start.8 ............................ [RUN]
[0m01:21:41.459110 [debug] [MainThread]: Using duckdb connection "master"
[0m01:21:41.460783 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
SET s3_url_style='path';
[0m01:21:41.463109 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m01:21:41.470990 [info ] [MainThread]: 9 of 9 OK hook: stock_dbt_project.on-run-start.8 ............................... [[32mOK[0m in 0.02s]
[0m01:21:41.474597 [info ] [MainThread]: 
[0m01:21:41.476606 [debug] [MainThread]: On master: Close
[0m01:21:41.496637 [debug] [Thread-1 (]: Began running node model.stock_dbt_project.stg_stock_data
[0m01:21:41.502727 [info ] [Thread-1 (]: 1 of 1 START sql view model main.stg_stock_data ................................ [RUN]
[0m01:21:41.507389 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.stock_dbt_project.stg_stock_data'
[0m01:21:41.509833 [debug] [Thread-1 (]: Began compiling node model.stock_dbt_project.stg_stock_data
[0m01:21:41.523922 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_dbt_project.stg_stock_data"
[0m01:21:41.526925 [debug] [Thread-1 (]: Began executing node model.stock_dbt_project.stg_stock_data
[0m01:21:41.642837 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_dbt_project.stg_stock_data"
[0m01:21:41.645834 [debug] [Thread-1 (]: Using duckdb connection "model.stock_dbt_project.stg_stock_data"
[0m01:21:41.646842 [debug] [Thread-1 (]: On model.stock_dbt_project.stg_stock_data: BEGIN
[0m01:21:41.650172 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m01:21:41.653178 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m01:21:41.655174 [debug] [Thread-1 (]: Using duckdb connection "model.stock_dbt_project.stg_stock_data"
[0m01:21:41.656175 [debug] [Thread-1 (]: On model.stock_dbt_project.stg_stock_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "node_id": "model.stock_dbt_project.stg_stock_data"} */

  
  create view "dev"."main"."stg_stock_data__dbt_tmp" as (
    



WITH raw AS (
    SELECT *
    FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/CVX/2025/4/13/CVX_20250413_113945_jz58k4.json')
)

SELECT
    CAST(symbol AS TEXT) AS symbol,
    CAST(datetime AS TIMESTAMP) AS datetime,
    CAST(open AS DOUBLE) AS open,
    CAST(high AS DOUBLE) AS high,
    CAST(low AS DOUBLE) AS low,
    CAST(close AS DOUBLE) AS close,
    CAST(volume AS BIGINT) AS volume
FROM raw
WHERE symbol IS NOT NULL AND datetime IS NOT NULL
  );

[0m01:21:41.697955 [debug] [Thread-1 (]: SQL status: OK in 0.039 seconds
[0m01:21:41.722641 [debug] [Thread-1 (]: Using duckdb connection "model.stock_dbt_project.stg_stock_data"
[0m01:21:41.724642 [debug] [Thread-1 (]: On model.stock_dbt_project.stg_stock_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "node_id": "model.stock_dbt_project.stg_stock_data"} */
alter view "dev"."main"."stg_stock_data__dbt_tmp" rename to "stg_stock_data"
[0m01:21:41.728220 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m01:21:41.764165 [debug] [Thread-1 (]: On model.stock_dbt_project.stg_stock_data: COMMIT
[0m01:21:41.766699 [debug] [Thread-1 (]: Using duckdb connection "model.stock_dbt_project.stg_stock_data"
[0m01:21:41.768722 [debug] [Thread-1 (]: On model.stock_dbt_project.stg_stock_data: COMMIT
[0m01:21:41.774165 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m01:21:41.786715 [debug] [Thread-1 (]: Using duckdb connection "model.stock_dbt_project.stg_stock_data"
[0m01:21:41.787817 [debug] [Thread-1 (]: On model.stock_dbt_project.stg_stock_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "node_id": "model.stock_dbt_project.stg_stock_data"} */
drop view if exists "dev"."main"."stg_stock_data__dbt_backup" cascade
[0m01:21:41.789594 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:21:41.794113 [debug] [Thread-1 (]: On model.stock_dbt_project.stg_stock_data: Close
[0m01:21:41.800470 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '675eb6d2-c3a4-405c-b968-2bd274b46829', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D5EE907F20>]}
[0m01:21:41.802471 [info ] [Thread-1 (]: 1 of 1 OK created sql view model main.stg_stock_data ........................... [[32mOK[0m in 0.29s]
[0m01:21:41.805478 [debug] [Thread-1 (]: Finished running node model.stock_dbt_project.stg_stock_data
[0m01:21:41.807352 [debug] [MainThread]: Using duckdb connection "master"
[0m01:21:41.809106 [debug] [MainThread]: On master: BEGIN
[0m01:21:41.809450 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:21:41.810506 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m01:21:41.811495 [debug] [MainThread]: On master: COMMIT
[0m01:21:41.812501 [debug] [MainThread]: Using duckdb connection "master"
[0m01:21:41.812501 [debug] [MainThread]: On master: COMMIT
[0m01:21:41.813503 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m01:21:41.814884 [debug] [MainThread]: On master: Close
[0m01:21:41.816896 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:21:41.817903 [debug] [MainThread]: Connection 'create_dev_main' was properly closed.
[0m01:21:41.818899 [debug] [MainThread]: Connection 'list_dev_main' was properly closed.
[0m01:21:41.819892 [debug] [MainThread]: Connection 'model.stock_dbt_project.stg_stock_data' was properly closed.
[0m01:21:41.819892 [info ] [MainThread]: 
[0m01:21:41.821893 [info ] [MainThread]: Finished running 9 project hooks, 1 view model in 0 hours 0 minutes and 1.25 seconds (1.25s).
[0m01:21:41.825902 [debug] [MainThread]: Command end result
[0m01:21:41.889266 [debug] [MainThread]: Wrote artifact WritableManifest to D:\Stock_price\stock_dbt_project\target\manifest.json
[0m01:21:41.895094 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\Stock_price\stock_dbt_project\target\semantic_manifest.json
[0m01:21:41.912597 [debug] [MainThread]: Wrote artifact RunExecutionResult to D:\Stock_price\stock_dbt_project\target\run_results.json
[0m01:21:41.914041 [info ] [MainThread]: 
[0m01:21:41.916329 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:21:41.918618 [info ] [MainThread]: 
[0m01:21:41.920828 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=0 SKIP=0 TOTAL=10
[0m01:21:41.923022 [debug] [MainThread]: Command `dbt run` succeeded at 01:21:41.923022 after 4.69 seconds
[0m01:21:41.923566 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D5F1B6F9E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D5F16B7980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D5F16B68D0>]}
[0m01:21:41.925575 [debug] [MainThread]: Flushing usage events
[0m01:21:42.710410 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:23:06.716767 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002078D666540>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002078DEB9CA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002078E10CF50>]}


============================== 01:23:06.723907 | 0ee4a103-a9d4-4f67-a724-df71c3913fa3 ==============================
[0m01:23:06.723907 [info ] [MainThread]: Running with dbt=1.9.4
[0m01:23:06.724900 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\loges\\.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'D:\\Stock_price\\stock_dbt_project\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select stg_stock_data', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m01:23:07.133476 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0ee4a103-a9d4-4f67-a724-df71c3913fa3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002078E6E9130>]}
[0m01:23:07.232533 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0ee4a103-a9d4-4f67-a724-df71c3913fa3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002078E76DD00>]}
[0m01:23:07.239733 [info ] [MainThread]: Registered adapter: duckdb=1.9.2
[0m01:23:07.677597 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m01:23:08.069580 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:23:08.071604 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:23:08.110882 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.stock_dbt_project.marts
[0m01:23:08.286432 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0ee4a103-a9d4-4f67-a724-df71c3913fa3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002078E69FAA0>]}
[0m01:23:08.475340 [debug] [MainThread]: Wrote artifact WritableManifest to D:\Stock_price\stock_dbt_project\target\manifest.json
[0m01:23:08.479339 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\Stock_price\stock_dbt_project\target\semantic_manifest.json
[0m01:23:08.542059 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0ee4a103-a9d4-4f67-a724-df71c3913fa3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002078FA64110>]}
[0m01:23:08.544193 [info ] [MainThread]: Found 4 models, 9 operations, 4 data tests, 426 macros
[0m01:23:08.546741 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0ee4a103-a9d4-4f67-a724-df71c3913fa3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002078E632540>]}
[0m01:23:08.554362 [info ] [MainThread]: 
[0m01:23:08.556577 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:23:08.558797 [info ] [MainThread]: 
[0m01:23:08.562010 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m01:23:08.574611 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m01:23:09.026055 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m01:23:09.028052 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m01:23:09.030571 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:23:09.150797 [debug] [ThreadPool]: SQL status: OK in 0.120 seconds
[0m01:23:09.158676 [debug] [ThreadPool]: On list_dev: Close
[0m01:23:09.162850 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m01:23:09.168615 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m01:23:09.204272 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m01:23:09.206820 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "create_dev_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m01:23:09.210781 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:23:09.225710 [debug] [ThreadPool]: SQL status: OK in 0.014 seconds
[0m01:23:09.239080 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m01:23:09.242362 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m01:23:09.246503 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m01:23:09.249430 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m01:23:09.252194 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "create_dev_main"} */

    
    
        create schema if not exists "dev"."main"
    
[0m01:23:09.255268 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m01:23:09.259671 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m01:23:09.260809 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m01:23:09.261800 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m01:23:09.263804 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m01:23:09.268019 [debug] [ThreadPool]: On create_dev_main: Close
[0m01:23:09.289242 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev_main'
[0m01:23:09.315488 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m01:23:09.319530 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m01:23:09.321004 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:23:09.324306 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m01:23:09.325238 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m01:23:09.326255 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m01:23:09.408382 [debug] [ThreadPool]: SQL status: OK in 0.081 seconds
[0m01:23:09.417521 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m01:23:09.424924 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m01:23:09.427828 [debug] [ThreadPool]: On list_dev_main: Close
[0m01:23:09.437557 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0ee4a103-a9d4-4f67-a724-df71c3913fa3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002078FA65AC0>]}
[0m01:23:09.441611 [debug] [MainThread]: Using duckdb connection "master"
[0m01:23:09.444387 [debug] [MainThread]: On master: BEGIN
[0m01:23:09.447170 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:23:09.450974 [debug] [MainThread]: SQL status: OK in 0.004 seconds
[0m01:23:09.454107 [debug] [MainThread]: On master: COMMIT
[0m01:23:09.456719 [debug] [MainThread]: Using duckdb connection "master"
[0m01:23:09.457790 [debug] [MainThread]: On master: COMMIT
[0m01:23:09.460988 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m01:23:09.483355 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-0"
[0m01:23:09.500154 [info ] [MainThread]: 1 of 9 START hook: stock_dbt_project.on-run-start.0 ............................ [RUN]
[0m01:23:09.503841 [debug] [MainThread]: Using duckdb connection "master"
[0m01:23:09.505759 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
INSTALL httpfs;
[0m01:23:09.509868 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m01:23:09.515202 [info ] [MainThread]: 1 of 9 OK hook: stock_dbt_project.on-run-start.0 ............................... [[32mOK[0m in 0.05s]
[0m01:23:09.523798 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-1"
[0m01:23:09.527795 [info ] [MainThread]: 2 of 9 START hook: stock_dbt_project.on-run-start.1 ............................ [RUN]
[0m01:23:09.531037 [debug] [MainThread]: Using duckdb connection "master"
[0m01:23:09.534039 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
INSTALL json;
[0m01:23:09.539040 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m01:23:09.543035 [info ] [MainThread]: 2 of 9 OK hook: stock_dbt_project.on-run-start.1 ............................... [[32mOK[0m in 0.02s]
[0m01:23:09.552861 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-2"
[0m01:23:09.556788 [info ] [MainThread]: 3 of 9 START hook: stock_dbt_project.on-run-start.2 ............................ [RUN]
[0m01:23:09.560057 [debug] [MainThread]: Using duckdb connection "master"
[0m01:23:09.561690 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
LOAD httpfs;
[0m01:23:09.994202 [debug] [MainThread]: SQL status: OK in 0.431 seconds
[0m01:23:10.002581 [info ] [MainThread]: 3 of 9 OK hook: stock_dbt_project.on-run-start.2 ............................... [[32mOK[0m in 0.45s]
[0m01:23:10.011046 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-3"
[0m01:23:10.016220 [info ] [MainThread]: 4 of 9 START hook: stock_dbt_project.on-run-start.3 ............................ [RUN]
[0m01:23:10.020639 [debug] [MainThread]: Using duckdb connection "master"
[0m01:23:10.023657 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
LOAD json;
[0m01:23:10.026778 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m01:23:10.032037 [info ] [MainThread]: 4 of 9 OK hook: stock_dbt_project.on-run-start.3 ............................... [[32mOK[0m in 0.03s]
[0m01:23:10.044536 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-4"
[0m01:23:10.052859 [info ] [MainThread]: 5 of 9 START hook: stock_dbt_project.on-run-start.4 ............................ [RUN]
[0m01:23:10.057431 [debug] [MainThread]: Using duckdb connection "master"
[0m01:23:10.060426 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
SET s3_access_key_id='minioadmin';
[0m01:23:10.067276 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m01:23:10.074270 [info ] [MainThread]: 5 of 9 OK hook: stock_dbt_project.on-run-start.4 ............................... [[32mOK[0m in 0.04s]
[0m01:23:10.088795 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-5"
[0m01:23:10.096857 [info ] [MainThread]: 6 of 9 START hook: stock_dbt_project.on-run-start.5 ............................ [RUN]
[0m01:23:10.113299 [debug] [MainThread]: Using duckdb connection "master"
[0m01:23:10.121954 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
SET s3_secret_access_key='minioadmin';
[0m01:23:10.129022 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m01:23:10.141222 [info ] [MainThread]: 6 of 9 OK hook: stock_dbt_project.on-run-start.5 ............................... [[32mOK[0m in 0.06s]
[0m01:23:10.156112 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-6"
[0m01:23:10.162372 [info ] [MainThread]: 7 of 9 START hook: stock_dbt_project.on-run-start.6 ............................ [RUN]
[0m01:23:10.172041 [debug] [MainThread]: Using duckdb connection "master"
[0m01:23:10.176910 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
SET s3_endpoint='http://localhost:9000';
[0m01:23:10.180768 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m01:23:10.191017 [info ] [MainThread]: 7 of 9 OK hook: stock_dbt_project.on-run-start.6 ............................... [[32mOK[0m in 0.04s]
[0m01:23:10.204933 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-7"
[0m01:23:10.211835 [info ] [MainThread]: 8 of 9 START hook: stock_dbt_project.on-run-start.7 ............................ [RUN]
[0m01:23:10.217622 [debug] [MainThread]: Using duckdb connection "master"
[0m01:23:10.228685 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
SET s3_use_ssl=false;
[0m01:23:10.239259 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m01:23:10.246624 [info ] [MainThread]: 8 of 9 OK hook: stock_dbt_project.on-run-start.7 ............................... [[32mOK[0m in 0.05s]
[0m01:23:10.264220 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-8"
[0m01:23:10.273553 [info ] [MainThread]: 9 of 9 START hook: stock_dbt_project.on-run-start.8 ............................ [RUN]
[0m01:23:10.278886 [debug] [MainThread]: Using duckdb connection "master"
[0m01:23:10.281392 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
SET s3_url_style='path';
[0m01:23:10.285554 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m01:23:10.291827 [info ] [MainThread]: 9 of 9 OK hook: stock_dbt_project.on-run-start.8 ............................... [[32mOK[0m in 0.04s]
[0m01:23:10.296026 [info ] [MainThread]: 
[0m01:23:10.299130 [debug] [MainThread]: On master: Close
[0m01:23:10.331878 [debug] [Thread-1 (]: Began running node model.stock_dbt_project.stg_stock_data
[0m01:23:10.336346 [info ] [Thread-1 (]: 1 of 1 START sql view model main.stg_stock_data ................................ [RUN]
[0m01:23:10.342426 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.stock_dbt_project.stg_stock_data'
[0m01:23:10.345498 [debug] [Thread-1 (]: Began compiling node model.stock_dbt_project.stg_stock_data
[0m01:23:10.361922 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_dbt_project.stg_stock_data"
[0m01:23:10.371373 [debug] [Thread-1 (]: Began executing node model.stock_dbt_project.stg_stock_data
[0m01:23:10.652888 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_dbt_project.stg_stock_data"
[0m01:23:10.657816 [debug] [Thread-1 (]: Using duckdb connection "model.stock_dbt_project.stg_stock_data"
[0m01:23:10.661440 [debug] [Thread-1 (]: On model.stock_dbt_project.stg_stock_data: BEGIN
[0m01:23:10.663791 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m01:23:10.675860 [debug] [Thread-1 (]: SQL status: OK in 0.012 seconds
[0m01:23:10.679288 [debug] [Thread-1 (]: Using duckdb connection "model.stock_dbt_project.stg_stock_data"
[0m01:23:10.681937 [debug] [Thread-1 (]: On model.stock_dbt_project.stg_stock_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "node_id": "model.stock_dbt_project.stg_stock_data"} */

  
  create view "dev"."main"."stg_stock_data__dbt_tmp" as (
    



WITH raw AS (
    SELECT *
    FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/CVX/2025/4/13/CVX_20250413_113945_jz58k4.json')
)

SELECT
    CAST(symbol AS TEXT) AS symbol,
    CAST(datetime AS TIMESTAMP) AS datetime,
    CAST(open AS DOUBLE) AS open,
    CAST(high AS DOUBLE) AS high,
    CAST(low AS DOUBLE) AS low,
    CAST(close AS DOUBLE) AS close,
    CAST(volume AS BIGINT) AS volume
FROM raw
WHERE symbol IS NOT NULL AND datetime IS NOT NULL
  );

[0m01:23:10.743853 [debug] [Thread-1 (]: SQL status: OK in 0.059 seconds
[0m01:23:10.782411 [debug] [Thread-1 (]: Using duckdb connection "model.stock_dbt_project.stg_stock_data"
[0m01:23:10.786541 [debug] [Thread-1 (]: On model.stock_dbt_project.stg_stock_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "node_id": "model.stock_dbt_project.stg_stock_data"} */
alter view "dev"."main"."stg_stock_data" rename to "stg_stock_data__dbt_backup"
[0m01:23:10.793471 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m01:23:10.815709 [debug] [Thread-1 (]: Using duckdb connection "model.stock_dbt_project.stg_stock_data"
[0m01:23:10.819548 [debug] [Thread-1 (]: On model.stock_dbt_project.stg_stock_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "node_id": "model.stock_dbt_project.stg_stock_data"} */
alter view "dev"."main"."stg_stock_data__dbt_tmp" rename to "stg_stock_data"
[0m01:23:10.825191 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:23:10.908433 [debug] [Thread-1 (]: On model.stock_dbt_project.stg_stock_data: COMMIT
[0m01:23:10.911273 [debug] [Thread-1 (]: Using duckdb connection "model.stock_dbt_project.stg_stock_data"
[0m01:23:10.914316 [debug] [Thread-1 (]: On model.stock_dbt_project.stg_stock_data: COMMIT
[0m01:23:10.924956 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m01:23:10.954326 [debug] [Thread-1 (]: Using duckdb connection "model.stock_dbt_project.stg_stock_data"
[0m01:23:10.957345 [debug] [Thread-1 (]: On model.stock_dbt_project.stg_stock_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "node_id": "model.stock_dbt_project.stg_stock_data"} */
drop view if exists "dev"."main"."stg_stock_data__dbt_backup" cascade
[0m01:23:10.962735 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m01:23:10.975755 [debug] [Thread-1 (]: On model.stock_dbt_project.stg_stock_data: Close
[0m01:23:10.989125 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0ee4a103-a9d4-4f67-a724-df71c3913fa3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020790378560>]}
[0m01:23:10.993508 [info ] [Thread-1 (]: 1 of 1 OK created sql view model main.stg_stock_data ........................... [[32mOK[0m in 0.64s]
[0m01:23:10.997674 [debug] [Thread-1 (]: Finished running node model.stock_dbt_project.stg_stock_data
[0m01:23:11.006801 [debug] [MainThread]: Using duckdb connection "master"
[0m01:23:11.010194 [debug] [MainThread]: On master: BEGIN
[0m01:23:11.012734 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:23:11.017839 [debug] [MainThread]: SQL status: OK in 0.006 seconds
[0m01:23:11.022915 [debug] [MainThread]: On master: COMMIT
[0m01:23:11.024951 [debug] [MainThread]: Using duckdb connection "master"
[0m01:23:11.028942 [debug] [MainThread]: On master: COMMIT
[0m01:23:11.033485 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m01:23:11.037022 [debug] [MainThread]: On master: Close
[0m01:23:11.040780 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:23:11.044814 [debug] [MainThread]: Connection 'create_dev_main' was properly closed.
[0m01:23:11.047811 [debug] [MainThread]: Connection 'list_dev_main' was properly closed.
[0m01:23:11.058164 [debug] [MainThread]: Connection 'model.stock_dbt_project.stg_stock_data' was properly closed.
[0m01:23:11.061149 [info ] [MainThread]: 
[0m01:23:11.069994 [info ] [MainThread]: Finished running 9 project hooks, 1 view model in 0 hours 0 minutes and 2.50 seconds (2.50s).
[0m01:23:11.089830 [debug] [MainThread]: Command end result
[0m01:23:11.204975 [debug] [MainThread]: Wrote artifact WritableManifest to D:\Stock_price\stock_dbt_project\target\manifest.json
[0m01:23:11.212503 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\Stock_price\stock_dbt_project\target\semantic_manifest.json
[0m01:23:11.234345 [debug] [MainThread]: Wrote artifact RunExecutionResult to D:\Stock_price\stock_dbt_project\target\run_results.json
[0m01:23:11.237361 [info ] [MainThread]: 
[0m01:23:11.238914 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:23:11.241132 [info ] [MainThread]: 
[0m01:23:11.242914 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=0 SKIP=0 TOTAL=10
[0m01:23:11.246708 [debug] [MainThread]: Command `dbt run` succeeded at 01:23:11.246587 after 4.80 seconds
[0m01:23:11.247721 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002078E5292B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002078E529F10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002078E5292E0>]}
[0m01:23:11.251557 [debug] [MainThread]: Flushing usage events
[0m01:23:12.148281 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:29:13.699264 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFF67ED970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFF6B97200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFF6A5F260>]}


============================== 01:29:13.709950 | 4c2f1039-efc5-47f9-bcf8-ef834a9d455a ==============================
[0m01:29:13.709950 [info ] [MainThread]: Running with dbt=1.9.4
[0m01:29:13.710940 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\loges\\.dbt', 'log_path': 'D:\\Stock_price\\stock_dbt_project\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --select stg_stock_data', 'send_anonymous_usage_stats': 'True'}
[0m01:29:14.477969 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4c2f1039-efc5-47f9-bcf8-ef834a9d455a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFF725A930>]}
[0m01:29:14.656900 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4c2f1039-efc5-47f9-bcf8-ef834a9d455a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFF4C30B30>]}
[0m01:29:14.665859 [info ] [MainThread]: Registered adapter: duckdb=1.9.2
[0m01:29:15.315843 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m01:29:15.695476 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m01:29:15.695476 [debug] [MainThread]: Partial parsing: updated file: stock_dbt_project://models\staging\stg_stock_data.sql
[0m01:29:16.580977 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.stock_dbt_project.marts
[0m01:29:16.598840 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4c2f1039-efc5-47f9-bcf8-ef834a9d455a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFF8B0DE50>]}
[0m01:29:16.879197 [debug] [MainThread]: Wrote artifact WritableManifest to D:\Stock_price\stock_dbt_project\target\manifest.json
[0m01:29:16.888222 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\Stock_price\stock_dbt_project\target\semantic_manifest.json
[0m01:29:17.003757 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4c2f1039-efc5-47f9-bcf8-ef834a9d455a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFF87EFE30>]}
[0m01:29:17.008940 [info ] [MainThread]: Found 4 models, 9 operations, 4 data tests, 426 macros
[0m01:29:17.012730 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4c2f1039-efc5-47f9-bcf8-ef834a9d455a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFF8809610>]}
[0m01:29:17.023187 [info ] [MainThread]: 
[0m01:29:17.028203 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:29:17.032449 [info ] [MainThread]: 
[0m01:29:17.039018 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m01:29:17.046198 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m01:29:17.412346 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m01:29:17.412346 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m01:29:17.412346 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:29:17.462541 [debug] [ThreadPool]: SQL status: OK in 0.050 seconds
[0m01:29:17.462541 [debug] [ThreadPool]: On list_dev: Close
[0m01:29:17.462541 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m01:29:17.462541 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m01:29:17.481738 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m01:29:17.481738 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "create_dev_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m01:29:17.481738 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:29:17.481738 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m01:29:17.488729 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m01:29:17.489746 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m01:29:17.490749 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m01:29:17.491805 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m01:29:17.492319 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "create_dev_main"} */

    
    
        create schema if not exists "dev"."main"
    
[0m01:29:17.493345 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m01:29:17.494634 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m01:29:17.495635 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m01:29:17.496605 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m01:29:17.497200 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m01:29:17.497200 [debug] [ThreadPool]: On create_dev_main: Close
[0m01:29:17.507409 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev_main'
[0m01:29:17.510494 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m01:29:17.510494 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m01:29:17.510494 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:29:17.523505 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m01:29:17.524534 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m01:29:17.526147 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m01:29:17.562213 [debug] [ThreadPool]: SQL status: OK in 0.035 seconds
[0m01:29:17.564948 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m01:29:17.564948 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m01:29:17.564948 [debug] [ThreadPool]: On list_dev_main: Close
[0m01:29:17.574840 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4c2f1039-efc5-47f9-bcf8-ef834a9d455a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFF411A9C0>]}
[0m01:29:17.575831 [debug] [MainThread]: Using duckdb connection "master"
[0m01:29:17.576842 [debug] [MainThread]: On master: BEGIN
[0m01:29:17.577838 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:29:17.579167 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m01:29:17.579637 [debug] [MainThread]: On master: COMMIT
[0m01:29:17.579637 [debug] [MainThread]: Using duckdb connection "master"
[0m01:29:17.579637 [debug] [MainThread]: On master: COMMIT
[0m01:29:17.579637 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m01:29:17.594315 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-0"
[0m01:29:17.594315 [info ] [MainThread]: 1 of 9 START hook: stock_dbt_project.on-run-start.0 ............................ [RUN]
[0m01:29:17.607684 [debug] [MainThread]: Using duckdb connection "master"
[0m01:29:17.608692 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
INSTALL httpfs;
[0m01:29:17.609695 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m01:29:17.612475 [info ] [MainThread]: 1 of 9 OK hook: stock_dbt_project.on-run-start.0 ............................... [[32mOK[0m in 0.03s]
[0m01:29:17.615592 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-1"
[0m01:29:17.618123 [info ] [MainThread]: 2 of 9 START hook: stock_dbt_project.on-run-start.1 ............................ [RUN]
[0m01:29:17.621668 [debug] [MainThread]: Using duckdb connection "master"
[0m01:29:17.623662 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
INSTALL json;
[0m01:29:17.625959 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m01:29:17.628314 [info ] [MainThread]: 2 of 9 OK hook: stock_dbt_project.on-run-start.1 ............................... [[32mOK[0m in 0.01s]
[0m01:29:17.632623 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-2"
[0m01:29:17.633613 [info ] [MainThread]: 3 of 9 START hook: stock_dbt_project.on-run-start.2 ............................ [RUN]
[0m01:29:17.636106 [debug] [MainThread]: Using duckdb connection "master"
[0m01:29:17.639260 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
LOAD httpfs;
[0m01:29:17.954796 [debug] [MainThread]: SQL status: OK in 0.313 seconds
[0m01:29:17.959645 [info ] [MainThread]: 3 of 9 OK hook: stock_dbt_project.on-run-start.2 ............................... [[32mOK[0m in 0.33s]
[0m01:29:17.962660 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-3"
[0m01:29:17.962660 [info ] [MainThread]: 4 of 9 START hook: stock_dbt_project.on-run-start.3 ............................ [RUN]
[0m01:29:17.972978 [debug] [MainThread]: Using duckdb connection "master"
[0m01:29:17.974996 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
LOAD json;
[0m01:29:17.977665 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m01:29:17.981907 [info ] [MainThread]: 4 of 9 OK hook: stock_dbt_project.on-run-start.3 ............................... [[32mOK[0m in 0.02s]
[0m01:29:17.991051 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-4"
[0m01:29:17.994377 [info ] [MainThread]: 5 of 9 START hook: stock_dbt_project.on-run-start.4 ............................ [RUN]
[0m01:29:17.995119 [debug] [MainThread]: Using duckdb connection "master"
[0m01:29:17.995119 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
SET s3_access_key_id='minioadmin';
[0m01:29:17.995119 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m01:29:18.005371 [info ] [MainThread]: 5 of 9 OK hook: stock_dbt_project.on-run-start.4 ............................... [[32mOK[0m in 0.02s]
[0m01:29:18.012029 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-5"
[0m01:29:18.014666 [info ] [MainThread]: 6 of 9 START hook: stock_dbt_project.on-run-start.5 ............................ [RUN]
[0m01:29:18.018531 [debug] [MainThread]: Using duckdb connection "master"
[0m01:29:18.021526 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
SET s3_secret_access_key='minioadmin';
[0m01:29:18.025132 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m01:29:18.029806 [info ] [MainThread]: 6 of 9 OK hook: stock_dbt_project.on-run-start.5 ............................... [[32mOK[0m in 0.02s]
[0m01:29:18.038059 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-6"
[0m01:29:18.042701 [info ] [MainThread]: 7 of 9 START hook: stock_dbt_project.on-run-start.6 ............................ [RUN]
[0m01:29:18.046312 [debug] [MainThread]: Using duckdb connection "master"
[0m01:29:18.048336 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
SET s3_endpoint='http://localhost:9000';
[0m01:29:18.051222 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m01:29:18.060480 [info ] [MainThread]: 7 of 9 OK hook: stock_dbt_project.on-run-start.6 ............................... [[32mOK[0m in 0.03s]
[0m01:29:18.070655 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-7"
[0m01:29:18.077120 [info ] [MainThread]: 8 of 9 START hook: stock_dbt_project.on-run-start.7 ............................ [RUN]
[0m01:29:18.080790 [debug] [MainThread]: Using duckdb connection "master"
[0m01:29:18.082885 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
SET s3_use_ssl=false;
[0m01:29:18.086838 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m01:29:18.093512 [info ] [MainThread]: 8 of 9 OK hook: stock_dbt_project.on-run-start.7 ............................... [[32mOK[0m in 0.03s]
[0m01:29:18.101619 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-8"
[0m01:29:18.109898 [info ] [MainThread]: 9 of 9 START hook: stock_dbt_project.on-run-start.8 ............................ [RUN]
[0m01:29:18.113612 [debug] [MainThread]: Using duckdb connection "master"
[0m01:29:18.116141 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
SET s3_url_style='path';
[0m01:29:18.119231 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m01:29:18.127230 [info ] [MainThread]: 9 of 9 OK hook: stock_dbt_project.on-run-start.8 ............................... [[32mOK[0m in 0.03s]
[0m01:29:18.130368 [info ] [MainThread]: 
[0m01:29:18.133384 [debug] [MainThread]: On master: Close
[0m01:29:18.150756 [debug] [Thread-1 (]: Began running node model.stock_dbt_project.stg_stock_data
[0m01:29:18.156377 [info ] [Thread-1 (]: 1 of 1 START sql view model main.stg_stock_data ................................ [RUN]
[0m01:29:18.160735 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.stock_dbt_project.stg_stock_data'
[0m01:29:18.163407 [debug] [Thread-1 (]: Began compiling node model.stock_dbt_project.stg_stock_data
[0m01:29:18.175778 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_dbt_project.stg_stock_data"
[0m01:29:18.179846 [debug] [Thread-1 (]: Began executing node model.stock_dbt_project.stg_stock_data
[0m01:29:18.310907 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_dbt_project.stg_stock_data"
[0m01:29:18.314331 [debug] [Thread-1 (]: Using duckdb connection "model.stock_dbt_project.stg_stock_data"
[0m01:29:18.316059 [debug] [Thread-1 (]: On model.stock_dbt_project.stg_stock_data: BEGIN
[0m01:29:18.317696 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m01:29:18.323132 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m01:29:18.325334 [debug] [Thread-1 (]: Using duckdb connection "model.stock_dbt_project.stg_stock_data"
[0m01:29:18.326795 [debug] [Thread-1 (]: On model.stock_dbt_project.stg_stock_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "node_id": "model.stock_dbt_project.stg_stock_data"} */

  
  create view "dev"."main"."stg_stock_data__dbt_tmp" as (
    



WITH raw AS (
    SELECT *
    FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/*/*/*/*/*.json')
)

SELECT
    CAST(symbol AS TEXT) AS symbol,
    CAST(datetime AS TIMESTAMP) AS datetime,
    CAST(open AS DOUBLE) AS open,
    CAST(high AS DOUBLE) AS high,
    CAST(low AS DOUBLE) AS low,
    CAST(close AS DOUBLE) AS close,
    CAST(volume AS BIGINT) AS volume
FROM raw
WHERE symbol IS NOT NULL AND datetime IS NOT NULL
  );

[0m01:29:18.343615 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "node_id": "model.stock_dbt_project.stg_stock_data"} */

  
  create view "dev"."main"."stg_stock_data__dbt_tmp" as (
    



WITH raw AS (
    SELECT *
    FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/*/*/*/*/*.json')
)

SELECT
    CAST(symbol AS TEXT) AS symbol,
    CAST(datetime AS TIMESTAMP) AS datetime,
    CAST(open AS DOUBLE) AS open,
    CAST(high AS DOUBLE) AS high,
    CAST(low AS DOUBLE) AS low,
    CAST(close AS DOUBLE) AS close,
    CAST(volume AS BIGINT) AS volume
FROM raw
WHERE symbol IS NOT NULL AND datetime IS NOT NULL
  );

[0m01:29:18.345808 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m01:29:18.347772 [debug] [Thread-1 (]: On model.stock_dbt_project.stg_stock_data: ROLLBACK
[0m01:29:18.362861 [debug] [Thread-1 (]: Failed to rollback 'model.stock_dbt_project.stg_stock_data'
[0m01:29:18.362861 [debug] [Thread-1 (]: On model.stock_dbt_project.stg_stock_data: Close
[0m01:29:18.370903 [debug] [Thread-1 (]: Runtime Error in model stg_stock_data (models\staging\stg_stock_data.sql)
  HTTP Error: Unable to connect to URL "http://localhost:9000/my-stock-data-bucket/stocks/*/*/*/*/*.json": 404 (Not Found).
[0m01:29:18.376653 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4c2f1039-efc5-47f9-bcf8-ef834a9d455a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFF9153110>]}
[0m01:29:18.376653 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model main.stg_stock_data ....................... [[31mERROR[0m in 0.21s]
[0m01:29:18.376653 [debug] [Thread-1 (]: Finished running node model.stock_dbt_project.stg_stock_data
[0m01:29:18.376653 [debug] [Thread-4 (]: Marking all children of 'model.stock_dbt_project.stg_stock_data' to be skipped because of status 'error'.  Reason: Runtime Error in model stg_stock_data (models\staging\stg_stock_data.sql)
  HTTP Error: Unable to connect to URL "http://localhost:9000/my-stock-data-bucket/stocks/*/*/*/*/*.json": 404 (Not Found)..
[0m01:29:18.376653 [debug] [MainThread]: Using duckdb connection "master"
[0m01:29:18.376653 [debug] [MainThread]: On master: BEGIN
[0m01:29:18.376653 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:29:18.376653 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m01:29:18.376653 [debug] [MainThread]: On master: COMMIT
[0m01:29:18.376653 [debug] [MainThread]: Using duckdb connection "master"
[0m01:29:18.390572 [debug] [MainThread]: On master: COMMIT
[0m01:29:18.391586 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m01:29:18.392591 [debug] [MainThread]: On master: Close
[0m01:29:18.394583 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:29:18.395581 [debug] [MainThread]: Connection 'create_dev_main' was properly closed.
[0m01:29:18.395581 [debug] [MainThread]: Connection 'list_dev_main' was properly closed.
[0m01:29:18.396581 [debug] [MainThread]: Connection 'model.stock_dbt_project.stg_stock_data' was properly closed.
[0m01:29:18.397581 [info ] [MainThread]: 
[0m01:29:18.398590 [info ] [MainThread]: Finished running 9 project hooks, 1 view model in 0 hours 0 minutes and 1.36 seconds (1.36s).
[0m01:29:18.402193 [debug] [MainThread]: Command end result
[0m01:29:18.455241 [debug] [MainThread]: Wrote artifact WritableManifest to D:\Stock_price\stock_dbt_project\target\manifest.json
[0m01:29:18.461002 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\Stock_price\stock_dbt_project\target\semantic_manifest.json
[0m01:29:18.479345 [debug] [MainThread]: Wrote artifact RunExecutionResult to D:\Stock_price\stock_dbt_project\target\run_results.json
[0m01:29:18.480777 [info ] [MainThread]: 
[0m01:29:18.482632 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m01:29:18.482632 [info ] [MainThread]: 
[0m01:29:18.482632 [error] [MainThread]:   Runtime Error in model stg_stock_data (models\staging\stg_stock_data.sql)
  HTTP Error: Unable to connect to URL "http://localhost:9000/my-stock-data-bucket/stocks/*/*/*/*/*.json": 404 (Not Found).
[0m01:29:18.487777 [info ] [MainThread]: 
[0m01:29:18.489808 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=1 SKIP=0 TOTAL=10
[0m01:29:18.492355 [debug] [MainThread]: Command `dbt run` failed at 01:29:18.491331 after 5.14 seconds
[0m01:29:18.492355 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFF62B67E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFF6ADFAA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFF72A3BC0>]}
[0m01:29:18.494352 [debug] [MainThread]: Flushing usage events
[0m01:29:19.342507 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:31:42.698052 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029CC55EC920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029CC2D51010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029CC5E251F0>]}


============================== 01:31:42.711470 | 343b056d-92c3-4d05-97aa-7928468f7766 ==============================
[0m01:31:42.711470 [info ] [MainThread]: Running with dbt=1.9.4
[0m01:31:42.714198 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\loges\\.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'D:\\Stock_price\\stock_dbt_project\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select stg_stock_data', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m01:31:43.513225 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '343b056d-92c3-4d05-97aa-7928468f7766', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029CC5C9C260>]}
[0m01:31:43.772488 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '343b056d-92c3-4d05-97aa-7928468f7766', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029CC622B7D0>]}
[0m01:31:43.793588 [info ] [MainThread]: Registered adapter: duckdb=1.9.2
[0m01:31:44.830065 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m01:31:45.466162 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m01:31:45.467855 [debug] [MainThread]: Partial parsing: updated file: stock_dbt_project://models\staging\stg_stock_data.sql
[0m01:31:46.493136 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.stock_dbt_project.marts
[0m01:31:46.512645 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '343b056d-92c3-4d05-97aa-7928468f7766', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029CC605A7E0>]}
[0m01:31:46.791399 [debug] [MainThread]: Wrote artifact WritableManifest to D:\Stock_price\stock_dbt_project\target\manifest.json
[0m01:31:46.796402 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\Stock_price\stock_dbt_project\target\semantic_manifest.json
[0m01:31:46.849697 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '343b056d-92c3-4d05-97aa-7928468f7766', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029CC766F140>]}
[0m01:31:46.852322 [info ] [MainThread]: Found 4 models, 9 operations, 4 data tests, 426 macros
[0m01:31:46.854332 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '343b056d-92c3-4d05-97aa-7928468f7766', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029CC793CB60>]}
[0m01:31:46.860232 [info ] [MainThread]: 
[0m01:31:46.862817 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:31:46.864473 [info ] [MainThread]: 
[0m01:31:46.866075 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m01:31:46.867696 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m01:31:47.044764 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m01:31:47.045764 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m01:31:47.047270 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:31:47.077279 [debug] [ThreadPool]: SQL status: OK in 0.030 seconds
[0m01:31:47.079449 [debug] [ThreadPool]: On list_dev: Close
[0m01:31:47.081449 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m01:31:47.082441 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m01:31:47.094319 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m01:31:47.095318 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "create_dev_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m01:31:47.096319 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:31:47.098797 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m01:31:47.102058 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m01:31:47.103106 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m01:31:47.105690 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m01:31:47.107388 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m01:31:47.108573 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "create_dev_main"} */

    
    
        create schema if not exists "dev"."main"
    
[0m01:31:47.109714 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m01:31:47.111948 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m01:31:47.112491 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m01:31:47.113679 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m01:31:47.114764 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m01:31:47.114764 [debug] [ThreadPool]: On create_dev_main: Close
[0m01:31:47.125975 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev_main'
[0m01:31:47.135949 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m01:31:47.137948 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m01:31:47.138955 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:31:47.139948 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m01:31:47.140955 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m01:31:47.142034 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m01:31:47.177861 [debug] [ThreadPool]: SQL status: OK in 0.035 seconds
[0m01:31:47.182592 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m01:31:47.185636 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m01:31:47.187151 [debug] [ThreadPool]: On list_dev_main: Close
[0m01:31:47.189802 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '343b056d-92c3-4d05-97aa-7928468f7766', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029CC7868B90>]}
[0m01:31:47.191797 [debug] [MainThread]: Using duckdb connection "master"
[0m01:31:47.191797 [debug] [MainThread]: On master: BEGIN
[0m01:31:47.193116 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:31:47.194113 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m01:31:47.195106 [debug] [MainThread]: On master: COMMIT
[0m01:31:47.196655 [debug] [MainThread]: Using duckdb connection "master"
[0m01:31:47.197953 [debug] [MainThread]: On master: COMMIT
[0m01:31:47.199925 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m01:31:47.216085 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-0"
[0m01:31:47.228088 [info ] [MainThread]: 1 of 9 START hook: stock_dbt_project.on-run-start.0 ............................ [RUN]
[0m01:31:47.230510 [debug] [MainThread]: Using duckdb connection "master"
[0m01:31:47.231578 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
INSTALL httpfs;
[0m01:31:47.233551 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m01:31:47.235542 [info ] [MainThread]: 1 of 9 OK hook: stock_dbt_project.on-run-start.0 ............................... [[32mOK[0m in 0.03s]
[0m01:31:47.240548 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-1"
[0m01:31:47.242546 [info ] [MainThread]: 2 of 9 START hook: stock_dbt_project.on-run-start.1 ............................ [RUN]
[0m01:31:47.244358 [debug] [MainThread]: Using duckdb connection "master"
[0m01:31:47.245370 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
INSTALL json;
[0m01:31:47.247876 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m01:31:47.248894 [info ] [MainThread]: 2 of 9 OK hook: stock_dbt_project.on-run-start.1 ............................... [[32mOK[0m in 0.01s]
[0m01:31:47.253839 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-2"
[0m01:31:47.255849 [info ] [MainThread]: 3 of 9 START hook: stock_dbt_project.on-run-start.2 ............................ [RUN]
[0m01:31:47.258845 [debug] [MainThread]: Using duckdb connection "master"
[0m01:31:47.261074 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
LOAD httpfs;
[0m01:31:47.624318 [debug] [MainThread]: SQL status: OK in 0.362 seconds
[0m01:31:47.628320 [info ] [MainThread]: 3 of 9 OK hook: stock_dbt_project.on-run-start.2 ............................... [[32mOK[0m in 0.38s]
[0m01:31:47.634810 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-3"
[0m01:31:47.639814 [info ] [MainThread]: 4 of 9 START hook: stock_dbt_project.on-run-start.3 ............................ [RUN]
[0m01:31:47.642807 [debug] [MainThread]: Using duckdb connection "master"
[0m01:31:47.644331 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
LOAD json;
[0m01:31:47.647349 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m01:31:47.649876 [info ] [MainThread]: 4 of 9 OK hook: stock_dbt_project.on-run-start.3 ............................... [[32mOK[0m in 0.02s]
[0m01:31:47.658955 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-4"
[0m01:31:47.662139 [info ] [MainThread]: 5 of 9 START hook: stock_dbt_project.on-run-start.4 ............................ [RUN]
[0m01:31:47.666877 [debug] [MainThread]: Using duckdb connection "master"
[0m01:31:47.670786 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
SET s3_access_key_id='minioadmin';
[0m01:31:47.674806 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m01:31:47.679186 [info ] [MainThread]: 5 of 9 OK hook: stock_dbt_project.on-run-start.4 ............................... [[32mOK[0m in 0.03s]
[0m01:31:47.686741 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-5"
[0m01:31:47.691343 [info ] [MainThread]: 6 of 9 START hook: stock_dbt_project.on-run-start.5 ............................ [RUN]
[0m01:31:47.695720 [debug] [MainThread]: Using duckdb connection "master"
[0m01:31:47.696879 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
SET s3_secret_access_key='minioadmin';
[0m01:31:47.699385 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m01:31:47.703767 [info ] [MainThread]: 6 of 9 OK hook: stock_dbt_project.on-run-start.5 ............................... [[32mOK[0m in 0.02s]
[0m01:31:47.712815 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-6"
[0m01:31:47.715811 [info ] [MainThread]: 7 of 9 START hook: stock_dbt_project.on-run-start.6 ............................ [RUN]
[0m01:31:47.719853 [debug] [MainThread]: Using duckdb connection "master"
[0m01:31:47.725122 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
SET s3_endpoint='http://localhost:9000';
[0m01:31:47.728123 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m01:31:47.732305 [info ] [MainThread]: 7 of 9 OK hook: stock_dbt_project.on-run-start.6 ............................... [[32mOK[0m in 0.02s]
[0m01:31:47.744063 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-7"
[0m01:31:47.747543 [info ] [MainThread]: 8 of 9 START hook: stock_dbt_project.on-run-start.7 ............................ [RUN]
[0m01:31:47.749720 [debug] [MainThread]: Using duckdb connection "master"
[0m01:31:47.751879 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
SET s3_use_ssl=false;
[0m01:31:47.756067 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m01:31:47.761581 [info ] [MainThread]: 8 of 9 OK hook: stock_dbt_project.on-run-start.7 ............................... [[32mOK[0m in 0.03s]
[0m01:31:47.773388 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-8"
[0m01:31:47.779657 [info ] [MainThread]: 9 of 9 START hook: stock_dbt_project.on-run-start.8 ............................ [RUN]
[0m01:31:47.782221 [debug] [MainThread]: Using duckdb connection "master"
[0m01:31:47.784210 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
SET s3_url_style='path';
[0m01:31:47.788389 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m01:31:47.794200 [info ] [MainThread]: 9 of 9 OK hook: stock_dbt_project.on-run-start.8 ............................... [[32mOK[0m in 0.03s]
[0m01:31:47.797197 [info ] [MainThread]: 
[0m01:31:47.799200 [debug] [MainThread]: On master: Close
[0m01:31:47.813737 [debug] [Thread-1 (]: Began running node model.stock_dbt_project.stg_stock_data
[0m01:31:47.815072 [info ] [Thread-1 (]: 1 of 1 START sql view model main.stg_stock_data ................................ [RUN]
[0m01:31:47.818064 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.stock_dbt_project.stg_stock_data'
[0m01:31:47.821214 [debug] [Thread-1 (]: Began compiling node model.stock_dbt_project.stg_stock_data
[0m01:31:47.831780 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_dbt_project.stg_stock_data"
[0m01:31:47.835709 [debug] [Thread-1 (]: Began executing node model.stock_dbt_project.stg_stock_data
[0m01:31:47.932989 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_dbt_project.stg_stock_data"
[0m01:31:47.934502 [debug] [Thread-1 (]: Using duckdb connection "model.stock_dbt_project.stg_stock_data"
[0m01:31:47.935513 [debug] [Thread-1 (]: On model.stock_dbt_project.stg_stock_data: BEGIN
[0m01:31:47.938054 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m01:31:47.940595 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m01:31:47.941619 [debug] [Thread-1 (]: Using duckdb connection "model.stock_dbt_project.stg_stock_data"
[0m01:31:47.942615 [debug] [Thread-1 (]: On model.stock_dbt_project.stg_stock_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "node_id": "model.stock_dbt_project.stg_stock_data"} */

  
  create view "dev"."main"."stg_stock_data__dbt_tmp" as (
    



WITH raw AS (
    SELECT *
    FROM read_json_auto(
        (SELECT * FROM glob('http://localhost:9000/my-stock-data-bucket/stocks/**/*.json'))
    )
)

SELECT
    CAST(symbol AS TEXT) AS symbol,
    CAST(datetime AS TIMESTAMP) AS datetime,
    CAST(open AS DOUBLE) AS open,
    CAST(high AS DOUBLE) AS high,
    CAST(low AS DOUBLE) AS low,
    CAST(close AS DOUBLE) AS close,
    CAST(volume AS BIGINT) AS volume
FROM raw
WHERE symbol IS NOT NULL AND datetime IS NOT NULL
  );

[0m01:31:47.955995 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "node_id": "model.stock_dbt_project.stg_stock_data"} */

  
  create view "dev"."main"."stg_stock_data__dbt_tmp" as (
    



WITH raw AS (
    SELECT *
    FROM read_json_auto(
        (SELECT * FROM glob('http://localhost:9000/my-stock-data-bucket/stocks/**/*.json'))
    )
)

SELECT
    CAST(symbol AS TEXT) AS symbol,
    CAST(datetime AS TIMESTAMP) AS datetime,
    CAST(open AS DOUBLE) AS open,
    CAST(high AS DOUBLE) AS high,
    CAST(low AS DOUBLE) AS low,
    CAST(close AS DOUBLE) AS close,
    CAST(volume AS BIGINT) AS volume
FROM raw
WHERE symbol IS NOT NULL AND datetime IS NOT NULL
  );

[0m01:31:47.957012 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m01:31:47.959014 [debug] [Thread-1 (]: On model.stock_dbt_project.stg_stock_data: ROLLBACK
[0m01:31:47.969006 [debug] [Thread-1 (]: Failed to rollback 'model.stock_dbt_project.stg_stock_data'
[0m01:31:47.970159 [debug] [Thread-1 (]: On model.stock_dbt_project.stg_stock_data: Close
[0m01:31:47.978319 [debug] [Thread-1 (]: Runtime Error in model stg_stock_data (models\staging\stg_stock_data.sql)
  Binder Error: Table function cannot contain subqueries
[0m01:31:47.982750 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '343b056d-92c3-4d05-97aa-7928468f7766', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029CC7ED66C0>]}
[0m01:31:47.984375 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model main.stg_stock_data ....................... [[31mERROR[0m in 0.16s]
[0m01:31:47.986464 [debug] [Thread-1 (]: Finished running node model.stock_dbt_project.stg_stock_data
[0m01:31:47.988991 [debug] [Thread-4 (]: Marking all children of 'model.stock_dbt_project.stg_stock_data' to be skipped because of status 'error'.  Reason: Runtime Error in model stg_stock_data (models\staging\stg_stock_data.sql)
  Binder Error: Table function cannot contain subqueries.
[0m01:31:47.992551 [debug] [MainThread]: Using duckdb connection "master"
[0m01:31:47.994078 [debug] [MainThread]: On master: BEGIN
[0m01:31:47.995095 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:31:47.996087 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m01:31:47.997094 [debug] [MainThread]: On master: COMMIT
[0m01:31:47.997094 [debug] [MainThread]: Using duckdb connection "master"
[0m01:31:47.998086 [debug] [MainThread]: On master: COMMIT
[0m01:31:47.999769 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m01:31:48.000694 [debug] [MainThread]: On master: Close
[0m01:31:48.001750 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:31:48.002741 [debug] [MainThread]: Connection 'create_dev_main' was properly closed.
[0m01:31:48.003749 [debug] [MainThread]: Connection 'list_dev_main' was properly closed.
[0m01:31:48.005395 [debug] [MainThread]: Connection 'model.stock_dbt_project.stg_stock_data' was properly closed.
[0m01:31:48.006742 [info ] [MainThread]: 
[0m01:31:48.008744 [info ] [MainThread]: Finished running 9 project hooks, 1 view model in 0 hours 0 minutes and 1.14 seconds (1.14s).
[0m01:31:48.015256 [debug] [MainThread]: Command end result
[0m01:31:48.090125 [debug] [MainThread]: Wrote artifact WritableManifest to D:\Stock_price\stock_dbt_project\target\manifest.json
[0m01:31:48.097183 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\Stock_price\stock_dbt_project\target\semantic_manifest.json
[0m01:31:48.115739 [debug] [MainThread]: Wrote artifact RunExecutionResult to D:\Stock_price\stock_dbt_project\target\run_results.json
[0m01:31:48.117931 [info ] [MainThread]: 
[0m01:31:48.121020 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m01:31:48.122960 [info ] [MainThread]: 
[0m01:31:48.126626 [error] [MainThread]:   Runtime Error in model stg_stock_data (models\staging\stg_stock_data.sql)
  Binder Error: Table function cannot contain subqueries
[0m01:31:48.128623 [info ] [MainThread]: 
[0m01:31:48.129622 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=1 SKIP=0 TOTAL=10
[0m01:31:48.133629 [debug] [MainThread]: Command `dbt run` failed at 01:31:48.132625 after 5.85 seconds
[0m01:31:48.134627 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029CC3768B30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029CC7968C50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029CC5E251F0>]}
[0m01:31:48.136806 [debug] [MainThread]: Flushing usage events
[0m01:31:48.940742 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:34:24.886845 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025E300A2AE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025E300A21B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025E2F44DF40>]}


============================== 01:34:24.911685 | c0645f6b-706b-422a-ae5d-5e08c0888f62 ==============================
[0m01:34:24.911685 [info ] [MainThread]: Running with dbt=1.9.4
[0m01:34:24.915703 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\loges\\.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'D:\\Stock_price\\stock_dbt_project\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run --select stg_stock_data', 'send_anonymous_usage_stats': 'True'}
[0m01:34:26.732813 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c0645f6b-706b-422a-ae5d-5e08c0888f62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025E3058C710>]}
[0m01:34:27.418472 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c0645f6b-706b-422a-ae5d-5e08c0888f62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025E305F8F80>]}
[0m01:34:27.631986 [info ] [MainThread]: Registered adapter: duckdb=1.9.2
[0m01:34:28.469473 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m01:34:29.090286 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m01:34:29.095076 [debug] [MainThread]: Partial parsing: updated file: stock_dbt_project://models\staging\stg_stock_data.sql
[0m01:34:30.931874 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.stock_dbt_project.marts
[0m01:34:30.962876 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c0645f6b-706b-422a-ae5d-5e08c0888f62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025E31D8DA60>]}
[0m01:34:31.440465 [debug] [MainThread]: Wrote artifact WritableManifest to D:\Stock_price\stock_dbt_project\target\manifest.json
[0m01:34:31.446728 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\Stock_price\stock_dbt_project\target\semantic_manifest.json
[0m01:34:31.505840 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c0645f6b-706b-422a-ae5d-5e08c0888f62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025E31A8EC00>]}
[0m01:34:31.508836 [info ] [MainThread]: Found 4 models, 9 operations, 4 data tests, 426 macros
[0m01:34:31.510833 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c0645f6b-706b-422a-ae5d-5e08c0888f62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025E31C45940>]}
[0m01:34:31.515242 [info ] [MainThread]: 
[0m01:34:31.517236 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:34:31.518236 [info ] [MainThread]: 
[0m01:34:31.520311 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m01:34:31.524840 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m01:34:31.719425 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m01:34:31.720434 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m01:34:31.721943 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:34:31.756242 [debug] [ThreadPool]: SQL status: OK in 0.034 seconds
[0m01:34:31.761747 [debug] [ThreadPool]: On list_dev: Close
[0m01:34:31.763758 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m01:34:31.764763 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m01:34:31.783829 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m01:34:31.784941 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "create_dev_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m01:34:31.796060 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:34:31.801836 [debug] [ThreadPool]: SQL status: OK in 0.006 seconds
[0m01:34:31.808551 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m01:34:31.816064 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m01:34:31.819490 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m01:34:31.825099 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m01:34:31.828457 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "create_dev_main"} */

    
    
        create schema if not exists "dev"."main"
    
[0m01:34:31.833789 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m01:34:31.840561 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m01:34:31.844119 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m01:34:31.846648 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m01:34:31.848649 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m01:34:31.850432 [debug] [ThreadPool]: On create_dev_main: Close
[0m01:34:31.870269 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev_main'
[0m01:34:31.898680 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m01:34:31.899694 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m01:34:31.902780 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:34:31.907762 [debug] [ThreadPool]: SQL status: OK in 0.005 seconds
[0m01:34:31.909773 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m01:34:31.911772 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m01:34:31.993829 [debug] [ThreadPool]: SQL status: OK in 0.081 seconds
[0m01:34:32.001627 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m01:34:32.008083 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m01:34:32.009086 [debug] [ThreadPool]: On list_dev_main: Close
[0m01:34:32.012117 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c0645f6b-706b-422a-ae5d-5e08c0888f62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025E321B8FE0>]}
[0m01:34:32.014255 [debug] [MainThread]: Using duckdb connection "master"
[0m01:34:32.016269 [debug] [MainThread]: On master: BEGIN
[0m01:34:32.018717 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:34:32.022265 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m01:34:32.027611 [debug] [MainThread]: On master: COMMIT
[0m01:34:32.030050 [debug] [MainThread]: Using duckdb connection "master"
[0m01:34:32.032311 [debug] [MainThread]: On master: COMMIT
[0m01:34:32.035049 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m01:34:32.064354 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-0"
[0m01:34:32.092143 [info ] [MainThread]: 1 of 9 START hook: stock_dbt_project.on-run-start.0 ............................ [RUN]
[0m01:34:32.096152 [debug] [MainThread]: Using duckdb connection "master"
[0m01:34:32.098170 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
INSTALL httpfs;
[0m01:34:32.104249 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m01:34:32.111782 [info ] [MainThread]: 1 of 9 OK hook: stock_dbt_project.on-run-start.0 ............................... [[32mOK[0m in 0.07s]
[0m01:34:32.119330 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-1"
[0m01:34:32.127977 [info ] [MainThread]: 2 of 9 START hook: stock_dbt_project.on-run-start.1 ............................ [RUN]
[0m01:34:32.131973 [debug] [MainThread]: Using duckdb connection "master"
[0m01:34:32.134693 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
INSTALL json;
[0m01:34:32.143779 [debug] [MainThread]: SQL status: OK in 0.006 seconds
[0m01:34:32.150962 [info ] [MainThread]: 2 of 9 OK hook: stock_dbt_project.on-run-start.1 ............................... [[32mOK[0m in 0.03s]
[0m01:34:32.168771 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-2"
[0m01:34:32.179196 [info ] [MainThread]: 3 of 9 START hook: stock_dbt_project.on-run-start.2 ............................ [RUN]
[0m01:34:32.186152 [debug] [MainThread]: Using duckdb connection "master"
[0m01:34:32.188517 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
LOAD httpfs;
[0m01:34:32.970203 [debug] [MainThread]: SQL status: OK in 0.777 seconds
[0m01:34:32.975977 [info ] [MainThread]: 3 of 9 OK hook: stock_dbt_project.on-run-start.2 ............................... [[32mOK[0m in 0.82s]
[0m01:34:32.982642 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-3"
[0m01:34:32.984647 [info ] [MainThread]: 4 of 9 START hook: stock_dbt_project.on-run-start.3 ............................ [RUN]
[0m01:34:32.986922 [debug] [MainThread]: Using duckdb connection "master"
[0m01:34:32.989369 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
LOAD json;
[0m01:34:32.993533 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m01:34:32.997544 [info ] [MainThread]: 4 of 9 OK hook: stock_dbt_project.on-run-start.3 ............................... [[32mOK[0m in 0.02s]
[0m01:34:33.003073 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-4"
[0m01:34:33.008098 [info ] [MainThread]: 5 of 9 START hook: stock_dbt_project.on-run-start.4 ............................ [RUN]
[0m01:34:33.048776 [debug] [MainThread]: Using duckdb connection "master"
[0m01:34:33.066881 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
SET s3_access_key_id='minioadmin';
[0m01:34:33.066881 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m01:34:33.078958 [info ] [MainThread]: 5 of 9 OK hook: stock_dbt_project.on-run-start.4 ............................... [[32mOK[0m in 0.08s]
[0m01:34:33.102709 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-5"
[0m01:34:33.113996 [info ] [MainThread]: 6 of 9 START hook: stock_dbt_project.on-run-start.5 ............................ [RUN]
[0m01:34:33.115667 [debug] [MainThread]: Using duckdb connection "master"
[0m01:34:33.128010 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
SET s3_secret_access_key='minioadmin';
[0m01:34:33.131008 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m01:34:33.136686 [info ] [MainThread]: 6 of 9 OK hook: stock_dbt_project.on-run-start.5 ............................... [[32mOK[0m in 0.05s]
[0m01:34:33.150221 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-6"
[0m01:34:33.158088 [info ] [MainThread]: 7 of 9 START hook: stock_dbt_project.on-run-start.6 ............................ [RUN]
[0m01:34:33.166473 [debug] [MainThread]: Using duckdb connection "master"
[0m01:34:33.175675 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
SET s3_endpoint='http://localhost:9000';
[0m01:34:33.180369 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m01:34:33.184812 [info ] [MainThread]: 7 of 9 OK hook: stock_dbt_project.on-run-start.6 ............................... [[32mOK[0m in 0.04s]
[0m01:34:33.195898 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-7"
[0m01:34:33.200091 [info ] [MainThread]: 8 of 9 START hook: stock_dbt_project.on-run-start.7 ............................ [RUN]
[0m01:34:33.211575 [debug] [MainThread]: Using duckdb connection "master"
[0m01:34:33.214688 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
SET s3_use_ssl=false;
[0m01:34:33.218688 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m01:34:33.232645 [info ] [MainThread]: 8 of 9 OK hook: stock_dbt_project.on-run-start.7 ............................... [[32mOK[0m in 0.04s]
[0m01:34:33.240166 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-8"
[0m01:34:33.248484 [info ] [MainThread]: 9 of 9 START hook: stock_dbt_project.on-run-start.8 ............................ [RUN]
[0m01:34:33.251827 [debug] [MainThread]: Using duckdb connection "master"
[0m01:34:33.254106 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
SET s3_url_style='path';
[0m01:34:33.257607 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m01:34:33.262677 [info ] [MainThread]: 9 of 9 OK hook: stock_dbt_project.on-run-start.8 ............................... [[32mOK[0m in 0.03s]
[0m01:34:33.264672 [info ] [MainThread]: 
[0m01:34:33.267675 [debug] [MainThread]: On master: Close
[0m01:34:33.281832 [debug] [Thread-1 (]: Began running node model.stock_dbt_project.stg_stock_data
[0m01:34:33.284999 [info ] [Thread-1 (]: 1 of 1 START sql view model main.stg_stock_data ................................ [RUN]
[0m01:34:33.289536 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.stock_dbt_project.stg_stock_data'
[0m01:34:33.292849 [debug] [Thread-1 (]: Began compiling node model.stock_dbt_project.stg_stock_data
[0m01:34:33.304258 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_dbt_project.stg_stock_data"
[0m01:34:33.308048 [debug] [Thread-1 (]: Began executing node model.stock_dbt_project.stg_stock_data
[0m01:34:33.482037 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_dbt_project.stg_stock_data"
[0m01:34:33.487064 [debug] [Thread-1 (]: Using duckdb connection "model.stock_dbt_project.stg_stock_data"
[0m01:34:33.497345 [debug] [Thread-1 (]: On model.stock_dbt_project.stg_stock_data: BEGIN
[0m01:34:33.500741 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m01:34:33.506857 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m01:34:33.510293 [debug] [Thread-1 (]: Using duckdb connection "model.stock_dbt_project.stg_stock_data"
[0m01:34:33.513903 [debug] [Thread-1 (]: On model.stock_dbt_project.stg_stock_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "node_id": "model.stock_dbt_project.stg_stock_data"} */

  
  create view "dev"."main"."stg_stock_data__dbt_tmp" as (
    



WITH raw AS (
    SELECT *
    FROM read_json_auto('s3://my-stock-data-bucket/stocks/*/*/*/*/*.json')
)

SELECT
    CAST(symbol AS TEXT) AS symbol,
    CAST(datetime AS TIMESTAMP) AS datetime,
    CAST(open AS DOUBLE) AS open,
    CAST(high AS DOUBLE) AS high,
    CAST(low AS DOUBLE) AS low,
    CAST(close AS DOUBLE) AS close,
    CAST(volume AS BIGINT) AS volume
FROM raw
WHERE symbol IS NOT NULL AND datetime IS NOT NULL
  );

[0m01:34:34.059049 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "node_id": "model.stock_dbt_project.stg_stock_data"} */

  
  create view "dev"."main"."stg_stock_data__dbt_tmp" as (
    



WITH raw AS (
    SELECT *
    FROM read_json_auto('s3://my-stock-data-bucket/stocks/*/*/*/*/*.json')
)

SELECT
    CAST(symbol AS TEXT) AS symbol,
    CAST(datetime AS TIMESTAMP) AS datetime,
    CAST(open AS DOUBLE) AS open,
    CAST(high AS DOUBLE) AS high,
    CAST(low AS DOUBLE) AS low,
    CAST(close AS DOUBLE) AS close,
    CAST(volume AS BIGINT) AS volume
FROM raw
WHERE symbol IS NOT NULL AND datetime IS NOT NULL
  );

[0m01:34:34.062438 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m01:34:34.065136 [debug] [Thread-1 (]: On model.stock_dbt_project.stg_stock_data: ROLLBACK
[0m01:34:34.082744 [debug] [Thread-1 (]: Failed to rollback 'model.stock_dbt_project.stg_stock_data'
[0m01:34:34.084744 [debug] [Thread-1 (]: On model.stock_dbt_project.stg_stock_data: Close
[0m01:34:34.096669 [debug] [Thread-1 (]: Runtime Error in model stg_stock_data (models\staging\stg_stock_data.sql)
  HTTP Error: HTTP GET error on '/?encoding-type=url&list-type=2&prefix=stocks%2F' (HTTP 400)
[0m01:34:34.104766 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c0645f6b-706b-422a-ae5d-5e08c0888f62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025E2F064D10>]}
[0m01:34:34.110168 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model main.stg_stock_data ....................... [[31mERROR[0m in 0.81s]
[0m01:34:34.114034 [debug] [Thread-1 (]: Finished running node model.stock_dbt_project.stg_stock_data
[0m01:34:34.117270 [debug] [Thread-4 (]: Marking all children of 'model.stock_dbt_project.stg_stock_data' to be skipped because of status 'error'.  Reason: Runtime Error in model stg_stock_data (models\staging\stg_stock_data.sql)
  HTTP Error: HTTP GET error on '/?encoding-type=url&list-type=2&prefix=stocks%2F' (HTTP 400).
[0m01:34:34.126229 [debug] [MainThread]: Using duckdb connection "master"
[0m01:34:34.129226 [debug] [MainThread]: On master: BEGIN
[0m01:34:34.130225 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:34:34.131736 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m01:34:34.133747 [debug] [MainThread]: On master: COMMIT
[0m01:34:34.135326 [debug] [MainThread]: Using duckdb connection "master"
[0m01:34:34.137865 [debug] [MainThread]: On master: COMMIT
[0m01:34:34.142276 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m01:34:34.144821 [debug] [MainThread]: On master: Close
[0m01:34:34.146561 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:34:34.147664 [debug] [MainThread]: Connection 'create_dev_main' was properly closed.
[0m01:34:34.148674 [debug] [MainThread]: Connection 'list_dev_main' was properly closed.
[0m01:34:34.149677 [debug] [MainThread]: Connection 'model.stock_dbt_project.stg_stock_data' was properly closed.
[0m01:34:34.150676 [info ] [MainThread]: 
[0m01:34:34.152743 [info ] [MainThread]: Finished running 9 project hooks, 1 view model in 0 hours 0 minutes and 2.63 seconds (2.63s).
[0m01:34:34.165068 [debug] [MainThread]: Command end result
[0m01:34:34.248102 [debug] [MainThread]: Wrote artifact WritableManifest to D:\Stock_price\stock_dbt_project\target\manifest.json
[0m01:34:34.252149 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\Stock_price\stock_dbt_project\target\semantic_manifest.json
[0m01:34:34.267449 [debug] [MainThread]: Wrote artifact RunExecutionResult to D:\Stock_price\stock_dbt_project\target\run_results.json
[0m01:34:34.268449 [info ] [MainThread]: 
[0m01:34:34.270440 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m01:34:34.271948 [info ] [MainThread]: 
[0m01:34:34.274676 [error] [MainThread]:   Runtime Error in model stg_stock_data (models\staging\stg_stock_data.sql)
  HTTP Error: HTTP GET error on '/?encoding-type=url&list-type=2&prefix=stocks%2F' (HTTP 400)
[0m01:34:34.277739 [info ] [MainThread]: 
[0m01:34:34.280130 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=1 SKIP=0 TOTAL=10
[0m01:34:34.284245 [debug] [MainThread]: Command `dbt run` failed at 01:34:34.283694 after 10.11 seconds
[0m01:34:34.285719 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025E3050ACF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025E31D464E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025E2FA14E90>]}
[0m01:34:34.287741 [debug] [MainThread]: Flushing usage events
[0m01:34:35.012782 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:36:44.800381 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AC7A042900>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AC79D89BB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AC77A45970>]}


============================== 01:36:44.816146 | 958404d2-83e5-4de1-b6b3-44366a779ac7 ==============================
[0m01:36:44.816146 [info ] [MainThread]: Running with dbt=1.9.4
[0m01:36:44.819882 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'D:\\Stock_price\\stock_dbt_project\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\loges\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run --select stg_stock_data', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m01:36:45.335781 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '958404d2-83e5-4de1-b6b3-44366a779ac7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AC7A56D580>]}
[0m01:36:45.523437 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '958404d2-83e5-4de1-b6b3-44366a779ac7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AC79A6DB20>]}
[0m01:36:45.531425 [info ] [MainThread]: Registered adapter: duckdb=1.9.2
[0m01:36:46.247526 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m01:36:46.582518 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m01:36:46.583515 [debug] [MainThread]: Partial parsing: updated file: stock_dbt_project://models\staging\stg_stock_data.sql
[0m01:36:47.100069 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.stock_dbt_project.marts
[0m01:36:47.112514 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '958404d2-83e5-4de1-b6b3-44366a779ac7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AC7BD9DD60>]}
[0m01:36:47.382190 [debug] [MainThread]: Wrote artifact WritableManifest to D:\Stock_price\stock_dbt_project\target\manifest.json
[0m01:36:47.389141 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\Stock_price\stock_dbt_project\target\semantic_manifest.json
[0m01:36:47.504676 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '958404d2-83e5-4de1-b6b3-44366a779ac7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AC7BA9EAE0>]}
[0m01:36:47.509224 [info ] [MainThread]: Found 4 models, 9 operations, 4 data tests, 426 macros
[0m01:36:47.512603 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '958404d2-83e5-4de1-b6b3-44366a779ac7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AC7BD59790>]}
[0m01:36:47.519238 [info ] [MainThread]: 
[0m01:36:47.523393 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:36:47.527712 [info ] [MainThread]: 
[0m01:36:47.532464 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m01:36:47.537998 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m01:36:47.782436 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m01:36:47.784441 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m01:36:47.785440 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:36:47.815445 [debug] [ThreadPool]: SQL status: OK in 0.030 seconds
[0m01:36:47.819463 [debug] [ThreadPool]: On list_dev: Close
[0m01:36:47.821875 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m01:36:47.824029 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m01:36:47.839225 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m01:36:47.840229 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "create_dev_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m01:36:47.841235 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:36:47.843751 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m01:36:47.847287 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m01:36:47.847806 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m01:36:47.848816 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m01:36:47.850096 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m01:36:47.852098 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "create_dev_main"} */

    
    
        create schema if not exists "dev"."main"
    
[0m01:36:47.854101 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m01:36:47.856101 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m01:36:47.858106 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m01:36:47.860103 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m01:36:47.861106 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m01:36:47.862109 [debug] [ThreadPool]: On create_dev_main: Close
[0m01:36:47.875104 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev_main'
[0m01:36:47.887673 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m01:36:47.888680 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m01:36:47.890686 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:36:47.892249 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m01:36:47.893245 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m01:36:47.894239 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m01:36:47.930291 [debug] [ThreadPool]: SQL status: OK in 0.035 seconds
[0m01:36:47.936182 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m01:36:47.941175 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m01:36:47.942172 [debug] [ThreadPool]: On list_dev_main: Close
[0m01:36:47.944166 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '958404d2-83e5-4de1-b6b3-44366a779ac7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AC7BC59F40>]}
[0m01:36:47.946026 [debug] [MainThread]: Using duckdb connection "master"
[0m01:36:47.946754 [debug] [MainThread]: On master: BEGIN
[0m01:36:47.947605 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:36:47.948613 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m01:36:47.949611 [debug] [MainThread]: On master: COMMIT
[0m01:36:47.949611 [debug] [MainThread]: Using duckdb connection "master"
[0m01:36:47.950613 [debug] [MainThread]: On master: COMMIT
[0m01:36:47.951995 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m01:36:47.963717 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-0"
[0m01:36:47.973584 [info ] [MainThread]: 1 of 9 START hook: stock_dbt_project.on-run-start.0 ............................ [RUN]
[0m01:36:47.975573 [debug] [MainThread]: Using duckdb connection "master"
[0m01:36:47.977578 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
INSTALL httpfs;
[0m01:36:47.980245 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m01:36:47.981863 [info ] [MainThread]: 1 of 9 OK hook: stock_dbt_project.on-run-start.0 ............................... [[32mOK[0m in 0.03s]
[0m01:36:47.985877 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-1"
[0m01:36:47.988374 [info ] [MainThread]: 2 of 9 START hook: stock_dbt_project.on-run-start.1 ............................ [RUN]
[0m01:36:47.991384 [debug] [MainThread]: Using duckdb connection "master"
[0m01:36:47.993387 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
INSTALL json;
[0m01:36:47.995385 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m01:36:47.998417 [info ] [MainThread]: 2 of 9 OK hook: stock_dbt_project.on-run-start.1 ............................... [[32mOK[0m in 0.01s]
[0m01:36:48.001430 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-2"
[0m01:36:48.002634 [info ] [MainThread]: 3 of 9 START hook: stock_dbt_project.on-run-start.2 ............................ [RUN]
[0m01:36:48.004638 [debug] [MainThread]: Using duckdb connection "master"
[0m01:36:48.007166 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
LOAD httpfs;
[0m01:36:48.579600 [debug] [MainThread]: SQL status: OK in 0.570 seconds
[0m01:36:48.585016 [info ] [MainThread]: 3 of 9 OK hook: stock_dbt_project.on-run-start.2 ............................... [[32mOK[0m in 0.58s]
[0m01:36:48.592787 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-3"
[0m01:36:48.596781 [info ] [MainThread]: 4 of 9 START hook: stock_dbt_project.on-run-start.3 ............................ [RUN]
[0m01:36:48.598787 [debug] [MainThread]: Using duckdb connection "master"
[0m01:36:48.600789 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
LOAD json;
[0m01:36:48.604446 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m01:36:48.610925 [info ] [MainThread]: 4 of 9 OK hook: stock_dbt_project.on-run-start.3 ............................... [[32mOK[0m in 0.02s]
[0m01:36:48.617797 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-4"
[0m01:36:48.623523 [info ] [MainThread]: 5 of 9 START hook: stock_dbt_project.on-run-start.4 ............................ [RUN]
[0m01:36:48.629654 [debug] [MainThread]: Using duckdb connection "master"
[0m01:36:48.632440 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
SET s3_access_key_id='minioadmin';
[0m01:36:48.635641 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m01:36:48.648071 [info ] [MainThread]: 5 of 9 OK hook: stock_dbt_project.on-run-start.4 ............................... [[32mOK[0m in 0.03s]
[0m01:36:48.661456 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-5"
[0m01:36:48.666024 [info ] [MainThread]: 6 of 9 START hook: stock_dbt_project.on-run-start.5 ............................ [RUN]
[0m01:36:48.670170 [debug] [MainThread]: Using duckdb connection "master"
[0m01:36:48.672813 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
SET s3_secret_access_key='minioadmin';
[0m01:36:48.678603 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m01:36:48.685294 [info ] [MainThread]: 6 of 9 OK hook: stock_dbt_project.on-run-start.5 ............................... [[32mOK[0m in 0.03s]
[0m01:36:48.697190 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-6"
[0m01:36:48.701198 [info ] [MainThread]: 7 of 9 START hook: stock_dbt_project.on-run-start.6 ............................ [RUN]
[0m01:36:48.704214 [debug] [MainThread]: Using duckdb connection "master"
[0m01:36:48.705976 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
SET s3_endpoint='http://localhost:9000';
[0m01:36:48.711413 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m01:36:48.714972 [info ] [MainThread]: 7 of 9 OK hook: stock_dbt_project.on-run-start.6 ............................... [[32mOK[0m in 0.03s]
[0m01:36:48.724262 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-7"
[0m01:36:48.730099 [info ] [MainThread]: 8 of 9 START hook: stock_dbt_project.on-run-start.7 ............................ [RUN]
[0m01:36:48.732644 [debug] [MainThread]: Using duckdb connection "master"
[0m01:36:48.734177 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
SET s3_use_ssl=false;
[0m01:36:48.736340 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m01:36:48.742603 [info ] [MainThread]: 8 of 9 OK hook: stock_dbt_project.on-run-start.7 ............................... [[32mOK[0m in 0.02s]
[0m01:36:48.750602 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-8"
[0m01:36:48.755806 [info ] [MainThread]: 9 of 9 START hook: stock_dbt_project.on-run-start.8 ............................ [RUN]
[0m01:36:48.761007 [debug] [MainThread]: Using duckdb connection "master"
[0m01:36:48.763120 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
SET s3_url_style='path';
[0m01:36:48.766275 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m01:36:48.771440 [info ] [MainThread]: 9 of 9 OK hook: stock_dbt_project.on-run-start.8 ............................... [[32mOK[0m in 0.02s]
[0m01:36:48.781568 [info ] [MainThread]: 
[0m01:36:48.784586 [debug] [MainThread]: On master: Close
[0m01:36:48.805829 [debug] [Thread-1 (]: Began running node model.stock_dbt_project.stg_stock_data
[0m01:36:48.812617 [info ] [Thread-1 (]: 1 of 1 START sql view model main.stg_stock_data ................................ [RUN]
[0m01:36:48.817497 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.stock_dbt_project.stg_stock_data'
[0m01:36:48.820852 [debug] [Thread-1 (]: Began compiling node model.stock_dbt_project.stg_stock_data
[0m01:36:48.835070 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_dbt_project.stg_stock_data"
[0m01:36:48.840446 [debug] [Thread-1 (]: Began executing node model.stock_dbt_project.stg_stock_data
[0m01:36:48.980125 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_dbt_project.stg_stock_data"
[0m01:36:48.984662 [debug] [Thread-1 (]: Using duckdb connection "model.stock_dbt_project.stg_stock_data"
[0m01:36:48.987415 [debug] [Thread-1 (]: On model.stock_dbt_project.stg_stock_data: BEGIN
[0m01:36:48.991707 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m01:36:48.995728 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m01:36:48.996727 [debug] [Thread-1 (]: Using duckdb connection "model.stock_dbt_project.stg_stock_data"
[0m01:36:48.998236 [debug] [Thread-1 (]: On model.stock_dbt_project.stg_stock_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "node_id": "model.stock_dbt_project.stg_stock_data"} */

  
  create view "dev"."main"."stg_stock_data__dbt_tmp" as (
    



WITH raw AS (
    SELECT *
    FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/*/*/*/*/*.json')
)

SELECT
    CAST(symbol AS TEXT) AS symbol,
    CAST(datetime AS TIMESTAMP) AS datetime,
    CAST(open AS DOUBLE) AS open,
    CAST(high AS DOUBLE) AS high,
    CAST(low AS DOUBLE) AS low,
    CAST(close AS DOUBLE) AS close,
    CAST(volume AS BIGINT) AS volume
FROM raw
WHERE symbol IS NOT NULL AND datetime IS NOT NULL
  );

[0m01:36:49.017935 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "node_id": "model.stock_dbt_project.stg_stock_data"} */

  
  create view "dev"."main"."stg_stock_data__dbt_tmp" as (
    



WITH raw AS (
    SELECT *
    FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/*/*/*/*/*.json')
)

SELECT
    CAST(symbol AS TEXT) AS symbol,
    CAST(datetime AS TIMESTAMP) AS datetime,
    CAST(open AS DOUBLE) AS open,
    CAST(high AS DOUBLE) AS high,
    CAST(low AS DOUBLE) AS low,
    CAST(close AS DOUBLE) AS close,
    CAST(volume AS BIGINT) AS volume
FROM raw
WHERE symbol IS NOT NULL AND datetime IS NOT NULL
  );

[0m01:36:49.019628 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m01:36:49.020749 [debug] [Thread-1 (]: On model.stock_dbt_project.stg_stock_data: ROLLBACK
[0m01:36:49.031768 [debug] [Thread-1 (]: Failed to rollback 'model.stock_dbt_project.stg_stock_data'
[0m01:36:49.033772 [debug] [Thread-1 (]: On model.stock_dbt_project.stg_stock_data: Close
[0m01:36:49.038048 [debug] [Thread-1 (]: Runtime Error in model stg_stock_data (models\staging\stg_stock_data.sql)
  HTTP Error: Unable to connect to URL "http://localhost:9000/my-stock-data-bucket/stocks/*/*/*/*/*.json": 404 (Not Found).
[0m01:36:49.043047 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '958404d2-83e5-4de1-b6b3-44366a779ac7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AC7C3D66C0>]}
[0m01:36:49.045046 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model main.stg_stock_data ....................... [[31mERROR[0m in 0.22s]
[0m01:36:49.046577 [debug] [Thread-1 (]: Finished running node model.stock_dbt_project.stg_stock_data
[0m01:36:49.047583 [debug] [Thread-4 (]: Marking all children of 'model.stock_dbt_project.stg_stock_data' to be skipped because of status 'error'.  Reason: Runtime Error in model stg_stock_data (models\staging\stg_stock_data.sql)
  HTTP Error: Unable to connect to URL "http://localhost:9000/my-stock-data-bucket/stocks/*/*/*/*/*.json": 404 (Not Found)..
[0m01:36:49.051154 [debug] [MainThread]: Using duckdb connection "master"
[0m01:36:49.052149 [debug] [MainThread]: On master: BEGIN
[0m01:36:49.053157 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:36:49.054150 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m01:36:49.055154 [debug] [MainThread]: On master: COMMIT
[0m01:36:49.056154 [debug] [MainThread]: Using duckdb connection "master"
[0m01:36:49.058153 [debug] [MainThread]: On master: COMMIT
[0m01:36:49.059151 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m01:36:49.060157 [debug] [MainThread]: On master: Close
[0m01:36:49.061151 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:36:49.061151 [debug] [MainThread]: Connection 'create_dev_main' was properly closed.
[0m01:36:49.062669 [debug] [MainThread]: Connection 'list_dev_main' was properly closed.
[0m01:36:49.063543 [debug] [MainThread]: Connection 'model.stock_dbt_project.stg_stock_data' was properly closed.
[0m01:36:49.064107 [info ] [MainThread]: 
[0m01:36:49.066109 [info ] [MainThread]: Finished running 9 project hooks, 1 view model in 0 hours 0 minutes and 1.53 seconds (1.53s).
[0m01:36:49.069640 [debug] [MainThread]: Command end result
[0m01:36:49.133925 [debug] [MainThread]: Wrote artifact WritableManifest to D:\Stock_price\stock_dbt_project\target\manifest.json
[0m01:36:49.136932 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\Stock_price\stock_dbt_project\target\semantic_manifest.json
[0m01:36:49.150460 [debug] [MainThread]: Wrote artifact RunExecutionResult to D:\Stock_price\stock_dbt_project\target\run_results.json
[0m01:36:49.151463 [info ] [MainThread]: 
[0m01:36:49.153005 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m01:36:49.154111 [info ] [MainThread]: 
[0m01:36:49.155126 [error] [MainThread]:   Runtime Error in model stg_stock_data (models\staging\stg_stock_data.sql)
  HTTP Error: Unable to connect to URL "http://localhost:9000/my-stock-data-bucket/stocks/*/*/*/*/*.json": 404 (Not Found).
[0m01:36:49.158130 [info ] [MainThread]: 
[0m01:36:49.159123 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=1 SKIP=0 TOTAL=10
[0m01:36:49.162725 [debug] [MainThread]: Command `dbt run` failed at 01:36:49.162725 after 4.76 seconds
[0m01:36:49.163723 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AC7A042900>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AC79EBF530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AC7A527CB0>]}
[0m01:36:49.164667 [debug] [MainThread]: Flushing usage events
[0m01:36:50.000136 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:37:54.783948 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000116B08AEF60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000116B2B80680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000116B37AACC0>]}


============================== 01:37:54.791677 | 214e3053-a38d-4b19-b836-2193b61a1147 ==============================
[0m01:37:54.791677 [info ] [MainThread]: Running with dbt=1.9.4
[0m01:37:54.794112 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\loges\\.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'D:\\Stock_price\\stock_dbt_project\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select stg_stock_data', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m01:37:55.389581 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '214e3053-a38d-4b19-b836-2193b61a1147', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000116B3C88C20>]}
[0m01:37:55.532744 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '214e3053-a38d-4b19-b836-2193b61a1147', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000116B35E75F0>]}
[0m01:37:55.550438 [info ] [MainThread]: Registered adapter: duckdb=1.9.2
[0m01:37:56.209887 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m01:37:56.687214 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m01:37:56.688578 [debug] [MainThread]: Partial parsing: updated file: stock_dbt_project://models\staging\stg_stock_data.sql
[0m01:37:57.143965 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.stock_dbt_project.marts
[0m01:37:57.162302 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '214e3053-a38d-4b19-b836-2193b61a1147', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000116B5394380>]}
[0m01:37:57.397078 [debug] [MainThread]: Wrote artifact WritableManifest to D:\Stock_price\stock_dbt_project\target\manifest.json
[0m01:37:57.401094 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\Stock_price\stock_dbt_project\target\semantic_manifest.json
[0m01:37:57.487604 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '214e3053-a38d-4b19-b836-2193b61a1147', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000116B51BF680>]}
[0m01:37:57.489607 [info ] [MainThread]: Found 4 models, 9 operations, 4 data tests, 426 macros
[0m01:37:57.494203 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '214e3053-a38d-4b19-b836-2193b61a1147', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000116B54941A0>]}
[0m01:37:57.498242 [info ] [MainThread]: 
[0m01:37:57.500212 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:37:57.501310 [info ] [MainThread]: 
[0m01:37:57.503304 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m01:37:57.505299 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m01:37:57.699181 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m01:37:57.701369 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m01:37:57.703245 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:37:57.752791 [debug] [ThreadPool]: SQL status: OK in 0.050 seconds
[0m01:37:57.759785 [debug] [ThreadPool]: On list_dev: Close
[0m01:37:57.763783 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m01:37:57.764785 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m01:37:57.796960 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m01:37:57.799052 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "create_dev_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m01:37:57.800591 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:37:57.805278 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m01:37:57.814537 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m01:37:57.816872 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m01:37:57.819472 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m01:37:57.820896 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m01:37:57.822912 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "create_dev_main"} */

    
    
        create schema if not exists "dev"."main"
    
[0m01:37:57.826458 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m01:37:57.830978 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m01:37:57.831980 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m01:37:57.833508 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m01:37:57.835640 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m01:37:57.837719 [debug] [ThreadPool]: On create_dev_main: Close
[0m01:37:57.864861 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev_main'
[0m01:37:57.888401 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m01:37:57.890565 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m01:37:57.891563 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:37:57.895092 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m01:37:57.897098 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m01:37:57.898274 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m01:37:57.984880 [debug] [ThreadPool]: SQL status: OK in 0.085 seconds
[0m01:37:57.992596 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m01:37:57.996633 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m01:37:57.998254 [debug] [ThreadPool]: On list_dev_main: Close
[0m01:37:58.000383 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '214e3053-a38d-4b19-b836-2193b61a1147', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000116B0ACAC00>]}
[0m01:37:58.001464 [debug] [MainThread]: Using duckdb connection "master"
[0m01:37:58.002593 [debug] [MainThread]: On master: BEGIN
[0m01:37:58.002593 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:37:58.004605 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m01:37:58.006095 [debug] [MainThread]: On master: COMMIT
[0m01:37:58.007896 [debug] [MainThread]: Using duckdb connection "master"
[0m01:37:58.010551 [debug] [MainThread]: On master: COMMIT
[0m01:37:58.012369 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m01:37:58.033003 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-0"
[0m01:37:58.048738 [info ] [MainThread]: 1 of 9 START hook: stock_dbt_project.on-run-start.0 ............................ [RUN]
[0m01:37:58.052275 [debug] [MainThread]: Using duckdb connection "master"
[0m01:37:58.053273 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
INSTALL httpfs;
[0m01:37:58.057306 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m01:37:58.061310 [info ] [MainThread]: 1 of 9 OK hook: stock_dbt_project.on-run-start.0 ............................... [[32mOK[0m in 0.05s]
[0m01:37:58.067798 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-1"
[0m01:37:58.071802 [info ] [MainThread]: 2 of 9 START hook: stock_dbt_project.on-run-start.1 ............................ [RUN]
[0m01:37:58.076113 [debug] [MainThread]: Using duckdb connection "master"
[0m01:37:58.081649 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
INSTALL json;
[0m01:37:58.085341 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m01:37:58.088589 [info ] [MainThread]: 2 of 9 OK hook: stock_dbt_project.on-run-start.1 ............................... [[32mOK[0m in 0.02s]
[0m01:37:58.098092 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-2"
[0m01:37:58.101083 [info ] [MainThread]: 3 of 9 START hook: stock_dbt_project.on-run-start.2 ............................ [RUN]
[0m01:37:58.103600 [debug] [MainThread]: Using duckdb connection "master"
[0m01:37:58.106658 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
LOAD httpfs;
[0m01:37:58.536746 [debug] [MainThread]: SQL status: OK in 0.426 seconds
[0m01:37:58.540561 [info ] [MainThread]: 3 of 9 OK hook: stock_dbt_project.on-run-start.2 ............................... [[32mOK[0m in 0.45s]
[0m01:37:58.547406 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-3"
[0m01:37:58.550610 [info ] [MainThread]: 4 of 9 START hook: stock_dbt_project.on-run-start.3 ............................ [RUN]
[0m01:37:58.552197 [debug] [MainThread]: Using duckdb connection "master"
[0m01:37:58.554209 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
LOAD json;
[0m01:37:58.558209 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m01:37:58.561982 [info ] [MainThread]: 4 of 9 OK hook: stock_dbt_project.on-run-start.3 ............................... [[32mOK[0m in 0.02s]
[0m01:37:58.566510 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-4"
[0m01:37:58.568743 [info ] [MainThread]: 5 of 9 START hook: stock_dbt_project.on-run-start.4 ............................ [RUN]
[0m01:37:58.570408 [debug] [MainThread]: Using duckdb connection "master"
[0m01:37:58.571693 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
SET s3_access_key_id='minioadmin';
[0m01:37:58.573716 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m01:37:58.578885 [info ] [MainThread]: 5 of 9 OK hook: stock_dbt_project.on-run-start.4 ............................... [[32mOK[0m in 0.01s]
[0m01:37:58.586002 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-5"
[0m01:37:58.588002 [info ] [MainThread]: 6 of 9 START hook: stock_dbt_project.on-run-start.5 ............................ [RUN]
[0m01:37:58.590639 [debug] [MainThread]: Using duckdb connection "master"
[0m01:37:58.593647 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
SET s3_secret_access_key='minioadmin';
[0m01:37:58.595995 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m01:37:58.598008 [info ] [MainThread]: 6 of 9 OK hook: stock_dbt_project.on-run-start.5 ............................... [[32mOK[0m in 0.02s]
[0m01:37:58.602709 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-6"
[0m01:37:58.604487 [info ] [MainThread]: 7 of 9 START hook: stock_dbt_project.on-run-start.6 ............................ [RUN]
[0m01:37:58.607401 [debug] [MainThread]: Using duckdb connection "master"
[0m01:37:58.609705 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
SET s3_endpoint='http://localhost:9000';
[0m01:37:58.612007 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m01:37:58.614985 [info ] [MainThread]: 7 of 9 OK hook: stock_dbt_project.on-run-start.6 ............................... [[32mOK[0m in 0.01s]
[0m01:37:58.621442 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-7"
[0m01:37:58.624698 [info ] [MainThread]: 8 of 9 START hook: stock_dbt_project.on-run-start.7 ............................ [RUN]
[0m01:37:58.626711 [debug] [MainThread]: Using duckdb connection "master"
[0m01:37:58.628710 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
SET s3_use_ssl=false;
[0m01:37:58.630709 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m01:37:58.632720 [info ] [MainThread]: 8 of 9 OK hook: stock_dbt_project.on-run-start.7 ............................... [[32mOK[0m in 0.02s]
[0m01:37:58.636723 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-8"
[0m01:37:58.638718 [info ] [MainThread]: 9 of 9 START hook: stock_dbt_project.on-run-start.8 ............................ [RUN]
[0m01:37:58.642723 [debug] [MainThread]: Using duckdb connection "master"
[0m01:37:58.645748 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
SET s3_url_style='path';
[0m01:37:58.647830 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m01:37:58.650851 [info ] [MainThread]: 9 of 9 OK hook: stock_dbt_project.on-run-start.8 ............................... [[32mOK[0m in 0.02s]
[0m01:37:58.652369 [info ] [MainThread]: 
[0m01:37:58.653371 [debug] [MainThread]: On master: Close
[0m01:37:58.661477 [debug] [Thread-1 (]: Began running node model.stock_dbt_project.stg_stock_data
[0m01:37:58.662477 [info ] [Thread-1 (]: 1 of 1 START sql view model main.stg_stock_data ................................ [RUN]
[0m01:37:58.665213 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.stock_dbt_project.stg_stock_data'
[0m01:37:58.666741 [debug] [Thread-1 (]: Began compiling node model.stock_dbt_project.stg_stock_data
[0m01:37:58.671264 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_dbt_project.stg_stock_data"
[0m01:37:58.673600 [debug] [Thread-1 (]: Began executing node model.stock_dbt_project.stg_stock_data
[0m01:37:58.741155 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_dbt_project.stg_stock_data"
[0m01:37:58.744152 [debug] [Thread-1 (]: Using duckdb connection "model.stock_dbt_project.stg_stock_data"
[0m01:37:58.745155 [debug] [Thread-1 (]: On model.stock_dbt_project.stg_stock_data: BEGIN
[0m01:37:58.746155 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m01:37:58.748149 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m01:37:58.749200 [debug] [Thread-1 (]: Using duckdb connection "model.stock_dbt_project.stg_stock_data"
[0m01:37:58.750200 [debug] [Thread-1 (]: On model.stock_dbt_project.stg_stock_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "node_id": "model.stock_dbt_project.stg_stock_data"} */

  
  create view "dev"."main"."stg_stock_data__dbt_tmp" as (
    



WITH raw AS (
    SELECT *
    FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/CVX/2025/4/13/CVX_20250413_113945_jz58k4.json')
)

SELECT
    CAST(symbol AS TEXT) AS symbol,
    CAST(datetime AS TIMESTAMP) AS datetime,
    CAST(open AS DOUBLE) AS open,
    CAST(high AS DOUBLE) AS high,
    CAST(low AS DOUBLE) AS low,
    CAST(close AS DOUBLE) AS close,
    CAST(volume AS BIGINT) AS volume
FROM raw
WHERE symbol IS NOT NULL AND datetime IS NOT NULL
  );

[0m01:37:58.787481 [debug] [Thread-1 (]: SQL status: OK in 0.036 seconds
[0m01:37:58.801782 [debug] [Thread-1 (]: Using duckdb connection "model.stock_dbt_project.stg_stock_data"
[0m01:37:58.802783 [debug] [Thread-1 (]: On model.stock_dbt_project.stg_stock_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "node_id": "model.stock_dbt_project.stg_stock_data"} */
alter view "dev"."main"."stg_stock_data" rename to "stg_stock_data__dbt_backup"
[0m01:37:58.804660 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:37:58.814505 [debug] [Thread-1 (]: Using duckdb connection "model.stock_dbt_project.stg_stock_data"
[0m01:37:58.816514 [debug] [Thread-1 (]: On model.stock_dbt_project.stg_stock_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "node_id": "model.stock_dbt_project.stg_stock_data"} */
alter view "dev"."main"."stg_stock_data__dbt_tmp" rename to "stg_stock_data"
[0m01:37:58.818620 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:37:58.845853 [debug] [Thread-1 (]: On model.stock_dbt_project.stg_stock_data: COMMIT
[0m01:37:58.846940 [debug] [Thread-1 (]: Using duckdb connection "model.stock_dbt_project.stg_stock_data"
[0m01:37:58.847896 [debug] [Thread-1 (]: On model.stock_dbt_project.stg_stock_data: COMMIT
[0m01:37:58.852053 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m01:37:58.863553 [debug] [Thread-1 (]: Using duckdb connection "model.stock_dbt_project.stg_stock_data"
[0m01:37:58.865561 [debug] [Thread-1 (]: On model.stock_dbt_project.stg_stock_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "node_id": "model.stock_dbt_project.stg_stock_data"} */
drop view if exists "dev"."main"."stg_stock_data__dbt_backup" cascade
[0m01:37:58.868301 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m01:37:58.873843 [debug] [Thread-1 (]: On model.stock_dbt_project.stg_stock_data: Close
[0m01:37:58.880136 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '214e3053-a38d-4b19-b836-2193b61a1147', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000116B30EBAD0>]}
[0m01:37:58.882569 [info ] [Thread-1 (]: 1 of 1 OK created sql view model main.stg_stock_data ........................... [[32mOK[0m in 0.21s]
[0m01:37:58.883571 [debug] [Thread-1 (]: Finished running node model.stock_dbt_project.stg_stock_data
[0m01:37:58.886569 [debug] [MainThread]: Using duckdb connection "master"
[0m01:37:58.887716 [debug] [MainThread]: On master: BEGIN
[0m01:37:58.888723 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:37:58.890725 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m01:37:58.891727 [debug] [MainThread]: On master: COMMIT
[0m01:37:58.893247 [debug] [MainThread]: Using duckdb connection "master"
[0m01:37:58.894259 [debug] [MainThread]: On master: COMMIT
[0m01:37:58.896379 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m01:37:58.897396 [debug] [MainThread]: On master: Close
[0m01:37:58.898451 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:37:58.899508 [debug] [MainThread]: Connection 'create_dev_main' was properly closed.
[0m01:37:58.899508 [debug] [MainThread]: Connection 'list_dev_main' was properly closed.
[0m01:37:58.900983 [debug] [MainThread]: Connection 'model.stock_dbt_project.stg_stock_data' was properly closed.
[0m01:37:58.902068 [info ] [MainThread]: 
[0m01:37:58.903217 [info ] [MainThread]: Finished running 9 project hooks, 1 view model in 0 hours 0 minutes and 1.40 seconds (1.40s).
[0m01:37:58.910782 [debug] [MainThread]: Command end result
[0m01:37:58.964950 [debug] [MainThread]: Wrote artifact WritableManifest to D:\Stock_price\stock_dbt_project\target\manifest.json
[0m01:37:58.968963 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\Stock_price\stock_dbt_project\target\semantic_manifest.json
[0m01:37:58.982133 [debug] [MainThread]: Wrote artifact RunExecutionResult to D:\Stock_price\stock_dbt_project\target\run_results.json
[0m01:37:58.984251 [info ] [MainThread]: 
[0m01:37:58.987277 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:37:58.988962 [info ] [MainThread]: 
[0m01:37:58.993429 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=0 SKIP=0 TOTAL=10
[0m01:37:58.998678 [debug] [MainThread]: Command `dbt run` succeeded at 01:37:58.997680 after 4.49 seconds
[0m01:37:59.000191 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000116B0A1C0B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000116B4F56960>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000116B4FD3C80>]}
[0m01:37:59.003002 [debug] [MainThread]: Flushing usage events
[0m01:37:59.808599 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:39:57.575062 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020522D569F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000205224FB2C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000205224FA7E0>]}


============================== 01:39:57.587982 | e93d961a-6f94-403e-aacf-7c67ea9e13bd ==============================
[0m01:39:57.587982 [info ] [MainThread]: Running with dbt=1.9.4
[0m01:39:57.589767 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\loges\\.dbt', 'log_path': 'D:\\Stock_price\\stock_dbt_project\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run --select stg_stock_data', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m01:39:58.200589 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e93d961a-6f94-403e-aacf-7c67ea9e13bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020522D75CD0>]}
[0m01:39:58.439591 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e93d961a-6f94-403e-aacf-7c67ea9e13bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020522F6A990>]}
[0m01:39:58.454982 [info ] [MainThread]: Registered adapter: duckdb=1.9.2
[0m01:39:59.066169 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m01:40:00.002914 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m01:40:00.007041 [debug] [MainThread]: Partial parsing: updated file: stock_dbt_project://models\staging\stg_stock_data.sql
[0m01:40:01.729512 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.stock_dbt_project.marts
[0m01:40:01.767081 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e93d961a-6f94-403e-aacf-7c67ea9e13bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000205245B42C0>]}
[0m01:40:02.366258 [debug] [MainThread]: Wrote artifact WritableManifest to D:\Stock_price\stock_dbt_project\target\manifest.json
[0m01:40:02.372049 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\Stock_price\stock_dbt_project\target\semantic_manifest.json
[0m01:40:02.448211 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e93d961a-6f94-403e-aacf-7c67ea9e13bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000205243DC260>]}
[0m01:40:02.450207 [info ] [MainThread]: Found 4 models, 9 operations, 4 data tests, 426 macros
[0m01:40:02.451205 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e93d961a-6f94-403e-aacf-7c67ea9e13bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000205245F2090>]}
[0m01:40:02.454956 [info ] [MainThread]: 
[0m01:40:02.456967 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:40:02.458972 [info ] [MainThread]: 
[0m01:40:02.460972 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m01:40:02.463970 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m01:40:02.619420 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m01:40:02.620417 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m01:40:02.621420 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:40:02.665891 [debug] [ThreadPool]: SQL status: OK in 0.044 seconds
[0m01:40:02.671273 [debug] [ThreadPool]: On list_dev: Close
[0m01:40:02.675271 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m01:40:02.678808 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m01:40:02.701941 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m01:40:02.704153 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "create_dev_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m01:40:02.706172 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:40:02.710616 [debug] [ThreadPool]: SQL status: OK in 0.005 seconds
[0m01:40:02.714504 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m01:40:02.715503 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m01:40:02.717497 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m01:40:02.718624 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m01:40:02.718909 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "create_dev_main"} */

    
    
        create schema if not exists "dev"."main"
    
[0m01:40:02.720920 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m01:40:02.723097 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m01:40:02.724586 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m01:40:02.727597 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m01:40:02.730197 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m01:40:02.732212 [debug] [ThreadPool]: On create_dev_main: Close
[0m01:40:02.743746 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev_main'
[0m01:40:02.754457 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m01:40:02.755450 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m01:40:02.756450 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:40:02.759454 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m01:40:02.760453 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m01:40:02.761460 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m01:40:02.801764 [debug] [ThreadPool]: SQL status: OK in 0.039 seconds
[0m01:40:02.806769 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m01:40:02.811125 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m01:40:02.812124 [debug] [ThreadPool]: On list_dev_main: Close
[0m01:40:02.814569 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e93d961a-6f94-403e-aacf-7c67ea9e13bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020524B40C20>]}
[0m01:40:02.815690 [debug] [MainThread]: Using duckdb connection "master"
[0m01:40:02.816042 [debug] [MainThread]: On master: BEGIN
[0m01:40:02.817034 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:40:02.819034 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m01:40:02.820033 [debug] [MainThread]: On master: COMMIT
[0m01:40:02.820033 [debug] [MainThread]: Using duckdb connection "master"
[0m01:40:02.821579 [debug] [MainThread]: On master: COMMIT
[0m01:40:02.822997 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m01:40:02.841484 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-0"
[0m01:40:02.859286 [info ] [MainThread]: 1 of 9 START hook: stock_dbt_project.on-run-start.0 ............................ [RUN]
[0m01:40:02.861314 [debug] [MainThread]: Using duckdb connection "master"
[0m01:40:02.862322 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
INSTALL httpfs;
[0m01:40:02.865836 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m01:40:02.867839 [info ] [MainThread]: 1 of 9 OK hook: stock_dbt_project.on-run-start.0 ............................... [[32mOK[0m in 0.04s]
[0m01:40:02.871841 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-1"
[0m01:40:02.874844 [info ] [MainThread]: 2 of 9 START hook: stock_dbt_project.on-run-start.1 ............................ [RUN]
[0m01:40:02.878633 [debug] [MainThread]: Using duckdb connection "master"
[0m01:40:02.880619 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
INSTALL json;
[0m01:40:02.884153 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m01:40:02.887238 [info ] [MainThread]: 2 of 9 OK hook: stock_dbt_project.on-run-start.1 ............................... [[32mOK[0m in 0.02s]
[0m01:40:02.891581 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-2"
[0m01:40:02.894596 [info ] [MainThread]: 3 of 9 START hook: stock_dbt_project.on-run-start.2 ............................ [RUN]
[0m01:40:02.898196 [debug] [MainThread]: Using duckdb connection "master"
[0m01:40:02.900229 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
LOAD httpfs;
[0m01:40:03.224352 [debug] [MainThread]: SQL status: OK in 0.323 seconds
[0m01:40:03.228379 [info ] [MainThread]: 3 of 9 OK hook: stock_dbt_project.on-run-start.2 ............................... [[32mOK[0m in 0.34s]
[0m01:40:03.233984 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-3"
[0m01:40:03.236468 [info ] [MainThread]: 4 of 9 START hook: stock_dbt_project.on-run-start.3 ............................ [RUN]
[0m01:40:03.238541 [debug] [MainThread]: Using duckdb connection "master"
[0m01:40:03.240066 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
LOAD json;
[0m01:40:03.243068 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m01:40:03.247074 [info ] [MainThread]: 4 of 9 OK hook: stock_dbt_project.on-run-start.3 ............................... [[32mOK[0m in 0.02s]
[0m01:40:03.252481 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-4"
[0m01:40:03.254484 [info ] [MainThread]: 5 of 9 START hook: stock_dbt_project.on-run-start.4 ............................ [RUN]
[0m01:40:03.256481 [debug] [MainThread]: Using duckdb connection "master"
[0m01:40:03.259651 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
SET s3_access_key_id='minioadmin';
[0m01:40:03.261647 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m01:40:03.265642 [info ] [MainThread]: 5 of 9 OK hook: stock_dbt_project.on-run-start.4 ............................... [[32mOK[0m in 0.02s]
[0m01:40:03.269118 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-5"
[0m01:40:03.270113 [info ] [MainThread]: 6 of 9 START hook: stock_dbt_project.on-run-start.5 ............................ [RUN]
[0m01:40:03.272383 [debug] [MainThread]: Using duckdb connection "master"
[0m01:40:03.273949 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
SET s3_secret_access_key='minioadmin';
[0m01:40:03.275948 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m01:40:03.281685 [info ] [MainThread]: 6 of 9 OK hook: stock_dbt_project.on-run-start.5 ............................... [[32mOK[0m in 0.01s]
[0m01:40:03.288746 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-6"
[0m01:40:03.295377 [info ] [MainThread]: 7 of 9 START hook: stock_dbt_project.on-run-start.6 ............................ [RUN]
[0m01:40:03.301410 [debug] [MainThread]: Using duckdb connection "master"
[0m01:40:03.303406 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
SET s3_endpoint='http://localhost:9000';
[0m01:40:03.307413 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m01:40:03.313419 [info ] [MainThread]: 7 of 9 OK hook: stock_dbt_project.on-run-start.6 ............................... [[32mOK[0m in 0.03s]
[0m01:40:03.321056 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-7"
[0m01:40:03.326361 [info ] [MainThread]: 8 of 9 START hook: stock_dbt_project.on-run-start.7 ............................ [RUN]
[0m01:40:03.331302 [debug] [MainThread]: Using duckdb connection "master"
[0m01:40:03.333679 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
SET s3_use_ssl=false;
[0m01:40:03.337053 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m01:40:03.340600 [info ] [MainThread]: 8 of 9 OK hook: stock_dbt_project.on-run-start.7 ............................... [[32mOK[0m in 0.02s]
[0m01:40:03.350601 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-8"
[0m01:40:03.355280 [info ] [MainThread]: 9 of 9 START hook: stock_dbt_project.on-run-start.8 ............................ [RUN]
[0m01:40:03.359687 [debug] [MainThread]: Using duckdb connection "master"
[0m01:40:03.364432 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
SET s3_url_style='path';
[0m01:40:03.367446 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m01:40:03.372003 [info ] [MainThread]: 9 of 9 OK hook: stock_dbt_project.on-run-start.8 ............................... [[32mOK[0m in 0.03s]
[0m01:40:03.375512 [info ] [MainThread]: 
[0m01:40:03.380723 [debug] [MainThread]: On master: Close
[0m01:40:03.396210 [debug] [Thread-1 (]: Began running node model.stock_dbt_project.stg_stock_data
[0m01:40:03.399361 [info ] [Thread-1 (]: 1 of 1 START sql view model main.stg_stock_data ................................ [RUN]
[0m01:40:03.402353 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.stock_dbt_project.stg_stock_data'
[0m01:40:03.404793 [debug] [Thread-1 (]: Began compiling node model.stock_dbt_project.stg_stock_data
[0m01:40:03.415092 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_dbt_project.stg_stock_data"
[0m01:40:03.417622 [debug] [Thread-1 (]: Began executing node model.stock_dbt_project.stg_stock_data
[0m01:40:03.553715 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_dbt_project.stg_stock_data"
[0m01:40:03.561255 [debug] [Thread-1 (]: Using duckdb connection "model.stock_dbt_project.stg_stock_data"
[0m01:40:03.565385 [debug] [Thread-1 (]: On model.stock_dbt_project.stg_stock_data: BEGIN
[0m01:40:03.569131 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m01:40:03.573627 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m01:40:03.580833 [debug] [Thread-1 (]: Using duckdb connection "model.stock_dbt_project.stg_stock_data"
[0m01:40:03.584087 [debug] [Thread-1 (]: On model.stock_dbt_project.stg_stock_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "node_id": "model.stock_dbt_project.stg_stock_data"} */

  
  create view "dev"."main"."stg_stock_data__dbt_tmp" as (
    



WITH raw AS (
    SELECT *
    FROM read_json_auto('s3://my-stock-data-bucket/stocks/*/*/*/*/*.json')
)

SELECT
    CAST(symbol AS TEXT) AS symbol,
    CAST(datetime AS TIMESTAMP) AS datetime,
    CAST(open AS DOUBLE) AS open,
    CAST(high AS DOUBLE) AS high,
    CAST(low AS DOUBLE) AS low,
    CAST(close AS DOUBLE) AS close,
    CAST(volume AS BIGINT) AS volume
FROM raw
WHERE symbol IS NOT NULL AND datetime IS NOT NULL
  );

[0m01:40:03.967043 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "node_id": "model.stock_dbt_project.stg_stock_data"} */

  
  create view "dev"."main"."stg_stock_data__dbt_tmp" as (
    



WITH raw AS (
    SELECT *
    FROM read_json_auto('s3://my-stock-data-bucket/stocks/*/*/*/*/*.json')
)

SELECT
    CAST(symbol AS TEXT) AS symbol,
    CAST(datetime AS TIMESTAMP) AS datetime,
    CAST(open AS DOUBLE) AS open,
    CAST(high AS DOUBLE) AS high,
    CAST(low AS DOUBLE) AS low,
    CAST(close AS DOUBLE) AS close,
    CAST(volume AS BIGINT) AS volume
FROM raw
WHERE symbol IS NOT NULL AND datetime IS NOT NULL
  );

[0m01:40:03.968720 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m01:40:03.969738 [debug] [Thread-1 (]: On model.stock_dbt_project.stg_stock_data: ROLLBACK
[0m01:40:03.983380 [debug] [Thread-1 (]: Failed to rollback 'model.stock_dbt_project.stg_stock_data'
[0m01:40:03.985375 [debug] [Thread-1 (]: On model.stock_dbt_project.stg_stock_data: Close
[0m01:40:03.990315 [debug] [Thread-1 (]: Runtime Error in model stg_stock_data (models\staging\stg_stock_data.sql)
  HTTP Error: HTTP GET error on '/?encoding-type=url&list-type=2&prefix=stocks%2F' (HTTP 400)
[0m01:40:03.996859 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e93d961a-6f94-403e-aacf-7c67ea9e13bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020524D24650>]}
[0m01:40:03.999413 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model main.stg_stock_data ....................... [[31mERROR[0m in 0.59s]
[0m01:40:04.002709 [debug] [Thread-1 (]: Finished running node model.stock_dbt_project.stg_stock_data
[0m01:40:04.005122 [debug] [Thread-4 (]: Marking all children of 'model.stock_dbt_project.stg_stock_data' to be skipped because of status 'error'.  Reason: Runtime Error in model stg_stock_data (models\staging\stg_stock_data.sql)
  HTTP Error: HTTP GET error on '/?encoding-type=url&list-type=2&prefix=stocks%2F' (HTTP 400).
[0m01:40:04.011724 [debug] [MainThread]: Using duckdb connection "master"
[0m01:40:04.014741 [debug] [MainThread]: On master: BEGIN
[0m01:40:04.016993 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:40:04.018990 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m01:40:04.020990 [debug] [MainThread]: On master: COMMIT
[0m01:40:04.022387 [debug] [MainThread]: Using duckdb connection "master"
[0m01:40:04.026435 [debug] [MainThread]: On master: COMMIT
[0m01:40:04.030400 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m01:40:04.031391 [debug] [MainThread]: On master: Close
[0m01:40:04.032392 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:40:04.034846 [debug] [MainThread]: Connection 'create_dev_main' was properly closed.
[0m01:40:04.036277 [debug] [MainThread]: Connection 'list_dev_main' was properly closed.
[0m01:40:04.037276 [debug] [MainThread]: Connection 'model.stock_dbt_project.stg_stock_data' was properly closed.
[0m01:40:04.039940 [info ] [MainThread]: 
[0m01:40:04.044954 [info ] [MainThread]: Finished running 9 project hooks, 1 view model in 0 hours 0 minutes and 1.58 seconds (1.58s).
[0m01:40:04.053854 [debug] [MainThread]: Command end result
[0m01:40:04.159626 [debug] [MainThread]: Wrote artifact WritableManifest to D:\Stock_price\stock_dbt_project\target\manifest.json
[0m01:40:04.166498 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\Stock_price\stock_dbt_project\target\semantic_manifest.json
[0m01:40:04.193838 [debug] [MainThread]: Wrote artifact RunExecutionResult to D:\Stock_price\stock_dbt_project\target\run_results.json
[0m01:40:04.196102 [info ] [MainThread]: 
[0m01:40:04.197856 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m01:40:04.198969 [info ] [MainThread]: 
[0m01:40:04.200074 [error] [MainThread]:   Runtime Error in model stg_stock_data (models\staging\stg_stock_data.sql)
  HTTP Error: HTTP GET error on '/?encoding-type=url&list-type=2&prefix=stocks%2F' (HTTP 400)
[0m01:40:04.201185 [info ] [MainThread]: 
[0m01:40:04.202119 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=1 SKIP=0 TOTAL=10
[0m01:40:04.204254 [debug] [MainThread]: Command `dbt run` failed at 01:40:04.204254 after 6.97 seconds
[0m01:40:04.205253 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020522733C80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002052233A780>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020522C54FB0>]}
[0m01:40:04.206242 [debug] [MainThread]: Flushing usage events
[0m01:40:05.003614 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:42:57.209743 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000163C382B230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000163C3807800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000163C3807200>]}


============================== 01:42:57.224482 | 117625c1-0656-4e28-8415-faf58f4f72e1 ==============================
[0m01:42:57.224482 [info ] [MainThread]: Running with dbt=1.9.4
[0m01:42:57.228708 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\loges\\.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'D:\\Stock_price\\stock_dbt_project\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select stg_stock_data', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m01:42:57.766486 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '117625c1-0656-4e28-8415-faf58f4f72e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000163C3D48C20>]}
[0m01:42:57.886659 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '117625c1-0656-4e28-8415-faf58f4f72e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000163C320C6B0>]}
[0m01:42:57.894762 [info ] [MainThread]: Registered adapter: duckdb=1.9.2
[0m01:42:58.532059 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m01:42:59.047535 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m01:42:59.049344 [debug] [MainThread]: Partial parsing: updated file: stock_dbt_project://models\staging\stg_stock_data.sql
[0m01:42:59.654951 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.stock_dbt_project.marts
[0m01:42:59.701830 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '117625c1-0656-4e28-8415-faf58f4f72e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000163C54694F0>]}
[0m01:43:00.304861 [debug] [MainThread]: Wrote artifact WritableManifest to D:\Stock_price\stock_dbt_project\target\manifest.json
[0m01:43:00.317763 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\Stock_price\stock_dbt_project\target\semantic_manifest.json
[0m01:43:00.440309 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '117625c1-0656-4e28-8415-faf58f4f72e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000163C528F2C0>]}
[0m01:43:00.446698 [info ] [MainThread]: Found 4 models, 9 operations, 4 data tests, 426 macros
[0m01:43:00.450331 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '117625c1-0656-4e28-8415-faf58f4f72e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000163C5560DA0>]}
[0m01:43:00.460769 [info ] [MainThread]: 
[0m01:43:00.464767 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:43:00.466815 [info ] [MainThread]: 
[0m01:43:00.469829 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m01:43:00.476915 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m01:43:00.939875 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m01:43:00.944581 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m01:43:00.946571 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:43:01.015837 [debug] [ThreadPool]: SQL status: OK in 0.068 seconds
[0m01:43:01.023249 [debug] [ThreadPool]: On list_dev: Close
[0m01:43:01.028911 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m01:43:01.032223 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m01:43:01.065292 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m01:43:01.066813 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "create_dev_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m01:43:01.069162 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:43:01.072178 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m01:43:01.081752 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m01:43:01.083643 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m01:43:01.085652 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m01:43:01.087556 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m01:43:01.089422 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "create_dev_main"} */

    
    
        create schema if not exists "dev"."main"
    
[0m01:43:01.092503 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m01:43:01.099112 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m01:43:01.101135 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m01:43:01.103127 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m01:43:01.105197 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m01:43:01.107096 [debug] [ThreadPool]: On create_dev_main: Close
[0m01:43:01.128057 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev_main'
[0m01:43:01.153236 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m01:43:01.154773 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m01:43:01.156288 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:43:01.161132 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m01:43:01.163139 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m01:43:01.167532 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m01:43:01.267778 [debug] [ThreadPool]: SQL status: OK in 0.099 seconds
[0m01:43:01.281642 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m01:43:01.288095 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m01:43:01.294528 [debug] [ThreadPool]: On list_dev_main: Close
[0m01:43:01.300224 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '117625c1-0656-4e28-8415-faf58f4f72e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000163C3DE28D0>]}
[0m01:43:01.302735 [debug] [MainThread]: Using duckdb connection "master"
[0m01:43:01.305864 [debug] [MainThread]: On master: BEGIN
[0m01:43:01.307369 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:43:01.311924 [debug] [MainThread]: SQL status: OK in 0.004 seconds
[0m01:43:01.313988 [debug] [MainThread]: On master: COMMIT
[0m01:43:01.316002 [debug] [MainThread]: Using duckdb connection "master"
[0m01:43:01.318257 [debug] [MainThread]: On master: COMMIT
[0m01:43:01.320730 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m01:43:01.351821 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-0"
[0m01:43:01.376174 [info ] [MainThread]: 1 of 9 START hook: stock_dbt_project.on-run-start.0 ............................ [RUN]
[0m01:43:01.382117 [debug] [MainThread]: Using duckdb connection "master"
[0m01:43:01.383624 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
INSTALL httpfs;
[0m01:43:01.389858 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m01:43:01.396121 [info ] [MainThread]: 1 of 9 OK hook: stock_dbt_project.on-run-start.0 ............................... [[32mOK[0m in 0.07s]
[0m01:43:01.404833 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-1"
[0m01:43:01.411111 [info ] [MainThread]: 2 of 9 START hook: stock_dbt_project.on-run-start.1 ............................ [RUN]
[0m01:43:01.416103 [debug] [MainThread]: Using duckdb connection "master"
[0m01:43:01.418960 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
INSTALL json;
[0m01:43:01.423511 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m01:43:01.430826 [info ] [MainThread]: 2 of 9 OK hook: stock_dbt_project.on-run-start.1 ............................... [[32mOK[0m in 0.03s]
[0m01:43:01.441364 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-2"
[0m01:43:01.448602 [info ] [MainThread]: 3 of 9 START hook: stock_dbt_project.on-run-start.2 ............................ [RUN]
[0m01:43:01.452526 [debug] [MainThread]: Using duckdb connection "master"
[0m01:43:01.454604 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
LOAD httpfs;
[0m01:43:02.084222 [debug] [MainThread]: SQL status: OK in 0.627 seconds
[0m01:43:02.091318 [info ] [MainThread]: 3 of 9 OK hook: stock_dbt_project.on-run-start.2 ............................... [[32mOK[0m in 0.66s]
[0m01:43:02.103517 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-3"
[0m01:43:02.107604 [info ] [MainThread]: 4 of 9 START hook: stock_dbt_project.on-run-start.3 ............................ [RUN]
[0m01:43:02.113087 [debug] [MainThread]: Using duckdb connection "master"
[0m01:43:02.116407 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
LOAD json;
[0m01:43:02.120423 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m01:43:02.126230 [info ] [MainThread]: 4 of 9 OK hook: stock_dbt_project.on-run-start.3 ............................... [[32mOK[0m in 0.03s]
[0m01:43:02.138361 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-4"
[0m01:43:02.144460 [info ] [MainThread]: 5 of 9 START hook: stock_dbt_project.on-run-start.4 ............................ [RUN]
[0m01:43:02.151667 [debug] [MainThread]: Using duckdb connection "master"
[0m01:43:02.154578 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
SET s3_access_key_id='minioadmin';
[0m01:43:02.159316 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m01:43:02.166314 [info ] [MainThread]: 5 of 9 OK hook: stock_dbt_project.on-run-start.4 ............................... [[32mOK[0m in 0.03s]
[0m01:43:02.175207 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-5"
[0m01:43:02.181368 [info ] [MainThread]: 6 of 9 START hook: stock_dbt_project.on-run-start.5 ............................ [RUN]
[0m01:43:02.186949 [debug] [MainThread]: Using duckdb connection "master"
[0m01:43:02.189012 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
SET s3_secret_access_key='minioadmin';
[0m01:43:02.192573 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m01:43:02.200842 [info ] [MainThread]: 6 of 9 OK hook: stock_dbt_project.on-run-start.5 ............................... [[32mOK[0m in 0.03s]
[0m01:43:02.212056 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-6"
[0m01:43:02.217751 [info ] [MainThread]: 7 of 9 START hook: stock_dbt_project.on-run-start.6 ............................ [RUN]
[0m01:43:02.222329 [debug] [MainThread]: Using duckdb connection "master"
[0m01:43:02.225108 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
SET s3_endpoint='http://localhost:9000';
[0m01:43:02.230326 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m01:43:02.235413 [info ] [MainThread]: 7 of 9 OK hook: stock_dbt_project.on-run-start.6 ............................... [[32mOK[0m in 0.03s]
[0m01:43:02.245317 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-7"
[0m01:43:02.251397 [info ] [MainThread]: 8 of 9 START hook: stock_dbt_project.on-run-start.7 ............................ [RUN]
[0m01:43:02.258916 [debug] [MainThread]: Using duckdb connection "master"
[0m01:43:02.264519 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
SET s3_use_ssl=false;
[0m01:43:02.267828 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m01:43:02.272990 [info ] [MainThread]: 8 of 9 OK hook: stock_dbt_project.on-run-start.7 ............................... [[32mOK[0m in 0.03s]
[0m01:43:02.289857 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-8"
[0m01:43:02.295889 [info ] [MainThread]: 9 of 9 START hook: stock_dbt_project.on-run-start.8 ............................ [RUN]
[0m01:43:02.301074 [debug] [MainThread]: Using duckdb connection "master"
[0m01:43:02.304695 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
SET s3_url_style='path';
[0m01:43:02.307636 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m01:43:02.312412 [info ] [MainThread]: 9 of 9 OK hook: stock_dbt_project.on-run-start.8 ............................... [[32mOK[0m in 0.03s]
[0m01:43:02.314604 [info ] [MainThread]: 
[0m01:43:02.316820 [debug] [MainThread]: On master: Close
[0m01:43:02.325966 [debug] [Thread-1 (]: Began running node model.stock_dbt_project.stg_stock_data
[0m01:43:02.329302 [info ] [Thread-1 (]: 1 of 1 START sql view model main.stg_stock_data ................................ [RUN]
[0m01:43:02.332610 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.stock_dbt_project.stg_stock_data'
[0m01:43:02.333678 [debug] [Thread-1 (]: Began compiling node model.stock_dbt_project.stg_stock_data
[0m01:43:02.339532 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_dbt_project.stg_stock_data"
[0m01:43:02.342291 [debug] [Thread-1 (]: Began executing node model.stock_dbt_project.stg_stock_data
[0m01:43:02.422092 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_dbt_project.stg_stock_data"
[0m01:43:02.424026 [debug] [Thread-1 (]: Using duckdb connection "model.stock_dbt_project.stg_stock_data"
[0m01:43:02.425027 [debug] [Thread-1 (]: On model.stock_dbt_project.stg_stock_data: BEGIN
[0m01:43:02.428033 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m01:43:02.431015 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m01:43:02.432087 [debug] [Thread-1 (]: Using duckdb connection "model.stock_dbt_project.stg_stock_data"
[0m01:43:02.433096 [debug] [Thread-1 (]: On model.stock_dbt_project.stg_stock_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "node_id": "model.stock_dbt_project.stg_stock_data"} */

  
  create view "dev"."main"."stg_stock_data__dbt_tmp" as (
    



WITH raw AS (
    SELECT *
    FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/CVX/2025/4/13/*.json')
)

SELECT
    CAST(symbol AS TEXT) AS symbol,
    CAST(datetime AS TIMESTAMP) AS datetime,
    CAST(open AS DOUBLE) AS open,
    CAST(high AS DOUBLE) AS high,
    CAST(low AS DOUBLE) AS low,
    CAST(close AS DOUBLE) AS close,
    CAST(volume AS BIGINT) AS volume
FROM raw
WHERE symbol IS NOT NULL AND datetime IS NOT NULL
  );

[0m01:43:02.446894 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "node_id": "model.stock_dbt_project.stg_stock_data"} */

  
  create view "dev"."main"."stg_stock_data__dbt_tmp" as (
    



WITH raw AS (
    SELECT *
    FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/CVX/2025/4/13/*.json')
)

SELECT
    CAST(symbol AS TEXT) AS symbol,
    CAST(datetime AS TIMESTAMP) AS datetime,
    CAST(open AS DOUBLE) AS open,
    CAST(high AS DOUBLE) AS high,
    CAST(low AS DOUBLE) AS low,
    CAST(close AS DOUBLE) AS close,
    CAST(volume AS BIGINT) AS volume
FROM raw
WHERE symbol IS NOT NULL AND datetime IS NOT NULL
  );

[0m01:43:02.448885 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m01:43:02.449889 [debug] [Thread-1 (]: On model.stock_dbt_project.stg_stock_data: ROLLBACK
[0m01:43:02.461230 [debug] [Thread-1 (]: Failed to rollback 'model.stock_dbt_project.stg_stock_data'
[0m01:43:02.462230 [debug] [Thread-1 (]: On model.stock_dbt_project.stg_stock_data: Close
[0m01:43:02.467794 [debug] [Thread-1 (]: Runtime Error in model stg_stock_data (models\staging\stg_stock_data.sql)
  HTTP Error: Unable to connect to URL "http://localhost:9000/my-stock-data-bucket/stocks/CVX/2025/4/13/*.json": 404 (Not Found).
[0m01:43:02.472411 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '117625c1-0656-4e28-8415-faf58f4f72e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000163C558D610>]}
[0m01:43:02.473410 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model main.stg_stock_data ....................... [[31mERROR[0m in 0.14s]
[0m01:43:02.475405 [debug] [Thread-1 (]: Finished running node model.stock_dbt_project.stg_stock_data
[0m01:43:02.477942 [debug] [Thread-4 (]: Marking all children of 'model.stock_dbt_project.stg_stock_data' to be skipped because of status 'error'.  Reason: Runtime Error in model stg_stock_data (models\staging\stg_stock_data.sql)
  HTTP Error: Unable to connect to URL "http://localhost:9000/my-stock-data-bucket/stocks/CVX/2025/4/13/*.json": 404 (Not Found)..
[0m01:43:02.483058 [debug] [MainThread]: Using duckdb connection "master"
[0m01:43:02.484345 [debug] [MainThread]: On master: BEGIN
[0m01:43:02.485365 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:43:02.486364 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m01:43:02.487367 [debug] [MainThread]: On master: COMMIT
[0m01:43:02.488365 [debug] [MainThread]: Using duckdb connection "master"
[0m01:43:02.489356 [debug] [MainThread]: On master: COMMIT
[0m01:43:02.490894 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m01:43:02.492922 [debug] [MainThread]: On master: Close
[0m01:43:02.493919 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:43:02.494917 [debug] [MainThread]: Connection 'create_dev_main' was properly closed.
[0m01:43:02.496439 [debug] [MainThread]: Connection 'list_dev_main' was properly closed.
[0m01:43:02.497454 [debug] [MainThread]: Connection 'model.stock_dbt_project.stg_stock_data' was properly closed.
[0m01:43:02.499067 [info ] [MainThread]: 
[0m01:43:02.501076 [info ] [MainThread]: Finished running 9 project hooks, 1 view model in 0 hours 0 minutes and 2.03 seconds (2.03s).
[0m01:43:02.506044 [debug] [MainThread]: Command end result
[0m01:43:02.566347 [debug] [MainThread]: Wrote artifact WritableManifest to D:\Stock_price\stock_dbt_project\target\manifest.json
[0m01:43:02.570349 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\Stock_price\stock_dbt_project\target\semantic_manifest.json
[0m01:43:02.587349 [debug] [MainThread]: Wrote artifact RunExecutionResult to D:\Stock_price\stock_dbt_project\target\run_results.json
[0m01:43:02.588340 [info ] [MainThread]: 
[0m01:43:02.589553 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m01:43:02.590716 [info ] [MainThread]: 
[0m01:43:02.591795 [error] [MainThread]:   Runtime Error in model stg_stock_data (models\staging\stg_stock_data.sql)
  HTTP Error: Unable to connect to URL "http://localhost:9000/my-stock-data-bucket/stocks/CVX/2025/4/13/*.json": 404 (Not Found).
[0m01:43:02.593369 [info ] [MainThread]: 
[0m01:43:02.595373 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=1 SKIP=0 TOTAL=10
[0m01:43:02.599876 [debug] [MainThread]: Command `dbt run` failed at 01:43:02.598364 after 5.77 seconds
[0m01:43:02.600885 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000163C3AC6DB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000163C3D1B770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000163C3CC6ED0>]}
[0m01:43:02.602888 [debug] [MainThread]: Flushing usage events
[0m01:43:03.399760 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m03:47:19.628767 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F4E4AFAC90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F4E59A1AF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F4E59A27B0>]}


============================== 03:47:19.643977 | dd659915-1e71-4b5a-b5f1-5f7d360a561c ==============================
[0m03:47:19.643977 [info ] [MainThread]: Running with dbt=1.9.4
[0m03:47:19.643977 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\loges\\.dbt', 'log_path': 'D:\\Stock_price\\stock_dbt_project\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --select read_csv', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m03:47:20.288618 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'dd659915-1e71-4b5a-b5f1-5f7d360a561c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F4E5EDE240>]}
[0m03:47:20.503657 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'dd659915-1e71-4b5a-b5f1-5f7d360a561c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F4E5EE9280>]}
[0m03:47:20.524389 [info ] [MainThread]: Registered adapter: duckdb=1.9.2
[0m03:47:21.072551 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m03:47:23.327280 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m03:47:23.334432 [debug] [MainThread]: Partial parsing: added file: stock_dbt_project://models\read_csv.sql
[0m03:47:23.757239 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.stock_dbt_project.marts
[0m03:47:23.778085 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'dd659915-1e71-4b5a-b5f1-5f7d360a561c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F4E7641DC0>]}
[0m03:47:23.919635 [debug] [MainThread]: Wrote artifact WritableManifest to D:\Stock_price\stock_dbt_project\target\manifest.json
[0m03:47:23.938358 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\Stock_price\stock_dbt_project\target\semantic_manifest.json
[0m03:47:23.972385 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'dd659915-1e71-4b5a-b5f1-5f7d360a561c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F4E733F7A0>]}
[0m03:47:23.986298 [info ] [MainThread]: Found 5 models, 9 operations, 4 data tests, 426 macros
[0m03:47:23.987325 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dd659915-1e71-4b5a-b5f1-5f7d360a561c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F4E7631E50>]}
[0m03:47:23.990319 [info ] [MainThread]: 
[0m03:47:23.991320 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m03:47:23.992311 [info ] [MainThread]: 
[0m03:47:23.993507 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m03:47:23.995510 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m03:47:30.951313 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m03:47:30.953746 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m03:47:30.955761 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:47:31.018858 [debug] [ThreadPool]: SQL status: OK in 0.063 seconds
[0m03:47:31.023350 [debug] [ThreadPool]: On list_dev: Close
[0m03:47:31.025726 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m03:47:31.027266 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m03:47:31.053784 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m03:47:31.055440 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "create_dev_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m03:47:31.056459 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:47:31.059967 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m03:47:31.063249 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m03:47:31.067732 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m03:47:31.069543 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m03:47:31.071189 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m03:47:31.072479 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "create_dev_main"} */

    
    
        create schema if not exists "dev"."main"
    
[0m03:47:31.074307 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m03:47:31.077742 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m03:47:31.079511 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m03:47:31.080739 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m03:47:31.080739 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m03:47:31.084165 [debug] [ThreadPool]: On create_dev_main: Close
[0m03:47:31.098645 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev_main'
[0m03:47:31.113288 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m03:47:31.116204 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m03:47:31.117864 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:47:31.119939 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m03:47:31.120959 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m03:47:31.121958 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m03:47:31.173204 [debug] [ThreadPool]: SQL status: OK in 0.051 seconds
[0m03:47:31.173204 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m03:47:31.208795 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m03:47:31.208795 [debug] [ThreadPool]: On list_dev_main: Close
[0m03:47:31.208795 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dd659915-1e71-4b5a-b5f1-5f7d360a561c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F4E758BEF0>]}
[0m03:47:31.215181 [debug] [MainThread]: Using duckdb connection "master"
[0m03:47:31.217557 [debug] [MainThread]: On master: BEGIN
[0m03:47:31.218396 [debug] [MainThread]: Opening a new connection, currently in state init
[0m03:47:31.221934 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m03:47:31.222954 [debug] [MainThread]: On master: COMMIT
[0m03:47:31.223957 [debug] [MainThread]: Using duckdb connection "master"
[0m03:47:31.225947 [debug] [MainThread]: On master: COMMIT
[0m03:47:31.226952 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m03:47:31.242556 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-0"
[0m03:47:31.255480 [info ] [MainThread]: 1 of 9 START hook: stock_dbt_project.on-run-start.0 ............................ [RUN]
[0m03:47:31.256550 [debug] [MainThread]: Using duckdb connection "master"
[0m03:47:31.256550 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
INSTALL httpfs;
[0m03:47:31.275686 [debug] [MainThread]: SQL status: OK in 0.016 seconds
[0m03:47:31.279859 [info ] [MainThread]: 1 of 9 OK hook: stock_dbt_project.on-run-start.0 ............................... [[32mOK[0m in 0.05s]
[0m03:47:31.288529 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-1"
[0m03:47:31.292523 [info ] [MainThread]: 2 of 9 START hook: stock_dbt_project.on-run-start.1 ............................ [RUN]
[0m03:47:31.295056 [debug] [MainThread]: Using duckdb connection "master"
[0m03:47:31.298070 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
INSTALL json;
[0m03:47:31.327727 [debug] [MainThread]: SQL status: OK in 0.027 seconds
[0m03:47:31.332948 [info ] [MainThread]: 2 of 9 OK hook: stock_dbt_project.on-run-start.1 ............................... [[32mOK[0m in 0.05s]
[0m03:47:31.342744 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-2"
[0m03:47:31.353936 [info ] [MainThread]: 3 of 9 START hook: stock_dbt_project.on-run-start.2 ............................ [RUN]
[0m03:47:31.357675 [debug] [MainThread]: Using duckdb connection "master"
[0m03:47:31.360526 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
LOAD httpfs;
[0m03:47:32.874870 [debug] [MainThread]: SQL status: OK in 1.512 seconds
[0m03:47:32.879427 [info ] [MainThread]: 3 of 9 OK hook: stock_dbt_project.on-run-start.2 ............................... [[32mOK[0m in 1.54s]
[0m03:47:32.893964 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-3"
[0m03:47:32.900266 [info ] [MainThread]: 4 of 9 START hook: stock_dbt_project.on-run-start.3 ............................ [RUN]
[0m03:47:32.910452 [debug] [MainThread]: Using duckdb connection "master"
[0m03:47:32.913342 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
LOAD json;
[0m03:47:32.917635 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m03:47:32.923035 [info ] [MainThread]: 4 of 9 OK hook: stock_dbt_project.on-run-start.3 ............................... [[32mOK[0m in 0.04s]
[0m03:47:32.943030 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-4"
[0m03:47:32.948525 [info ] [MainThread]: 5 of 9 START hook: stock_dbt_project.on-run-start.4 ............................ [RUN]
[0m03:47:32.953659 [debug] [MainThread]: Using duckdb connection "master"
[0m03:47:32.968548 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
SET s3_access_key_id='minioadmin';
[0m03:47:32.977542 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m03:47:32.986160 [info ] [MainThread]: 5 of 9 OK hook: stock_dbt_project.on-run-start.4 ............................... [[32mOK[0m in 0.06s]
[0m03:47:33.001862 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-5"
[0m03:47:33.021165 [info ] [MainThread]: 6 of 9 START hook: stock_dbt_project.on-run-start.5 ............................ [RUN]
[0m03:47:33.029227 [debug] [MainThread]: Using duckdb connection "master"
[0m03:47:33.040486 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
SET s3_secret_access_key='minioadmin';
[0m03:47:33.046345 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m03:47:33.057010 [info ] [MainThread]: 6 of 9 OK hook: stock_dbt_project.on-run-start.5 ............................... [[32mOK[0m in 0.06s]
[0m03:47:33.080456 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-6"
[0m03:47:33.091774 [info ] [MainThread]: 7 of 9 START hook: stock_dbt_project.on-run-start.6 ............................ [RUN]
[0m03:47:33.103027 [debug] [MainThread]: Using duckdb connection "master"
[0m03:47:33.109012 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
SET s3_endpoint='http://localhost:9000';
[0m03:47:33.112668 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m03:47:33.127253 [info ] [MainThread]: 7 of 9 OK hook: stock_dbt_project.on-run-start.6 ............................... [[32mOK[0m in 0.06s]
[0m03:47:33.145580 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-7"
[0m03:47:33.155366 [info ] [MainThread]: 8 of 9 START hook: stock_dbt_project.on-run-start.7 ............................ [RUN]
[0m03:47:33.160468 [debug] [MainThread]: Using duckdb connection "master"
[0m03:47:33.165417 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
SET s3_use_ssl=false;
[0m03:47:33.172476 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m03:47:33.178975 [info ] [MainThread]: 8 of 9 OK hook: stock_dbt_project.on-run-start.7 ............................... [[32mOK[0m in 0.04s]
[0m03:47:33.191043 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-8"
[0m03:47:33.197509 [info ] [MainThread]: 9 of 9 START hook: stock_dbt_project.on-run-start.8 ............................ [RUN]
[0m03:47:33.203253 [debug] [MainThread]: Using duckdb connection "master"
[0m03:47:33.205981 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
SET s3_url_style='path';
[0m03:47:33.210052 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m03:47:33.221969 [info ] [MainThread]: 9 of 9 OK hook: stock_dbt_project.on-run-start.8 ............................... [[32mOK[0m in 0.04s]
[0m03:47:33.228197 [info ] [MainThread]: 
[0m03:47:33.232927 [debug] [MainThread]: On master: Close
[0m03:47:33.270868 [debug] [Thread-1 (]: Began running node model.stock_dbt_project.read_csv
[0m03:47:33.275253 [info ] [Thread-1 (]: 1 of 1 START sql table model main.read_csv ..................................... [RUN]
[0m03:47:33.282500 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.stock_dbt_project.read_csv'
[0m03:47:33.283918 [debug] [Thread-1 (]: Began compiling node model.stock_dbt_project.read_csv
[0m03:47:33.301279 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_dbt_project.read_csv"
[0m03:47:33.319033 [debug] [Thread-1 (]: Began executing node model.stock_dbt_project.read_csv
[0m03:47:33.477982 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_dbt_project.read_csv"
[0m03:47:33.486417 [debug] [Thread-1 (]: Using duckdb connection "model.stock_dbt_project.read_csv"
[0m03:47:33.488414 [debug] [Thread-1 (]: On model.stock_dbt_project.read_csv: BEGIN
[0m03:47:33.489280 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m03:47:33.490250 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m03:47:33.490250 [debug] [Thread-1 (]: Using duckdb connection "model.stock_dbt_project.read_csv"
[0m03:47:33.493332 [debug] [Thread-1 (]: On model.stock_dbt_project.read_csv: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "node_id": "model.stock_dbt_project.read_csv"} */

  
    
    

    create  table
      "dev"."main"."read_csv__dbt_tmp"
  
    as (
      

-- Load DuckDB S3 config (MinIO)
SET s3_endpoint = 'localhost:9000';
SET s3_access_key_id = 'minioadmin';
SET s3_secret_access_key = 'minioadmin';
SET s3_region = 'us-east-1';
SET s3_url_style = 'path';

-- Read all stocks from all symbols and dates
SELECT 
    json_extract_string(value, '$.symbol') AS symbol,
    json_extract_string(value, '$.datetime') AS datetime,
    json_extract_double(value, '$.open') AS open,
    json_extract_double(value, '$.high') AS high,
    json_extract_double(value, '$.low') AS low,
    json_extract_double(value, '$.close') AS close,
    json_extract_double(value, '$.volume') AS volume
FROM 
    read_ndjson_auto('s3://my-stock-data-bucket/stocks/*/*/*/*/*.json')
    );
  
  
[0m03:47:33.506791 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "node_id": "model.stock_dbt_project.read_csv"} */

  
    
    

    create  table
      "dev"."main"."read_csv__dbt_tmp"
  
    as (
      

-- Load DuckDB S3 config (MinIO)
SET s3_endpoint = 'localhost:9000';
SET s3_access_key_id = 'minioadmin';
SET s3_secret_access_key = 'minioadmin';
SET s3_region = 'us-east-1';
SET s3_url_style = 'path';

-- Read all stocks from all symbols and dates
SELECT 
    json_extract_string(value, '$.symbol') AS symbol,
    json_extract_string(value, '$.datetime') AS datetime,
    json_extract_double(value, '$.open') AS open,
    json_extract_double(value, '$.high') AS high,
    json_extract_double(value, '$.low') AS low,
    json_extract_double(value, '$.close') AS close,
    json_extract_double(value, '$.volume') AS volume
FROM 
    read_ndjson_auto('s3://my-stock-data-bucket/stocks/*/*/*/*/*.json')
    );
  
  
[0m03:47:33.507806 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m03:47:33.508805 [debug] [Thread-1 (]: On model.stock_dbt_project.read_csv: ROLLBACK
[0m03:47:33.786737 [debug] [Thread-1 (]: Failed to rollback 'model.stock_dbt_project.read_csv'
[0m03:47:33.788737 [debug] [Thread-1 (]: On model.stock_dbt_project.read_csv: Close
[0m03:47:33.789502 [debug] [Thread-1 (]: Runtime Error in model read_csv (models\read_csv.sql)
  Parser Error: syntax error at or near "SET"
[0m03:47:33.795513 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dd659915-1e71-4b5a-b5f1-5f7d360a561c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F4E7C5CFB0>]}
[0m03:47:33.795513 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model main.read_csv ............................ [[31mERROR[0m in 0.51s]
[0m03:47:33.795513 [debug] [Thread-1 (]: Finished running node model.stock_dbt_project.read_csv
[0m03:47:33.803492 [debug] [Thread-4 (]: Marking all children of 'model.stock_dbt_project.read_csv' to be skipped because of status 'error'.  Reason: Runtime Error in model read_csv (models\read_csv.sql)
  Parser Error: syntax error at or near "SET".
[0m03:47:33.807170 [debug] [MainThread]: Using duckdb connection "master"
[0m03:47:33.808148 [debug] [MainThread]: On master: BEGIN
[0m03:47:33.809379 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m03:47:33.809379 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m03:47:33.811397 [debug] [MainThread]: On master: COMMIT
[0m03:47:33.811397 [debug] [MainThread]: Using duckdb connection "master"
[0m03:47:33.811397 [debug] [MainThread]: On master: COMMIT
[0m03:47:33.811397 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m03:47:33.811397 [debug] [MainThread]: On master: Close
[0m03:47:33.818425 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:47:33.819496 [debug] [MainThread]: Connection 'create_dev_main' was properly closed.
[0m03:47:33.821024 [debug] [MainThread]: Connection 'list_dev_main' was properly closed.
[0m03:47:33.822548 [debug] [MainThread]: Connection 'model.stock_dbt_project.read_csv' was properly closed.
[0m03:47:33.823562 [info ] [MainThread]: 
[0m03:47:33.825644 [info ] [MainThread]: Finished running 9 project hooks, 1 table model in 0 hours 0 minutes and 9.83 seconds (9.83s).
[0m03:47:33.834470 [debug] [MainThread]: Command end result
[0m03:47:33.906566 [debug] [MainThread]: Wrote artifact WritableManifest to D:\Stock_price\stock_dbt_project\target\manifest.json
[0m03:47:33.910579 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\Stock_price\stock_dbt_project\target\semantic_manifest.json
[0m03:47:33.938369 [debug] [MainThread]: Wrote artifact RunExecutionResult to D:\Stock_price\stock_dbt_project\target\run_results.json
[0m03:47:33.940355 [info ] [MainThread]: 
[0m03:47:33.943289 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m03:47:33.943811 [info ] [MainThread]: 
[0m03:47:33.943811 [error] [MainThread]:   Runtime Error in model read_csv (models\read_csv.sql)
  Parser Error: syntax error at or near "SET"
[0m03:47:33.950602 [info ] [MainThread]: 
[0m03:47:33.953201 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=1 SKIP=0 TOTAL=10
[0m03:47:33.957422 [debug] [MainThread]: Command `dbt run` failed at 03:47:33.957422 after 14.59 seconds
[0m03:47:33.959955 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F4E5E53D70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F4E5969CA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F4E52B7590>]}
[0m03:47:33.963167 [debug] [MainThread]: Flushing usage events
[0m03:47:34.662148 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m03:48:40.043081 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D0F7452DB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D0FA3C8AD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D0FA3CBF20>]}


============================== 03:48:40.046367 | cbb66347-b02c-49d4-bead-e3f5d088e831 ==============================
[0m03:48:40.046367 [info ] [MainThread]: Running with dbt=1.9.4
[0m03:48:40.046367 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'D:\\Stock_price\\stock_dbt_project\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\loges\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run --select read_csv', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m03:48:40.780126 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cbb66347-b02c-49d4-bead-e3f5d088e831', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D0FA878A10>]}
[0m03:48:41.009533 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cbb66347-b02c-49d4-bead-e3f5d088e831', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D0FA425460>]}
[0m03:48:41.024794 [info ] [MainThread]: Registered adapter: duckdb=1.9.2
[0m03:48:41.873869 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m03:48:42.121795 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m03:48:42.122776 [debug] [MainThread]: Partial parsing: updated file: stock_dbt_project://models\read_csv.sql
[0m03:48:42.772761 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.stock_dbt_project.marts
[0m03:48:42.793536 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cbb66347-b02c-49d4-bead-e3f5d088e831', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D0FC025E20>]}
[0m03:48:42.958325 [debug] [MainThread]: Wrote artifact WritableManifest to D:\Stock_price\stock_dbt_project\target\manifest.json
[0m03:48:42.960049 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\Stock_price\stock_dbt_project\target\semantic_manifest.json
[0m03:48:43.053733 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cbb66347-b02c-49d4-bead-e3f5d088e831', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D0FBD307D0>]}
[0m03:48:43.055831 [info ] [MainThread]: Found 5 models, 9 operations, 4 data tests, 426 macros
[0m03:48:43.057097 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cbb66347-b02c-49d4-bead-e3f5d088e831', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D0FBDCAC30>]}
[0m03:48:43.060738 [info ] [MainThread]: 
[0m03:48:43.060738 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m03:48:43.067781 [info ] [MainThread]: 
[0m03:48:43.069777 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m03:48:43.073788 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m03:48:43.281263 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m03:48:43.281263 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m03:48:43.286278 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:48:43.310524 [debug] [ThreadPool]: SQL status: OK in 0.029 seconds
[0m03:48:43.310524 [debug] [ThreadPool]: On list_dev: Close
[0m03:48:43.321933 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m03:48:43.323948 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m03:48:43.341715 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m03:48:43.344740 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "create_dev_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m03:48:43.345842 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:48:43.348689 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m03:48:43.353481 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m03:48:43.354680 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m03:48:43.357488 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m03:48:43.359407 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m03:48:43.360500 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "create_dev_main"} */

    
    
        create schema if not exists "dev"."main"
    
[0m03:48:43.362007 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m03:48:43.365111 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m03:48:43.366914 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m03:48:43.368559 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m03:48:43.370495 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m03:48:43.371729 [debug] [ThreadPool]: On create_dev_main: Close
[0m03:48:43.384321 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev_main'
[0m03:48:43.390368 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m03:48:43.390368 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m03:48:43.397082 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:48:43.397082 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m03:48:43.397082 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m03:48:43.397082 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m03:48:43.425813 [debug] [ThreadPool]: SQL status: OK in 0.031 seconds
[0m03:48:43.425813 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m03:48:43.439349 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m03:48:43.440369 [debug] [ThreadPool]: On list_dev_main: Close
[0m03:48:43.442368 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cbb66347-b02c-49d4-bead-e3f5d088e831', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D0FBEA33B0>]}
[0m03:48:43.443359 [debug] [MainThread]: Using duckdb connection "master"
[0m03:48:43.443359 [debug] [MainThread]: On master: BEGIN
[0m03:48:43.444549 [debug] [MainThread]: Opening a new connection, currently in state init
[0m03:48:43.444549 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m03:48:43.445744 [debug] [MainThread]: On master: COMMIT
[0m03:48:43.445744 [debug] [MainThread]: Using duckdb connection "master"
[0m03:48:43.445744 [debug] [MainThread]: On master: COMMIT
[0m03:48:43.445744 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m03:48:43.457678 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-0"
[0m03:48:43.459512 [info ] [MainThread]: 1 of 9 START hook: stock_dbt_project.on-run-start.0 ............................ [RUN]
[0m03:48:43.466489 [debug] [MainThread]: Using duckdb connection "master"
[0m03:48:43.467851 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
INSTALL httpfs;
[0m03:48:43.471853 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m03:48:43.473460 [info ] [MainThread]: 1 of 9 OK hook: stock_dbt_project.on-run-start.0 ............................... [[32mOK[0m in 0.03s]
[0m03:48:43.476272 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-1"
[0m03:48:43.478260 [info ] [MainThread]: 2 of 9 START hook: stock_dbt_project.on-run-start.1 ............................ [RUN]
[0m03:48:43.479345 [debug] [MainThread]: Using duckdb connection "master"
[0m03:48:43.480204 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
INSTALL json;
[0m03:48:43.482211 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m03:48:43.485219 [info ] [MainThread]: 2 of 9 OK hook: stock_dbt_project.on-run-start.1 ............................... [[32mOK[0m in 0.01s]
[0m03:48:43.489434 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-2"
[0m03:48:43.490953 [info ] [MainThread]: 3 of 9 START hook: stock_dbt_project.on-run-start.2 ............................ [RUN]
[0m03:48:43.491956 [debug] [MainThread]: Using duckdb connection "master"
[0m03:48:43.493727 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
LOAD httpfs;
[0m03:48:43.845237 [debug] [MainThread]: SQL status: OK in 0.350 seconds
[0m03:48:43.849250 [info ] [MainThread]: 3 of 9 OK hook: stock_dbt_project.on-run-start.2 ............................... [[32mOK[0m in 0.36s]
[0m03:48:43.856140 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-3"
[0m03:48:43.860875 [info ] [MainThread]: 4 of 9 START hook: stock_dbt_project.on-run-start.3 ............................ [RUN]
[0m03:48:43.863324 [debug] [MainThread]: Using duckdb connection "master"
[0m03:48:43.865091 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
LOAD json;
[0m03:48:43.868050 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m03:48:43.873884 [info ] [MainThread]: 4 of 9 OK hook: stock_dbt_project.on-run-start.3 ............................... [[32mOK[0m in 0.02s]
[0m03:48:43.884528 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-4"
[0m03:48:43.889898 [info ] [MainThread]: 5 of 9 START hook: stock_dbt_project.on-run-start.4 ............................ [RUN]
[0m03:48:43.892911 [debug] [MainThread]: Using duckdb connection "master"
[0m03:48:43.895072 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
SET s3_access_key_id='minioadmin';
[0m03:48:43.897100 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m03:48:43.899187 [info ] [MainThread]: 5 of 9 OK hook: stock_dbt_project.on-run-start.4 ............................... [[32mOK[0m in 0.02s]
[0m03:48:43.909931 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-5"
[0m03:48:43.912922 [info ] [MainThread]: 6 of 9 START hook: stock_dbt_project.on-run-start.5 ............................ [RUN]
[0m03:48:43.916964 [debug] [MainThread]: Using duckdb connection "master"
[0m03:48:43.920078 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
SET s3_secret_access_key='minioadmin';
[0m03:48:43.923176 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m03:48:43.927846 [info ] [MainThread]: 6 of 9 OK hook: stock_dbt_project.on-run-start.5 ............................... [[32mOK[0m in 0.03s]
[0m03:48:43.936125 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-6"
[0m03:48:43.942611 [info ] [MainThread]: 7 of 9 START hook: stock_dbt_project.on-run-start.6 ............................ [RUN]
[0m03:48:43.946822 [debug] [MainThread]: Using duckdb connection "master"
[0m03:48:43.949796 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
SET s3_endpoint='http://localhost:9000';
[0m03:48:43.954694 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m03:48:43.959097 [info ] [MainThread]: 7 of 9 OK hook: stock_dbt_project.on-run-start.6 ............................... [[32mOK[0m in 0.03s]
[0m03:48:43.968308 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-7"
[0m03:48:43.972190 [info ] [MainThread]: 8 of 9 START hook: stock_dbt_project.on-run-start.7 ............................ [RUN]
[0m03:48:43.975825 [debug] [MainThread]: Using duckdb connection "master"
[0m03:48:43.976840 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
SET s3_use_ssl=false;
[0m03:48:43.979109 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m03:48:43.983072 [info ] [MainThread]: 8 of 9 OK hook: stock_dbt_project.on-run-start.7 ............................... [[32mOK[0m in 0.02s]
[0m03:48:43.989820 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-8"
[0m03:48:43.992673 [info ] [MainThread]: 9 of 9 START hook: stock_dbt_project.on-run-start.8 ............................ [RUN]
[0m03:48:43.995180 [debug] [MainThread]: Using duckdb connection "master"
[0m03:48:43.996184 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
SET s3_url_style='path';
[0m03:48:43.999266 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m03:48:44.004889 [info ] [MainThread]: 9 of 9 OK hook: stock_dbt_project.on-run-start.8 ............................... [[32mOK[0m in 0.02s]
[0m03:48:44.007650 [info ] [MainThread]: 
[0m03:48:44.010454 [debug] [MainThread]: On master: Close
[0m03:48:44.022614 [debug] [Thread-1 (]: Began running node model.stock_dbt_project.read_csv
[0m03:48:44.024455 [info ] [Thread-1 (]: 1 of 1 START sql table model main.read_csv ..................................... [RUN]
[0m03:48:44.027363 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.stock_dbt_project.read_csv'
[0m03:48:44.028357 [debug] [Thread-1 (]: Began compiling node model.stock_dbt_project.read_csv
[0m03:48:44.037718 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_dbt_project.read_csv"
[0m03:48:44.040238 [debug] [Thread-1 (]: Began executing node model.stock_dbt_project.read_csv
[0m03:48:44.146117 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_dbt_project.read_csv"
[0m03:48:44.149387 [debug] [Thread-1 (]: Using duckdb connection "model.stock_dbt_project.read_csv"
[0m03:48:44.150774 [debug] [Thread-1 (]: On model.stock_dbt_project.read_csv: BEGIN
[0m03:48:44.151943 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m03:48:44.153980 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m03:48:44.155000 [debug] [Thread-1 (]: Using duckdb connection "model.stock_dbt_project.read_csv"
[0m03:48:44.155998 [debug] [Thread-1 (]: On model.stock_dbt_project.read_csv: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "node_id": "model.stock_dbt_project.read_csv"} */

  
    
    

    create  table
      "dev"."main"."read_csv__dbt_tmp"
  
    as (
      



-- Read all stocks from all symbols and dates
SELECT 
    json_extract_string(value, '$.symbol') AS symbol,
    json_extract_string(value, '$.datetime') AS datetime,
    json_extract_double(value, '$.open') AS open,
    json_extract_double(value, '$.high') AS high,
    json_extract_double(value, '$.low') AS low,
    json_extract_double(value, '$.close') AS close,
    json_extract_double(value, '$.volume') AS volume
FROM 
    read_ndjson_auto('s3://my-stock-data-bucket/stocks/*/*/*/*/*.json')
    );
  
  
[0m03:48:44.533797 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "node_id": "model.stock_dbt_project.read_csv"} */

  
    
    

    create  table
      "dev"."main"."read_csv__dbt_tmp"
  
    as (
      



-- Read all stocks from all symbols and dates
SELECT 
    json_extract_string(value, '$.symbol') AS symbol,
    json_extract_string(value, '$.datetime') AS datetime,
    json_extract_double(value, '$.open') AS open,
    json_extract_double(value, '$.high') AS high,
    json_extract_double(value, '$.low') AS low,
    json_extract_double(value, '$.close') AS close,
    json_extract_double(value, '$.volume') AS volume
FROM 
    read_ndjson_auto('s3://my-stock-data-bucket/stocks/*/*/*/*/*.json')
    );
  
  
[0m03:48:44.539405 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m03:48:44.542907 [debug] [Thread-1 (]: On model.stock_dbt_project.read_csv: ROLLBACK
[0m03:48:44.564323 [debug] [Thread-1 (]: Failed to rollback 'model.stock_dbt_project.read_csv'
[0m03:48:44.568525 [debug] [Thread-1 (]: On model.stock_dbt_project.read_csv: Close
[0m03:48:44.577658 [debug] [Thread-1 (]: Runtime Error in model read_csv (models\read_csv.sql)
  HTTP Error: HTTP GET error on '/?encoding-type=url&list-type=2&prefix=stocks%2F' (HTTP 400)
[0m03:48:44.590395 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cbb66347-b02c-49d4-bead-e3f5d088e831', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D0FC5CE3C0>]}
[0m03:48:44.592915 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model main.read_csv ............................ [[31mERROR[0m in 0.55s]
[0m03:48:44.592915 [debug] [Thread-1 (]: Finished running node model.stock_dbt_project.read_csv
[0m03:48:44.601396 [debug] [Thread-4 (]: Marking all children of 'model.stock_dbt_project.read_csv' to be skipped because of status 'error'.  Reason: Runtime Error in model read_csv (models\read_csv.sql)
  HTTP Error: HTTP GET error on '/?encoding-type=url&list-type=2&prefix=stocks%2F' (HTTP 400).
[0m03:48:44.608462 [debug] [MainThread]: Using duckdb connection "master"
[0m03:48:44.609862 [debug] [MainThread]: On master: BEGIN
[0m03:48:44.611703 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m03:48:44.616143 [debug] [MainThread]: SQL status: OK in 0.004 seconds
[0m03:48:44.620935 [debug] [MainThread]: On master: COMMIT
[0m03:48:44.623771 [debug] [MainThread]: Using duckdb connection "master"
[0m03:48:44.625777 [debug] [MainThread]: On master: COMMIT
[0m03:48:44.627086 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m03:48:44.631835 [debug] [MainThread]: On master: Close
[0m03:48:44.636630 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:48:44.639107 [debug] [MainThread]: Connection 'create_dev_main' was properly closed.
[0m03:48:44.641837 [debug] [MainThread]: Connection 'list_dev_main' was properly closed.
[0m03:48:44.643852 [debug] [MainThread]: Connection 'model.stock_dbt_project.read_csv' was properly closed.
[0m03:48:44.645875 [info ] [MainThread]: 
[0m03:48:44.651968 [info ] [MainThread]: Finished running 9 project hooks, 1 table model in 0 hours 0 minutes and 1.58 seconds (1.58s).
[0m03:48:44.664293 [debug] [MainThread]: Command end result
[0m03:48:44.775557 [debug] [MainThread]: Wrote artifact WritableManifest to D:\Stock_price\stock_dbt_project\target\manifest.json
[0m03:48:44.778604 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\Stock_price\stock_dbt_project\target\semantic_manifest.json
[0m03:48:44.802587 [debug] [MainThread]: Wrote artifact RunExecutionResult to D:\Stock_price\stock_dbt_project\target\run_results.json
[0m03:48:44.803598 [info ] [MainThread]: 
[0m03:48:44.806033 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m03:48:44.808051 [info ] [MainThread]: 
[0m03:48:44.810046 [error] [MainThread]:   Runtime Error in model read_csv (models\read_csv.sql)
  HTTP Error: HTTP GET error on '/?encoding-type=url&list-type=2&prefix=stocks%2F' (HTTP 400)
[0m03:48:44.811318 [info ] [MainThread]: 
[0m03:48:44.812479 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=1 SKIP=0 TOTAL=10
[0m03:48:44.816494 [debug] [MainThread]: Command `dbt run` failed at 03:48:44.815489 after 5.12 seconds
[0m03:48:44.817558 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D0FA68ECC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D0FA7FAE40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D0FA7FB1D0>]}
[0m03:48:44.821039 [debug] [MainThread]: Flushing usage events
[0m03:48:45.549052 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m03:50:32.148574 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DBB3D6A990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DBB3D6A870>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DBB3D6A7B0>]}


============================== 03:50:32.160213 | 09693b6a-ba01-44bf-84b8-447e5ba51cb0 ==============================
[0m03:50:32.160213 [info ] [MainThread]: Running with dbt=1.9.4
[0m03:50:32.162497 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\loges\\.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'D:\\Stock_price\\stock_dbt_project\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run --select read_csv', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m03:50:32.513544 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '09693b6a-ba01-44bf-84b8-447e5ba51cb0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DBB375CE60>]}
[0m03:50:32.661281 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '09693b6a-ba01-44bf-84b8-447e5ba51cb0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DBB4538680>]}
[0m03:50:32.674154 [info ] [MainThread]: Registered adapter: duckdb=1.9.2
[0m03:50:33.082820 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m03:50:33.511828 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m03:50:33.513246 [debug] [MainThread]: Partial parsing: updated file: stock_dbt_project://models\read_csv.sql
[0m03:50:33.996399 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.stock_dbt_project.marts
[0m03:50:34.075152 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '09693b6a-ba01-44bf-84b8-447e5ba51cb0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DBB5AFE060>]}
[0m03:50:34.255530 [debug] [MainThread]: Wrote artifact WritableManifest to D:\Stock_price\stock_dbt_project\target\manifest.json
[0m03:50:34.258692 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\Stock_price\stock_dbt_project\target\semantic_manifest.json
[0m03:50:34.310220 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '09693b6a-ba01-44bf-84b8-447e5ba51cb0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DBB57DE0F0>]}
[0m03:50:34.318922 [info ] [MainThread]: Found 5 models, 9 operations, 4 data tests, 426 macros
[0m03:50:34.323809 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '09693b6a-ba01-44bf-84b8-447e5ba51cb0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DBB5AE7B30>]}
[0m03:50:34.336532 [info ] [MainThread]: 
[0m03:50:34.340209 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m03:50:34.344236 [info ] [MainThread]: 
[0m03:50:34.347778 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m03:50:34.355133 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m03:50:34.742190 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m03:50:34.745210 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m03:50:34.747243 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:50:34.826572 [debug] [ThreadPool]: SQL status: OK in 0.079 seconds
[0m03:50:34.837563 [debug] [ThreadPool]: On list_dev: Close
[0m03:50:34.842097 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m03:50:34.846662 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m03:50:34.882443 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m03:50:34.885073 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "create_dev_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m03:50:34.887743 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:50:34.895074 [debug] [ThreadPool]: SQL status: OK in 0.007 seconds
[0m03:50:34.905184 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m03:50:34.908881 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m03:50:34.911986 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m03:50:34.915734 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m03:50:34.918202 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "create_dev_main"} */

    
    
        create schema if not exists "dev"."main"
    
[0m03:50:34.921318 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m03:50:34.929539 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m03:50:34.932536 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m03:50:34.934537 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m03:50:34.937538 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m03:50:34.939538 [debug] [ThreadPool]: On create_dev_main: Close
[0m03:50:34.964716 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev_main'
[0m03:50:34.992230 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m03:50:34.993237 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m03:50:34.995230 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:50:34.997067 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m03:50:34.997067 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m03:50:34.997067 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m03:50:35.046236 [debug] [ThreadPool]: SQL status: OK in 0.044 seconds
[0m03:50:35.054229 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m03:50:35.058603 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m03:50:35.059432 [debug] [ThreadPool]: On list_dev_main: Close
[0m03:50:35.059432 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '09693b6a-ba01-44bf-84b8-447e5ba51cb0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DBB5B01220>]}
[0m03:50:35.059432 [debug] [MainThread]: Using duckdb connection "master"
[0m03:50:35.059432 [debug] [MainThread]: On master: BEGIN
[0m03:50:35.059432 [debug] [MainThread]: Opening a new connection, currently in state init
[0m03:50:35.067195 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m03:50:35.068204 [debug] [MainThread]: On master: COMMIT
[0m03:50:35.069209 [debug] [MainThread]: Using duckdb connection "master"
[0m03:50:35.070868 [debug] [MainThread]: On master: COMMIT
[0m03:50:35.072309 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m03:50:35.073317 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-0"
[0m03:50:35.098285 [info ] [MainThread]: 1 of 9 START hook: stock_dbt_project.on-run-start.0 ............................ [RUN]
[0m03:50:35.101111 [debug] [MainThread]: Using duckdb connection "master"
[0m03:50:35.103139 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
INSTALL httpfs;
[0m03:50:35.105123 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m03:50:35.108001 [info ] [MainThread]: 1 of 9 OK hook: stock_dbt_project.on-run-start.0 ............................... [[32mOK[0m in 0.03s]
[0m03:50:35.113130 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-1"
[0m03:50:35.115120 [info ] [MainThread]: 2 of 9 START hook: stock_dbt_project.on-run-start.1 ............................ [RUN]
[0m03:50:35.117844 [debug] [MainThread]: Using duckdb connection "master"
[0m03:50:35.120468 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
INSTALL json;
[0m03:50:35.123970 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m03:50:35.128308 [info ] [MainThread]: 2 of 9 OK hook: stock_dbt_project.on-run-start.1 ............................... [[32mOK[0m in 0.02s]
[0m03:50:35.133051 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-2"
[0m03:50:35.135890 [info ] [MainThread]: 3 of 9 START hook: stock_dbt_project.on-run-start.2 ............................ [RUN]
[0m03:50:35.138907 [debug] [MainThread]: Using duckdb connection "master"
[0m03:50:35.141060 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
LOAD httpfs;
[0m03:50:35.543931 [debug] [MainThread]: SQL status: OK in 0.401 seconds
[0m03:50:35.545017 [info ] [MainThread]: 3 of 9 OK hook: stock_dbt_project.on-run-start.2 ............................... [[32mOK[0m in 0.41s]
[0m03:50:35.548743 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-3"
[0m03:50:35.552046 [info ] [MainThread]: 4 of 9 START hook: stock_dbt_project.on-run-start.3 ............................ [RUN]
[0m03:50:35.554066 [debug] [MainThread]: Using duckdb connection "master"
[0m03:50:35.555662 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
LOAD json;
[0m03:50:35.557674 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m03:50:35.560255 [info ] [MainThread]: 4 of 9 OK hook: stock_dbt_project.on-run-start.3 ............................... [[32mOK[0m in 0.01s]
[0m03:50:35.564348 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-4"
[0m03:50:35.566880 [info ] [MainThread]: 5 of 9 START hook: stock_dbt_project.on-run-start.4 ............................ [RUN]
[0m03:50:35.568879 [debug] [MainThread]: Using duckdb connection "master"
[0m03:50:35.570147 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
SET s3_access_key_id='minioadmin';
[0m03:50:35.571205 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m03:50:35.574899 [info ] [MainThread]: 5 of 9 OK hook: stock_dbt_project.on-run-start.4 ............................... [[32mOK[0m in 0.01s]
[0m03:50:35.577892 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-5"
[0m03:50:35.579892 [info ] [MainThread]: 6 of 9 START hook: stock_dbt_project.on-run-start.5 ............................ [RUN]
[0m03:50:35.581894 [debug] [MainThread]: Using duckdb connection "master"
[0m03:50:35.582973 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
SET s3_secret_access_key='minioadmin';
[0m03:50:35.582973 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m03:50:35.588775 [info ] [MainThread]: 6 of 9 OK hook: stock_dbt_project.on-run-start.5 ............................... [[32mOK[0m in 0.01s]
[0m03:50:35.592778 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-6"
[0m03:50:35.593777 [info ] [MainThread]: 7 of 9 START hook: stock_dbt_project.on-run-start.6 ............................ [RUN]
[0m03:50:35.595887 [debug] [MainThread]: Using duckdb connection "master"
[0m03:50:35.597211 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
SET s3_endpoint='http://localhost:9000';
[0m03:50:35.599226 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m03:50:35.602737 [info ] [MainThread]: 7 of 9 OK hook: stock_dbt_project.on-run-start.6 ............................... [[32mOK[0m in 0.01s]
[0m03:50:35.606568 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-7"
[0m03:50:35.609345 [info ] [MainThread]: 8 of 9 START hook: stock_dbt_project.on-run-start.7 ............................ [RUN]
[0m03:50:35.611341 [debug] [MainThread]: Using duckdb connection "master"
[0m03:50:35.612344 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
SET s3_use_ssl=false;
[0m03:50:35.613341 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m03:50:35.614341 [info ] [MainThread]: 8 of 9 OK hook: stock_dbt_project.on-run-start.7 ............................... [[32mOK[0m in 0.01s]
[0m03:50:35.622440 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-8"
[0m03:50:35.625428 [info ] [MainThread]: 9 of 9 START hook: stock_dbt_project.on-run-start.8 ............................ [RUN]
[0m03:50:35.627429 [debug] [MainThread]: Using duckdb connection "master"
[0m03:50:35.628496 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
SET s3_url_style='path';
[0m03:50:35.628496 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m03:50:35.628496 [info ] [MainThread]: 9 of 9 OK hook: stock_dbt_project.on-run-start.8 ............................... [[32mOK[0m in 0.01s]
[0m03:50:35.635316 [info ] [MainThread]: 
[0m03:50:35.638345 [debug] [MainThread]: On master: Close
[0m03:50:35.645896 [debug] [Thread-1 (]: Began running node model.stock_dbt_project.read_csv
[0m03:50:35.645896 [info ] [Thread-1 (]: 1 of 1 START sql table model main.read_csv ..................................... [RUN]
[0m03:50:35.645896 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.stock_dbt_project.read_csv'
[0m03:50:35.645896 [debug] [Thread-1 (]: Began compiling node model.stock_dbt_project.read_csv
[0m03:50:35.659400 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_dbt_project.read_csv"
[0m03:50:35.660934 [debug] [Thread-1 (]: Began executing node model.stock_dbt_project.read_csv
[0m03:50:35.770900 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_dbt_project.read_csv"
[0m03:50:35.774035 [debug] [Thread-1 (]: Using duckdb connection "model.stock_dbt_project.read_csv"
[0m03:50:35.776559 [debug] [Thread-1 (]: On model.stock_dbt_project.read_csv: BEGIN
[0m03:50:35.776559 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m03:50:35.776559 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m03:50:35.776559 [debug] [Thread-1 (]: Using duckdb connection "model.stock_dbt_project.read_csv"
[0m03:50:35.776559 [debug] [Thread-1 (]: On model.stock_dbt_project.read_csv: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "node_id": "model.stock_dbt_project.read_csv"} */

  
    
    

    create  table
      "dev"."main"."read_csv__dbt_tmp"
  
    as (
      



-- Read all stocks from all symbols and dates
SELECT 
    json_extract_string(value, '$.symbol') AS symbol,
    json_extract_string(value, '$.datetime') AS datetime,
    json_extract_double(value, '$.open') AS open,
    json_extract_double(value, '$.high') AS high,
    json_extract_double(value, '$.low') AS low,
    json_extract_double(value, '$.close') AS close,
    json_extract_double(value, '$.volume') AS volume
FROM 
    read_ndjson_auto('s3://my-stock-data-bucket/stocks/CVX/2025/4/13/CVX_20250413_113945_jz58k4.json')
    );
  
  
[0m03:50:37.800341 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "node_id": "model.stock_dbt_project.read_csv"} */

  
    
    

    create  table
      "dev"."main"."read_csv__dbt_tmp"
  
    as (
      



-- Read all stocks from all symbols and dates
SELECT 
    json_extract_string(value, '$.symbol') AS symbol,
    json_extract_string(value, '$.datetime') AS datetime,
    json_extract_double(value, '$.open') AS open,
    json_extract_double(value, '$.high') AS high,
    json_extract_double(value, '$.low') AS low,
    json_extract_double(value, '$.close') AS close,
    json_extract_double(value, '$.volume') AS volume
FROM 
    read_ndjson_auto('s3://my-stock-data-bucket/stocks/CVX/2025/4/13/CVX_20250413_113945_jz58k4.json')
    );
  
  
[0m03:50:37.802078 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m03:50:37.803178 [debug] [Thread-1 (]: On model.stock_dbt_project.read_csv: ROLLBACK
[0m03:50:37.813626 [debug] [Thread-1 (]: Failed to rollback 'model.stock_dbt_project.read_csv'
[0m03:50:37.813626 [debug] [Thread-1 (]: On model.stock_dbt_project.read_csv: Close
[0m03:50:37.825655 [debug] [Thread-1 (]: Runtime Error in model read_csv (models\read_csv.sql)
  HTTP Error: HTTP GET error on 'https://my-stock-data-bucket.s3.amazonaws.com/stocks/CVX/2025/4/13/CVX_20250413_113945_jz58k4.json' (HTTP 400)
[0m03:50:37.827704 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '09693b6a-ba01-44bf-84b8-447e5ba51cb0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DBB36AB860>]}
[0m03:50:37.831722 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model main.read_csv ............................ [[31mERROR[0m in 2.18s]
[0m03:50:37.835403 [debug] [Thread-1 (]: Finished running node model.stock_dbt_project.read_csv
[0m03:50:37.837435 [debug] [Thread-4 (]: Marking all children of 'model.stock_dbt_project.read_csv' to be skipped because of status 'error'.  Reason: Runtime Error in model read_csv (models\read_csv.sql)
  HTTP Error: HTTP GET error on 'https://my-stock-data-bucket.s3.amazonaws.com/stocks/CVX/2025/4/13/CVX_20250413_113945_jz58k4.json' (HTTP 400).
[0m03:50:37.841815 [debug] [MainThread]: Using duckdb connection "master"
[0m03:50:37.843963 [debug] [MainThread]: On master: BEGIN
[0m03:50:37.845094 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m03:50:37.846274 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m03:50:37.847993 [debug] [MainThread]: On master: COMMIT
[0m03:50:37.849084 [debug] [MainThread]: Using duckdb connection "master"
[0m03:50:37.850730 [debug] [MainThread]: On master: COMMIT
[0m03:50:37.852892 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m03:50:37.854088 [debug] [MainThread]: On master: Close
[0m03:50:37.856541 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:50:37.858843 [debug] [MainThread]: Connection 'create_dev_main' was properly closed.
[0m03:50:37.860257 [debug] [MainThread]: Connection 'list_dev_main' was properly closed.
[0m03:50:37.862054 [debug] [MainThread]: Connection 'model.stock_dbt_project.read_csv' was properly closed.
[0m03:50:37.863156 [info ] [MainThread]: 
[0m03:50:37.863156 [info ] [MainThread]: Finished running 9 project hooks, 1 table model in 0 hours 0 minutes and 3.52 seconds (3.52s).
[0m03:50:37.872951 [debug] [MainThread]: Command end result
[0m03:50:37.926887 [debug] [MainThread]: Wrote artifact WritableManifest to D:\Stock_price\stock_dbt_project\target\manifest.json
[0m03:50:37.941633 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\Stock_price\stock_dbt_project\target\semantic_manifest.json
[0m03:50:37.957066 [debug] [MainThread]: Wrote artifact RunExecutionResult to D:\Stock_price\stock_dbt_project\target\run_results.json
[0m03:50:37.959251 [info ] [MainThread]: 
[0m03:50:37.959251 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m03:50:37.961949 [info ] [MainThread]: 
[0m03:50:37.961949 [error] [MainThread]:   Runtime Error in model read_csv (models\read_csv.sql)
  HTTP Error: HTTP GET error on 'https://my-stock-data-bucket.s3.amazonaws.com/stocks/CVX/2025/4/13/CVX_20250413_113945_jz58k4.json' (HTTP 400)
[0m03:50:37.961949 [info ] [MainThread]: 
[0m03:50:37.961949 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=1 SKIP=0 TOTAL=10
[0m03:50:37.967855 [debug] [MainThread]: Command `dbt run` failed at 03:50:37.967855 after 6.30 seconds
[0m03:50:37.969849 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DBB45B9D00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DBB59D67B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DBB36D4C80>]}
[0m03:50:37.970689 [debug] [MainThread]: Flushing usage events
[0m03:50:38.662158 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m03:57:20.258654 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002055DE0BB30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020560C89D00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020560C8BE00>]}


============================== 03:57:20.278108 | ddd74bb4-70f3-47c9-bc7e-879c062ae15e ==============================
[0m03:57:20.278108 [info ] [MainThread]: Running with dbt=1.9.4
[0m03:57:20.283384 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'D:\\Stock_price\\stock_dbt_project\\logs', 'profiles_dir': 'C:\\Users\\loges\\.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --select read_csv', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m03:57:21.569260 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ddd74bb4-70f3-47c9-bc7e-879c062ae15e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000205606BF530>]}
[0m03:57:21.984136 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ddd74bb4-70f3-47c9-bc7e-879c062ae15e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020561174AD0>]}
[0m03:57:22.006752 [info ] [MainThread]: Registered adapter: duckdb=1.9.2
[0m03:57:22.815729 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m03:57:23.297116 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m03:57:23.299141 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'ddd74bb4-70f3-47c9-bc7e-879c062ae15e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000205627D00E0>]}
[0m03:57:27.084205 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.stock_dbt_project.marts
[0m03:57:27.166416 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ddd74bb4-70f3-47c9-bc7e-879c062ae15e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002056276AE10>]}
[0m03:57:27.636421 [debug] [MainThread]: Wrote artifact WritableManifest to D:\Stock_price\stock_dbt_project\target\manifest.json
[0m03:57:27.641976 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\Stock_price\stock_dbt_project\target\semantic_manifest.json
[0m03:57:27.691370 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ddd74bb4-70f3-47c9-bc7e-879c062ae15e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020562701EE0>]}
[0m03:57:27.692374 [info ] [MainThread]: Found 5 models, 10 operations, 4 data tests, 426 macros
[0m03:57:27.693693 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ddd74bb4-70f3-47c9-bc7e-879c062ae15e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000205628D8560>]}
[0m03:57:27.695234 [info ] [MainThread]: 
[0m03:57:27.695234 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m03:57:27.695234 [info ] [MainThread]: 
[0m03:57:27.700262 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m03:57:27.702279 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m03:57:27.822939 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m03:57:27.823456 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m03:57:27.824472 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:57:27.848803 [debug] [ThreadPool]: SQL status: OK in 0.028 seconds
[0m03:57:27.855805 [debug] [ThreadPool]: On list_dev: Close
[0m03:57:27.857804 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m03:57:27.858866 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m03:57:27.875690 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m03:57:27.877703 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "create_dev_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m03:57:27.878701 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:57:27.879701 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m03:57:27.883070 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m03:57:27.883070 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m03:57:27.883070 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m03:57:27.883070 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m03:57:27.883070 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "create_dev_main"} */

    
    
        create schema if not exists "dev"."main"
    
[0m03:57:27.883070 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m03:57:27.889526 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m03:57:27.890547 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m03:57:27.891545 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m03:57:27.892537 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m03:57:27.893543 [debug] [ThreadPool]: On create_dev_main: Close
[0m03:57:27.896450 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev_main'
[0m03:57:27.913982 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m03:57:27.914995 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m03:57:27.916331 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:57:27.917191 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m03:57:27.917191 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m03:57:27.917191 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m03:57:27.945033 [debug] [ThreadPool]: SQL status: OK in 0.029 seconds
[0m03:57:27.945033 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m03:57:27.945033 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m03:57:27.945033 [debug] [ThreadPool]: On list_dev_main: Close
[0m03:57:27.945033 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ddd74bb4-70f3-47c9-bc7e-879c062ae15e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002056293D3A0>]}
[0m03:57:27.958988 [debug] [MainThread]: Using duckdb connection "master"
[0m03:57:27.960004 [debug] [MainThread]: On master: BEGIN
[0m03:57:27.960004 [debug] [MainThread]: Opening a new connection, currently in state init
[0m03:57:27.962001 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m03:57:27.962001 [debug] [MainThread]: On master: COMMIT
[0m03:57:27.963004 [debug] [MainThread]: Using duckdb connection "master"
[0m03:57:27.964007 [debug] [MainThread]: On master: COMMIT
[0m03:57:27.964254 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m03:57:27.973811 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-0"
[0m03:57:27.989915 [info ] [MainThread]: 1 of 10 START hook: stock_dbt_project.on-run-start.0 ........................... [RUN]
[0m03:57:27.989915 [debug] [MainThread]: Using duckdb connection "master"
[0m03:57:27.993911 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
INSTALL httpfs;
[0m03:57:27.997865 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m03:57:28.000101 [info ] [MainThread]: 1 of 10 OK hook: stock_dbt_project.on-run-start.0 .............................. [[32mOK[0m in 0.03s]
[0m03:57:28.005021 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-1"
[0m03:57:28.009170 [info ] [MainThread]: 2 of 10 START hook: stock_dbt_project.on-run-start.1 ........................... [RUN]
[0m03:57:28.011037 [debug] [MainThread]: Using duckdb connection "master"
[0m03:57:28.012691 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
INSTALL json;
[0m03:57:28.015699 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m03:57:28.017750 [info ] [MainThread]: 2 of 10 OK hook: stock_dbt_project.on-run-start.1 .............................. [[32mOK[0m in 0.02s]
[0m03:57:28.025621 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-2"
[0m03:57:28.028950 [info ] [MainThread]: 3 of 10 START hook: stock_dbt_project.on-run-start.2 ........................... [RUN]
[0m03:57:28.030481 [debug] [MainThread]: Using duckdb connection "master"
[0m03:57:28.031487 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
LOAD httpfs;
[0m03:57:28.339101 [debug] [MainThread]: SQL status: OK in 0.306 seconds
[0m03:57:28.342108 [info ] [MainThread]: 3 of 10 OK hook: stock_dbt_project.on-run-start.2 .............................. [[32mOK[0m in 0.32s]
[0m03:57:28.348932 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-3"
[0m03:57:28.352613 [info ] [MainThread]: 4 of 10 START hook: stock_dbt_project.on-run-start.3 ........................... [RUN]
[0m03:57:28.357977 [debug] [MainThread]: Using duckdb connection "master"
[0m03:57:28.360270 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
LOAD json;
[0m03:57:28.362419 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m03:57:28.362419 [info ] [MainThread]: 4 of 10 OK hook: stock_dbt_project.on-run-start.3 .............................. [[32mOK[0m in 0.02s]
[0m03:57:28.375292 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-4"
[0m03:57:28.382088 [info ] [MainThread]: 5 of 10 START hook: stock_dbt_project.on-run-start.4 ........................... [RUN]
[0m03:57:28.384356 [debug] [MainThread]: Using duckdb connection "master"
[0m03:57:28.386020 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
SET s3_endpoint='http://localhost:9000';
[0m03:57:28.388373 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m03:57:28.391388 [info ] [MainThread]: 5 of 10 OK hook: stock_dbt_project.on-run-start.4 .............................. [[32mOK[0m in 0.03s]
[0m03:57:28.395639 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-5"
[0m03:57:28.397481 [info ] [MainThread]: 6 of 10 START hook: stock_dbt_project.on-run-start.5 ........................... [RUN]
[0m03:57:28.398422 [debug] [MainThread]: Using duckdb connection "master"
[0m03:57:28.400043 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
SET s3_access_key_id='minioadmin';
[0m03:57:28.402054 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m03:57:28.403300 [info ] [MainThread]: 6 of 10 OK hook: stock_dbt_project.on-run-start.5 .............................. [[32mOK[0m in 0.01s]
[0m03:57:28.409939 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-6"
[0m03:57:28.411960 [info ] [MainThread]: 7 of 10 START hook: stock_dbt_project.on-run-start.6 ........................... [RUN]
[0m03:57:28.412948 [debug] [MainThread]: Using duckdb connection "master"
[0m03:57:28.413957 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
SET s3_secret_access_key='minioadmin';
[0m03:57:28.415950 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m03:57:28.418084 [info ] [MainThread]: 7 of 10 OK hook: stock_dbt_project.on-run-start.6 .............................. [[32mOK[0m in 0.01s]
[0m03:57:28.423712 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-7"
[0m03:57:28.425248 [info ] [MainThread]: 8 of 10 START hook: stock_dbt_project.on-run-start.7 ........................... [RUN]
[0m03:57:28.427256 [debug] [MainThread]: Using duckdb connection "master"
[0m03:57:28.429247 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
SET s3_region='us-east-1';
[0m03:57:28.430245 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m03:57:28.432254 [info ] [MainThread]: 8 of 10 OK hook: stock_dbt_project.on-run-start.7 .............................. [[32mOK[0m in 0.01s]
[0m03:57:28.436943 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-8"
[0m03:57:28.440100 [info ] [MainThread]: 9 of 10 START hook: stock_dbt_project.on-run-start.8 ........................... [RUN]
[0m03:57:28.442944 [debug] [MainThread]: Using duckdb connection "master"
[0m03:57:28.444034 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
SET s3_use_ssl=false;
[0m03:57:28.445041 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m03:57:28.448040 [info ] [MainThread]: 9 of 10 OK hook: stock_dbt_project.on-run-start.8 .............................. [[32mOK[0m in 0.01s]
[0m03:57:28.453761 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-9"
[0m03:57:28.458478 [info ] [MainThread]: 10 of 10 START hook: stock_dbt_project.on-run-start.9 .......................... [RUN]
[0m03:57:28.460493 [debug] [MainThread]: Using duckdb connection "master"
[0m03:57:28.462505 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
SET s3_url_style='path';
[0m03:57:28.463489 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m03:57:28.467180 [info ] [MainThread]: 10 of 10 OK hook: stock_dbt_project.on-run-start.9 ............................. [[32mOK[0m in 0.02s]
[0m03:57:28.467180 [info ] [MainThread]: 
[0m03:57:28.472289 [debug] [MainThread]: On master: Close
[0m03:57:28.480834 [debug] [Thread-1 (]: Began running node model.stock_dbt_project.read_csv
[0m03:57:28.483347 [info ] [Thread-1 (]: 1 of 1 START sql table model main.read_csv ..................................... [RUN]
[0m03:57:28.486184 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.stock_dbt_project.read_csv'
[0m03:57:28.489285 [debug] [Thread-1 (]: Began compiling node model.stock_dbt_project.read_csv
[0m03:57:28.499646 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_dbt_project.read_csv"
[0m03:57:28.499964 [debug] [Thread-1 (]: Began executing node model.stock_dbt_project.read_csv
[0m03:57:28.642622 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_dbt_project.read_csv"
[0m03:57:28.647639 [debug] [Thread-1 (]: Using duckdb connection "model.stock_dbt_project.read_csv"
[0m03:57:28.649155 [debug] [Thread-1 (]: On model.stock_dbt_project.read_csv: BEGIN
[0m03:57:28.656107 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m03:57:28.666972 [debug] [Thread-1 (]: SQL status: OK in 0.010 seconds
[0m03:57:28.670306 [debug] [Thread-1 (]: Using duckdb connection "model.stock_dbt_project.read_csv"
[0m03:57:28.673118 [debug] [Thread-1 (]: On model.stock_dbt_project.read_csv: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "node_id": "model.stock_dbt_project.read_csv"} */

  
    
    

    create  table
      "dev"."main"."read_csv__dbt_tmp"
  
    as (
      



-- Read all stocks from all symbols and dates
SELECT 
    json_extract_string(value, '$.symbol') AS symbol,
    json_extract_string(value, '$.datetime') AS datetime,
    json_extract_double(value, '$.open') AS open,
    json_extract_double(value, '$.high') AS high,
    json_extract_double(value, '$.low') AS low,
    json_extract_double(value, '$.close') AS close,
    json_extract_double(value, '$.volume') AS volume
FROM 
    read_ndjson_auto('s3://my-stock-data-bucket/stocks/CVX/2025/4/13/CVX_20250413_113945_jz58k4.json')
    );
  
  
[0m03:57:30.671401 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "node_id": "model.stock_dbt_project.read_csv"} */

  
    
    

    create  table
      "dev"."main"."read_csv__dbt_tmp"
  
    as (
      



-- Read all stocks from all symbols and dates
SELECT 
    json_extract_string(value, '$.symbol') AS symbol,
    json_extract_string(value, '$.datetime') AS datetime,
    json_extract_double(value, '$.open') AS open,
    json_extract_double(value, '$.high') AS high,
    json_extract_double(value, '$.low') AS low,
    json_extract_double(value, '$.close') AS close,
    json_extract_double(value, '$.volume') AS volume
FROM 
    read_ndjson_auto('s3://my-stock-data-bucket/stocks/CVX/2025/4/13/CVX_20250413_113945_jz58k4.json')
    );
  
  
[0m03:57:30.673413 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m03:57:30.674414 [debug] [Thread-1 (]: On model.stock_dbt_project.read_csv: ROLLBACK
[0m03:57:30.686536 [debug] [Thread-1 (]: Failed to rollback 'model.stock_dbt_project.read_csv'
[0m03:57:30.690543 [debug] [Thread-1 (]: On model.stock_dbt_project.read_csv: Close
[0m03:57:30.705848 [debug] [Thread-1 (]: Runtime Error in model read_csv (models\read_csv.sql)
  HTTP Error: HTTP GET error on 'https://my-stock-data-bucket.s3.amazonaws.com/stocks/CVX/2025/4/13/CVX_20250413_113945_jz58k4.json' (HTTP 400)
[0m03:57:30.715543 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ddd74bb4-70f3-47c9-bc7e-879c062ae15e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020562A90B60>]}
[0m03:57:30.718700 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model main.read_csv ............................ [[31mERROR[0m in 2.22s]
[0m03:57:30.723349 [debug] [Thread-1 (]: Finished running node model.stock_dbt_project.read_csv
[0m03:57:30.727087 [debug] [Thread-4 (]: Marking all children of 'model.stock_dbt_project.read_csv' to be skipped because of status 'error'.  Reason: Runtime Error in model read_csv (models\read_csv.sql)
  HTTP Error: HTTP GET error on 'https://my-stock-data-bucket.s3.amazonaws.com/stocks/CVX/2025/4/13/CVX_20250413_113945_jz58k4.json' (HTTP 400).
[0m03:57:30.734458 [debug] [MainThread]: Using duckdb connection "master"
[0m03:57:30.736457 [debug] [MainThread]: On master: BEGIN
[0m03:57:30.737565 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m03:57:30.742023 [debug] [MainThread]: SQL status: OK in 0.004 seconds
[0m03:57:30.745026 [debug] [MainThread]: On master: COMMIT
[0m03:57:30.750506 [debug] [MainThread]: Using duckdb connection "master"
[0m03:57:30.752780 [debug] [MainThread]: On master: COMMIT
[0m03:57:30.756259 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m03:57:30.759895 [debug] [MainThread]: On master: Close
[0m03:57:30.763852 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:57:30.765530 [debug] [MainThread]: Connection 'create_dev_main' was properly closed.
[0m03:57:30.767547 [debug] [MainThread]: Connection 'list_dev_main' was properly closed.
[0m03:57:30.768982 [debug] [MainThread]: Connection 'model.stock_dbt_project.read_csv' was properly closed.
[0m03:57:30.771170 [info ] [MainThread]: 
[0m03:57:30.773721 [info ] [MainThread]: Finished running 10 project hooks, 1 table model in 0 hours 0 minutes and 3.07 seconds (3.07s).
[0m03:57:30.783878 [debug] [MainThread]: Command end result
[0m03:57:30.864242 [debug] [MainThread]: Wrote artifact WritableManifest to D:\Stock_price\stock_dbt_project\target\manifest.json
[0m03:57:30.873667 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\Stock_price\stock_dbt_project\target\semantic_manifest.json
[0m03:57:30.897430 [debug] [MainThread]: Wrote artifact RunExecutionResult to D:\Stock_price\stock_dbt_project\target\run_results.json
[0m03:57:30.899285 [info ] [MainThread]: 
[0m03:57:30.900254 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m03:57:30.900254 [info ] [MainThread]: 
[0m03:57:30.908464 [error] [MainThread]:   Runtime Error in model read_csv (models\read_csv.sql)
  HTTP Error: HTTP GET error on 'https://my-stock-data-bucket.s3.amazonaws.com/stocks/CVX/2025/4/13/CVX_20250413_113945_jz58k4.json' (HTTP 400)
[0m03:57:30.911483 [info ] [MainThread]: 
[0m03:57:30.913478 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=1 SKIP=0 TOTAL=11
[0m03:57:30.916673 [debug] [MainThread]: Command `dbt run` failed at 03:57:30.916673 after 11.23 seconds
[0m03:57:30.919962 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020560FE39E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020560CF90A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020560E18D10>]}
[0m03:57:30.922861 [debug] [MainThread]: Flushing usage events
[0m03:57:31.563546 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m03:58:43.267771 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EB7308FE00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EB75447590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EB75445EB0>]}


============================== 03:58:43.288019 | 6f578f00-7583-4451-89bf-af36e17e7446 ==============================
[0m03:58:43.288019 [info ] [MainThread]: Running with dbt=1.9.4
[0m03:58:43.291619 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\loges\\.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'D:\\Stock_price\\stock_dbt_project\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt clean', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m03:58:43.779222 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6f578f00-7583-4451-89bf-af36e17e7446', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EB76309B50>]}
[0m03:58:43.859434 [debug] [MainThread]: Command `dbt clean` succeeded at 03:58:43.858415 after 1.14 seconds
[0m03:58:43.861414 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EB76469A30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EB764696A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EB76246930>]}
[0m03:58:43.863430 [debug] [MainThread]: Flushing usage events
[0m03:58:44.463506 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m03:59:00.030336 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000204589AEC60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002045A0BE180>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002045C22BE00>]}


============================== 03:59:00.047487 | 4a413722-e464-45df-b5a1-3e8181d2bf3c ==============================
[0m03:59:00.047487 [info ] [MainThread]: Running with dbt=1.9.4
[0m03:59:00.049478 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'D:\\Stock_price\\stock_dbt_project\\logs', 'profiles_dir': 'C:\\Users\\loges\\.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run --select read_csv', 'send_anonymous_usage_stats': 'True'}
[0m03:59:00.384232 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4a413722-e464-45df-b5a1-3e8181d2bf3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002045C7A1F10>]}
[0m03:59:00.523935 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4a413722-e464-45df-b5a1-3e8181d2bf3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020458299220>]}
[0m03:59:00.529937 [info ] [MainThread]: Registered adapter: duckdb=1.9.2
[0m03:59:01.221718 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m03:59:01.225986 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m03:59:01.227629 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '4a413722-e464-45df-b5a1-3e8181d2bf3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002045CAC4FB0>]}
[0m03:59:05.624634 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.stock_dbt_project.marts
[0m03:59:05.631420 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4a413722-e464-45df-b5a1-3e8181d2bf3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002045DFBB800>]}
[0m03:59:05.795230 [debug] [MainThread]: Wrote artifact WritableManifest to D:\Stock_price\stock_dbt_project\target\manifest.json
[0m03:59:05.795230 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\Stock_price\stock_dbt_project\target\semantic_manifest.json
[0m03:59:05.872897 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4a413722-e464-45df-b5a1-3e8181d2bf3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002045DD12AE0>]}
[0m03:59:05.874586 [info ] [MainThread]: Found 5 models, 10 operations, 4 data tests, 426 macros
[0m03:59:05.876839 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4a413722-e464-45df-b5a1-3e8181d2bf3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002045DE498E0>]}
[0m03:59:05.882681 [info ] [MainThread]: 
[0m03:59:05.884314 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m03:59:05.886041 [info ] [MainThread]: 
[0m03:59:05.889055 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m03:59:05.893771 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m03:59:06.150113 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m03:59:06.150113 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m03:59:06.150113 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:59:06.202080 [debug] [ThreadPool]: SQL status: OK in 0.052 seconds
[0m03:59:06.210478 [debug] [ThreadPool]: On list_dev: Close
[0m03:59:06.211453 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m03:59:06.211453 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m03:59:06.247508 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m03:59:06.249663 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "create_dev_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m03:59:06.250693 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:59:06.256207 [debug] [ThreadPool]: SQL status: OK in 0.005 seconds
[0m03:59:06.263573 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m03:59:06.266017 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m03:59:06.267975 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m03:59:06.271783 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m03:59:06.275351 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "create_dev_main"} */

    
    
        create schema if not exists "dev"."main"
    
[0m03:59:06.278366 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m03:59:06.282597 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m03:59:06.285656 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m03:59:06.286686 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m03:59:06.291527 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m03:59:06.297336 [debug] [ThreadPool]: On create_dev_main: Close
[0m03:59:06.318346 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev_main'
[0m03:59:06.345372 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m03:59:06.347374 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m03:59:06.348753 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:59:06.351597 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m03:59:06.353835 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m03:59:06.356619 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m03:59:06.437785 [debug] [ThreadPool]: SQL status: OK in 0.080 seconds
[0m03:59:06.445506 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m03:59:06.447334 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m03:59:06.447334 [debug] [ThreadPool]: On list_dev_main: Close
[0m03:59:06.455821 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4a413722-e464-45df-b5a1-3e8181d2bf3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002045C7B4E00>]}
[0m03:59:06.457824 [debug] [MainThread]: Using duckdb connection "master"
[0m03:59:06.460716 [debug] [MainThread]: On master: BEGIN
[0m03:59:06.461299 [debug] [MainThread]: Opening a new connection, currently in state init
[0m03:59:06.464815 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m03:59:06.466438 [debug] [MainThread]: On master: COMMIT
[0m03:59:06.467450 [debug] [MainThread]: Using duckdb connection "master"
[0m03:59:06.467450 [debug] [MainThread]: On master: COMMIT
[0m03:59:06.471085 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m03:59:06.498423 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-0"
[0m03:59:06.523774 [info ] [MainThread]: 1 of 10 START hook: stock_dbt_project.on-run-start.0 ........................... [RUN]
[0m03:59:06.526789 [debug] [MainThread]: Using duckdb connection "master"
[0m03:59:06.528793 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
INSTALL httpfs;
[0m03:59:06.533352 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m03:59:06.537696 [info ] [MainThread]: 1 of 10 OK hook: stock_dbt_project.on-run-start.0 .............................. [[32mOK[0m in 0.06s]
[0m03:59:06.551314 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-1"
[0m03:59:06.553356 [info ] [MainThread]: 2 of 10 START hook: stock_dbt_project.on-run-start.1 ........................... [RUN]
[0m03:59:06.561473 [debug] [MainThread]: Using duckdb connection "master"
[0m03:59:06.563619 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
INSTALL json;
[0m03:59:06.567998 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m03:59:06.573438 [info ] [MainThread]: 2 of 10 OK hook: stock_dbt_project.on-run-start.1 .............................. [[32mOK[0m in 0.03s]
[0m03:59:06.580864 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-2"
[0m03:59:06.583482 [info ] [MainThread]: 3 of 10 START hook: stock_dbt_project.on-run-start.2 ........................... [RUN]
[0m03:59:06.587327 [debug] [MainThread]: Using duckdb connection "master"
[0m03:59:06.590340 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
LOAD httpfs;
[0m03:59:07.146999 [debug] [MainThread]: SQL status: OK in 0.553 seconds
[0m03:59:07.149168 [info ] [MainThread]: 3 of 10 OK hook: stock_dbt_project.on-run-start.2 .............................. [[32mOK[0m in 0.57s]
[0m03:59:07.161979 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-3"
[0m03:59:07.166979 [info ] [MainThread]: 4 of 10 START hook: stock_dbt_project.on-run-start.3 ........................... [RUN]
[0m03:59:07.170521 [debug] [MainThread]: Using duckdb connection "master"
[0m03:59:07.172046 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
LOAD json;
[0m03:59:07.177352 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m03:59:07.182697 [info ] [MainThread]: 4 of 10 OK hook: stock_dbt_project.on-run-start.3 .............................. [[32mOK[0m in 0.03s]
[0m03:59:07.195225 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-4"
[0m03:59:07.202378 [info ] [MainThread]: 5 of 10 START hook: stock_dbt_project.on-run-start.4 ........................... [RUN]
[0m03:59:07.207019 [debug] [MainThread]: Using duckdb connection "master"
[0m03:59:07.210546 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
SET s3_endpoint='http://localhost:9000';
[0m03:59:07.214596 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m03:59:07.219402 [info ] [MainThread]: 5 of 10 OK hook: stock_dbt_project.on-run-start.4 .............................. [[32mOK[0m in 0.03s]
[0m03:59:07.230264 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-5"
[0m03:59:07.235123 [info ] [MainThread]: 6 of 10 START hook: stock_dbt_project.on-run-start.5 ........................... [RUN]
[0m03:59:07.239877 [debug] [MainThread]: Using duckdb connection "master"
[0m03:59:07.243406 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
SET s3_access_key_id='minioadmin';
[0m03:59:07.249119 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m03:59:07.255768 [info ] [MainThread]: 6 of 10 OK hook: stock_dbt_project.on-run-start.5 .............................. [[32mOK[0m in 0.03s]
[0m03:59:07.279286 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-6"
[0m03:59:07.285634 [info ] [MainThread]: 7 of 10 START hook: stock_dbt_project.on-run-start.6 ........................... [RUN]
[0m03:59:07.291542 [debug] [MainThread]: Using duckdb connection "master"
[0m03:59:07.295268 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
SET s3_secret_access_key='minioadmin';
[0m03:59:07.299335 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m03:59:07.302348 [info ] [MainThread]: 7 of 10 OK hook: stock_dbt_project.on-run-start.6 .............................. [[32mOK[0m in 0.03s]
[0m03:59:07.316045 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-7"
[0m03:59:07.320714 [info ] [MainThread]: 8 of 10 START hook: stock_dbt_project.on-run-start.7 ........................... [RUN]
[0m03:59:07.325427 [debug] [MainThread]: Using duckdb connection "master"
[0m03:59:07.327457 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
SET s3_region='us-east-1';
[0m03:59:07.332065 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m03:59:07.335976 [info ] [MainThread]: 8 of 10 OK hook: stock_dbt_project.on-run-start.7 .............................. [[32mOK[0m in 0.03s]
[0m03:59:07.349625 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-8"
[0m03:59:07.355229 [info ] [MainThread]: 9 of 10 START hook: stock_dbt_project.on-run-start.8 ........................... [RUN]
[0m03:59:07.359999 [debug] [MainThread]: Using duckdb connection "master"
[0m03:59:07.362395 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
SET s3_use_ssl=false;
[0m03:59:07.367375 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m03:59:07.373876 [info ] [MainThread]: 9 of 10 OK hook: stock_dbt_project.on-run-start.8 .............................. [[32mOK[0m in 0.03s]
[0m03:59:07.382351 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-9"
[0m03:59:07.387052 [info ] [MainThread]: 10 of 10 START hook: stock_dbt_project.on-run-start.9 .......................... [RUN]
[0m03:59:07.395278 [debug] [MainThread]: Using duckdb connection "master"
[0m03:59:07.401318 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
SET s3_url_style='path';
[0m03:59:07.411636 [debug] [MainThread]: SQL status: OK in 0.005 seconds
[0m03:59:07.429504 [info ] [MainThread]: 10 of 10 OK hook: stock_dbt_project.on-run-start.9 ............................. [[32mOK[0m in 0.05s]
[0m03:59:07.435149 [info ] [MainThread]: 
[0m03:59:07.443511 [debug] [MainThread]: On master: Close
[0m03:59:07.470495 [debug] [Thread-1 (]: Began running node model.stock_dbt_project.read_csv
[0m03:59:07.472098 [info ] [Thread-1 (]: 1 of 1 START sql table model main.read_csv ..................................... [RUN]
[0m03:59:07.473825 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.stock_dbt_project.read_csv'
[0m03:59:07.474911 [debug] [Thread-1 (]: Began compiling node model.stock_dbt_project.read_csv
[0m03:59:07.479969 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_dbt_project.read_csv"
[0m03:59:07.481606 [debug] [Thread-1 (]: Began executing node model.stock_dbt_project.read_csv
[0m03:59:07.552569 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_dbt_project.read_csv"
[0m03:59:07.559324 [debug] [Thread-1 (]: Using duckdb connection "model.stock_dbt_project.read_csv"
[0m03:59:07.559324 [debug] [Thread-1 (]: On model.stock_dbt_project.read_csv: BEGIN
[0m03:59:07.559324 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m03:59:07.559324 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m03:59:07.559324 [debug] [Thread-1 (]: Using duckdb connection "model.stock_dbt_project.read_csv"
[0m03:59:07.559324 [debug] [Thread-1 (]: On model.stock_dbt_project.read_csv: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "node_id": "model.stock_dbt_project.read_csv"} */

  
    
    

    create  table
      "dev"."main"."read_csv__dbt_tmp"
  
    as (
      



-- Read all stocks from all symbols and dates
SELECT 
    json_extract_string(value, '$.symbol') AS symbol,
    json_extract_string(value, '$.datetime') AS datetime,
    json_extract_double(value, '$.open') AS open,
    json_extract_double(value, '$.high') AS high,
    json_extract_double(value, '$.low') AS low,
    json_extract_double(value, '$.close') AS close,
    json_extract_double(value, '$.volume') AS volume
FROM 
    read_ndjson_auto('s3://my-stock-data-bucket/stocks/CVX/2025/4/13/CVX_20250413_113945_jz58k4.json')
    );
  
  
[0m03:59:09.513507 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "node_id": "model.stock_dbt_project.read_csv"} */

  
    
    

    create  table
      "dev"."main"."read_csv__dbt_tmp"
  
    as (
      



-- Read all stocks from all symbols and dates
SELECT 
    json_extract_string(value, '$.symbol') AS symbol,
    json_extract_string(value, '$.datetime') AS datetime,
    json_extract_double(value, '$.open') AS open,
    json_extract_double(value, '$.high') AS high,
    json_extract_double(value, '$.low') AS low,
    json_extract_double(value, '$.close') AS close,
    json_extract_double(value, '$.volume') AS volume
FROM 
    read_ndjson_auto('s3://my-stock-data-bucket/stocks/CVX/2025/4/13/CVX_20250413_113945_jz58k4.json')
    );
  
  
[0m03:59:09.513507 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m03:59:09.513507 [debug] [Thread-1 (]: On model.stock_dbt_project.read_csv: ROLLBACK
[0m03:59:09.539956 [debug] [Thread-1 (]: Failed to rollback 'model.stock_dbt_project.read_csv'
[0m03:59:09.542424 [debug] [Thread-1 (]: On model.stock_dbt_project.read_csv: Close
[0m03:59:09.549381 [debug] [Thread-1 (]: Runtime Error in model read_csv (models\read_csv.sql)
  HTTP Error: HTTP GET error on 'https://my-stock-data-bucket.s3.amazonaws.com/stocks/CVX/2025/4/13/CVX_20250413_113945_jz58k4.json' (HTTP 400)
[0m03:59:09.556594 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4a413722-e464-45df-b5a1-3e8181d2bf3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002045DF9EB40>]}
[0m03:59:09.559270 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model main.read_csv ............................ [[31mERROR[0m in 2.08s]
[0m03:59:09.561286 [debug] [Thread-1 (]: Finished running node model.stock_dbt_project.read_csv
[0m03:59:09.563771 [debug] [Thread-4 (]: Marking all children of 'model.stock_dbt_project.read_csv' to be skipped because of status 'error'.  Reason: Runtime Error in model read_csv (models\read_csv.sql)
  HTTP Error: HTTP GET error on 'https://my-stock-data-bucket.s3.amazonaws.com/stocks/CVX/2025/4/13/CVX_20250413_113945_jz58k4.json' (HTTP 400).
[0m03:59:09.568307 [debug] [MainThread]: Using duckdb connection "master"
[0m03:59:09.569542 [debug] [MainThread]: On master: BEGIN
[0m03:59:09.570683 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m03:59:09.572529 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m03:59:09.573680 [debug] [MainThread]: On master: COMMIT
[0m03:59:09.575252 [debug] [MainThread]: Using duckdb connection "master"
[0m03:59:09.576620 [debug] [MainThread]: On master: COMMIT
[0m03:59:09.577880 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m03:59:09.578985 [debug] [MainThread]: On master: Close
[0m03:59:09.580165 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:59:09.580755 [debug] [MainThread]: Connection 'create_dev_main' was properly closed.
[0m03:59:09.581604 [debug] [MainThread]: Connection 'list_dev_main' was properly closed.
[0m03:59:09.582180 [debug] [MainThread]: Connection 'model.stock_dbt_project.read_csv' was properly closed.
[0m03:59:09.583564 [info ] [MainThread]: 
[0m03:59:09.584633 [info ] [MainThread]: Finished running 10 project hooks, 1 table model in 0 hours 0 minutes and 3.69 seconds (3.69s).
[0m03:59:09.592452 [debug] [MainThread]: Command end result
[0m03:59:09.632696 [debug] [MainThread]: Wrote artifact WritableManifest to D:\Stock_price\stock_dbt_project\target\manifest.json
[0m03:59:09.636911 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\Stock_price\stock_dbt_project\target\semantic_manifest.json
[0m03:59:09.647928 [debug] [MainThread]: Wrote artifact RunExecutionResult to D:\Stock_price\stock_dbt_project\target\run_results.json
[0m03:59:09.647928 [info ] [MainThread]: 
[0m03:59:09.647928 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m03:59:09.651637 [info ] [MainThread]: 
[0m03:59:09.651637 [error] [MainThread]:   Runtime Error in model read_csv (models\read_csv.sql)
  HTTP Error: HTTP GET error on 'https://my-stock-data-bucket.s3.amazonaws.com/stocks/CVX/2025/4/13/CVX_20250413_113945_jz58k4.json' (HTTP 400)
[0m03:59:09.651637 [info ] [MainThread]: 
[0m03:59:09.655767 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=1 SKIP=0 TOTAL=11
[0m03:59:09.658795 [debug] [MainThread]: Command `dbt run` failed at 03:59:09.657796 after 9.91 seconds
[0m03:59:09.659302 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000204589AEC60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002045C228230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002045C22BE00>]}
[0m03:59:09.661319 [debug] [MainThread]: Flushing usage events
[0m03:59:10.280565 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:32:59.662034 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020FB2813C80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020FB533D1F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020FB533DB20>]}


============================== 17:32:59.680090 | bd994701-85d8-4f10-9630-bf8e28e3f385 ==============================
[0m17:32:59.680090 [info ] [MainThread]: Running with dbt=1.9.4
[0m17:32:59.683779 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\loges\\.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'D:\\Stock_price\\stock_dbt_project\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt debug', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m17:32:59.902379 [info ] [MainThread]: dbt version: 1.9.4
[0m17:32:59.902379 [info ] [MainThread]: python version: 3.12.3
[0m17:32:59.905457 [info ] [MainThread]: python path: C:\Users\loges\.virtualenvs\Stock_price-P2gocZed\Scripts\python.exe
[0m17:32:59.905457 [info ] [MainThread]: os info: Windows-11-10.0.22631-SP0
[0m17:33:00.358855 [info ] [MainThread]: Using profiles dir at C:\Users\loges\.dbt
[0m17:33:00.359927 [info ] [MainThread]: Using profiles.yml file at C:\Users\loges\.dbt\profiles.yml
[0m17:33:00.360475 [info ] [MainThread]: Using dbt_project.yml file at D:\Stock_price\stock_dbt_project\dbt_project.yml
[0m17:33:00.413843 [info ] [MainThread]: adapter type: duckdb
[0m17:33:00.415482 [info ] [MainThread]: adapter version: 1.9.2
[0m17:33:00.738742 [info ] [MainThread]: Configuration:
[0m17:33:00.738742 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m17:33:00.738742 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m17:33:00.738742 [info ] [MainThread]: Required dependencies:
[0m17:33:00.752674 [debug] [MainThread]: Executing "git --help"
[0m17:33:00.841717 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m17:33:00.841717 [debug] [MainThread]: STDERR: "b''"
[0m17:33:00.841717 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m17:33:00.841717 [info ] [MainThread]: Connection:
[0m17:33:00.841717 [info ] [MainThread]:   database: dev
[0m17:33:00.848715 [info ] [MainThread]:   schema: main
[0m17:33:00.849728 [info ] [MainThread]:   path: dev.duckdb
[0m17:33:00.850727 [info ] [MainThread]:   config_options: None
[0m17:33:00.852726 [info ] [MainThread]:   extensions: None
[0m17:33:00.853726 [info ] [MainThread]:   settings: {}
[0m17:33:00.854725 [info ] [MainThread]:   external_root: .
[0m17:33:00.854725 [info ] [MainThread]:   use_credential_provider: None
[0m17:33:00.855728 [info ] [MainThread]:   attach: None
[0m17:33:00.856726 [info ] [MainThread]:   filesystems: None
[0m17:33:00.857676 [info ] [MainThread]:   remote: None
[0m17:33:00.858719 [info ] [MainThread]:   plugins: None
[0m17:33:00.860731 [info ] [MainThread]:   disable_transactions: False
[0m17:33:00.861745 [info ] [MainThread]: Registered adapter: duckdb=1.9.2
[0m17:33:01.527861 [debug] [MainThread]: Acquiring new duckdb connection 'debug'
[0m17:33:09.496467 [debug] [MainThread]: Using duckdb connection "debug"
[0m17:33:09.498954 [debug] [MainThread]: On debug: select 1 as id
[0m17:33:09.500202 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:33:09.578840 [debug] [MainThread]: SQL status: OK in 0.080 seconds
[0m17:33:09.585176 [debug] [MainThread]: On debug: Close
[0m17:33:09.587621 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m17:33:09.590736 [info ] [MainThread]: [32mAll checks passed![0m
[0m17:33:09.590736 [debug] [MainThread]: Command `dbt debug` succeeded at 17:33:09.590736 after 10.59 seconds
[0m17:33:09.597073 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m17:33:09.599829 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020FB5B8F560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020FAF4396A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020FB2750E90>]}
[0m17:33:09.601849 [debug] [MainThread]: Flushing usage events
[0m17:33:10.376496 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:35:19.360771 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018B3D64F0E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018B3D64FCE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018B3DAE6D50>]}


============================== 22:35:19.384672 | 720e4c25-08d3-4aff-9e62-cb46a704f6d4 ==============================
[0m22:35:19.384672 [info ] [MainThread]: Running with dbt=1.9.4
[0m22:35:19.389968 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\loges\\.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'D:\\Stock_price\\stock_dbt_project\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run --select read_csv', 'send_anonymous_usage_stats': 'True'}
[0m22:35:21.017954 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '720e4c25-08d3-4aff-9e62-cb46a704f6d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018B3DB316A0>]}
[0m22:35:21.263085 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '720e4c25-08d3-4aff-9e62-cb46a704f6d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018B3DE07E90>]}
[0m22:35:21.323368 [info ] [MainThread]: Registered adapter: duckdb=1.9.2
[0m22:35:22.630691 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m22:35:23.250859 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m22:35:23.255396 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '720e4c25-08d3-4aff-9e62-cb46a704f6d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018B3D682240>]}
[0m22:35:31.644396 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.stock_dbt_project.marts
[0m22:35:31.679188 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '720e4c25-08d3-4aff-9e62-cb46a704f6d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018B3F3D9FA0>]}
[0m22:35:32.138664 [debug] [MainThread]: Wrote artifact WritableManifest to D:\Stock_price\stock_dbt_project\target\manifest.json
[0m22:35:32.181569 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\Stock_price\stock_dbt_project\target\semantic_manifest.json
[0m22:35:32.307093 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '720e4c25-08d3-4aff-9e62-cb46a704f6d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018B3F357740>]}
[0m22:35:32.310121 [info ] [MainThread]: Found 5 models, 11 operations, 4 data tests, 426 macros
[0m22:35:32.312854 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '720e4c25-08d3-4aff-9e62-cb46a704f6d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018B3F120860>]}
[0m22:35:32.318099 [info ] [MainThread]: 
[0m22:35:32.324396 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:35:32.326447 [info ] [MainThread]: 
[0m22:35:32.329444 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m22:35:32.332982 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m22:35:36.522335 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m22:35:36.524334 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m22:35:36.525335 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:35:36.606263 [debug] [ThreadPool]: SQL status: OK in 0.081 seconds
[0m22:35:36.612233 [debug] [ThreadPool]: On list_dev: Close
[0m22:35:36.612233 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m22:35:36.612233 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m22:35:36.648101 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m22:35:36.649719 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "create_dev_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m22:35:36.651399 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:35:36.656413 [debug] [ThreadPool]: SQL status: OK in 0.005 seconds
[0m22:35:36.660043 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m22:35:36.660043 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m22:35:36.666063 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m22:35:36.667872 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m22:35:36.672656 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "create_dev_main"} */

    
    
        create schema if not exists "dev"."main"
    
[0m22:35:36.675852 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m22:35:36.679946 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m22:35:36.681407 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m22:35:36.683076 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m22:35:36.684750 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m22:35:36.689729 [debug] [ThreadPool]: On create_dev_main: Close
[0m22:35:36.712788 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev_main'
[0m22:35:36.743238 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m22:35:36.744454 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m22:35:36.747064 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:35:36.747064 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m22:35:36.747064 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m22:35:36.753499 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m22:35:36.861308 [debug] [ThreadPool]: SQL status: OK in 0.103 seconds
[0m22:35:36.866869 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m22:35:36.920555 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m22:35:36.924194 [debug] [ThreadPool]: On list_dev_main: Close
[0m22:35:36.930129 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '720e4c25-08d3-4aff-9e62-cb46a704f6d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018B3DEBA030>]}
[0m22:35:36.932390 [debug] [MainThread]: Using duckdb connection "master"
[0m22:35:36.934133 [debug] [MainThread]: On master: BEGIN
[0m22:35:36.935846 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:35:36.940880 [debug] [MainThread]: SQL status: OK in 0.005 seconds
[0m22:35:36.943307 [debug] [MainThread]: On master: COMMIT
[0m22:35:36.945302 [debug] [MainThread]: Using duckdb connection "master"
[0m22:35:36.947110 [debug] [MainThread]: On master: COMMIT
[0m22:35:36.948764 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m22:35:36.964061 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-0"
[0m22:35:36.975242 [info ] [MainThread]: 1 of 11 START hook: stock_dbt_project.on-run-start.0 ........................... [RUN]
[0m22:35:36.977243 [debug] [MainThread]: Using duckdb connection "master"
[0m22:35:36.979090 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
INSTALL httpfs;
[0m22:35:36.995263 [debug] [MainThread]: SQL status: OK in 0.019 seconds
[0m22:35:36.995263 [info ] [MainThread]: 1 of 11 OK hook: stock_dbt_project.on-run-start.0 .............................. [[32mOK[0m in 0.05s]
[0m22:35:37.009033 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-1"
[0m22:35:37.012036 [info ] [MainThread]: 2 of 11 START hook: stock_dbt_project.on-run-start.1 ........................... [RUN]
[0m22:35:37.013829 [debug] [MainThread]: Using duckdb connection "master"
[0m22:35:37.014629 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
INSTALL json;
[0m22:35:37.033507 [debug] [MainThread]: SQL status: OK in 0.018 seconds
[0m22:35:37.036615 [info ] [MainThread]: 2 of 11 OK hook: stock_dbt_project.on-run-start.1 .............................. [[32mOK[0m in 0.03s]
[0m22:35:37.044403 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-2"
[0m22:35:37.047719 [info ] [MainThread]: 3 of 11 START hook: stock_dbt_project.on-run-start.2 ........................... [RUN]
[0m22:35:37.048498 [debug] [MainThread]: Using duckdb connection "master"
[0m22:35:37.050847 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
LOAD httpfs;
[0m22:35:38.599801 [debug] [MainThread]: SQL status: OK in 1.551 seconds
[0m22:35:38.599801 [info ] [MainThread]: 3 of 11 OK hook: stock_dbt_project.on-run-start.2 .............................. [[32mOK[0m in 1.56s]
[0m22:35:38.614879 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-3"
[0m22:35:38.617887 [info ] [MainThread]: 4 of 11 START hook: stock_dbt_project.on-run-start.3 ........................... [RUN]
[0m22:35:38.621983 [debug] [MainThread]: Using duckdb connection "master"
[0m22:35:38.624620 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
LOAD json;
[0m22:35:38.628769 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m22:35:38.632750 [info ] [MainThread]: 4 of 11 OK hook: stock_dbt_project.on-run-start.3 .............................. [[32mOK[0m in 0.02s]
[0m22:35:38.641259 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-4"
[0m22:35:38.644121 [info ] [MainThread]: 5 of 11 START hook: stock_dbt_project.on-run-start.4 ........................... [RUN]
[0m22:35:38.649919 [debug] [MainThread]: Using duckdb connection "master"
[0m22:35:38.653265 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
SET s3_endpoint='http://localhost:9000';
[0m22:35:38.657251 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m22:35:38.663504 [info ] [MainThread]: 5 of 11 OK hook: stock_dbt_project.on-run-start.4 .............................. [[32mOK[0m in 0.03s]
[0m22:35:38.673962 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-5"
[0m22:35:38.678547 [info ] [MainThread]: 6 of 11 START hook: stock_dbt_project.on-run-start.5 ........................... [RUN]
[0m22:35:38.683093 [debug] [MainThread]: Using duckdb connection "master"
[0m22:35:38.686098 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
SET s3_access_key_id='minioadmin';
[0m22:35:38.693963 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m22:35:38.704097 [info ] [MainThread]: 6 of 11 OK hook: stock_dbt_project.on-run-start.5 .............................. [[32mOK[0m in 0.04s]
[0m22:35:38.716911 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-6"
[0m22:35:38.723470 [info ] [MainThread]: 7 of 11 START hook: stock_dbt_project.on-run-start.6 ........................... [RUN]
[0m22:35:38.728838 [debug] [MainThread]: Using duckdb connection "master"
[0m22:35:38.735970 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
SET s3_secret_access_key='minioadmin';
[0m22:35:38.741968 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m22:35:38.750693 [info ] [MainThread]: 7 of 11 OK hook: stock_dbt_project.on-run-start.6 .............................. [[32mOK[0m in 0.04s]
[0m22:35:38.762559 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-7"
[0m22:35:38.766142 [info ] [MainThread]: 8 of 11 START hook: stock_dbt_project.on-run-start.7 ........................... [RUN]
[0m22:35:38.774037 [debug] [MainThread]: Using duckdb connection "master"
[0m22:35:38.779483 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
SET s3_region='us-east-1';
[0m22:35:38.787481 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m22:35:38.797377 [info ] [MainThread]: 8 of 11 OK hook: stock_dbt_project.on-run-start.7 .............................. [[32mOK[0m in 0.04s]
[0m22:35:38.815647 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-8"
[0m22:35:38.822330 [info ] [MainThread]: 9 of 11 START hook: stock_dbt_project.on-run-start.8 ........................... [RUN]
[0m22:35:38.828542 [debug] [MainThread]: Using duckdb connection "master"
[0m22:35:38.832309 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
SET s3_use_ssl=false;
[0m22:35:38.837083 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m22:35:38.845342 [info ] [MainThread]: 9 of 11 OK hook: stock_dbt_project.on-run-start.8 .............................. [[32mOK[0m in 0.04s]
[0m22:35:38.868080 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-9"
[0m22:35:38.875237 [info ] [MainThread]: 10 of 11 START hook: stock_dbt_project.on-run-start.9 .......................... [RUN]
[0m22:35:38.891231 [debug] [MainThread]: Using duckdb connection "master"
[0m22:35:38.900352 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
SET s3_url_style='path';
[0m22:35:38.903937 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m22:35:38.915073 [info ] [MainThread]: 10 of 11 OK hook: stock_dbt_project.on-run-start.9 ............................. [[32mOK[0m in 0.06s]
[0m22:35:38.929631 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-10"
[0m22:35:38.935489 [info ] [MainThread]: 11 of 11 START hook: stock_dbt_project.on-run-start.10 ......................... [RUN]
[0m22:35:38.945618 [debug] [MainThread]: Using duckdb connection "master"
[0m22:35:38.950715 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
python scripts/generate_stock_model.py
[0m22:35:38.956382 [debug] [MainThread]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
python scripts/generate_stock_model.py
[0m22:35:38.959577 [debug] [MainThread]: DuckDB adapter: Rolling back transaction.
[0m22:35:38.968149 [info ] [MainThread]: 11 of 11 ERROR hook: stock_dbt_project.on-run-start.10 ......................... [[31mERROR[0m in 0.05s]
[0m22:35:38.972973 [info ] [MainThread]: 
[0m22:35:38.983194 [debug] [MainThread]: On master: Close
[0m22:35:39.011504 [debug] [Thread-1 (]: Began running node model.stock_dbt_project.read_csv
[0m22:35:39.012855 [info ] [Thread-1 (]: 1 of 1 START sql table model main.read_csv ..................................... [RUN]
[0m22:35:39.019585 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.stock_dbt_project.read_csv'
[0m22:35:39.021954 [debug] [Thread-1 (]: Began compiling node model.stock_dbt_project.read_csv
[0m22:35:39.035717 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_dbt_project.read_csv"
[0m22:35:39.039500 [debug] [Thread-1 (]: Began executing node model.stock_dbt_project.read_csv
[0m22:35:39.351164 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_dbt_project.read_csv"
[0m22:35:39.362264 [debug] [Thread-1 (]: Using duckdb connection "model.stock_dbt_project.read_csv"
[0m22:35:39.368850 [debug] [Thread-1 (]: On model.stock_dbt_project.read_csv: BEGIN
[0m22:35:39.374320 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:35:39.377504 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m22:35:39.379825 [debug] [Thread-1 (]: Using duckdb connection "model.stock_dbt_project.read_csv"
[0m22:35:39.379825 [debug] [Thread-1 (]: On model.stock_dbt_project.read_csv: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "node_id": "model.stock_dbt_project.read_csv"} */

  
    
    

    create  table
      "dev"."main"."read_csv__dbt_tmp"
  
    as (
      



-- Read all stocks from all symbols and dates
SELECT 
    json_extract_string(value, '$.symbol') AS symbol,
    json_extract_string(value, '$.datetime') AS datetime,
    json_extract_double(value, '$.open') AS open,
    json_extract_double(value, '$.high') AS high,
    json_extract_double(value, '$.low') AS low,
    json_extract_double(value, '$.close') AS close,
    json_extract_double(value, '$.volume') AS volume
FROM 
    read_ndjson_auto('s3://my-stock-data-bucket/stocks/CVX/2025/4/13/CVX_20250413_113945_jz58k4.json')
    );
  
  
[0m22:35:41.620844 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "node_id": "model.stock_dbt_project.read_csv"} */

  
    
    

    create  table
      "dev"."main"."read_csv__dbt_tmp"
  
    as (
      



-- Read all stocks from all symbols and dates
SELECT 
    json_extract_string(value, '$.symbol') AS symbol,
    json_extract_string(value, '$.datetime') AS datetime,
    json_extract_double(value, '$.open') AS open,
    json_extract_double(value, '$.high') AS high,
    json_extract_double(value, '$.low') AS low,
    json_extract_double(value, '$.close') AS close,
    json_extract_double(value, '$.volume') AS volume
FROM 
    read_ndjson_auto('s3://my-stock-data-bucket/stocks/CVX/2025/4/13/CVX_20250413_113945_jz58k4.json')
    );
  
  
[0m22:35:41.621860 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m22:35:41.622855 [debug] [Thread-1 (]: On model.stock_dbt_project.read_csv: ROLLBACK
[0m22:35:41.877191 [debug] [Thread-1 (]: Failed to rollback 'model.stock_dbt_project.read_csv'
[0m22:35:41.877191 [debug] [Thread-1 (]: On model.stock_dbt_project.read_csv: Close
[0m22:35:41.891023 [debug] [Thread-1 (]: Runtime Error in model read_csv (models\read_csv.sql)
  HTTP Error: HTTP GET error on 'https://my-stock-data-bucket.s3.amazonaws.com/stocks/CVX/2025/4/13/CVX_20250413_113945_jz58k4.json' (HTTP 400)
[0m22:35:41.899820 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '720e4c25-08d3-4aff-9e62-cb46a704f6d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018B3F7A7AA0>]}
[0m22:35:41.899820 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model main.read_csv ............................ [[31mERROR[0m in 2.88s]
[0m22:35:41.905724 [debug] [Thread-1 (]: Finished running node model.stock_dbt_project.read_csv
[0m22:35:41.908190 [debug] [Thread-4 (]: Marking all children of 'model.stock_dbt_project.read_csv' to be skipped because of status 'error'.  Reason: Runtime Error in model read_csv (models\read_csv.sql)
  HTTP Error: HTTP GET error on 'https://my-stock-data-bucket.s3.amazonaws.com/stocks/CVX/2025/4/13/CVX_20250413_113945_jz58k4.json' (HTTP 400).
[0m22:35:41.914408 [debug] [MainThread]: Using duckdb connection "master"
[0m22:35:41.914408 [debug] [MainThread]: On master: BEGIN
[0m22:35:41.916435 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:35:41.919963 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m22:35:41.922698 [debug] [MainThread]: On master: COMMIT
[0m22:35:41.926350 [debug] [MainThread]: Using duckdb connection "master"
[0m22:35:41.928770 [debug] [MainThread]: On master: COMMIT
[0m22:35:41.932946 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m22:35:41.938154 [debug] [MainThread]: On master: Close
[0m22:35:41.942398 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:35:41.944881 [debug] [MainThread]: Connection 'create_dev_main' was properly closed.
[0m22:35:41.947701 [debug] [MainThread]: Connection 'list_dev_main' was properly closed.
[0m22:35:41.950246 [debug] [MainThread]: Connection 'model.stock_dbt_project.read_csv' was properly closed.
[0m22:35:41.951911 [info ] [MainThread]: 
[0m22:35:41.956942 [info ] [MainThread]: Finished running 11 project hooks, 1 table model in 0 hours 0 minutes and 9.62 seconds (9.62s).
[0m22:35:41.978309 [debug] [MainThread]: Command end result
[0m22:35:42.038823 [debug] [MainThread]: Wrote artifact WritableManifest to D:\Stock_price\stock_dbt_project\target\manifest.json
[0m22:35:42.049179 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\Stock_price\stock_dbt_project\target\semantic_manifest.json
[0m22:35:42.049179 [debug] [MainThread]: Wrote artifact RunExecutionResult to D:\Stock_price\stock_dbt_project\target\run_results.json
[0m22:35:42.058330 [info ] [MainThread]: 
[0m22:35:42.058330 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m22:35:42.058330 [info ] [MainThread]: 
[0m22:35:42.058330 [error] [MainThread]:   stock_dbt_project.on-run-start.10 failed, error:
 Parser Error: syntax error at or near "python"
[0m22:35:42.062901 [info ] [MainThread]: 
[0m22:35:42.063407 [error] [MainThread]:   Runtime Error in model read_csv (models\read_csv.sql)
  HTTP Error: HTTP GET error on 'https://my-stock-data-bucket.s3.amazonaws.com/stocks/CVX/2025/4/13/CVX_20250413_113945_jz58k4.json' (HTTP 400)
[0m22:35:42.064428 [info ] [MainThread]: 
[0m22:35:42.066095 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=2 SKIP=0 TOTAL=12
[0m22:35:42.068103 [debug] [MainThread]: Command `dbt run` failed at 22:35:42.068103 after 23.46 seconds
[0m22:35:42.069110 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018B3DAE7320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018B3DAE6B10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018B3DAE6D50>]}
[0m22:35:42.069110 [debug] [MainThread]: Flushing usage events
[0m22:35:42.801129 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:37:32.788540 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E7DEFA0740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E7DED45CA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E7DCE9B380>]}


============================== 22:37:32.803137 | e1883ca5-0fd0-4f5e-b357-ce2ff4f1dbc9 ==============================
[0m22:37:32.803137 [info ] [MainThread]: Running with dbt=1.9.4
[0m22:37:32.806819 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\loges\\.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'D:\\Stock_price\\stock_dbt_project\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run --select stg_stock_data', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:37:33.282468 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e1883ca5-0fd0-4f5e-b357-ce2ff4f1dbc9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E7DF29DA30>]}
[0m22:37:33.456276 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e1883ca5-0fd0-4f5e-b357-ce2ff4f1dbc9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E7DE8E9310>]}
[0m22:37:33.467131 [info ] [MainThread]: Registered adapter: duckdb=1.9.2
[0m22:37:34.242479 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m22:37:34.805650 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m22:37:34.809097 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'e1883ca5-0fd0-4f5e-b357-ce2ff4f1dbc9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E7DEFA2180>]}
[0m22:37:38.527335 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.stock_dbt_project.marts
[0m22:37:38.561322 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e1883ca5-0fd0-4f5e-b357-ce2ff4f1dbc9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E7DF450DD0>]}
[0m22:37:39.044079 [debug] [MainThread]: Wrote artifact WritableManifest to D:\Stock_price\stock_dbt_project\target\manifest.json
[0m22:37:39.049082 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\Stock_price\stock_dbt_project\target\semantic_manifest.json
[0m22:37:39.176157 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e1883ca5-0fd0-4f5e-b357-ce2ff4f1dbc9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E7E0C81310>]}
[0m22:37:39.179176 [info ] [MainThread]: Found 5 models, 10 operations, 4 data tests, 426 macros
[0m22:37:39.179176 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e1883ca5-0fd0-4f5e-b357-ce2ff4f1dbc9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E7DCF2E450>]}
[0m22:37:39.179176 [info ] [MainThread]: 
[0m22:37:39.179176 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:37:39.194341 [info ] [MainThread]: 
[0m22:37:39.198855 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m22:37:39.201987 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m22:37:39.388773 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m22:37:39.389776 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m22:37:39.390767 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:37:39.414983 [debug] [ThreadPool]: SQL status: OK in 0.025 seconds
[0m22:37:39.414983 [debug] [ThreadPool]: On list_dev: Close
[0m22:37:39.414983 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m22:37:39.423332 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m22:37:39.429987 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m22:37:39.429987 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "create_dev_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m22:37:39.429987 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:37:39.429987 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m22:37:39.429987 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m22:37:39.429987 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m22:37:39.442892 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m22:37:39.442892 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m22:37:39.443947 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "create_dev_main"} */

    
    
        create schema if not exists "dev"."main"
    
[0m22:37:39.444963 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m22:37:39.446963 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m22:37:39.446963 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m22:37:39.448289 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m22:37:39.448364 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m22:37:39.449375 [debug] [ThreadPool]: On create_dev_main: Close
[0m22:37:39.458664 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev_main'
[0m22:37:39.463576 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m22:37:39.463576 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m22:37:39.463576 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:37:39.463576 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m22:37:39.470845 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m22:37:39.470845 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m22:37:39.498233 [debug] [ThreadPool]: SQL status: OK in 0.029 seconds
[0m22:37:39.498233 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m22:37:39.507586 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m22:37:39.508582 [debug] [ThreadPool]: On list_dev_main: Close
[0m22:37:39.510577 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e1883ca5-0fd0-4f5e-b357-ce2ff4f1dbc9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E7E1107B60>]}
[0m22:37:39.511857 [debug] [MainThread]: Using duckdb connection "master"
[0m22:37:39.512317 [debug] [MainThread]: On master: BEGIN
[0m22:37:39.512831 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:37:39.512831 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m22:37:39.512831 [debug] [MainThread]: On master: COMMIT
[0m22:37:39.512831 [debug] [MainThread]: Using duckdb connection "master"
[0m22:37:39.512831 [debug] [MainThread]: On master: COMMIT
[0m22:37:39.512831 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m22:37:39.529073 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-0"
[0m22:37:39.532976 [info ] [MainThread]: 1 of 10 START hook: stock_dbt_project.on-run-start.0 ........................... [RUN]
[0m22:37:39.532976 [debug] [MainThread]: Using duckdb connection "master"
[0m22:37:39.532976 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
INSTALL httpfs;
[0m22:37:39.540954 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m22:37:39.543012 [info ] [MainThread]: 1 of 10 OK hook: stock_dbt_project.on-run-start.0 .............................. [[32mOK[0m in 0.03s]
[0m22:37:39.546952 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-1"
[0m22:37:39.549013 [info ] [MainThread]: 2 of 10 START hook: stock_dbt_project.on-run-start.1 ........................... [RUN]
[0m22:37:39.550327 [debug] [MainThread]: Using duckdb connection "master"
[0m22:37:39.551183 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
INSTALL json;
[0m22:37:39.553249 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m22:37:39.555964 [info ] [MainThread]: 2 of 10 OK hook: stock_dbt_project.on-run-start.1 .............................. [[32mOK[0m in 0.01s]
[0m22:37:39.560802 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-2"
[0m22:37:39.563914 [info ] [MainThread]: 3 of 10 START hook: stock_dbt_project.on-run-start.2 ........................... [RUN]
[0m22:37:39.565604 [debug] [MainThread]: Using duckdb connection "master"
[0m22:37:39.566735 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
LOAD httpfs;
[0m22:37:39.846120 [debug] [MainThread]: SQL status: OK in 0.278 seconds
[0m22:37:39.846236 [info ] [MainThread]: 3 of 10 OK hook: stock_dbt_project.on-run-start.2 .............................. [[32mOK[0m in 0.29s]
[0m22:37:39.846236 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-3"
[0m22:37:39.853880 [info ] [MainThread]: 4 of 10 START hook: stock_dbt_project.on-run-start.3 ........................... [RUN]
[0m22:37:39.853880 [debug] [MainThread]: Using duckdb connection "master"
[0m22:37:39.853880 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
LOAD json;
[0m22:37:39.858166 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m22:37:39.860698 [info ] [MainThread]: 4 of 10 OK hook: stock_dbt_project.on-run-start.3 .............................. [[32mOK[0m in 0.01s]
[0m22:37:39.863690 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-4"
[0m22:37:39.864927 [info ] [MainThread]: 5 of 10 START hook: stock_dbt_project.on-run-start.4 ........................... [RUN]
[0m22:37:39.867203 [debug] [MainThread]: Using duckdb connection "master"
[0m22:37:39.868184 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
SET s3_endpoint='http://localhost:9000';
[0m22:37:39.870194 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m22:37:39.871266 [info ] [MainThread]: 5 of 10 OK hook: stock_dbt_project.on-run-start.4 .............................. [[32mOK[0m in 0.01s]
[0m22:37:39.876558 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-5"
[0m22:37:39.878742 [info ] [MainThread]: 6 of 10 START hook: stock_dbt_project.on-run-start.5 ........................... [RUN]
[0m22:37:39.879782 [debug] [MainThread]: Using duckdb connection "master"
[0m22:37:39.880717 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
SET s3_access_key_id='minioadmin';
[0m22:37:39.882724 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m22:37:39.883731 [info ] [MainThread]: 6 of 10 OK hook: stock_dbt_project.on-run-start.5 .............................. [[32mOK[0m in 0.01s]
[0m22:37:39.889471 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-6"
[0m22:37:39.892745 [info ] [MainThread]: 7 of 10 START hook: stock_dbt_project.on-run-start.6 ........................... [RUN]
[0m22:37:39.893668 [debug] [MainThread]: Using duckdb connection "master"
[0m22:37:39.895290 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
SET s3_secret_access_key='minioadmin';
[0m22:37:39.897304 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m22:37:39.899309 [info ] [MainThread]: 7 of 10 OK hook: stock_dbt_project.on-run-start.6 .............................. [[32mOK[0m in 0.01s]
[0m22:37:39.900357 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-7"
[0m22:37:39.900357 [info ] [MainThread]: 8 of 10 START hook: stock_dbt_project.on-run-start.7 ........................... [RUN]
[0m22:37:39.907065 [debug] [MainThread]: Using duckdb connection "master"
[0m22:37:39.909509 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
SET s3_region='us-east-1';
[0m22:37:39.911540 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m22:37:39.915069 [info ] [MainThread]: 8 of 10 OK hook: stock_dbt_project.on-run-start.7 .............................. [[32mOK[0m in 0.01s]
[0m22:37:39.922178 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-8"
[0m22:37:39.926194 [info ] [MainThread]: 9 of 10 START hook: stock_dbt_project.on-run-start.8 ........................... [RUN]
[0m22:37:39.928405 [debug] [MainThread]: Using duckdb connection "master"
[0m22:37:39.929970 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
SET s3_use_ssl=false;
[0m22:37:39.931009 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m22:37:39.932964 [info ] [MainThread]: 9 of 10 OK hook: stock_dbt_project.on-run-start.8 .............................. [[32mOK[0m in 0.02s]
[0m22:37:39.934965 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-9"
[0m22:37:39.934965 [info ] [MainThread]: 10 of 10 START hook: stock_dbt_project.on-run-start.9 .......................... [RUN]
[0m22:37:39.934965 [debug] [MainThread]: Using duckdb connection "master"
[0m22:37:39.942498 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
SET s3_url_style='path';
[0m22:37:39.944570 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m22:37:39.948571 [info ] [MainThread]: 10 of 10 OK hook: stock_dbt_project.on-run-start.9 ............................. [[32mOK[0m in 0.01s]
[0m22:37:39.949515 [info ] [MainThread]: 
[0m22:37:39.950392 [debug] [MainThread]: On master: Close
[0m22:37:39.959809 [debug] [Thread-1 (]: Began running node model.stock_dbt_project.stg_stock_data
[0m22:37:39.962137 [info ] [Thread-1 (]: 1 of 1 START sql view model main.stg_stock_data ................................ [RUN]
[0m22:37:39.963098 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.stock_dbt_project.stg_stock_data'
[0m22:37:39.966289 [debug] [Thread-1 (]: Began compiling node model.stock_dbt_project.stg_stock_data
[0m22:37:39.970600 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_dbt_project.stg_stock_data"
[0m22:37:39.978994 [debug] [Thread-1 (]: Began executing node model.stock_dbt_project.stg_stock_data
[0m22:37:40.084194 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_dbt_project.stg_stock_data"
[0m22:37:40.086931 [debug] [Thread-1 (]: Using duckdb connection "model.stock_dbt_project.stg_stock_data"
[0m22:37:40.089204 [debug] [Thread-1 (]: On model.stock_dbt_project.stg_stock_data: BEGIN
[0m22:37:40.091527 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:37:40.094043 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m22:37:40.095417 [debug] [Thread-1 (]: Using duckdb connection "model.stock_dbt_project.stg_stock_data"
[0m22:37:40.097078 [debug] [Thread-1 (]: On model.stock_dbt_project.stg_stock_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "node_id": "model.stock_dbt_project.stg_stock_data"} */

  
  create view "dev"."main"."stg_stock_data__dbt_tmp" as (
    



WITH raw AS (
    SELECT *
    FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/CVX/2025/4/13/*.json')
)

SELECT
    CAST(symbol AS TEXT) AS symbol,
    CAST(datetime AS TIMESTAMP) AS datetime,
    CAST(open AS DOUBLE) AS open,
    CAST(high AS DOUBLE) AS high,
    CAST(low AS DOUBLE) AS low,
    CAST(close AS DOUBLE) AS close,
    CAST(volume AS BIGINT) AS volume
FROM raw
WHERE symbol IS NOT NULL AND datetime IS NOT NULL
  );

[0m22:37:40.114812 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "node_id": "model.stock_dbt_project.stg_stock_data"} */

  
  create view "dev"."main"."stg_stock_data__dbt_tmp" as (
    



WITH raw AS (
    SELECT *
    FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/CVX/2025/4/13/*.json')
)

SELECT
    CAST(symbol AS TEXT) AS symbol,
    CAST(datetime AS TIMESTAMP) AS datetime,
    CAST(open AS DOUBLE) AS open,
    CAST(high AS DOUBLE) AS high,
    CAST(low AS DOUBLE) AS low,
    CAST(close AS DOUBLE) AS close,
    CAST(volume AS BIGINT) AS volume
FROM raw
WHERE symbol IS NOT NULL AND datetime IS NOT NULL
  );

[0m22:37:40.116220 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m22:37:40.117861 [debug] [Thread-1 (]: On model.stock_dbt_project.stg_stock_data: ROLLBACK
[0m22:37:40.132409 [debug] [Thread-1 (]: Failed to rollback 'model.stock_dbt_project.stg_stock_data'
[0m22:37:40.134057 [debug] [Thread-1 (]: On model.stock_dbt_project.stg_stock_data: Close
[0m22:37:40.142398 [debug] [Thread-1 (]: Runtime Error in model stg_stock_data (models\staging\stg_stock_data.sql)
  HTTP Error: Unable to connect to URL "http://localhost:9000/my-stock-data-bucket/stocks/CVX/2025/4/13/*.json": 404 (Not Found).
[0m22:37:40.151633 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e1883ca5-0fd0-4f5e-b357-ce2ff4f1dbc9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E7E130E030>]}
[0m22:37:40.156797 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model main.stg_stock_data ....................... [[31mERROR[0m in 0.18s]
[0m22:37:40.161747 [debug] [Thread-1 (]: Finished running node model.stock_dbt_project.stg_stock_data
[0m22:37:40.165058 [debug] [Thread-4 (]: Marking all children of 'model.stock_dbt_project.stg_stock_data' to be skipped because of status 'error'.  Reason: Runtime Error in model stg_stock_data (models\staging\stg_stock_data.sql)
  HTTP Error: Unable to connect to URL "http://localhost:9000/my-stock-data-bucket/stocks/CVX/2025/4/13/*.json": 404 (Not Found)..
[0m22:37:40.175039 [debug] [MainThread]: Using duckdb connection "master"
[0m22:37:40.177583 [debug] [MainThread]: On master: BEGIN
[0m22:37:40.180112 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:37:40.183886 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m22:37:40.186245 [debug] [MainThread]: On master: COMMIT
[0m22:37:40.190891 [debug] [MainThread]: Using duckdb connection "master"
[0m22:37:40.193782 [debug] [MainThread]: On master: COMMIT
[0m22:37:40.197304 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m22:37:40.199795 [debug] [MainThread]: On master: Close
[0m22:37:40.201112 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:37:40.207700 [debug] [MainThread]: Connection 'create_dev_main' was properly closed.
[0m22:37:40.209866 [debug] [MainThread]: Connection 'list_dev_main' was properly closed.
[0m22:37:40.212844 [debug] [MainThread]: Connection 'model.stock_dbt_project.stg_stock_data' was properly closed.
[0m22:37:40.215359 [info ] [MainThread]: 
[0m22:37:40.219530 [info ] [MainThread]: Finished running 10 project hooks, 1 view model in 0 hours 0 minutes and 1.02 seconds (1.02s).
[0m22:37:40.232530 [debug] [MainThread]: Command end result
[0m22:37:40.361786 [debug] [MainThread]: Wrote artifact WritableManifest to D:\Stock_price\stock_dbt_project\target\manifest.json
[0m22:37:40.373793 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\Stock_price\stock_dbt_project\target\semantic_manifest.json
[0m22:37:40.406013 [debug] [MainThread]: Wrote artifact RunExecutionResult to D:\Stock_price\stock_dbt_project\target\run_results.json
[0m22:37:40.409770 [info ] [MainThread]: 
[0m22:37:40.412682 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m22:37:40.415972 [info ] [MainThread]: 
[0m22:37:40.418670 [error] [MainThread]:   Runtime Error in model stg_stock_data (models\staging\stg_stock_data.sql)
  HTTP Error: Unable to connect to URL "http://localhost:9000/my-stock-data-bucket/stocks/CVX/2025/4/13/*.json": 404 (Not Found).
[0m22:37:40.423673 [info ] [MainThread]: 
[0m22:37:40.427160 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=1 SKIP=0 TOTAL=11
[0m22:37:40.435023 [debug] [MainThread]: Command `dbt run` failed at 22:37:40.433549 after 7.92 seconds
[0m22:37:40.441995 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E7DF2C39E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E7E09C4170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E7DF1A7650>]}
[0m22:37:40.446021 [debug] [MainThread]: Flushing usage events
[0m22:37:41.098028 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:38:32.327207 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002527C31AA80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002527BC2AFC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002527BC28AD0>]}


============================== 22:38:32.332467 | 1a12f17d-c54c-4903-bb01-391503902f1d ==============================
[0m22:38:32.332467 [info ] [MainThread]: Running with dbt=1.9.4
[0m22:38:32.332467 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\loges\\.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'D:\\Stock_price\\stock_dbt_project\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run --select stg_stock_data', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:38:32.909380 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1a12f17d-c54c-4903-bb01-391503902f1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002527C7F89B0>]}
[0m22:38:33.023806 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1a12f17d-c54c-4903-bb01-391503902f1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002527BCBD970>]}
[0m22:38:33.028322 [info ] [MainThread]: Registered adapter: duckdb=1.9.2
[0m22:38:33.672064 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m22:38:34.261175 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m22:38:34.264190 [debug] [MainThread]: Partial parsing: updated file: stock_dbt_project://models\staging\stg_stock_data.sql
[0m22:38:35.403384 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.stock_dbt_project.marts
[0m22:38:35.435099 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1a12f17d-c54c-4903-bb01-391503902f1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002527DFA23F0>]}
[0m22:38:35.820419 [debug] [MainThread]: Wrote artifact WritableManifest to D:\Stock_price\stock_dbt_project\target\manifest.json
[0m22:38:35.824102 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\Stock_price\stock_dbt_project\target\semantic_manifest.json
[0m22:38:35.863584 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1a12f17d-c54c-4903-bb01-391503902f1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002527DD0F650>]}
[0m22:38:35.863584 [info ] [MainThread]: Found 5 models, 10 operations, 4 data tests, 426 macros
[0m22:38:35.863584 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1a12f17d-c54c-4903-bb01-391503902f1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002527DFB1580>]}
[0m22:38:35.872651 [info ] [MainThread]: 
[0m22:38:35.874323 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:38:35.875896 [info ] [MainThread]: 
[0m22:38:35.877010 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m22:38:35.879231 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m22:38:36.049411 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m22:38:36.050419 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m22:38:36.051192 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:38:36.099411 [debug] [ThreadPool]: SQL status: OK in 0.048 seconds
[0m22:38:36.106574 [debug] [ThreadPool]: On list_dev: Close
[0m22:38:36.111922 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m22:38:36.115042 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m22:38:36.142214 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m22:38:36.144211 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "create_dev_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m22:38:36.145210 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:38:36.148095 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m22:38:36.148095 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m22:38:36.148095 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m22:38:36.156239 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m22:38:36.158243 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m22:38:36.159234 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "create_dev_main"} */

    
    
        create schema if not exists "dev"."main"
    
[0m22:38:36.162001 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m22:38:36.162001 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m22:38:36.162001 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m22:38:36.162001 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m22:38:36.162001 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m22:38:36.162001 [debug] [ThreadPool]: On create_dev_main: Close
[0m22:38:36.182676 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev_main'
[0m22:38:36.196610 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m22:38:36.196610 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m22:38:36.196610 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:38:36.196610 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m22:38:36.196610 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m22:38:36.210676 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m22:38:36.245089 [debug] [ThreadPool]: SQL status: OK in 0.038 seconds
[0m22:38:36.245089 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m22:38:36.245089 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m22:38:36.245089 [debug] [ThreadPool]: On list_dev_main: Close
[0m22:38:36.260084 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1a12f17d-c54c-4903-bb01-391503902f1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002527C7A3470>]}
[0m22:38:36.261085 [debug] [MainThread]: Using duckdb connection "master"
[0m22:38:36.261085 [debug] [MainThread]: On master: BEGIN
[0m22:38:36.262081 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:38:36.263093 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m22:38:36.264085 [debug] [MainThread]: On master: COMMIT
[0m22:38:36.264222 [debug] [MainThread]: Using duckdb connection "master"
[0m22:38:36.265261 [debug] [MainThread]: On master: COMMIT
[0m22:38:36.265922 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m22:38:36.274920 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-0"
[0m22:38:36.279828 [info ] [MainThread]: 1 of 10 START hook: stock_dbt_project.on-run-start.0 ........................... [RUN]
[0m22:38:36.279828 [debug] [MainThread]: Using duckdb connection "master"
[0m22:38:36.279828 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
INSTALL httpfs;
[0m22:38:36.279828 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m22:38:36.279828 [info ] [MainThread]: 1 of 10 OK hook: stock_dbt_project.on-run-start.0 .............................. [[32mOK[0m in 0.01s]
[0m22:38:36.294138 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-1"
[0m22:38:36.297131 [info ] [MainThread]: 2 of 10 START hook: stock_dbt_project.on-run-start.1 ........................... [RUN]
[0m22:38:36.299977 [debug] [MainThread]: Using duckdb connection "master"
[0m22:38:36.300637 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
INSTALL json;
[0m22:38:36.304135 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m22:38:36.306551 [info ] [MainThread]: 2 of 10 OK hook: stock_dbt_project.on-run-start.1 .............................. [[32mOK[0m in 0.03s]
[0m22:38:36.314642 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-2"
[0m22:38:36.316717 [info ] [MainThread]: 3 of 10 START hook: stock_dbt_project.on-run-start.2 ........................... [RUN]
[0m22:38:36.318727 [debug] [MainThread]: Using duckdb connection "master"
[0m22:38:36.319533 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
LOAD httpfs;
[0m22:38:36.626805 [debug] [MainThread]: SQL status: OK in 0.305 seconds
[0m22:38:36.628924 [info ] [MainThread]: 3 of 10 OK hook: stock_dbt_project.on-run-start.2 .............................. [[32mOK[0m in 0.32s]
[0m22:38:36.632597 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-3"
[0m22:38:36.633555 [info ] [MainThread]: 4 of 10 START hook: stock_dbt_project.on-run-start.3 ........................... [RUN]
[0m22:38:36.633555 [debug] [MainThread]: Using duckdb connection "master"
[0m22:38:36.636061 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
LOAD json;
[0m22:38:36.638078 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m22:38:36.642156 [info ] [MainThread]: 4 of 10 OK hook: stock_dbt_project.on-run-start.3 .............................. [[32mOK[0m in 0.01s]
[0m22:38:36.646291 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-4"
[0m22:38:36.648396 [info ] [MainThread]: 5 of 10 START hook: stock_dbt_project.on-run-start.4 ........................... [RUN]
[0m22:38:36.650000 [debug] [MainThread]: Using duckdb connection "master"
[0m22:38:36.650000 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
SET s3_endpoint='http://localhost:9000';
[0m22:38:36.651999 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m22:38:36.653811 [info ] [MainThread]: 5 of 10 OK hook: stock_dbt_project.on-run-start.4 .............................. [[32mOK[0m in 0.01s]
[0m22:38:36.658438 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-5"
[0m22:38:36.660437 [info ] [MainThread]: 6 of 10 START hook: stock_dbt_project.on-run-start.5 ........................... [RUN]
[0m22:38:36.661437 [debug] [MainThread]: Using duckdb connection "master"
[0m22:38:36.662434 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
SET s3_access_key_id='minioadmin';
[0m22:38:36.663445 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m22:38:36.664512 [info ] [MainThread]: 6 of 10 OK hook: stock_dbt_project.on-run-start.5 .............................. [[32mOK[0m in 0.01s]
[0m22:38:36.668191 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-6"
[0m22:38:36.670196 [info ] [MainThread]: 7 of 10 START hook: stock_dbt_project.on-run-start.6 ........................... [RUN]
[0m22:38:36.671464 [debug] [MainThread]: Using duckdb connection "master"
[0m22:38:36.671464 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
SET s3_secret_access_key='minioadmin';
[0m22:38:36.671464 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m22:38:36.676343 [info ] [MainThread]: 7 of 10 OK hook: stock_dbt_project.on-run-start.6 .............................. [[32mOK[0m in 0.01s]
[0m22:38:36.680345 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-7"
[0m22:38:36.681338 [info ] [MainThread]: 8 of 10 START hook: stock_dbt_project.on-run-start.7 ........................... [RUN]
[0m22:38:36.682339 [debug] [MainThread]: Using duckdb connection "master"
[0m22:38:36.683340 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
SET s3_region='us-east-1';
[0m22:38:36.686687 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m22:38:36.692503 [info ] [MainThread]: 8 of 10 OK hook: stock_dbt_project.on-run-start.7 .............................. [[32mOK[0m in 0.01s]
[0m22:38:36.701577 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-8"
[0m22:38:36.707190 [info ] [MainThread]: 9 of 10 START hook: stock_dbt_project.on-run-start.8 ........................... [RUN]
[0m22:38:36.710115 [debug] [MainThread]: Using duckdb connection "master"
[0m22:38:36.713130 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
SET s3_use_ssl=false;
[0m22:38:36.717381 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m22:38:36.724239 [info ] [MainThread]: 9 of 10 OK hook: stock_dbt_project.on-run-start.8 .............................. [[32mOK[0m in 0.03s]
[0m22:38:36.734114 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-9"
[0m22:38:36.741793 [info ] [MainThread]: 10 of 10 START hook: stock_dbt_project.on-run-start.9 .......................... [RUN]
[0m22:38:36.746771 [debug] [MainThread]: Using duckdb connection "master"
[0m22:38:36.749444 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
SET s3_url_style='path';
[0m22:38:36.752167 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m22:38:36.756903 [info ] [MainThread]: 10 of 10 OK hook: stock_dbt_project.on-run-start.9 ............................. [[32mOK[0m in 0.03s]
[0m22:38:36.760162 [info ] [MainThread]: 
[0m22:38:36.764137 [debug] [MainThread]: On master: Close
[0m22:38:36.780535 [debug] [Thread-1 (]: Began running node model.stock_dbt_project.stg_stock_data
[0m22:38:36.784488 [info ] [Thread-1 (]: 1 of 1 START sql view model main.stg_stock_data ................................ [RUN]
[0m22:38:36.791064 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.stock_dbt_project.stg_stock_data'
[0m22:38:36.794316 [debug] [Thread-1 (]: Began compiling node model.stock_dbt_project.stg_stock_data
[0m22:38:36.811591 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_dbt_project.stg_stock_data"
[0m22:38:36.816931 [debug] [Thread-1 (]: Began executing node model.stock_dbt_project.stg_stock_data
[0m22:38:36.951189 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_dbt_project.stg_stock_data"
[0m22:38:36.960895 [debug] [Thread-1 (]: Using duckdb connection "model.stock_dbt_project.stg_stock_data"
[0m22:38:36.962918 [debug] [Thread-1 (]: On model.stock_dbt_project.stg_stock_data: BEGIN
[0m22:38:36.964911 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:38:36.968579 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m22:38:36.970917 [debug] [Thread-1 (]: Using duckdb connection "model.stock_dbt_project.stg_stock_data"
[0m22:38:36.973716 [debug] [Thread-1 (]: On model.stock_dbt_project.stg_stock_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "node_id": "model.stock_dbt_project.stg_stock_data"} */

  
  create view "dev"."main"."stg_stock_data__dbt_tmp" as (
    



WITH raw AS (
    SELECT *
    FROM read_json_auto('s3://my-stock-data-bucket/stocks/*/*/*/*/*.json')
)

SELECT
    CAST(symbol AS TEXT) AS symbol,
    CAST(datetime AS TIMESTAMP) AS datetime,
    CAST(open AS DOUBLE) AS open,
    CAST(high AS DOUBLE) AS high,
    CAST(low AS DOUBLE) AS low, 
    CAST(close AS DOUBLE) AS close,
    CAST(volume AS BIGINT) AS volume
FROM raw
WHERE symbol IS NOT NULL AND datetime IS NOT NULL
  );

[0m22:38:37.325051 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "node_id": "model.stock_dbt_project.stg_stock_data"} */

  
  create view "dev"."main"."stg_stock_data__dbt_tmp" as (
    



WITH raw AS (
    SELECT *
    FROM read_json_auto('s3://my-stock-data-bucket/stocks/*/*/*/*/*.json')
)

SELECT
    CAST(symbol AS TEXT) AS symbol,
    CAST(datetime AS TIMESTAMP) AS datetime,
    CAST(open AS DOUBLE) AS open,
    CAST(high AS DOUBLE) AS high,
    CAST(low AS DOUBLE) AS low, 
    CAST(close AS DOUBLE) AS close,
    CAST(volume AS BIGINT) AS volume
FROM raw
WHERE symbol IS NOT NULL AND datetime IS NOT NULL
  );

[0m22:38:37.327286 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m22:38:37.329768 [debug] [Thread-1 (]: On model.stock_dbt_project.stg_stock_data: ROLLBACK
[0m22:38:37.346633 [debug] [Thread-1 (]: Failed to rollback 'model.stock_dbt_project.stg_stock_data'
[0m22:38:37.348821 [debug] [Thread-1 (]: On model.stock_dbt_project.stg_stock_data: Close
[0m22:38:37.358588 [debug] [Thread-1 (]: Runtime Error in model stg_stock_data (models\staging\stg_stock_data.sql)
  HTTP Error: HTTP GET error on '/?encoding-type=url&list-type=2&prefix=stocks%2F' (HTTP 400)
[0m22:38:37.370325 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1a12f17d-c54c-4903-bb01-391503902f1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002527BC5BCE0>]}
[0m22:38:37.377822 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model main.stg_stock_data ....................... [[31mERROR[0m in 0.57s]
[0m22:38:37.384085 [debug] [Thread-1 (]: Finished running node model.stock_dbt_project.stg_stock_data
[0m22:38:37.388457 [debug] [Thread-4 (]: Marking all children of 'model.stock_dbt_project.stg_stock_data' to be skipped because of status 'error'.  Reason: Runtime Error in model stg_stock_data (models\staging\stg_stock_data.sql)
  HTTP Error: HTTP GET error on '/?encoding-type=url&list-type=2&prefix=stocks%2F' (HTTP 400).
[0m22:38:37.397918 [debug] [MainThread]: Using duckdb connection "master"
[0m22:38:37.398901 [debug] [MainThread]: On master: BEGIN
[0m22:38:37.408171 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:38:37.417540 [debug] [MainThread]: SQL status: OK in 0.010 seconds
[0m22:38:37.422359 [debug] [MainThread]: On master: COMMIT
[0m22:38:37.424636 [debug] [MainThread]: Using duckdb connection "master"
[0m22:38:37.426707 [debug] [MainThread]: On master: COMMIT
[0m22:38:37.430607 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m22:38:37.432411 [debug] [MainThread]: On master: Close
[0m22:38:37.434657 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:38:37.436676 [debug] [MainThread]: Connection 'create_dev_main' was properly closed.
[0m22:38:37.439437 [debug] [MainThread]: Connection 'list_dev_main' was properly closed.
[0m22:38:37.442451 [debug] [MainThread]: Connection 'model.stock_dbt_project.stg_stock_data' was properly closed.
[0m22:38:37.446049 [info ] [MainThread]: 
[0m22:38:37.456175 [info ] [MainThread]: Finished running 10 project hooks, 1 view model in 0 hours 0 minutes and 1.57 seconds (1.57s).
[0m22:38:37.476779 [debug] [MainThread]: Command end result
[0m22:38:37.611767 [debug] [MainThread]: Wrote artifact WritableManifest to D:\Stock_price\stock_dbt_project\target\manifest.json
[0m22:38:37.611767 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\Stock_price\stock_dbt_project\target\semantic_manifest.json
[0m22:38:37.634361 [debug] [MainThread]: Wrote artifact RunExecutionResult to D:\Stock_price\stock_dbt_project\target\run_results.json
[0m22:38:37.639649 [info ] [MainThread]: 
[0m22:38:37.642678 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m22:38:37.643669 [info ] [MainThread]: 
[0m22:38:37.645944 [error] [MainThread]:   Runtime Error in model stg_stock_data (models\staging\stg_stock_data.sql)
  HTTP Error: HTTP GET error on '/?encoding-type=url&list-type=2&prefix=stocks%2F' (HTTP 400)
[0m22:38:37.646467 [info ] [MainThread]: 
[0m22:38:37.648872 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=1 SKIP=0 TOTAL=11
[0m22:38:37.650890 [debug] [MainThread]: Command `dbt run` failed at 22:38:37.650890 after 5.72 seconds
[0m22:38:37.651889 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002527C3C7E60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002527C4475C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000252793853D0>]}
[0m22:38:37.652888 [debug] [MainThread]: Flushing usage events
[0m22:38:38.269425 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:41:45.196782 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E933353E30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E933353C50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E9303C51C0>]}


============================== 22:41:45.216425 | 2b6a7aea-a461-497d-a2da-6e9dea34a30b ==============================
[0m22:41:45.216425 [info ] [MainThread]: Running with dbt=1.9.4
[0m22:41:45.222032 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'D:\\Stock_price\\stock_dbt_project\\logs', 'profiles_dir': 'C:\\Users\\loges\\.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run --select stg_stock_data', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:41:46.156082 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2b6a7aea-a461-497d-a2da-6e9dea34a30b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E932FBF2F0>]}
[0m22:41:46.281735 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2b6a7aea-a461-497d-a2da-6e9dea34a30b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E93067A8D0>]}
[0m22:41:46.291927 [info ] [MainThread]: Registered adapter: duckdb=1.9.2
[0m22:41:46.731528 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m22:41:47.407579 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:41:47.410315 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:41:47.434965 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.stock_dbt_project.marts
[0m22:41:47.586335 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2b6a7aea-a461-497d-a2da-6e9dea34a30b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E933B6C320>]}
[0m22:41:47.757951 [debug] [MainThread]: Wrote artifact WritableManifest to D:\Stock_price\stock_dbt_project\target\manifest.json
[0m22:41:47.762269 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\Stock_price\stock_dbt_project\target\semantic_manifest.json
[0m22:41:47.817289 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2b6a7aea-a461-497d-a2da-6e9dea34a30b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E934F088C0>]}
[0m22:41:47.817807 [info ] [MainThread]: Found 5 models, 10 operations, 4 data tests, 426 macros
[0m22:41:47.820428 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2b6a7aea-a461-497d-a2da-6e9dea34a30b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E93384EB70>]}
[0m22:41:47.826208 [info ] [MainThread]: 
[0m22:41:47.827222 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:41:47.828870 [info ] [MainThread]: 
[0m22:41:47.830889 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m22:41:47.833431 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m22:41:47.992530 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m22:41:47.993521 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m22:41:47.994037 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:41:48.020729 [debug] [ThreadPool]: SQL status: OK in 0.026 seconds
[0m22:41:48.020729 [debug] [ThreadPool]: On list_dev: Close
[0m22:41:48.026553 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m22:41:48.027681 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m22:41:48.051402 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m22:41:48.051402 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "create_dev_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m22:41:48.051402 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:41:48.051402 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m22:41:48.051402 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m22:41:48.061790 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m22:41:48.063804 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m22:41:48.064803 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m22:41:48.065804 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "create_dev_main"} */

    
    
        create schema if not exists "dev"."main"
    
[0m22:41:48.067173 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m22:41:48.068633 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m22:41:48.070205 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m22:41:48.070205 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m22:41:48.070205 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m22:41:48.070205 [debug] [ThreadPool]: On create_dev_main: Close
[0m22:41:48.084610 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev_main'
[0m22:41:48.102465 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m22:41:48.104549 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m22:41:48.104549 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:41:48.109437 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m22:41:48.110458 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m22:41:48.112466 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m22:41:48.165946 [debug] [ThreadPool]: SQL status: OK in 0.056 seconds
[0m22:41:48.176105 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m22:41:48.181296 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m22:41:48.182755 [debug] [ThreadPool]: On list_dev_main: Close
[0m22:41:48.185204 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2b6a7aea-a461-497d-a2da-6e9dea34a30b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E933B8DD00>]}
[0m22:41:48.185811 [debug] [MainThread]: Using duckdb connection "master"
[0m22:41:48.185811 [debug] [MainThread]: On master: BEGIN
[0m22:41:48.185811 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:41:48.193800 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m22:41:48.194797 [debug] [MainThread]: On master: COMMIT
[0m22:41:48.195793 [debug] [MainThread]: Using duckdb connection "master"
[0m22:41:48.196796 [debug] [MainThread]: On master: COMMIT
[0m22:41:48.199132 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m22:41:48.213284 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-0"
[0m22:41:48.220806 [info ] [MainThread]: 1 of 10 START hook: stock_dbt_project.on-run-start.0 ........................... [RUN]
[0m22:41:48.227159 [debug] [MainThread]: Using duckdb connection "master"
[0m22:41:48.228490 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
INSTALL httpfs;
[0m22:41:48.232101 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m22:41:48.234089 [info ] [MainThread]: 1 of 10 OK hook: stock_dbt_project.on-run-start.0 .............................. [[32mOK[0m in 0.03s]
[0m22:41:48.243161 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-1"
[0m22:41:48.248090 [info ] [MainThread]: 2 of 10 START hook: stock_dbt_project.on-run-start.1 ........................... [RUN]
[0m22:41:48.248090 [debug] [MainThread]: Using duckdb connection "master"
[0m22:41:48.252381 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
INSTALL json;
[0m22:41:48.255371 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m22:41:48.259134 [info ] [MainThread]: 2 of 10 OK hook: stock_dbt_project.on-run-start.1 .............................. [[32mOK[0m in 0.02s]
[0m22:41:48.266023 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-2"
[0m22:41:48.269605 [info ] [MainThread]: 3 of 10 START hook: stock_dbt_project.on-run-start.2 ........................... [RUN]
[0m22:41:48.271780 [debug] [MainThread]: Using duckdb connection "master"
[0m22:41:48.271780 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
LOAD httpfs;
[0m22:41:48.734463 [debug] [MainThread]: SQL status: OK in 0.458 seconds
[0m22:41:48.739576 [info ] [MainThread]: 3 of 10 OK hook: stock_dbt_project.on-run-start.2 .............................. [[32mOK[0m in 0.48s]
[0m22:41:48.747517 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-3"
[0m22:41:48.750038 [info ] [MainThread]: 4 of 10 START hook: stock_dbt_project.on-run-start.3 ........................... [RUN]
[0m22:41:48.756612 [debug] [MainThread]: Using duckdb connection "master"
[0m22:41:48.760164 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
LOAD json;
[0m22:41:48.764556 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m22:41:48.770866 [info ] [MainThread]: 4 of 10 OK hook: stock_dbt_project.on-run-start.3 .............................. [[32mOK[0m in 0.03s]
[0m22:41:48.782260 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-4"
[0m22:41:48.791372 [info ] [MainThread]: 5 of 10 START hook: stock_dbt_project.on-run-start.4 ........................... [RUN]
[0m22:41:48.796992 [debug] [MainThread]: Using duckdb connection "master"
[0m22:41:48.801206 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
SET s3_endpoint='http://localhost:9000';
[0m22:41:48.807474 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m22:41:48.814291 [info ] [MainThread]: 5 of 10 OK hook: stock_dbt_project.on-run-start.4 .............................. [[32mOK[0m in 0.04s]
[0m22:41:48.833348 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-5"
[0m22:41:48.840531 [info ] [MainThread]: 6 of 10 START hook: stock_dbt_project.on-run-start.5 ........................... [RUN]
[0m22:41:48.846465 [debug] [MainThread]: Using duckdb connection "master"
[0m22:41:48.850287 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
SET s3_access_key_id='minioadmin';
[0m22:41:48.853299 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m22:41:48.863537 [info ] [MainThread]: 6 of 10 OK hook: stock_dbt_project.on-run-start.5 .............................. [[32mOK[0m in 0.04s]
[0m22:41:48.874312 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-6"
[0m22:41:48.879565 [info ] [MainThread]: 7 of 10 START hook: stock_dbt_project.on-run-start.6 ........................... [RUN]
[0m22:41:48.886748 [debug] [MainThread]: Using duckdb connection "master"
[0m22:41:48.890075 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
SET s3_secret_access_key='minioadmin';
[0m22:41:48.890767 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m22:41:48.899248 [info ] [MainThread]: 7 of 10 OK hook: stock_dbt_project.on-run-start.6 .............................. [[32mOK[0m in 0.03s]
[0m22:41:48.909667 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-7"
[0m22:41:48.914404 [info ] [MainThread]: 8 of 10 START hook: stock_dbt_project.on-run-start.7 ........................... [RUN]
[0m22:41:48.918048 [debug] [MainThread]: Using duckdb connection "master"
[0m22:41:48.918048 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
SET s3_region='us-east-1';
[0m22:41:48.925301 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m22:41:48.932100 [info ] [MainThread]: 8 of 10 OK hook: stock_dbt_project.on-run-start.7 .............................. [[32mOK[0m in 0.03s]
[0m22:41:48.944103 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-8"
[0m22:41:48.949810 [info ] [MainThread]: 9 of 10 START hook: stock_dbt_project.on-run-start.8 ........................... [RUN]
[0m22:41:48.953801 [debug] [MainThread]: Using duckdb connection "master"
[0m22:41:48.957689 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
SET s3_use_ssl=false;
[0m22:41:48.961709 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m22:41:48.966123 [info ] [MainThread]: 9 of 10 OK hook: stock_dbt_project.on-run-start.8 .............................. [[32mOK[0m in 0.03s]
[0m22:41:48.978117 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-9"
[0m22:41:48.982287 [info ] [MainThread]: 10 of 10 START hook: stock_dbt_project.on-run-start.9 .......................... [RUN]
[0m22:41:48.986388 [debug] [MainThread]: Using duckdb connection "master"
[0m22:41:48.988410 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
SET s3_url_style='path';
[0m22:41:48.993521 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m22:41:48.998755 [info ] [MainThread]: 10 of 10 OK hook: stock_dbt_project.on-run-start.9 ............................. [[32mOK[0m in 0.03s]
[0m22:41:49.001567 [info ] [MainThread]: 
[0m22:41:49.003893 [debug] [MainThread]: On master: Close
[0m22:41:49.017981 [debug] [Thread-1 (]: Began running node model.stock_dbt_project.stg_stock_data
[0m22:41:49.019498 [info ] [Thread-1 (]: 1 of 1 START sql view model main.stg_stock_data ................................ [RUN]
[0m22:41:49.023320 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.stock_dbt_project.stg_stock_data'
[0m22:41:49.025915 [debug] [Thread-1 (]: Began compiling node model.stock_dbt_project.stg_stock_data
[0m22:41:49.032363 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_dbt_project.stg_stock_data"
[0m22:41:49.033374 [debug] [Thread-1 (]: Began executing node model.stock_dbt_project.stg_stock_data
[0m22:41:49.105799 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_dbt_project.stg_stock_data"
[0m22:41:49.109183 [debug] [Thread-1 (]: Using duckdb connection "model.stock_dbt_project.stg_stock_data"
[0m22:41:49.110205 [debug] [Thread-1 (]: On model.stock_dbt_project.stg_stock_data: BEGIN
[0m22:41:49.111196 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:41:49.113203 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m22:41:49.114720 [debug] [Thread-1 (]: Using duckdb connection "model.stock_dbt_project.stg_stock_data"
[0m22:41:49.115073 [debug] [Thread-1 (]: On model.stock_dbt_project.stg_stock_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "node_id": "model.stock_dbt_project.stg_stock_data"} */

  
  create view "dev"."main"."stg_stock_data__dbt_tmp" as (
    



WITH raw AS (
    SELECT *
    FROM read_json_auto('s3://my-stock-data-bucket/stocks/*/*/*/*/*.json')
)

SELECT
    CAST(symbol AS TEXT) AS symbol,
    CAST(datetime AS TIMESTAMP) AS datetime,
    CAST(open AS DOUBLE) AS open,
    CAST(high AS DOUBLE) AS high,
    CAST(low AS DOUBLE) AS low, 
    CAST(close AS DOUBLE) AS close,
    CAST(volume AS BIGINT) AS volume
FROM raw
WHERE symbol IS NOT NULL AND datetime IS NOT NULL
  );

[0m22:41:49.471653 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "node_id": "model.stock_dbt_project.stg_stock_data"} */

  
  create view "dev"."main"."stg_stock_data__dbt_tmp" as (
    



WITH raw AS (
    SELECT *
    FROM read_json_auto('s3://my-stock-data-bucket/stocks/*/*/*/*/*.json')
)

SELECT
    CAST(symbol AS TEXT) AS symbol,
    CAST(datetime AS TIMESTAMP) AS datetime,
    CAST(open AS DOUBLE) AS open,
    CAST(high AS DOUBLE) AS high,
    CAST(low AS DOUBLE) AS low, 
    CAST(close AS DOUBLE) AS close,
    CAST(volume AS BIGINT) AS volume
FROM raw
WHERE symbol IS NOT NULL AND datetime IS NOT NULL
  );

[0m22:41:49.473630 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m22:41:49.474913 [debug] [Thread-1 (]: On model.stock_dbt_project.stg_stock_data: ROLLBACK
[0m22:41:49.490728 [debug] [Thread-1 (]: Failed to rollback 'model.stock_dbt_project.stg_stock_data'
[0m22:41:49.493757 [debug] [Thread-1 (]: On model.stock_dbt_project.stg_stock_data: Close
[0m22:41:49.501208 [debug] [Thread-1 (]: Runtime Error in model stg_stock_data (models\staging\stg_stock_data.sql)
  HTTP Error: HTTP GET error on '/?encoding-type=url&list-type=2&prefix=stocks%2F' (HTTP 400)
[0m22:41:49.509976 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2b6a7aea-a461-497d-a2da-6e9dea34a30b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E93389A2A0>]}
[0m22:41:49.514139 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model main.stg_stock_data ....................... [[31mERROR[0m in 0.48s]
[0m22:41:49.516377 [debug] [Thread-1 (]: Finished running node model.stock_dbt_project.stg_stock_data
[0m22:41:49.517534 [debug] [Thread-4 (]: Marking all children of 'model.stock_dbt_project.stg_stock_data' to be skipped because of status 'error'.  Reason: Runtime Error in model stg_stock_data (models\staging\stg_stock_data.sql)
  HTTP Error: HTTP GET error on '/?encoding-type=url&list-type=2&prefix=stocks%2F' (HTTP 400).
[0m22:41:49.519363 [debug] [MainThread]: Using duckdb connection "master"
[0m22:41:49.524714 [debug] [MainThread]: On master: BEGIN
[0m22:41:49.526725 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:41:49.528726 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m22:41:49.529945 [debug] [MainThread]: On master: COMMIT
[0m22:41:49.530016 [debug] [MainThread]: Using duckdb connection "master"
[0m22:41:49.531332 [debug] [MainThread]: On master: COMMIT
[0m22:41:49.532465 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m22:41:49.533483 [debug] [MainThread]: On master: Close
[0m22:41:49.534474 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:41:49.535472 [debug] [MainThread]: Connection 'create_dev_main' was properly closed.
[0m22:41:49.536473 [debug] [MainThread]: Connection 'list_dev_main' was properly closed.
[0m22:41:49.537543 [debug] [MainThread]: Connection 'model.stock_dbt_project.stg_stock_data' was properly closed.
[0m22:41:49.537543 [info ] [MainThread]: 
[0m22:41:49.541036 [info ] [MainThread]: Finished running 10 project hooks, 1 view model in 0 hours 0 minutes and 1.71 seconds (1.71s).
[0m22:41:49.546845 [debug] [MainThread]: Command end result
[0m22:41:49.593872 [debug] [MainThread]: Wrote artifact WritableManifest to D:\Stock_price\stock_dbt_project\target\manifest.json
[0m22:41:49.599219 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\Stock_price\stock_dbt_project\target\semantic_manifest.json
[0m22:41:49.611780 [debug] [MainThread]: Wrote artifact RunExecutionResult to D:\Stock_price\stock_dbt_project\target\run_results.json
[0m22:41:49.612779 [info ] [MainThread]: 
[0m22:41:49.614093 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m22:41:49.614591 [info ] [MainThread]: 
[0m22:41:49.614591 [error] [MainThread]:   Runtime Error in model stg_stock_data (models\staging\stg_stock_data.sql)
  HTTP Error: HTTP GET error on '/?encoding-type=url&list-type=2&prefix=stocks%2F' (HTTP 400)
[0m22:41:49.614591 [info ] [MainThread]: 
[0m22:41:49.614591 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=1 SKIP=0 TOTAL=11
[0m22:41:49.620598 [debug] [MainThread]: Command `dbt run` failed at 22:41:49.620598 after 5.24 seconds
[0m22:41:49.622613 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E9336739E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E933B8D9D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E933B8D5E0>]}
[0m22:41:49.624213 [debug] [MainThread]: Flushing usage events
[0m22:41:50.291354 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:44:46.460747 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014B6972FF20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014B6C019A60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014B6B5B12B0>]}


============================== 22:44:46.479828 | 0ec02c20-bb01-424c-8835-3236b26f2b38 ==============================
[0m22:44:46.479828 [info ] [MainThread]: Running with dbt=1.9.4
[0m22:44:46.484703 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\loges\\.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'D:\\Stock_price\\stock_dbt_project\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt debug', 'send_anonymous_usage_stats': 'True'}
[0m22:44:46.600242 [info ] [MainThread]: dbt version: 1.9.4
[0m22:44:46.603383 [info ] [MainThread]: python version: 3.12.3
[0m22:44:46.608842 [info ] [MainThread]: python path: C:\Users\loges\.virtualenvs\Stock_price-P2gocZed\Scripts\python.exe
[0m22:44:46.612302 [info ] [MainThread]: os info: Windows-11-10.0.22631-SP0
[0m22:44:47.069573 [info ] [MainThread]: Using profiles dir at C:\Users\loges\.dbt
[0m22:44:47.072610 [info ] [MainThread]: Using profiles.yml file at C:\Users\loges\.dbt\profiles.yml
[0m22:44:47.074508 [info ] [MainThread]: Using dbt_project.yml file at D:\Stock_price\stock_dbt_project\dbt_project.yml
[0m22:44:47.092964 [info ] [MainThread]: adapter type: duckdb
[0m22:44:47.097234 [info ] [MainThread]: adapter version: 1.9.2
[0m22:44:47.555986 [info ] [MainThread]: Configuration:
[0m22:44:47.558179 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m22:44:47.558179 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m22:44:47.563302 [info ] [MainThread]: Required dependencies:
[0m22:44:47.565663 [debug] [MainThread]: Executing "git --help"
[0m22:44:47.638464 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m22:44:47.641774 [debug] [MainThread]: STDERR: "b''"
[0m22:44:47.644077 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m22:44:47.646720 [info ] [MainThread]: Connection:
[0m22:44:47.649073 [info ] [MainThread]:   database: dev
[0m22:44:47.650204 [info ] [MainThread]:   schema: main
[0m22:44:47.652409 [info ] [MainThread]:   path: dev.duckdb
[0m22:44:47.654494 [info ] [MainThread]:   config_options: None
[0m22:44:47.655741 [info ] [MainThread]:   extensions: None
[0m22:44:47.657140 [info ] [MainThread]:   settings: {}
[0m22:44:47.658442 [info ] [MainThread]:   external_root: .
[0m22:44:47.660904 [info ] [MainThread]:   use_credential_provider: None
[0m22:44:47.662543 [info ] [MainThread]:   attach: None
[0m22:44:47.664563 [info ] [MainThread]:   filesystems: None
[0m22:44:47.665566 [info ] [MainThread]:   remote: None
[0m22:44:47.667084 [info ] [MainThread]:   plugins: None
[0m22:44:47.668170 [info ] [MainThread]:   disable_transactions: False
[0m22:44:47.670949 [info ] [MainThread]: Registered adapter: duckdb=1.9.2
[0m22:44:48.298518 [debug] [MainThread]: Acquiring new duckdb connection 'debug'
[0m22:44:48.485195 [debug] [MainThread]: Using duckdb connection "debug"
[0m22:44:48.486839 [debug] [MainThread]: On debug: select 1 as id
[0m22:44:48.486839 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:44:48.516016 [debug] [MainThread]: SQL status: OK in 0.028 seconds
[0m22:44:48.518278 [debug] [MainThread]: On debug: Close
[0m22:44:48.519289 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m22:44:48.520837 [info ] [MainThread]: [32mAll checks passed![0m
[0m22:44:48.520837 [debug] [MainThread]: Command `dbt debug` succeeded at 22:44:48.520837 after 2.73 seconds
[0m22:44:48.520837 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m22:44:48.520837 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014B6DD85850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014B6CAD4560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014B6BF6A840>]}
[0m22:44:48.527935 [debug] [MainThread]: Flushing usage events
[0m22:44:49.116554 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:48:06.483527 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000194BCB0E9F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000194BC768770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000194BBCAAF00>]}


============================== 22:48:06.488720 | 64ea96ac-8ab1-4e2c-83ba-a8b7fb7c9be5 ==============================
[0m22:48:06.488720 [info ] [MainThread]: Running with dbt=1.9.4
[0m22:48:06.488720 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'D:\\Stock_price\\stock_dbt_project\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\loges\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt debug', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:48:06.545701 [info ] [MainThread]: dbt version: 1.9.4
[0m22:48:06.546689 [info ] [MainThread]: python version: 3.12.3
[0m22:48:06.548692 [info ] [MainThread]: python path: C:\Users\loges\.virtualenvs\Stock_price-P2gocZed\Scripts\python.exe
[0m22:48:06.548692 [info ] [MainThread]: os info: Windows-11-10.0.22631-SP0
[0m22:48:06.836988 [info ] [MainThread]: Using profiles dir at C:\Users\loges\.dbt
[0m22:48:06.839748 [info ] [MainThread]: Using profiles.yml file at C:\Users\loges\.dbt\profiles.yml
[0m22:48:06.841597 [info ] [MainThread]: Using dbt_project.yml file at D:\Stock_price\stock_dbt_project\dbt_project.yml
[0m22:48:06.851976 [info ] [MainThread]: adapter type: duckdb
[0m22:48:06.853080 [info ] [MainThread]: adapter version: 1.9.2
[0m22:48:07.071452 [info ] [MainThread]: Configuration:
[0m22:48:07.072480 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m22:48:07.075762 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m22:48:07.078590 [info ] [MainThread]: Required dependencies:
[0m22:48:07.081452 [debug] [MainThread]: Executing "git --help"
[0m22:48:07.201439 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m22:48:07.204607 [debug] [MainThread]: STDERR: "b''"
[0m22:48:07.207457 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m22:48:07.210286 [info ] [MainThread]: Connection:
[0m22:48:07.213856 [info ] [MainThread]:   database: dev
[0m22:48:07.216932 [info ] [MainThread]:   schema: main
[0m22:48:07.220359 [info ] [MainThread]:   path: D:/Stock_price/stock_dbt_project/dev.duckdb
[0m22:48:07.222425 [info ] [MainThread]:   config_options: None
[0m22:48:07.223510 [info ] [MainThread]:   extensions: ['httpfs', 'json']
[0m22:48:07.228079 [info ] [MainThread]:   settings: {}
[0m22:48:07.233539 [info ] [MainThread]:   external_root: .
[0m22:48:07.235544 [info ] [MainThread]:   use_credential_provider: None
[0m22:48:07.238123 [info ] [MainThread]:   attach: None
[0m22:48:07.239714 [info ] [MainThread]:   filesystems: None
[0m22:48:07.246079 [info ] [MainThread]:   remote: None
[0m22:48:07.250358 [info ] [MainThread]:   plugins: None
[0m22:48:07.255809 [info ] [MainThread]:   disable_transactions: False
[0m22:48:07.259956 [info ] [MainThread]: Registered adapter: duckdb=1.9.2
[0m22:48:07.872748 [debug] [MainThread]: Acquiring new duckdb connection 'debug'
[0m22:48:07.987289 [debug] [MainThread]: Using duckdb connection "debug"
[0m22:48:07.987289 [debug] [MainThread]: On debug: select 1 as id
[0m22:48:07.995520 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:48:08.371848 [debug] [MainThread]: SQL status: OK in 0.377 seconds
[0m22:48:08.376091 [debug] [MainThread]: On debug: Close
[0m22:48:08.379111 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m22:48:08.380612 [info ] [MainThread]: [32mAll checks passed![0m
[0m22:48:08.382683 [debug] [MainThread]: Command `dbt debug` succeeded at 22:48:08.382683 after 2.20 seconds
[0m22:48:08.382683 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m22:48:08.382683 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000194BCD56D20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000194BCD86840>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000194BC919430>]}
[0m22:48:08.382683 [debug] [MainThread]: Flushing usage events
[0m22:48:08.980342 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:48:39.218894 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BFB4127AA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BFB350D070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BFB41251F0>]}


============================== 22:48:39.237304 | 6f5b57fb-5a79-4e01-8d3a-523a465c98e8 ==============================
[0m22:48:39.237304 [info ] [MainThread]: Running with dbt=1.9.4
[0m22:48:39.240837 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\loges\\.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'D:\\Stock_price\\stock_dbt_project\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run --select stg_stock_data', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:48:40.429449 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6f5b57fb-5a79-4e01-8d3a-523a465c98e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BFB397E780>]}
[0m22:48:40.975582 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6f5b57fb-5a79-4e01-8d3a-523a465c98e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BFB4519190>]}
[0m22:48:40.997889 [info ] [MainThread]: Registered adapter: duckdb=1.9.2
[0m22:48:42.074509 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m22:48:42.621621 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m22:48:42.625103 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '6f5b57fb-5a79-4e01-8d3a-523a465c98e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BFB3FD2330>]}
[0m22:48:46.927933 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.stock_dbt_project.marts
[0m22:48:46.947346 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6f5b57fb-5a79-4e01-8d3a-523a465c98e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BFB5B90320>]}
[0m22:48:47.445868 [debug] [MainThread]: Wrote artifact WritableManifest to D:\Stock_price\stock_dbt_project\target\manifest.json
[0m22:48:47.455534 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\Stock_price\stock_dbt_project\target\semantic_manifest.json
[0m22:48:47.655445 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6f5b57fb-5a79-4e01-8d3a-523a465c98e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BFB5B39FA0>]}
[0m22:48:47.660268 [info ] [MainThread]: Found 5 models, 10 operations, 4 data tests, 426 macros
[0m22:48:47.664151 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6f5b57fb-5a79-4e01-8d3a-523a465c98e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BFB12CACC0>]}
[0m22:48:47.673463 [info ] [MainThread]: 
[0m22:48:47.678357 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:48:47.681186 [info ] [MainThread]: 
[0m22:48:47.686916 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m22:48:47.695499 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m22:48:48.036711 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m22:48:48.036711 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m22:48:48.038785 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:48:48.556349 [debug] [ThreadPool]: SQL status: OK in 0.517 seconds
[0m22:48:48.560337 [debug] [ThreadPool]: On list_dev: Close
[0m22:48:48.561340 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m22:48:48.563339 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m22:48:48.585290 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m22:48:48.586454 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "create_dev_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m22:48:48.586454 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:48:48.591787 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m22:48:48.600219 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m22:48:48.602221 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m22:48:48.604920 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m22:48:48.606265 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m22:48:48.606265 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "create_dev_main"} */

    
    
        create schema if not exists "dev"."main"
    
[0m22:48:48.606265 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m22:48:48.614561 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m22:48:48.615573 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m22:48:48.617921 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m22:48:48.620001 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m22:48:48.620001 [debug] [ThreadPool]: On create_dev_main: Close
[0m22:48:48.633250 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev_main'
[0m22:48:48.635807 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m22:48:48.647560 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m22:48:48.648922 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:48:48.651053 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m22:48:48.653625 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m22:48:48.655438 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m22:48:48.751639 [debug] [ThreadPool]: SQL status: OK in 0.097 seconds
[0m22:48:48.759086 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m22:48:48.766749 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m22:48:48.768904 [debug] [ThreadPool]: On list_dev_main: Close
[0m22:48:48.772589 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6f5b57fb-5a79-4e01-8d3a-523a465c98e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BFB44377D0>]}
[0m22:48:48.772589 [debug] [MainThread]: Using duckdb connection "master"
[0m22:48:48.779149 [debug] [MainThread]: On master: BEGIN
[0m22:48:48.781169 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:48:48.785252 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m22:48:48.786469 [debug] [MainThread]: On master: COMMIT
[0m22:48:48.790240 [debug] [MainThread]: Using duckdb connection "master"
[0m22:48:48.790240 [debug] [MainThread]: On master: COMMIT
[0m22:48:48.792899 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m22:48:48.832659 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-0"
[0m22:48:48.854714 [info ] [MainThread]: 1 of 10 START hook: stock_dbt_project.on-run-start.0 ........................... [RUN]
[0m22:48:48.856229 [debug] [MainThread]: Using duckdb connection "master"
[0m22:48:48.861918 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
INSTALL httpfs;
[0m22:48:48.868284 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m22:48:48.872465 [info ] [MainThread]: 1 of 10 OK hook: stock_dbt_project.on-run-start.0 .............................. [[32mOK[0m in 0.08s]
[0m22:48:48.878873 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-1"
[0m22:48:48.882147 [info ] [MainThread]: 2 of 10 START hook: stock_dbt_project.on-run-start.1 ........................... [RUN]
[0m22:48:48.884150 [debug] [MainThread]: Using duckdb connection "master"
[0m22:48:48.886156 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
INSTALL json;
[0m22:48:48.888466 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m22:48:48.890457 [info ] [MainThread]: 2 of 10 OK hook: stock_dbt_project.on-run-start.1 .............................. [[32mOK[0m in 0.02s]
[0m22:48:48.896415 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-2"
[0m22:48:48.901435 [info ] [MainThread]: 3 of 10 START hook: stock_dbt_project.on-run-start.2 ........................... [RUN]
[0m22:48:48.904421 [debug] [MainThread]: Using duckdb connection "master"
[0m22:48:48.906424 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
LOAD httpfs;
[0m22:48:48.908947 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m22:48:48.913958 [info ] [MainThread]: 3 of 10 OK hook: stock_dbt_project.on-run-start.2 .............................. [[32mOK[0m in 0.02s]
[0m22:48:48.921940 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-3"
[0m22:48:48.925153 [info ] [MainThread]: 4 of 10 START hook: stock_dbt_project.on-run-start.3 ........................... [RUN]
[0m22:48:48.928689 [debug] [MainThread]: Using duckdb connection "master"
[0m22:48:48.930694 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
LOAD json;
[0m22:48:48.933487 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m22:48:48.937570 [info ] [MainThread]: 4 of 10 OK hook: stock_dbt_project.on-run-start.3 .............................. [[32mOK[0m in 0.02s]
[0m22:48:48.943470 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-4"
[0m22:48:48.946516 [info ] [MainThread]: 5 of 10 START hook: stock_dbt_project.on-run-start.4 ........................... [RUN]
[0m22:48:48.949088 [debug] [MainThread]: Using duckdb connection "master"
[0m22:48:48.950423 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
SET s3_endpoint='http://localhost:9000';
[0m22:48:48.951941 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m22:48:48.954937 [info ] [MainThread]: 5 of 10 OK hook: stock_dbt_project.on-run-start.4 .............................. [[32mOK[0m in 0.02s]
[0m22:48:48.963074 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-5"
[0m22:48:48.965328 [info ] [MainThread]: 6 of 10 START hook: stock_dbt_project.on-run-start.5 ........................... [RUN]
[0m22:48:48.967866 [debug] [MainThread]: Using duckdb connection "master"
[0m22:48:48.969640 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
SET s3_access_key_id='minioadmin';
[0m22:48:48.971361 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m22:48:48.973591 [info ] [MainThread]: 6 of 10 OK hook: stock_dbt_project.on-run-start.5 .............................. [[32mOK[0m in 0.02s]
[0m22:48:48.983156 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-6"
[0m22:48:48.986062 [info ] [MainThread]: 7 of 10 START hook: stock_dbt_project.on-run-start.6 ........................... [RUN]
[0m22:48:48.989486 [debug] [MainThread]: Using duckdb connection "master"
[0m22:48:48.991261 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
SET s3_secret_access_key='minioadmin';
[0m22:48:48.994129 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m22:48:48.997132 [info ] [MainThread]: 7 of 10 OK hook: stock_dbt_project.on-run-start.6 .............................. [[32mOK[0m in 0.02s]
[0m22:48:49.004300 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-7"
[0m22:48:49.005370 [info ] [MainThread]: 8 of 10 START hook: stock_dbt_project.on-run-start.7 ........................... [RUN]
[0m22:48:49.005370 [debug] [MainThread]: Using duckdb connection "master"
[0m22:48:49.005370 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
SET s3_region='us-east-1';
[0m22:48:49.013252 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m22:48:49.016225 [info ] [MainThread]: 8 of 10 OK hook: stock_dbt_project.on-run-start.7 .............................. [[32mOK[0m in 0.02s]
[0m22:48:49.022399 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-8"
[0m22:48:49.027440 [info ] [MainThread]: 9 of 10 START hook: stock_dbt_project.on-run-start.8 ........................... [RUN]
[0m22:48:49.031215 [debug] [MainThread]: Using duckdb connection "master"
[0m22:48:49.033019 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
SET s3_use_ssl=false;
[0m22:48:49.035708 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m22:48:49.039214 [info ] [MainThread]: 9 of 10 OK hook: stock_dbt_project.on-run-start.8 .............................. [[32mOK[0m in 0.02s]
[0m22:48:49.049105 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-9"
[0m22:48:49.053126 [info ] [MainThread]: 10 of 10 START hook: stock_dbt_project.on-run-start.9 .......................... [RUN]
[0m22:48:49.056527 [debug] [MainThread]: Using duckdb connection "master"
[0m22:48:49.058603 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
SET s3_url_style='path';
[0m22:48:49.062225 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m22:48:49.070610 [info ] [MainThread]: 10 of 10 OK hook: stock_dbt_project.on-run-start.9 ............................. [[32mOK[0m in 0.03s]
[0m22:48:49.072479 [info ] [MainThread]: 
[0m22:48:49.074463 [debug] [MainThread]: On master: Close
[0m22:48:49.087982 [debug] [Thread-1 (]: Began running node model.stock_dbt_project.stg_stock_data
[0m22:48:49.093074 [info ] [Thread-1 (]: 1 of 1 START sql view model main.stg_stock_data ................................ [RUN]
[0m22:48:49.100005 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.stock_dbt_project.stg_stock_data'
[0m22:48:49.102525 [debug] [Thread-1 (]: Began compiling node model.stock_dbt_project.stg_stock_data
[0m22:48:49.113797 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_dbt_project.stg_stock_data"
[0m22:48:49.116797 [debug] [Thread-1 (]: Began executing node model.stock_dbt_project.stg_stock_data
[0m22:48:49.233533 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_dbt_project.stg_stock_data"
[0m22:48:49.236306 [debug] [Thread-1 (]: Using duckdb connection "model.stock_dbt_project.stg_stock_data"
[0m22:48:49.236306 [debug] [Thread-1 (]: On model.stock_dbt_project.stg_stock_data: BEGIN
[0m22:48:49.239824 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:48:49.239824 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m22:48:49.246180 [debug] [Thread-1 (]: Using duckdb connection "model.stock_dbt_project.stg_stock_data"
[0m22:48:49.248249 [debug] [Thread-1 (]: On model.stock_dbt_project.stg_stock_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "node_id": "model.stock_dbt_project.stg_stock_data"} */

  
  create view "dev"."main"."stg_stock_data__dbt_tmp" as (
    



WITH raw AS (
    SELECT *
    FROM read_json_auto('s3://my-stock-data-bucket/stocks/*/*/*/*/*.json')
)

SELECT
    CAST(symbol AS TEXT) AS symbol,
    CAST(datetime AS TIMESTAMP) AS datetime,
    CAST(open AS DOUBLE) AS open,
    CAST(high AS DOUBLE) AS high,
    CAST(low AS DOUBLE) AS low, 
    CAST(close AS DOUBLE) AS close,
    CAST(volume AS BIGINT) AS volume
FROM raw
WHERE symbol IS NOT NULL AND datetime IS NOT NULL
  );

[0m22:48:49.594257 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "node_id": "model.stock_dbt_project.stg_stock_data"} */

  
  create view "dev"."main"."stg_stock_data__dbt_tmp" as (
    



WITH raw AS (
    SELECT *
    FROM read_json_auto('s3://my-stock-data-bucket/stocks/*/*/*/*/*.json')
)

SELECT
    CAST(symbol AS TEXT) AS symbol,
    CAST(datetime AS TIMESTAMP) AS datetime,
    CAST(open AS DOUBLE) AS open,
    CAST(high AS DOUBLE) AS high,
    CAST(low AS DOUBLE) AS low, 
    CAST(close AS DOUBLE) AS close,
    CAST(volume AS BIGINT) AS volume
FROM raw
WHERE symbol IS NOT NULL AND datetime IS NOT NULL
  );

[0m22:48:49.598217 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m22:48:49.601889 [debug] [Thread-1 (]: On model.stock_dbt_project.stg_stock_data: ROLLBACK
[0m22:48:49.628623 [debug] [Thread-1 (]: Failed to rollback 'model.stock_dbt_project.stg_stock_data'
[0m22:48:49.634603 [debug] [Thread-1 (]: On model.stock_dbt_project.stg_stock_data: Close
[0m22:48:49.647009 [debug] [Thread-1 (]: Runtime Error in model stg_stock_data (models\staging\stg_stock_data.sql)
  HTTP Error: HTTP GET error on '/?encoding-type=url&list-type=2&prefix=stocks%2F' (HTTP 400)
[0m22:48:49.659882 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6f5b57fb-5a79-4e01-8d3a-523a465c98e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BFB631B320>]}
[0m22:48:49.663582 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model main.stg_stock_data ....................... [[31mERROR[0m in 0.55s]
[0m22:48:49.669043 [debug] [Thread-1 (]: Finished running node model.stock_dbt_project.stg_stock_data
[0m22:48:49.672683 [debug] [Thread-4 (]: Marking all children of 'model.stock_dbt_project.stg_stock_data' to be skipped because of status 'error'.  Reason: Runtime Error in model stg_stock_data (models\staging\stg_stock_data.sql)
  HTTP Error: HTTP GET error on '/?encoding-type=url&list-type=2&prefix=stocks%2F' (HTTP 400).
[0m22:48:49.680699 [debug] [MainThread]: Using duckdb connection "master"
[0m22:48:49.684111 [debug] [MainThread]: On master: BEGIN
[0m22:48:49.685668 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:48:49.689110 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m22:48:49.692651 [debug] [MainThread]: On master: COMMIT
[0m22:48:49.697780 [debug] [MainThread]: Using duckdb connection "master"
[0m22:48:49.700406 [debug] [MainThread]: On master: COMMIT
[0m22:48:49.703525 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m22:48:49.705551 [debug] [MainThread]: On master: Close
[0m22:48:49.705551 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:48:49.709632 [debug] [MainThread]: Connection 'create_dev_main' was properly closed.
[0m22:48:49.713610 [debug] [MainThread]: Connection 'list_dev_main' was properly closed.
[0m22:48:49.716327 [debug] [MainThread]: Connection 'model.stock_dbt_project.stg_stock_data' was properly closed.
[0m22:48:49.718446 [info ] [MainThread]: 
[0m22:48:49.721869 [info ] [MainThread]: Finished running 10 project hooks, 1 view model in 0 hours 0 minutes and 2.03 seconds (2.03s).
[0m22:48:49.740481 [debug] [MainThread]: Command end result
[0m22:48:49.892258 [debug] [MainThread]: Wrote artifact WritableManifest to D:\Stock_price\stock_dbt_project\target\manifest.json
[0m22:48:49.906004 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\Stock_price\stock_dbt_project\target\semantic_manifest.json
[0m22:48:49.952904 [debug] [MainThread]: Wrote artifact RunExecutionResult to D:\Stock_price\stock_dbt_project\target\run_results.json
[0m22:48:49.955217 [info ] [MainThread]: 
[0m22:48:49.959087 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m22:48:49.963480 [info ] [MainThread]: 
[0m22:48:49.968314 [error] [MainThread]:   Runtime Error in model stg_stock_data (models\staging\stg_stock_data.sql)
  HTTP Error: HTTP GET error on '/?encoding-type=url&list-type=2&prefix=stocks%2F' (HTTP 400)
[0m22:48:49.972522 [info ] [MainThread]: 
[0m22:48:49.977192 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=1 SKIP=0 TOTAL=11
[0m22:48:49.987407 [debug] [MainThread]: Command `dbt run` failed at 22:48:49.986390 after 11.24 seconds
[0m22:48:49.990699 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BFB4483CB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BFADC39610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BFB56E11C0>]}
[0m22:48:49.996034 [debug] [MainThread]: Flushing usage events
[0m22:48:50.656022 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:49:18.020857 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021E009D35C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021E00340770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021E7FE93980>]}


============================== 22:49:18.036217 | 1387f664-9e4d-43ff-a81a-5b435e89d72c ==============================
[0m22:49:18.036217 [info ] [MainThread]: Running with dbt=1.9.4
[0m22:49:18.037238 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\loges\\.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'D:\\Stock_price\\stock_dbt_project\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt clean', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:49:18.359210 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1387f664-9e4d-43ff-a81a-5b435e89d72c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021E00CFC350>]}
[0m22:49:18.434224 [debug] [MainThread]: Command `dbt clean` succeeded at 22:49:18.434224 after 0.85 seconds
[0m22:49:18.437211 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021E007B7140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021E007B7200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021E007B7F20>]}
[0m22:49:18.438834 [debug] [MainThread]: Flushing usage events
[0m22:49:19.064842 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:49:35.536147 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E5CBF13E60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E5CEC1F560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E5CEC1C7A0>]}


============================== 22:49:35.545748 | 81352ea0-9a44-48fd-80ab-fa4bf1cf62d5 ==============================
[0m22:49:35.545748 [info ] [MainThread]: Running with dbt=1.9.4
[0m22:49:35.549528 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\loges\\.dbt', 'log_path': 'D:\\Stock_price\\stock_dbt_project\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt debug', 'send_anonymous_usage_stats': 'True'}
[0m22:49:35.585128 [info ] [MainThread]: dbt version: 1.9.4
[0m22:49:35.585128 [info ] [MainThread]: python version: 3.12.3
[0m22:49:35.585128 [info ] [MainThread]: python path: C:\Users\loges\.virtualenvs\Stock_price-P2gocZed\Scripts\python.exe
[0m22:49:35.585128 [info ] [MainThread]: os info: Windows-11-10.0.22631-SP0
[0m22:49:35.731421 [info ] [MainThread]: Using profiles dir at C:\Users\loges\.dbt
[0m22:49:35.733006 [info ] [MainThread]: Using profiles.yml file at C:\Users\loges\.dbt\profiles.yml
[0m22:49:35.734015 [info ] [MainThread]: Using dbt_project.yml file at D:\Stock_price\stock_dbt_project\dbt_project.yml
[0m22:49:35.736754 [info ] [MainThread]: adapter type: duckdb
[0m22:49:35.736754 [info ] [MainThread]: adapter version: 1.9.2
[0m22:49:35.932840 [info ] [MainThread]: Configuration:
[0m22:49:35.933858 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m22:49:35.935851 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m22:49:35.937134 [info ] [MainThread]: Required dependencies:
[0m22:49:35.938134 [debug] [MainThread]: Executing "git --help"
[0m22:49:35.986529 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m22:49:35.993563 [debug] [MainThread]: STDERR: "b''"
[0m22:49:35.994582 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m22:49:35.995641 [info ] [MainThread]: Connection:
[0m22:49:35.997582 [info ] [MainThread]:   database: dev
[0m22:49:35.998750 [info ] [MainThread]:   schema: main
[0m22:49:35.999852 [info ] [MainThread]:   path: D:/Stock_price/stock_dbt_project/dev.duckdb
[0m22:49:36.000419 [info ] [MainThread]:   config_options: None
[0m22:49:36.001440 [info ] [MainThread]:   extensions: ['httpfs', 'json']
[0m22:49:36.003457 [info ] [MainThread]:   settings: {}
[0m22:49:36.004455 [info ] [MainThread]:   external_root: .
[0m22:49:36.005460 [info ] [MainThread]:   use_credential_provider: None
[0m22:49:36.006362 [info ] [MainThread]:   attach: None
[0m22:49:36.007802 [info ] [MainThread]:   filesystems: None
[0m22:49:36.008826 [info ] [MainThread]:   remote: None
[0m22:49:36.009895 [info ] [MainThread]:   plugins: None
[0m22:49:36.012270 [info ] [MainThread]:   disable_transactions: False
[0m22:49:36.013645 [info ] [MainThread]: Registered adapter: duckdb=1.9.2
[0m22:49:36.320156 [debug] [MainThread]: Acquiring new duckdb connection 'debug'
[0m22:49:36.437399 [debug] [MainThread]: Using duckdb connection "debug"
[0m22:49:36.437399 [debug] [MainThread]: On debug: select 1 as id
[0m22:49:36.437399 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:49:36.979235 [debug] [MainThread]: SQL status: OK in 0.532 seconds
[0m22:49:36.982036 [debug] [MainThread]: On debug: Close
[0m22:49:36.983120 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m22:49:36.984172 [info ] [MainThread]: [32mAll checks passed![0m
[0m22:49:36.985398 [debug] [MainThread]: Command `dbt debug` succeeded at 22:49:36.985398 after 1.85 seconds
[0m22:49:36.985398 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m22:49:36.985398 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E5CEA0ED20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E5CF365BB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E5CEC1C7A0>]}
[0m22:49:36.985398 [debug] [MainThread]: Flushing usage events
[0m22:49:37.505776 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:51:57.844581 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024CDE233D70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024CDAE663C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024CDAE645C0>]}


============================== 22:51:57.861361 | 2ce27ae1-3141-4f37-b337-cd87e47f5f60 ==============================
[0m22:51:57.861361 [info ] [MainThread]: Running with dbt=1.9.4
[0m22:51:57.868309 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'D:\\Stock_price\\stock_dbt_project\\logs', 'profiles_dir': 'C:\\Users\\loges\\.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run --select stg_stock_data', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:51:58.859694 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2ce27ae1-3141-4f37-b337-cd87e47f5f60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024CE15D87D0>]}
[0m22:51:59.230003 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2ce27ae1-3141-4f37-b337-cd87e47f5f60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024CE0D7FE30>]}
[0m22:51:59.252286 [info ] [MainThread]: Registered adapter: duckdb=1.9.2
[0m22:51:59.816256 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m22:51:59.821479 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m22:51:59.823828 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '2ce27ae1-3141-4f37-b337-cd87e47f5f60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024CE0AEDA30>]}
[0m22:52:07.427931 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.stock_dbt_project.marts
[0m22:52:07.457803 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2ce27ae1-3141-4f37-b337-cd87e47f5f60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024CE2C0D1C0>]}
[0m22:52:07.822619 [debug] [MainThread]: Wrote artifact WritableManifest to D:\Stock_price\stock_dbt_project\target\manifest.json
[0m22:52:07.830613 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\Stock_price\stock_dbt_project\target\semantic_manifest.json
[0m22:52:07.920889 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2ce27ae1-3141-4f37-b337-cd87e47f5f60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024CE2D5AD50>]}
[0m22:52:07.920889 [info ] [MainThread]: Found 5 models, 10 operations, 4 data tests, 426 macros
[0m22:52:07.925920 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2ce27ae1-3141-4f37-b337-cd87e47f5f60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024CE2BC1C70>]}
[0m22:52:07.937214 [info ] [MainThread]: 
[0m22:52:07.941359 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:52:07.945055 [info ] [MainThread]: 
[0m22:52:07.948536 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m22:52:07.954344 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m22:52:08.438818 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m22:52:08.441187 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m22:52:08.443061 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:52:08.947482 [debug] [ThreadPool]: SQL status: OK in 0.505 seconds
[0m22:52:08.950887 [debug] [ThreadPool]: On list_dev: Close
[0m22:52:08.953350 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m22:52:08.953350 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m22:52:08.969349 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m22:52:08.971675 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "create_dev_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m22:52:08.972993 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:52:08.974207 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m22:52:08.974207 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m22:52:08.981123 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m22:52:08.982139 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m22:52:08.984138 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m22:52:08.984138 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "create_dev_main"} */

    
    
        create schema if not exists "dev"."main"
    
[0m22:52:08.985297 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m22:52:08.987343 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m22:52:08.987971 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m22:52:08.987971 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m22:52:08.990984 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m22:52:08.992047 [debug] [ThreadPool]: On create_dev_main: Close
[0m22:52:09.002015 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev_main'
[0m22:52:09.019481 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m22:52:09.020743 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m22:52:09.021756 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:52:09.022672 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m22:52:09.022672 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m22:52:09.022672 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m22:52:09.057798 [debug] [ThreadPool]: SQL status: OK in 0.036 seconds
[0m22:52:09.065523 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m22:52:09.069267 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m22:52:09.069545 [debug] [ThreadPool]: On list_dev_main: Close
[0m22:52:09.071212 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2ce27ae1-3141-4f37-b337-cd87e47f5f60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024CE2C5AEA0>]}
[0m22:52:09.071212 [debug] [MainThread]: Using duckdb connection "master"
[0m22:52:09.071212 [debug] [MainThread]: On master: BEGIN
[0m22:52:09.071212 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:52:09.071212 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m22:52:09.071212 [debug] [MainThread]: On master: COMMIT
[0m22:52:09.079334 [debug] [MainThread]: Using duckdb connection "master"
[0m22:52:09.080352 [debug] [MainThread]: On master: COMMIT
[0m22:52:09.081349 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m22:52:09.092205 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-0"
[0m22:52:09.106948 [info ] [MainThread]: 1 of 10 START hook: stock_dbt_project.on-run-start.0 ........................... [RUN]
[0m22:52:09.107948 [debug] [MainThread]: Using duckdb connection "master"
[0m22:52:09.109958 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
INSTALL httpfs;
[0m22:52:09.115562 [debug] [MainThread]: SQL status: OK in 0.005 seconds
[0m22:52:09.118639 [info ] [MainThread]: 1 of 10 OK hook: stock_dbt_project.on-run-start.0 .............................. [[32mOK[0m in 0.04s]
[0m22:52:09.123141 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-1"
[0m22:52:09.127630 [info ] [MainThread]: 2 of 10 START hook: stock_dbt_project.on-run-start.1 ........................... [RUN]
[0m22:52:09.130084 [debug] [MainThread]: Using duckdb connection "master"
[0m22:52:09.131257 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
INSTALL json;
[0m22:52:09.134272 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m22:52:09.136275 [info ] [MainThread]: 2 of 10 OK hook: stock_dbt_project.on-run-start.1 .............................. [[32mOK[0m in 0.01s]
[0m22:52:09.141274 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-2"
[0m22:52:09.143382 [info ] [MainThread]: 3 of 10 START hook: stock_dbt_project.on-run-start.2 ........................... [RUN]
[0m22:52:09.145898 [debug] [MainThread]: Using duckdb connection "master"
[0m22:52:09.148799 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
LOAD httpfs;
[0m22:52:09.150801 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m22:52:09.153083 [info ] [MainThread]: 3 of 10 OK hook: stock_dbt_project.on-run-start.2 .............................. [[32mOK[0m in 0.02s]
[0m22:52:09.156694 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-3"
[0m22:52:09.158218 [info ] [MainThread]: 4 of 10 START hook: stock_dbt_project.on-run-start.3 ........................... [RUN]
[0m22:52:09.160387 [debug] [MainThread]: Using duckdb connection "master"
[0m22:52:09.162032 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
LOAD json;
[0m22:52:09.164033 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m22:52:09.167560 [info ] [MainThread]: 4 of 10 OK hook: stock_dbt_project.on-run-start.3 .............................. [[32mOK[0m in 0.01s]
[0m22:52:09.170636 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-4"
[0m22:52:09.172170 [info ] [MainThread]: 5 of 10 START hook: stock_dbt_project.on-run-start.4 ........................... [RUN]
[0m22:52:09.172170 [debug] [MainThread]: Using duckdb connection "master"
[0m22:52:09.176898 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
SET s3_endpoint='http://localhost:9000';
[0m22:52:09.177837 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m22:52:09.183381 [info ] [MainThread]: 5 of 10 OK hook: stock_dbt_project.on-run-start.4 .............................. [[32mOK[0m in 0.01s]
[0m22:52:09.189718 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-5"
[0m22:52:09.191712 [info ] [MainThread]: 6 of 10 START hook: stock_dbt_project.on-run-start.5 ........................... [RUN]
[0m22:52:09.193918 [debug] [MainThread]: Using duckdb connection "master"
[0m22:52:09.194924 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
SET s3_access_key_id='minioadmin';
[0m22:52:09.198567 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m22:52:09.203157 [info ] [MainThread]: 6 of 10 OK hook: stock_dbt_project.on-run-start.5 .............................. [[32mOK[0m in 0.02s]
[0m22:52:09.207183 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-6"
[0m22:52:09.209244 [info ] [MainThread]: 7 of 10 START hook: stock_dbt_project.on-run-start.6 ........................... [RUN]
[0m22:52:09.212265 [debug] [MainThread]: Using duckdb connection "master"
[0m22:52:09.212265 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
SET s3_secret_access_key='minioadmin';
[0m22:52:09.216328 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m22:52:09.220041 [info ] [MainThread]: 7 of 10 OK hook: stock_dbt_project.on-run-start.6 .............................. [[32mOK[0m in 0.01s]
[0m22:52:09.223272 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-7"
[0m22:52:09.226254 [info ] [MainThread]: 8 of 10 START hook: stock_dbt_project.on-run-start.7 ........................... [RUN]
[0m22:52:09.227927 [debug] [MainThread]: Using duckdb connection "master"
[0m22:52:09.230914 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
SET s3_region='us-east-1';
[0m22:52:09.232925 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m22:52:09.234926 [info ] [MainThread]: 8 of 10 OK hook: stock_dbt_project.on-run-start.7 .............................. [[32mOK[0m in 0.01s]
[0m22:52:09.239149 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-8"
[0m22:52:09.241147 [info ] [MainThread]: 9 of 10 START hook: stock_dbt_project.on-run-start.8 ........................... [RUN]
[0m22:52:09.243149 [debug] [MainThread]: Using duckdb connection "master"
[0m22:52:09.244860 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
SET s3_use_ssl=false;
[0m22:52:09.247057 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m22:52:09.250320 [info ] [MainThread]: 9 of 10 OK hook: stock_dbt_project.on-run-start.8 .............................. [[32mOK[0m in 0.01s]
[0m22:52:09.253799 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-9"
[0m22:52:09.255796 [info ] [MainThread]: 10 of 10 START hook: stock_dbt_project.on-run-start.9 .......................... [RUN]
[0m22:52:09.256801 [debug] [MainThread]: Using duckdb connection "master"
[0m22:52:09.257865 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
SET s3_url_style='path';
[0m22:52:09.257865 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m22:52:09.263885 [info ] [MainThread]: 10 of 10 OK hook: stock_dbt_project.on-run-start.9 ............................. [[32mOK[0m in 0.01s]
[0m22:52:09.265193 [info ] [MainThread]: 
[0m22:52:09.266218 [debug] [MainThread]: On master: Close
[0m22:52:09.275541 [debug] [Thread-1 (]: Began running node model.stock_dbt_project.stg_stock_data
[0m22:52:09.278587 [info ] [Thread-1 (]: 1 of 1 START sql view model main.stg_stock_data ................................ [RUN]
[0m22:52:09.282818 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.stock_dbt_project.stg_stock_data'
[0m22:52:09.285566 [debug] [Thread-1 (]: Began compiling node model.stock_dbt_project.stg_stock_data
[0m22:52:09.297598 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_dbt_project.stg_stock_data"
[0m22:52:09.301729 [debug] [Thread-1 (]: Began executing node model.stock_dbt_project.stg_stock_data
[0m22:52:09.413731 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_dbt_project.stg_stock_data"
[0m22:52:09.418167 [debug] [Thread-1 (]: Using duckdb connection "model.stock_dbt_project.stg_stock_data"
[0m22:52:09.419966 [debug] [Thread-1 (]: On model.stock_dbt_project.stg_stock_data: BEGIN
[0m22:52:09.421984 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:52:09.421984 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m22:52:09.421984 [debug] [Thread-1 (]: Using duckdb connection "model.stock_dbt_project.stg_stock_data"
[0m22:52:09.429502 [debug] [Thread-1 (]: On model.stock_dbt_project.stg_stock_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "node_id": "model.stock_dbt_project.stg_stock_data"} */

  
  create view "dev"."main"."stg_stock_data__dbt_tmp" as (
    



WITH raw AS (
    SELECT *
    FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/*/*/*/*/*.json')
)

SELECT
    CAST(symbol AS TEXT) AS symbol,
    CAST(datetime AS TIMESTAMP) AS datetime,
    CAST(open AS DOUBLE) AS open,
    CAST(high AS DOUBLE) AS high,
    CAST(low AS DOUBLE) AS low, 
    CAST(close AS DOUBLE) AS close,
    CAST(volume AS BIGINT) AS volume
FROM raw
WHERE symbol IS NOT NULL AND datetime IS NOT NULL
  );

[0m22:52:09.453494 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "node_id": "model.stock_dbt_project.stg_stock_data"} */

  
  create view "dev"."main"."stg_stock_data__dbt_tmp" as (
    



WITH raw AS (
    SELECT *
    FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/*/*/*/*/*.json')
)

SELECT
    CAST(symbol AS TEXT) AS symbol,
    CAST(datetime AS TIMESTAMP) AS datetime,
    CAST(open AS DOUBLE) AS open,
    CAST(high AS DOUBLE) AS high,
    CAST(low AS DOUBLE) AS low, 
    CAST(close AS DOUBLE) AS close,
    CAST(volume AS BIGINT) AS volume
FROM raw
WHERE symbol IS NOT NULL AND datetime IS NOT NULL
  );

[0m22:52:09.458530 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m22:52:09.463752 [debug] [Thread-1 (]: On model.stock_dbt_project.stg_stock_data: ROLLBACK
[0m22:52:09.495468 [debug] [Thread-1 (]: Failed to rollback 'model.stock_dbt_project.stg_stock_data'
[0m22:52:09.505298 [debug] [Thread-1 (]: On model.stock_dbt_project.stg_stock_data: Close
[0m22:52:09.523419 [debug] [Thread-1 (]: Runtime Error in model stg_stock_data (models\staging\stg_stock_data.sql)
  HTTP Error: Unable to connect to URL "http://localhost:9000/my-stock-data-bucket/stocks/*/*/*/*/*.json": 404 (Not Found).
[0m22:52:09.534976 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2ce27ae1-3141-4f37-b337-cd87e47f5f60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024CE30B15B0>]}
[0m22:52:09.536098 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model main.stg_stock_data ....................... [[31mERROR[0m in 0.24s]
[0m22:52:09.541315 [debug] [Thread-1 (]: Finished running node model.stock_dbt_project.stg_stock_data
[0m22:52:09.541315 [debug] [Thread-4 (]: Marking all children of 'model.stock_dbt_project.stg_stock_data' to be skipped because of status 'error'.  Reason: Runtime Error in model stg_stock_data (models\staging\stg_stock_data.sql)
  HTTP Error: Unable to connect to URL "http://localhost:9000/my-stock-data-bucket/stocks/*/*/*/*/*.json": 404 (Not Found)..
[0m22:52:09.551077 [debug] [MainThread]: Using duckdb connection "master"
[0m22:52:09.553806 [debug] [MainThread]: On master: BEGIN
[0m22:52:09.554806 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:52:09.556996 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m22:52:09.558511 [debug] [MainThread]: On master: COMMIT
[0m22:52:09.558511 [debug] [MainThread]: Using duckdb connection "master"
[0m22:52:09.565357 [debug] [MainThread]: On master: COMMIT
[0m22:52:09.568684 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m22:52:09.570198 [debug] [MainThread]: On master: Close
[0m22:52:09.572444 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:52:09.574074 [debug] [MainThread]: Connection 'create_dev_main' was properly closed.
[0m22:52:09.574590 [debug] [MainThread]: Connection 'list_dev_main' was properly closed.
[0m22:52:09.578832 [debug] [MainThread]: Connection 'model.stock_dbt_project.stg_stock_data' was properly closed.
[0m22:52:09.581977 [info ] [MainThread]: 
[0m22:52:09.584663 [info ] [MainThread]: Finished running 10 project hooks, 1 view model in 0 hours 0 minutes and 1.63 seconds (1.63s).
[0m22:52:09.601530 [debug] [MainThread]: Command end result
[0m22:52:09.736669 [debug] [MainThread]: Wrote artifact WritableManifest to D:\Stock_price\stock_dbt_project\target\manifest.json
[0m22:52:09.747625 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\Stock_price\stock_dbt_project\target\semantic_manifest.json
[0m22:52:09.779551 [debug] [MainThread]: Wrote artifact RunExecutionResult to D:\Stock_price\stock_dbt_project\target\run_results.json
[0m22:52:09.784097 [info ] [MainThread]: 
[0m22:52:09.788524 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m22:52:09.789564 [info ] [MainThread]: 
[0m22:52:09.798215 [error] [MainThread]:   Runtime Error in model stg_stock_data (models\staging\stg_stock_data.sql)
  HTTP Error: Unable to connect to URL "http://localhost:9000/my-stock-data-bucket/stocks/*/*/*/*/*.json": 404 (Not Found).
[0m22:52:09.803491 [info ] [MainThread]: 
[0m22:52:09.806129 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=1 SKIP=0 TOTAL=11
[0m22:52:09.816251 [debug] [MainThread]: Command `dbt run` failed at 22:52:09.815227 after 12.76 seconds
[0m22:52:09.819452 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024CE0A0D580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024CDAE94410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024CE15A3E60>]}
[0m22:52:09.822565 [debug] [MainThread]: Flushing usage events
[0m22:52:10.566166 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:53:39.973894 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CA998CED20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CA9C2FFC20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CA99840E60>]}


============================== 22:53:39.990074 | 0bc8e48f-3a42-4d47-bc03-4410ed2ada8e ==============================
[0m22:53:39.990074 [info ] [MainThread]: Running with dbt=1.9.4
[0m22:53:39.991074 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\loges\\.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'D:\\Stock_price\\stock_dbt_project\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run --select stg_stock_data', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:53:40.705716 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0bc8e48f-3a42-4d47-bc03-4410ed2ada8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CA9D470B60>]}
[0m22:53:40.856181 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0bc8e48f-3a42-4d47-bc03-4410ed2ada8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CA971BA840>]}
[0m22:53:40.858294 [info ] [MainThread]: Registered adapter: duckdb=1.9.2
[0m22:53:41.163672 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m22:53:41.406301 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m22:53:41.406301 [debug] [MainThread]: Partial parsing: updated file: stock_dbt_project://models\staging\stg_stock_data.sql
[0m22:53:42.025781 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.stock_dbt_project.marts
[0m22:53:42.038357 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0bc8e48f-3a42-4d47-bc03-4410ed2ada8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CA9ECC6210>]}
[0m22:53:42.165900 [debug] [MainThread]: Wrote artifact WritableManifest to D:\Stock_price\stock_dbt_project\target\manifest.json
[0m22:53:42.169443 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\Stock_price\stock_dbt_project\target\semantic_manifest.json
[0m22:53:42.221075 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0bc8e48f-3a42-4d47-bc03-4410ed2ada8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CA9E9CF2F0>]}
[0m22:53:42.223064 [info ] [MainThread]: Found 5 models, 10 operations, 4 data tests, 426 macros
[0m22:53:42.223191 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0bc8e48f-3a42-4d47-bc03-4410ed2ada8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CA9EC8F830>]}
[0m22:53:42.224859 [info ] [MainThread]: 
[0m22:53:42.228368 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:53:42.230143 [info ] [MainThread]: 
[0m22:53:42.231141 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m22:53:42.233148 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m22:53:42.352608 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m22:53:42.353628 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m22:53:42.354630 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:53:42.721246 [debug] [ThreadPool]: SQL status: OK in 0.366 seconds
[0m22:53:42.724409 [debug] [ThreadPool]: On list_dev: Close
[0m22:53:42.728144 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m22:53:42.731534 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m22:53:42.769516 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m22:53:42.771515 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "create_dev_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m22:53:42.773274 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:53:42.774276 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m22:53:42.782081 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m22:53:42.783101 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m22:53:42.786113 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m22:53:42.786897 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m22:53:42.786897 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "create_dev_main"} */

    
    
        create schema if not exists "dev"."main"
    
[0m22:53:42.786897 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m22:53:42.786897 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m22:53:42.786897 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m22:53:42.798794 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m22:53:42.800952 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m22:53:42.804243 [debug] [ThreadPool]: On create_dev_main: Close
[0m22:53:42.825297 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev_main'
[0m22:53:42.845799 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m22:53:42.851539 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m22:53:42.853524 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:53:42.857304 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m22:53:42.858900 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m22:53:42.862052 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m22:53:42.940685 [debug] [ThreadPool]: SQL status: OK in 0.080 seconds
[0m22:53:42.954543 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m22:53:42.958067 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m22:53:42.959069 [debug] [ThreadPool]: On list_dev_main: Close
[0m22:53:42.963694 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0bc8e48f-3a42-4d47-bc03-4410ed2ada8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CA9EB8A990>]}
[0m22:53:42.963694 [debug] [MainThread]: Using duckdb connection "master"
[0m22:53:42.963694 [debug] [MainThread]: On master: BEGIN
[0m22:53:42.968356 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:53:42.969354 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m22:53:42.970868 [debug] [MainThread]: On master: COMMIT
[0m22:53:42.971884 [debug] [MainThread]: Using duckdb connection "master"
[0m22:53:42.973199 [debug] [MainThread]: On master: COMMIT
[0m22:53:42.974104 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m22:53:42.989132 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-0"
[0m22:53:43.002041 [info ] [MainThread]: 1 of 10 START hook: stock_dbt_project.on-run-start.0 ........................... [RUN]
[0m22:53:43.002041 [debug] [MainThread]: Using duckdb connection "master"
[0m22:53:43.015908 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
INSTALL httpfs;
[0m22:53:43.020929 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m22:53:43.024812 [info ] [MainThread]: 1 of 10 OK hook: stock_dbt_project.on-run-start.0 .............................. [[32mOK[0m in 0.05s]
[0m22:53:43.034619 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-1"
[0m22:53:43.038947 [info ] [MainThread]: 2 of 10 START hook: stock_dbt_project.on-run-start.1 ........................... [RUN]
[0m22:53:43.041490 [debug] [MainThread]: Using duckdb connection "master"
[0m22:53:43.044495 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
INSTALL json;
[0m22:53:43.053450 [debug] [MainThread]: SQL status: OK in 0.005 seconds
[0m22:53:43.057590 [info ] [MainThread]: 2 of 10 OK hook: stock_dbt_project.on-run-start.1 .............................. [[32mOK[0m in 0.03s]
[0m22:53:43.066458 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-2"
[0m22:53:43.069461 [info ] [MainThread]: 3 of 10 START hook: stock_dbt_project.on-run-start.2 ........................... [RUN]
[0m22:53:43.072843 [debug] [MainThread]: Using duckdb connection "master"
[0m22:53:43.074554 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
LOAD httpfs;
[0m22:53:43.076569 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m22:53:43.082651 [info ] [MainThread]: 3 of 10 OK hook: stock_dbt_project.on-run-start.2 .............................. [[32mOK[0m in 0.02s]
[0m22:53:43.090103 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-3"
[0m22:53:43.091797 [info ] [MainThread]: 4 of 10 START hook: stock_dbt_project.on-run-start.3 ........................... [RUN]
[0m22:53:43.093402 [debug] [MainThread]: Using duckdb connection "master"
[0m22:53:43.094501 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
LOAD json;
[0m22:53:43.096814 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m22:53:43.099085 [info ] [MainThread]: 4 of 10 OK hook: stock_dbt_project.on-run-start.3 .............................. [[32mOK[0m in 0.01s]
[0m22:53:43.103101 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-4"
[0m22:53:43.105095 [info ] [MainThread]: 5 of 10 START hook: stock_dbt_project.on-run-start.4 ........................... [RUN]
[0m22:53:43.106095 [debug] [MainThread]: Using duckdb connection "master"
[0m22:53:43.107103 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
SET s3_endpoint='http://localhost:9000';
[0m22:53:43.107103 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m22:53:43.107103 [info ] [MainThread]: 5 of 10 OK hook: stock_dbt_project.on-run-start.4 .............................. [[32mOK[0m in 0.01s]
[0m22:53:43.113642 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-5"
[0m22:53:43.116802 [info ] [MainThread]: 6 of 10 START hook: stock_dbt_project.on-run-start.5 ........................... [RUN]
[0m22:53:43.118909 [debug] [MainThread]: Using duckdb connection "master"
[0m22:53:43.119967 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
SET s3_access_key_id='minioadmin';
[0m22:53:43.121019 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m22:53:43.123115 [info ] [MainThread]: 6 of 10 OK hook: stock_dbt_project.on-run-start.5 .............................. [[32mOK[0m in 0.02s]
[0m22:53:43.127122 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-6"
[0m22:53:43.128305 [info ] [MainThread]: 7 of 10 START hook: stock_dbt_project.on-run-start.6 ........................... [RUN]
[0m22:53:43.128305 [debug] [MainThread]: Using duckdb connection "master"
[0m22:53:43.133832 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
SET s3_secret_access_key='minioadmin';
[0m22:53:43.135845 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m22:53:43.137849 [info ] [MainThread]: 7 of 10 OK hook: stock_dbt_project.on-run-start.6 .............................. [[32mOK[0m in 0.01s]
[0m22:53:43.141076 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-7"
[0m22:53:43.142074 [info ] [MainThread]: 8 of 10 START hook: stock_dbt_project.on-run-start.7 ........................... [RUN]
[0m22:53:43.144071 [debug] [MainThread]: Using duckdb connection "master"
[0m22:53:43.144823 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
SET s3_region='us-east-1';
[0m22:53:43.144823 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m22:53:43.149808 [info ] [MainThread]: 8 of 10 OK hook: stock_dbt_project.on-run-start.7 .............................. [[32mOK[0m in 0.01s]
[0m22:53:43.152808 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-8"
[0m22:53:43.154802 [info ] [MainThread]: 9 of 10 START hook: stock_dbt_project.on-run-start.8 ........................... [RUN]
[0m22:53:43.155802 [debug] [MainThread]: Using duckdb connection "master"
[0m22:53:43.156889 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
SET s3_use_ssl=false;
[0m22:53:43.156889 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m22:53:43.156889 [info ] [MainThread]: 9 of 10 OK hook: stock_dbt_project.on-run-start.8 .............................. [[32mOK[0m in 0.01s]
[0m22:53:43.164496 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-9"
[0m22:53:43.168514 [info ] [MainThread]: 10 of 10 START hook: stock_dbt_project.on-run-start.9 .......................... [RUN]
[0m22:53:43.172270 [debug] [MainThread]: Using duckdb connection "master"
[0m22:53:43.173723 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
SET s3_url_style='path';
[0m22:53:43.176722 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m22:53:43.182545 [info ] [MainThread]: 10 of 10 OK hook: stock_dbt_project.on-run-start.9 ............................. [[32mOK[0m in 0.02s]
[0m22:53:43.184569 [info ] [MainThread]: 
[0m22:53:43.186558 [debug] [MainThread]: On master: Close
[0m22:53:43.192158 [debug] [Thread-1 (]: Began running node model.stock_dbt_project.stg_stock_data
[0m22:53:43.192158 [info ] [Thread-1 (]: 1 of 1 START sql view model main.stg_stock_data ................................ [RUN]
[0m22:53:43.197273 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.stock_dbt_project.stg_stock_data'
[0m22:53:43.198273 [debug] [Thread-1 (]: Began compiling node model.stock_dbt_project.stg_stock_data
[0m22:53:43.203275 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_dbt_project.stg_stock_data"
[0m22:53:43.205358 [debug] [Thread-1 (]: Began executing node model.stock_dbt_project.stg_stock_data
[0m22:53:43.258628 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_dbt_project.stg_stock_data"
[0m22:53:43.259132 [debug] [Thread-1 (]: Using duckdb connection "model.stock_dbt_project.stg_stock_data"
[0m22:53:43.261658 [debug] [Thread-1 (]: On model.stock_dbt_project.stg_stock_data: BEGIN
[0m22:53:43.261658 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:53:43.261658 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m22:53:43.261658 [debug] [Thread-1 (]: Using duckdb connection "model.stock_dbt_project.stg_stock_data"
[0m22:53:43.265548 [debug] [Thread-1 (]: On model.stock_dbt_project.stg_stock_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "node_id": "model.stock_dbt_project.stg_stock_data"} */

  
  create view "dev"."main"."stg_stock_data__dbt_tmp" as (
    



WITH raw AS (
    SELECT *
    FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/AXP/2025/4/13/AXP_20250413_112043_rxe487.json')
)

SELECT
    CAST(symbol AS TEXT) AS symbol,
    CAST(datetime AS TIMESTAMP) AS datetime,
    CAST(open AS DOUBLE) AS open,
    CAST(high AS DOUBLE) AS high,
    CAST(low AS DOUBLE) AS low, 
    CAST(close AS DOUBLE) AS close,
    CAST(volume AS BIGINT) AS volume
FROM raw
WHERE symbol IS NOT NULL AND datetime IS NOT NULL
  );

[0m22:53:43.286279 [debug] [Thread-1 (]: SQL status: OK in 0.023 seconds
[0m22:53:43.300220 [debug] [Thread-1 (]: Using duckdb connection "model.stock_dbt_project.stg_stock_data"
[0m22:53:43.301241 [debug] [Thread-1 (]: On model.stock_dbt_project.stg_stock_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "node_id": "model.stock_dbt_project.stg_stock_data"} */
alter view "dev"."main"."stg_stock_data" rename to "stg_stock_data__dbt_backup"
[0m22:53:43.302245 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:53:43.307142 [debug] [Thread-1 (]: Using duckdb connection "model.stock_dbt_project.stg_stock_data"
[0m22:53:43.307142 [debug] [Thread-1 (]: On model.stock_dbt_project.stg_stock_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "node_id": "model.stock_dbt_project.stg_stock_data"} */
alter view "dev"."main"."stg_stock_data__dbt_tmp" rename to "stg_stock_data"
[0m22:53:43.307142 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:53:43.331102 [debug] [Thread-1 (]: On model.stock_dbt_project.stg_stock_data: COMMIT
[0m22:53:43.332102 [debug] [Thread-1 (]: Using duckdb connection "model.stock_dbt_project.stg_stock_data"
[0m22:53:43.333276 [debug] [Thread-1 (]: On model.stock_dbt_project.stg_stock_data: COMMIT
[0m22:53:43.336960 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m22:53:43.347374 [debug] [Thread-1 (]: Using duckdb connection "model.stock_dbt_project.stg_stock_data"
[0m22:53:43.349514 [debug] [Thread-1 (]: On model.stock_dbt_project.stg_stock_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "node_id": "model.stock_dbt_project.stg_stock_data"} */
drop view if exists "dev"."main"."stg_stock_data__dbt_backup" cascade
[0m22:53:43.353402 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m22:53:43.355707 [debug] [Thread-1 (]: On model.stock_dbt_project.stg_stock_data: Close
[0m22:53:43.369528 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0bc8e48f-3a42-4d47-bc03-4410ed2ada8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CA9C90BAA0>]}
[0m22:53:43.369528 [info ] [Thread-1 (]: 1 of 1 OK created sql view model main.stg_stock_data ........................... [[32mOK[0m in 0.17s]
[0m22:53:43.374565 [debug] [Thread-1 (]: Finished running node model.stock_dbt_project.stg_stock_data
[0m22:53:43.377701 [debug] [MainThread]: Using duckdb connection "master"
[0m22:53:43.379871 [debug] [MainThread]: On master: BEGIN
[0m22:53:43.380937 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:53:43.381957 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m22:53:43.382478 [debug] [MainThread]: On master: COMMIT
[0m22:53:43.383502 [debug] [MainThread]: Using duckdb connection "master"
[0m22:53:43.384010 [debug] [MainThread]: On master: COMMIT
[0m22:53:43.385020 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m22:53:43.387018 [debug] [MainThread]: On master: Close
[0m22:53:43.388021 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:53:43.389017 [debug] [MainThread]: Connection 'create_dev_main' was properly closed.
[0m22:53:43.389292 [debug] [MainThread]: Connection 'list_dev_main' was properly closed.
[0m22:53:43.390459 [debug] [MainThread]: Connection 'model.stock_dbt_project.stg_stock_data' was properly closed.
[0m22:53:43.392170 [info ] [MainThread]: 
[0m22:53:43.394399 [info ] [MainThread]: Finished running 10 project hooks, 1 view model in 0 hours 0 minutes and 1.16 seconds (1.16s).
[0m22:53:43.401526 [debug] [MainThread]: Command end result
[0m22:53:43.446500 [debug] [MainThread]: Wrote artifact WritableManifest to D:\Stock_price\stock_dbt_project\target\manifest.json
[0m22:53:43.450515 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\Stock_price\stock_dbt_project\target\semantic_manifest.json
[0m22:53:43.452859 [debug] [MainThread]: Wrote artifact RunExecutionResult to D:\Stock_price\stock_dbt_project\target\run_results.json
[0m22:53:43.452859 [info ] [MainThread]: 
[0m22:53:43.462556 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:53:43.462556 [info ] [MainThread]: 
[0m22:53:43.462556 [info ] [MainThread]: Done. PASS=11 WARN=0 ERROR=0 SKIP=0 TOTAL=11
[0m22:53:43.466705 [debug] [MainThread]: Command `dbt run` succeeded at 22:53:43.466705 after 3.72 seconds
[0m22:53:43.467728 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CA9D41EBD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CA9C9BD730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CA9C65F920>]}
[0m22:53:43.468723 [debug] [MainThread]: Flushing usage events
[0m22:53:44.180436 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:55:36.243017 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C8B926D640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C8B926D8B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C8B60E5190>]}


============================== 22:55:36.259667 | a7493a44-19b5-4494-ba4a-3855a60a032d ==============================
[0m22:55:36.259667 [info ] [MainThread]: Running with dbt=1.9.4
[0m22:55:36.262980 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\loges\\.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'D:\\Stock_price\\stock_dbt_project\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run --select stg_stock_data', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:55:37.125353 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a7493a44-19b5-4494-ba4a-3855a60a032d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C8B9BF1970>]}
[0m22:55:37.375549 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a7493a44-19b5-4494-ba4a-3855a60a032d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C8B9D5C500>]}
[0m22:55:37.383745 [info ] [MainThread]: Registered adapter: duckdb=1.9.2
[0m22:55:37.900617 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m22:55:38.173871 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m22:55:38.175210 [debug] [MainThread]: Partial parsing: updated file: stock_dbt_project://models\staging\stg_stock_data.sql
[0m22:55:38.938921 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.stock_dbt_project.marts
[0m22:55:38.957464 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a7493a44-19b5-4494-ba4a-3855a60a032d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C8BB576690>]}
[0m22:55:39.205369 [debug] [MainThread]: Wrote artifact WritableManifest to D:\Stock_price\stock_dbt_project\target\manifest.json
[0m22:55:39.209778 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\Stock_price\stock_dbt_project\target\semantic_manifest.json
[0m22:55:39.271546 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a7493a44-19b5-4494-ba4a-3855a60a032d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C8BB25CFB0>]}
[0m22:55:39.271546 [info ] [MainThread]: Found 5 models, 10 operations, 4 data tests, 426 macros
[0m22:55:39.271546 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a7493a44-19b5-4494-ba4a-3855a60a032d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C8BB27A480>]}
[0m22:55:39.271546 [info ] [MainThread]: 
[0m22:55:39.271546 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:55:39.283934 [info ] [MainThread]: 
[0m22:55:39.284946 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m22:55:39.287951 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m22:55:39.423153 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m22:55:39.423153 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m22:55:39.423153 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:55:39.771646 [debug] [ThreadPool]: SQL status: OK in 0.355 seconds
[0m22:55:39.789084 [debug] [ThreadPool]: On list_dev: Close
[0m22:55:39.791394 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m22:55:39.792927 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m22:55:39.804721 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m22:55:39.804721 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "create_dev_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m22:55:39.819514 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:55:39.822532 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m22:55:39.825525 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m22:55:39.825525 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m22:55:39.825525 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m22:55:39.833063 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m22:55:39.834269 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "create_dev_main"} */

    
    
        create schema if not exists "dev"."main"
    
[0m22:55:39.836118 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m22:55:39.839468 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m22:55:39.839468 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m22:55:39.839468 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m22:55:39.839468 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m22:55:39.839468 [debug] [ThreadPool]: On create_dev_main: Close
[0m22:55:39.860807 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev_main'
[0m22:55:39.874132 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m22:55:39.881665 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m22:55:39.882681 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:55:39.884678 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m22:55:39.885677 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m22:55:39.887042 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m22:55:39.936522 [debug] [ThreadPool]: SQL status: OK in 0.060 seconds
[0m22:55:39.956807 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m22:55:39.957354 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m22:55:39.964650 [debug] [ThreadPool]: On list_dev_main: Close
[0m22:55:39.969023 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a7493a44-19b5-4494-ba4a-3855a60a032d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C8BB324A40>]}
[0m22:55:39.971238 [debug] [MainThread]: Using duckdb connection "master"
[0m22:55:39.971238 [debug] [MainThread]: On master: BEGIN
[0m22:55:39.975280 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:55:39.975794 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m22:55:39.975794 [debug] [MainThread]: On master: COMMIT
[0m22:55:39.975794 [debug] [MainThread]: Using duckdb connection "master"
[0m22:55:39.975794 [debug] [MainThread]: On master: COMMIT
[0m22:55:39.986283 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m22:55:40.007089 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-0"
[0m22:55:40.026864 [info ] [MainThread]: 1 of 10 START hook: stock_dbt_project.on-run-start.0 ........................... [RUN]
[0m22:55:40.030879 [debug] [MainThread]: Using duckdb connection "master"
[0m22:55:40.034825 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
INSTALL httpfs;
[0m22:55:40.039475 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m22:55:40.044409 [info ] [MainThread]: 1 of 10 OK hook: stock_dbt_project.on-run-start.0 .............................. [[32mOK[0m in 0.05s]
[0m22:55:40.052952 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-1"
[0m22:55:40.057119 [info ] [MainThread]: 2 of 10 START hook: stock_dbt_project.on-run-start.1 ........................... [RUN]
[0m22:55:40.060047 [debug] [MainThread]: Using duckdb connection "master"
[0m22:55:40.062334 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
INSTALL json;
[0m22:55:40.068073 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m22:55:40.072768 [info ] [MainThread]: 2 of 10 OK hook: stock_dbt_project.on-run-start.1 .............................. [[32mOK[0m in 0.02s]
[0m22:55:40.076964 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-2"
[0m22:55:40.079265 [info ] [MainThread]: 3 of 10 START hook: stock_dbt_project.on-run-start.2 ........................... [RUN]
[0m22:55:40.081921 [debug] [MainThread]: Using duckdb connection "master"
[0m22:55:40.084108 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
LOAD httpfs;
[0m22:55:40.085859 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m22:55:40.089217 [info ] [MainThread]: 3 of 10 OK hook: stock_dbt_project.on-run-start.2 .............................. [[32mOK[0m in 0.01s]
[0m22:55:40.093839 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-3"
[0m22:55:40.095408 [info ] [MainThread]: 4 of 10 START hook: stock_dbt_project.on-run-start.3 ........................... [RUN]
[0m22:55:40.097074 [debug] [MainThread]: Using duckdb connection "master"
[0m22:55:40.098299 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
LOAD json;
[0m22:55:40.099893 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m22:55:40.101421 [info ] [MainThread]: 4 of 10 OK hook: stock_dbt_project.on-run-start.3 .............................. [[32mOK[0m in 0.01s]
[0m22:55:40.105153 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-4"
[0m22:55:40.105153 [info ] [MainThread]: 5 of 10 START hook: stock_dbt_project.on-run-start.4 ........................... [RUN]
[0m22:55:40.105153 [debug] [MainThread]: Using duckdb connection "master"
[0m22:55:40.108403 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
SET s3_endpoint='http://localhost:9000';
[0m22:55:40.110422 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m22:55:40.111960 [info ] [MainThread]: 5 of 10 OK hook: stock_dbt_project.on-run-start.4 .............................. [[32mOK[0m in 0.01s]
[0m22:55:40.114031 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-5"
[0m22:55:40.114031 [info ] [MainThread]: 6 of 10 START hook: stock_dbt_project.on-run-start.5 ........................... [RUN]
[0m22:55:40.114031 [debug] [MainThread]: Using duckdb connection "master"
[0m22:55:40.120200 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
SET s3_access_key_id='minioadmin';
[0m22:55:40.121744 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m22:55:40.123743 [info ] [MainThread]: 6 of 10 OK hook: stock_dbt_project.on-run-start.5 .............................. [[32mOK[0m in 0.01s]
[0m22:55:40.128558 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-6"
[0m22:55:40.131154 [info ] [MainThread]: 7 of 10 START hook: stock_dbt_project.on-run-start.6 ........................... [RUN]
[0m22:55:40.132144 [debug] [MainThread]: Using duckdb connection "master"
[0m22:55:40.132144 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
SET s3_secret_access_key='minioadmin';
[0m22:55:40.132144 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m22:55:40.132144 [info ] [MainThread]: 7 of 10 OK hook: stock_dbt_project.on-run-start.6 .............................. [[32mOK[0m in 0.01s]
[0m22:55:40.141329 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-7"
[0m22:55:40.144338 [info ] [MainThread]: 8 of 10 START hook: stock_dbt_project.on-run-start.7 ........................... [RUN]
[0m22:55:40.145397 [debug] [MainThread]: Using duckdb connection "master"
[0m22:55:40.146250 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
SET s3_region='us-east-1';
[0m22:55:40.148261 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m22:55:40.149259 [info ] [MainThread]: 8 of 10 OK hook: stock_dbt_project.on-run-start.7 .............................. [[32mOK[0m in 0.02s]
[0m22:55:40.153496 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-8"
[0m22:55:40.155138 [info ] [MainThread]: 9 of 10 START hook: stock_dbt_project.on-run-start.8 ........................... [RUN]
[0m22:55:40.156272 [debug] [MainThread]: Using duckdb connection "master"
[0m22:55:40.157201 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
SET s3_use_ssl=false;
[0m22:55:40.158391 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m22:55:40.160551 [info ] [MainThread]: 9 of 10 OK hook: stock_dbt_project.on-run-start.8 .............................. [[32mOK[0m in 0.01s]
[0m22:55:40.164889 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-9"
[0m22:55:40.167375 [info ] [MainThread]: 10 of 10 START hook: stock_dbt_project.on-run-start.9 .......................... [RUN]
[0m22:55:40.169580 [debug] [MainThread]: Using duckdb connection "master"
[0m22:55:40.170683 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
SET s3_url_style='path';
[0m22:55:40.171823 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m22:55:40.174030 [info ] [MainThread]: 10 of 10 OK hook: stock_dbt_project.on-run-start.9 ............................. [[32mOK[0m in 0.01s]
[0m22:55:40.175129 [info ] [MainThread]: 
[0m22:55:40.176664 [debug] [MainThread]: On master: Close
[0m22:55:40.182480 [debug] [Thread-1 (]: Began running node model.stock_dbt_project.stg_stock_data
[0m22:55:40.182480 [info ] [Thread-1 (]: 1 of 1 START sql view model main.stg_stock_data ................................ [RUN]
[0m22:55:40.187609 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.stock_dbt_project.stg_stock_data'
[0m22:55:40.188634 [debug] [Thread-1 (]: Began compiling node model.stock_dbt_project.stg_stock_data
[0m22:55:40.192679 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_dbt_project.stg_stock_data"
[0m22:55:40.192679 [debug] [Thread-1 (]: Began executing node model.stock_dbt_project.stg_stock_data
[0m22:55:40.241801 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_dbt_project.stg_stock_data"
[0m22:55:40.249759 [debug] [Thread-1 (]: Using duckdb connection "model.stock_dbt_project.stg_stock_data"
[0m22:55:40.251403 [debug] [Thread-1 (]: On model.stock_dbt_project.stg_stock_data: BEGIN
[0m22:55:40.252295 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:55:40.253297 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m22:55:40.255180 [debug] [Thread-1 (]: Using duckdb connection "model.stock_dbt_project.stg_stock_data"
[0m22:55:40.255845 [debug] [Thread-1 (]: On model.stock_dbt_project.stg_stock_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "node_id": "model.stock_dbt_project.stg_stock_data"} */

  
  create view "dev"."main"."stg_stock_data__dbt_tmp" as (
    



WITH raw AS (
    SELECT *
    FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/*/*/*/*/*.json')
)

SELECT
    CAST(symbol AS TEXT) AS symbol,
    CAST(datetime AS TIMESTAMP) AS datetime,
    CAST(open AS DOUBLE) AS open,
    CAST(high AS DOUBLE) AS high,
    CAST(low AS DOUBLE) AS low, 
    CAST(close AS DOUBLE) AS close,
    CAST(volume AS BIGINT) AS volume
FROM raw
WHERE symbol IS NOT NULL AND datetime IS NOT NULL
  );

[0m22:55:40.269603 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "node_id": "model.stock_dbt_project.stg_stock_data"} */

  
  create view "dev"."main"."stg_stock_data__dbt_tmp" as (
    



WITH raw AS (
    SELECT *
    FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/*/*/*/*/*.json')
)

SELECT
    CAST(symbol AS TEXT) AS symbol,
    CAST(datetime AS TIMESTAMP) AS datetime,
    CAST(open AS DOUBLE) AS open,
    CAST(high AS DOUBLE) AS high,
    CAST(low AS DOUBLE) AS low, 
    CAST(close AS DOUBLE) AS close,
    CAST(volume AS BIGINT) AS volume
FROM raw
WHERE symbol IS NOT NULL AND datetime IS NOT NULL
  );

[0m22:55:40.271193 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m22:55:40.272203 [debug] [Thread-1 (]: On model.stock_dbt_project.stg_stock_data: ROLLBACK
[0m22:55:40.276385 [debug] [Thread-1 (]: Failed to rollback 'model.stock_dbt_project.stg_stock_data'
[0m22:55:40.276385 [debug] [Thread-1 (]: On model.stock_dbt_project.stg_stock_data: Close
[0m22:55:40.287435 [debug] [Thread-1 (]: Runtime Error in model stg_stock_data (models\staging\stg_stock_data.sql)
  HTTP Error: Unable to connect to URL "http://localhost:9000/my-stock-data-bucket/stocks/*/*/*/*/*.json": 404 (Not Found).
[0m22:55:40.290294 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a7493a44-19b5-4494-ba4a-3855a60a032d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C8B91BB9B0>]}
[0m22:55:40.290294 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model main.stg_stock_data ....................... [[31mERROR[0m in 0.11s]
[0m22:55:40.290294 [debug] [Thread-1 (]: Finished running node model.stock_dbt_project.stg_stock_data
[0m22:55:40.290294 [debug] [Thread-4 (]: Marking all children of 'model.stock_dbt_project.stg_stock_data' to be skipped because of status 'error'.  Reason: Runtime Error in model stg_stock_data (models\staging\stg_stock_data.sql)
  HTTP Error: Unable to connect to URL "http://localhost:9000/my-stock-data-bucket/stocks/*/*/*/*/*.json": 404 (Not Found)..
[0m22:55:40.299322 [debug] [MainThread]: Using duckdb connection "master"
[0m22:55:40.300327 [debug] [MainThread]: On master: BEGIN
[0m22:55:40.301327 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:55:40.302522 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m22:55:40.303525 [debug] [MainThread]: On master: COMMIT
[0m22:55:40.303525 [debug] [MainThread]: Using duckdb connection "master"
[0m22:55:40.304525 [debug] [MainThread]: On master: COMMIT
[0m22:55:40.305532 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m22:55:40.306532 [debug] [MainThread]: On master: Close
[0m22:55:40.307525 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:55:40.307525 [debug] [MainThread]: Connection 'create_dev_main' was properly closed.
[0m22:55:40.308597 [debug] [MainThread]: Connection 'list_dev_main' was properly closed.
[0m22:55:40.308597 [debug] [MainThread]: Connection 'model.stock_dbt_project.stg_stock_data' was properly closed.
[0m22:55:40.308597 [info ] [MainThread]: 
[0m22:55:40.308597 [info ] [MainThread]: Finished running 10 project hooks, 1 view model in 0 hours 0 minutes and 1.02 seconds (1.02s).
[0m22:55:40.316515 [debug] [MainThread]: Command end result
[0m22:55:40.352725 [debug] [MainThread]: Wrote artifact WritableManifest to D:\Stock_price\stock_dbt_project\target\manifest.json
[0m22:55:40.352725 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\Stock_price\stock_dbt_project\target\semantic_manifest.json
[0m22:55:40.371217 [debug] [MainThread]: Wrote artifact RunExecutionResult to D:\Stock_price\stock_dbt_project\target\run_results.json
[0m22:55:40.372231 [info ] [MainThread]: 
[0m22:55:40.373769 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m22:55:40.373769 [info ] [MainThread]: 
[0m22:55:40.373769 [error] [MainThread]:   Runtime Error in model stg_stock_data (models\staging\stg_stock_data.sql)
  HTTP Error: Unable to connect to URL "http://localhost:9000/my-stock-data-bucket/stocks/*/*/*/*/*.json": 404 (Not Found).
[0m22:55:40.373769 [info ] [MainThread]: 
[0m22:55:40.379592 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=1 SKIP=0 TOTAL=11
[0m22:55:40.382608 [debug] [MainThread]: Command `dbt run` failed at 22:55:40.382608 after 4.69 seconds
[0m22:55:40.384617 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C8B926D8B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C8B99C6FF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C8B9D23B60>]}
[0m22:55:40.385609 [debug] [MainThread]: Flushing usage events
[0m22:55:41.105139 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:09:05.900485 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F2DB04ADB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F2DE59A720>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F2DE59B470>]}


============================== 23:09:05.923073 | f14a6112-59eb-4ff0-8acd-0a5b0527a2ce ==============================
[0m23:09:05.923073 [info ] [MainThread]: Running with dbt=1.9.4
[0m23:09:05.926607 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\loges\\.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'D:\\Stock_price\\stock_dbt_project\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt debug', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m23:09:06.029954 [info ] [MainThread]: dbt version: 1.9.4
[0m23:09:06.031935 [info ] [MainThread]: python version: 3.12.3
[0m23:09:06.036525 [info ] [MainThread]: python path: C:\Users\loges\.virtualenvs\Stock_price-P2gocZed\Scripts\python.exe
[0m23:09:06.042355 [info ] [MainThread]: os info: Windows-11-10.0.22631-SP0
[0m23:09:06.538885 [info ] [MainThread]: Using profiles dir at C:\Users\loges\.dbt
[0m23:09:06.542526 [info ] [MainThread]: Using profiles.yml file at C:\Users\loges\.dbt\profiles.yml
[0m23:09:06.546423 [info ] [MainThread]: Using dbt_project.yml file at D:\Stock_price\stock_dbt_project\dbt_project.yml
[0m23:09:06.569354 [info ] [MainThread]: adapter type: duckdb
[0m23:09:06.573563 [info ] [MainThread]: adapter version: 1.9.2
[0m23:09:07.108204 [info ] [MainThread]: Configuration:
[0m23:09:07.111843 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m23:09:07.115037 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m23:09:07.115772 [info ] [MainThread]: Required dependencies:
[0m23:09:07.120890 [debug] [MainThread]: Executing "git --help"
[0m23:09:07.277987 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m23:09:07.281861 [debug] [MainThread]: STDERR: "b''"
[0m23:09:07.283804 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m23:09:07.285889 [info ] [MainThread]: Connection:
[0m23:09:07.293535 [info ] [MainThread]:   database: dev
[0m23:09:07.296131 [info ] [MainThread]:   schema: main
[0m23:09:07.299710 [info ] [MainThread]:   path: D:/Stock_price/stock_dbt_project/dev.duckdb
[0m23:09:07.302765 [info ] [MainThread]:   config_options: None
[0m23:09:07.308431 [info ] [MainThread]:   extensions: ['httpfs', 'json']
[0m23:09:07.311943 [info ] [MainThread]:   settings: {}
[0m23:09:07.314253 [info ] [MainThread]:   external_root: .
[0m23:09:07.316377 [info ] [MainThread]:   use_credential_provider: None
[0m23:09:07.319200 [info ] [MainThread]:   attach: None
[0m23:09:07.320743 [info ] [MainThread]:   filesystems: None
[0m23:09:07.326134 [info ] [MainThread]:   remote: None
[0m23:09:07.331251 [info ] [MainThread]:   plugins: None
[0m23:09:07.336145 [info ] [MainThread]:   disable_transactions: False
[0m23:09:07.342683 [info ] [MainThread]: Registered adapter: duckdb=1.9.2
[0m23:09:08.245946 [debug] [MainThread]: Acquiring new duckdb connection 'debug'
[0m23:09:08.679787 [debug] [MainThread]: Using duckdb connection "debug"
[0m23:09:08.682670 [debug] [MainThread]: On debug: select 1 as id
[0m23:09:08.686055 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:09:09.112219 [debug] [MainThread]: SQL status: OK in 0.427 seconds
[0m23:09:09.113634 [debug] [MainThread]: On debug: Close
[0m23:09:09.113634 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m23:09:09.113634 [info ] [MainThread]: [32mAll checks passed![0m
[0m23:09:09.119754 [debug] [MainThread]: Command `dbt debug` succeeded at 23:09:09.119754 after 3.85 seconds
[0m23:09:09.121850 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m23:09:09.123107 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F2DECEABD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F2DE59B470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F2D88C4590>]}
[0m23:09:09.124294 [debug] [MainThread]: Flushing usage events
[0m23:09:09.694452 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:18:32.077098 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD497B0A40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD497B3E00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD497B3560>]}


============================== 23:18:32.094441 | 3d521342-9a18-4cc6-9c86-c8686a7fa61a ==============================
[0m23:18:32.094441 [info ] [MainThread]: Running with dbt=1.9.4
[0m23:18:32.097443 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\loges\\.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'D:\\Stock_price\\stock_dbt_project\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt debug', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m23:18:32.194829 [info ] [MainThread]: dbt version: 1.9.4
[0m23:18:32.196826 [info ] [MainThread]: python version: 3.12.3
[0m23:18:32.199233 [info ] [MainThread]: python path: C:\Users\loges\.virtualenvs\Stock_price-P2gocZed\Scripts\python.exe
[0m23:18:32.200271 [info ] [MainThread]: os info: Windows-11-10.0.22631-SP0
[0m23:18:32.412682 [info ] [MainThread]: Using profiles dir at C:\Users\loges\.dbt
[0m23:18:32.413916 [info ] [MainThread]: Using profiles.yml file at C:\Users\loges\.dbt\profiles.yml
[0m23:18:32.413916 [info ] [MainThread]: Using dbt_project.yml file at D:\Stock_price\stock_dbt_project\dbt_project.yml
[0m23:18:32.413916 [info ] [MainThread]: adapter type: duckdb
[0m23:18:32.413916 [info ] [MainThread]: adapter version: 1.9.2
[0m23:18:32.766772 [info ] [MainThread]: Configuration:
[0m23:18:32.768284 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m23:18:32.770537 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m23:18:32.772093 [info ] [MainThread]: Required dependencies:
[0m23:18:32.773813 [debug] [MainThread]: Executing "git --help"
[0m23:18:32.878132 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m23:18:32.878132 [debug] [MainThread]: STDERR: "b''"
[0m23:18:32.878132 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m23:18:32.878132 [info ] [MainThread]: Connection:
[0m23:18:32.878132 [info ] [MainThread]:   database: dev
[0m23:18:32.878132 [info ] [MainThread]:   schema: main
[0m23:18:32.889434 [info ] [MainThread]:   path: D:/Stock_price/stock_dbt_project/dev.duckdb
[0m23:18:32.890709 [info ] [MainThread]:   config_options: None
[0m23:18:32.893171 [info ] [MainThread]:   extensions: ['httpfs', 'json']
[0m23:18:32.895169 [info ] [MainThread]:   settings: {}
[0m23:18:32.898168 [info ] [MainThread]:   external_root: .
[0m23:18:32.898935 [info ] [MainThread]:   use_credential_provider: None
[0m23:18:32.898935 [info ] [MainThread]:   attach: None
[0m23:18:32.898935 [info ] [MainThread]:   filesystems: None
[0m23:18:32.898935 [info ] [MainThread]:   remote: None
[0m23:18:32.898935 [info ] [MainThread]:   plugins: None
[0m23:18:32.908127 [info ] [MainThread]:   disable_transactions: False
[0m23:18:32.911131 [info ] [MainThread]: Registered adapter: duckdb=1.9.2
[0m23:18:33.918093 [debug] [MainThread]: Acquiring new duckdb connection 'debug'
[0m23:18:34.292214 [debug] [MainThread]: Using duckdb connection "debug"
[0m23:18:34.295917 [debug] [MainThread]: On debug: select 1 as id
[0m23:18:34.297453 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:18:34.842245 [debug] [MainThread]: SQL status: OK in 0.544 seconds
[0m23:18:34.847601 [debug] [MainThread]: On debug: Close
[0m23:18:34.850708 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m23:18:34.854103 [info ] [MainThread]: [32mAll checks passed![0m
[0m23:18:34.861689 [debug] [MainThread]: Command `dbt debug` succeeded at 23:18:34.860200 after 3.15 seconds
[0m23:18:34.863861 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m23:18:34.866170 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD49F76450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD499060C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD46825040>]}
[0m23:18:34.868381 [debug] [MainThread]: Flushing usage events
[0m23:18:35.452959 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:18:51.317368 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018BE122FE00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018BE4922A50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018BE426BA70>]}


============================== 23:18:51.329403 | 2c519c94-fc98-4d4d-a528-c5e48beec861 ==============================
[0m23:18:51.329403 [info ] [MainThread]: Running with dbt=1.9.4
[0m23:18:51.330609 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\loges\\.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'D:\\Stock_price\\stock_dbt_project\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run --select stg_stock_data', 'send_anonymous_usage_stats': 'True'}
[0m23:18:51.678762 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2c519c94-fc98-4d4d-a528-c5e48beec861', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018BE50E3860>]}
[0m23:18:51.781625 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2c519c94-fc98-4d4d-a528-c5e48beec861', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018BE426A3F0>]}
[0m23:18:51.789147 [info ] [MainThread]: Registered adapter: duckdb=1.9.2
[0m23:18:52.150100 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m23:18:52.645368 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:18:52.647043 [debug] [MainThread]: Partial parsing: updated file: stock_dbt_project://models\staging\stg_stock_data.sql
[0m23:18:53.222578 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.stock_dbt_project.marts
[0m23:18:53.242750 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2c519c94-fc98-4d4d-a528-c5e48beec861', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018BE64D4440>]}
[0m23:18:53.599863 [debug] [MainThread]: Wrote artifact WritableManifest to D:\Stock_price\stock_dbt_project\target\manifest.json
[0m23:18:53.608767 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\Stock_price\stock_dbt_project\target\semantic_manifest.json
[0m23:18:53.718487 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2c519c94-fc98-4d4d-a528-c5e48beec861', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018BE62DC560>]}
[0m23:18:53.724790 [info ] [MainThread]: Found 5 models, 10 operations, 4 data tests, 426 macros
[0m23:18:53.728352 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2c519c94-fc98-4d4d-a528-c5e48beec861', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018BE1CE2FC0>]}
[0m23:18:53.735327 [info ] [MainThread]: 
[0m23:18:53.738612 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:18:53.741459 [info ] [MainThread]: 
[0m23:18:53.744456 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m23:18:53.749094 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m23:18:54.073758 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m23:18:54.076773 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m23:18:54.081426 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:18:54.631393 [debug] [ThreadPool]: SQL status: OK in 0.550 seconds
[0m23:18:54.638693 [debug] [ThreadPool]: On list_dev: Close
[0m23:18:54.644706 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m23:18:54.648568 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m23:18:54.691050 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m23:18:54.692120 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "create_dev_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m23:18:54.693232 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:18:54.695383 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m23:18:54.700949 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m23:18:54.703958 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m23:18:54.706732 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m23:18:54.708488 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m23:18:54.709578 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "create_dev_main"} */

    
    
        create schema if not exists "dev"."main"
    
[0m23:18:54.713090 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m23:18:54.717437 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m23:18:54.720222 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m23:18:54.721306 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m23:18:54.723294 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m23:18:54.724379 [debug] [ThreadPool]: On create_dev_main: Close
[0m23:18:54.744406 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev_main'
[0m23:18:54.756418 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m23:18:54.757483 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m23:18:54.758007 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:18:54.759099 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m23:18:54.759649 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m23:18:54.759649 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m23:18:54.786441 [debug] [ThreadPool]: SQL status: OK in 0.025 seconds
[0m23:18:54.790370 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m23:18:54.790370 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m23:18:54.790370 [debug] [ThreadPool]: On list_dev_main: Close
[0m23:18:54.790370 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2c519c94-fc98-4d4d-a528-c5e48beec861', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018BE50E0590>]}
[0m23:18:54.790370 [debug] [MainThread]: Using duckdb connection "master"
[0m23:18:54.797393 [debug] [MainThread]: On master: BEGIN
[0m23:18:54.797496 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:18:54.797496 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m23:18:54.797496 [debug] [MainThread]: On master: COMMIT
[0m23:18:54.797496 [debug] [MainThread]: Using duckdb connection "master"
[0m23:18:54.797496 [debug] [MainThread]: On master: COMMIT
[0m23:18:54.797496 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m23:18:54.809404 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-0"
[0m23:18:54.816683 [info ] [MainThread]: 1 of 10 START hook: stock_dbt_project.on-run-start.0 ........................... [RUN]
[0m23:18:54.816683 [debug] [MainThread]: Using duckdb connection "master"
[0m23:18:54.819282 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
INSTALL httpfs;
[0m23:18:54.820448 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m23:18:54.823157 [info ] [MainThread]: 1 of 10 OK hook: stock_dbt_project.on-run-start.0 .............................. [[32mOK[0m in 0.03s]
[0m23:18:54.826180 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-1"
[0m23:18:54.828324 [info ] [MainThread]: 2 of 10 START hook: stock_dbt_project.on-run-start.1 ........................... [RUN]
[0m23:18:54.829983 [debug] [MainThread]: Using duckdb connection "master"
[0m23:18:54.830506 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
INSTALL json;
[0m23:18:54.832132 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m23:18:54.834117 [info ] [MainThread]: 2 of 10 OK hook: stock_dbt_project.on-run-start.1 .............................. [[32mOK[0m in 0.01s]
[0m23:18:54.838462 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-2"
[0m23:18:54.840665 [info ] [MainThread]: 3 of 10 START hook: stock_dbt_project.on-run-start.2 ........................... [RUN]
[0m23:18:54.843319 [debug] [MainThread]: Using duckdb connection "master"
[0m23:18:54.844957 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
LOAD httpfs;
[0m23:18:54.846016 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m23:18:54.848446 [info ] [MainThread]: 3 of 10 OK hook: stock_dbt_project.on-run-start.2 .............................. [[32mOK[0m in 0.01s]
[0m23:18:54.851697 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-3"
[0m23:18:54.852986 [info ] [MainThread]: 4 of 10 START hook: stock_dbt_project.on-run-start.3 ........................... [RUN]
[0m23:18:54.855460 [debug] [MainThread]: Using duckdb connection "master"
[0m23:18:54.856827 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
LOAD json;
[0m23:18:54.858539 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m23:18:54.860915 [info ] [MainThread]: 4 of 10 OK hook: stock_dbt_project.on-run-start.3 .............................. [[32mOK[0m in 0.01s]
[0m23:18:54.864206 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-4"
[0m23:18:54.865397 [info ] [MainThread]: 5 of 10 START hook: stock_dbt_project.on-run-start.4 ........................... [RUN]
[0m23:18:54.867196 [debug] [MainThread]: Using duckdb connection "master"
[0m23:18:54.868229 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
SET s3_endpoint='http://localhost:9000';
[0m23:18:54.870525 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m23:18:54.872781 [info ] [MainThread]: 5 of 10 OK hook: stock_dbt_project.on-run-start.4 .............................. [[32mOK[0m in 0.01s]
[0m23:18:54.877559 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-5"
[0m23:18:54.878865 [info ] [MainThread]: 6 of 10 START hook: stock_dbt_project.on-run-start.5 ........................... [RUN]
[0m23:18:54.879875 [debug] [MainThread]: Using duckdb connection "master"
[0m23:18:54.880876 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
SET s3_access_key_id='minioadmin';
[0m23:18:54.883158 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m23:18:54.887707 [info ] [MainThread]: 6 of 10 OK hook: stock_dbt_project.on-run-start.5 .............................. [[32mOK[0m in 0.01s]
[0m23:18:54.895212 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-6"
[0m23:18:54.898213 [info ] [MainThread]: 7 of 10 START hook: stock_dbt_project.on-run-start.6 ........................... [RUN]
[0m23:18:54.900972 [debug] [MainThread]: Using duckdb connection "master"
[0m23:18:54.902720 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
SET s3_secret_access_key='minioadmin';
[0m23:18:54.906352 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m23:18:54.909795 [info ] [MainThread]: 7 of 10 OK hook: stock_dbt_project.on-run-start.6 .............................. [[32mOK[0m in 0.02s]
[0m23:18:54.916211 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-7"
[0m23:18:54.919415 [info ] [MainThread]: 8 of 10 START hook: stock_dbt_project.on-run-start.7 ........................... [RUN]
[0m23:18:54.923704 [debug] [MainThread]: Using duckdb connection "master"
[0m23:18:54.927270 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
SET s3_region='us-east-1';
[0m23:18:54.929923 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m23:18:54.935638 [info ] [MainThread]: 8 of 10 OK hook: stock_dbt_project.on-run-start.7 .............................. [[32mOK[0m in 0.02s]
[0m23:18:54.956167 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-8"
[0m23:18:54.964122 [info ] [MainThread]: 9 of 10 START hook: stock_dbt_project.on-run-start.8 ........................... [RUN]
[0m23:18:54.969361 [debug] [MainThread]: Using duckdb connection "master"
[0m23:18:54.973410 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
SET s3_use_ssl=false;
[0m23:18:54.979106 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m23:18:54.985048 [info ] [MainThread]: 9 of 10 OK hook: stock_dbt_project.on-run-start.8 .............................. [[32mOK[0m in 0.04s]
[0m23:18:54.999538 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-9"
[0m23:18:55.003411 [info ] [MainThread]: 10 of 10 START hook: stock_dbt_project.on-run-start.9 .......................... [RUN]
[0m23:18:55.012379 [debug] [MainThread]: Using duckdb connection "master"
[0m23:18:55.015635 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
SET s3_url_style='path';
[0m23:18:55.020901 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m23:18:55.032127 [info ] [MainThread]: 10 of 10 OK hook: stock_dbt_project.on-run-start.9 ............................. [[32mOK[0m in 0.04s]
[0m23:18:55.036393 [info ] [MainThread]: 
[0m23:18:55.046063 [debug] [MainThread]: On master: Close
[0m23:18:55.072011 [debug] [Thread-1 (]: Began running node model.stock_dbt_project.stg_stock_data
[0m23:18:55.078123 [info ] [Thread-1 (]: 1 of 1 START sql view model main.stg_stock_data ................................ [RUN]
[0m23:18:55.084100 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.stock_dbt_project.stg_stock_data'
[0m23:18:55.088199 [debug] [Thread-1 (]: Began compiling node model.stock_dbt_project.stg_stock_data
[0m23:18:55.102355 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_dbt_project.stg_stock_data"
[0m23:18:55.108523 [debug] [Thread-1 (]: Began executing node model.stock_dbt_project.stg_stock_data
[0m23:18:55.342430 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_dbt_project.stg_stock_data"
[0m23:18:55.346972 [debug] [Thread-1 (]: Using duckdb connection "model.stock_dbt_project.stg_stock_data"
[0m23:18:55.349576 [debug] [Thread-1 (]: On model.stock_dbt_project.stg_stock_data: BEGIN
[0m23:18:55.352245 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m23:18:55.357374 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m23:18:55.361188 [debug] [Thread-1 (]: Using duckdb connection "model.stock_dbt_project.stg_stock_data"
[0m23:18:55.364652 [debug] [Thread-1 (]: On model.stock_dbt_project.stg_stock_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "node_id": "model.stock_dbt_project.stg_stock_data"} */

  
  create view "dev"."main"."stg_stock_data__dbt_tmp" as (
    

WITH urls AS (
    SELECT * FROM read_csv_auto('sources.txt')
),
raw AS (
    SELECT *
    FROM urls,
         read_json_auto(urls.column1)
)

SELECT
    CAST(symbol AS TEXT) AS symbol,
    CAST(datetime AS TIMESTAMP) AS datetime,
    CAST(open AS DOUBLE) AS open,
    CAST(high AS DOUBLE) AS high,
    CAST(low AS DOUBLE) AS low,
    CAST(close AS DOUBLE) AS close,
    CAST(volume AS BIGINT) AS volume
FROM raw
WHERE symbol IS NOT NULL AND datetime IS NOT NULL
  );

[0m23:18:55.405451 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "node_id": "model.stock_dbt_project.stg_stock_data"} */

  
  create view "dev"."main"."stg_stock_data__dbt_tmp" as (
    

WITH urls AS (
    SELECT * FROM read_csv_auto('sources.txt')
),
raw AS (
    SELECT *
    FROM urls,
         read_json_auto(urls.column1)
)

SELECT
    CAST(symbol AS TEXT) AS symbol,
    CAST(datetime AS TIMESTAMP) AS datetime,
    CAST(open AS DOUBLE) AS open,
    CAST(high AS DOUBLE) AS high,
    CAST(low AS DOUBLE) AS low,
    CAST(close AS DOUBLE) AS close,
    CAST(volume AS BIGINT) AS volume
FROM raw
WHERE symbol IS NOT NULL AND datetime IS NOT NULL
  );

[0m23:18:55.405451 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m23:18:55.411050 [debug] [Thread-1 (]: On model.stock_dbt_project.stg_stock_data: ROLLBACK
[0m23:18:55.429998 [debug] [Thread-1 (]: Failed to rollback 'model.stock_dbt_project.stg_stock_data'
[0m23:18:55.431204 [debug] [Thread-1 (]: On model.stock_dbt_project.stg_stock_data: Close
[0m23:18:55.440827 [debug] [Thread-1 (]: Runtime Error in model stg_stock_data (models\staging\stg_stock_data.sql)
  IO Error: No files found that match the pattern "urls.column1"
[0m23:18:55.445104 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2c519c94-fc98-4d4d-a528-c5e48beec861', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018BE51047D0>]}
[0m23:18:55.445104 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model main.stg_stock_data ....................... [[31mERROR[0m in 0.36s]
[0m23:18:55.452884 [debug] [Thread-1 (]: Finished running node model.stock_dbt_project.stg_stock_data
[0m23:18:55.452884 [debug] [Thread-4 (]: Marking all children of 'model.stock_dbt_project.stg_stock_data' to be skipped because of status 'error'.  Reason: Runtime Error in model stg_stock_data (models\staging\stg_stock_data.sql)
  IO Error: No files found that match the pattern "urls.column1".
[0m23:18:55.464808 [debug] [MainThread]: Using duckdb connection "master"
[0m23:18:55.468283 [debug] [MainThread]: On master: BEGIN
[0m23:18:55.470078 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:18:55.474112 [debug] [MainThread]: SQL status: OK in 0.004 seconds
[0m23:18:55.476109 [debug] [MainThread]: On master: COMMIT
[0m23:18:55.478534 [debug] [MainThread]: Using duckdb connection "master"
[0m23:18:55.481528 [debug] [MainThread]: On master: COMMIT
[0m23:18:55.481859 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m23:18:55.483878 [debug] [MainThread]: On master: Close
[0m23:18:55.483878 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:18:55.483878 [debug] [MainThread]: Connection 'create_dev_main' was properly closed.
[0m23:18:55.483878 [debug] [MainThread]: Connection 'list_dev_main' was properly closed.
[0m23:18:55.491118 [debug] [MainThread]: Connection 'model.stock_dbt_project.stg_stock_data' was properly closed.
[0m23:18:55.495838 [info ] [MainThread]: 
[0m23:18:55.497834 [info ] [MainThread]: Finished running 10 project hooks, 1 view model in 0 hours 0 minutes and 1.75 seconds (1.75s).
[0m23:18:55.500741 [debug] [MainThread]: Command end result
[0m23:18:55.563002 [debug] [MainThread]: Wrote artifact WritableManifest to D:\Stock_price\stock_dbt_project\target\manifest.json
[0m23:18:55.563002 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\Stock_price\stock_dbt_project\target\semantic_manifest.json
[0m23:18:55.579965 [debug] [MainThread]: Wrote artifact RunExecutionResult to D:\Stock_price\stock_dbt_project\target\run_results.json
[0m23:18:55.580986 [info ] [MainThread]: 
[0m23:18:55.582097 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m23:18:55.582097 [info ] [MainThread]: 
[0m23:18:55.583801 [error] [MainThread]:   Runtime Error in model stg_stock_data (models\staging\stg_stock_data.sql)
  IO Error: No files found that match the pattern "urls.column1"
[0m23:18:55.583801 [info ] [MainThread]: 
[0m23:18:55.583801 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=1 SKIP=0 TOTAL=11
[0m23:18:55.588514 [debug] [MainThread]: Command `dbt run` failed at 23:18:55.588514 after 4.57 seconds
[0m23:18:55.589539 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018BE122FE00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018BE3B96270>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018BE4DB0590>]}
[0m23:18:55.590534 [debug] [MainThread]: Flushing usage events
[0m23:18:56.270086 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:21:45.126545 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB0F555730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB1303A870>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB1303ABA0>]}


============================== 23:21:45.139409 | 248ed26c-9ea0-4d0e-89f7-99ec2c484021 ==============================
[0m23:21:45.139409 [info ] [MainThread]: Running with dbt=1.9.4
[0m23:21:45.141771 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'D:\\Stock_price\\stock_dbt_project\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\loges\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --select stg_stock_data', 'send_anonymous_usage_stats': 'True'}
[0m23:21:45.630191 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '248ed26c-9ea0-4d0e-89f7-99ec2c484021', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB13572780>]}
[0m23:21:45.750492 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '248ed26c-9ea0-4d0e-89f7-99ec2c484021', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB1352C5C0>]}
[0m23:21:45.763142 [info ] [MainThread]: Registered adapter: duckdb=1.9.2
[0m23:21:46.378275 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m23:21:46.717347 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m23:21:46.718600 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '248ed26c-9ea0-4d0e-89f7-99ec2c484021', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB1303A540>]}
[0m23:21:51.642296 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.stock_dbt_project.marts
[0m23:21:51.665229 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '248ed26c-9ea0-4d0e-89f7-99ec2c484021', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB12FF5640>]}
[0m23:21:52.212255 [debug] [MainThread]: Wrote artifact WritableManifest to D:\Stock_price\stock_dbt_project\target\manifest.json
[0m23:21:52.219360 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\Stock_price\stock_dbt_project\target\semantic_manifest.json
[0m23:21:52.378490 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '248ed26c-9ea0-4d0e-89f7-99ec2c484021', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB147A6F30>]}
[0m23:21:52.383706 [info ] [MainThread]: Found 5 models, 11 operations, 4 data tests, 426 macros
[0m23:21:52.386271 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '248ed26c-9ea0-4d0e-89f7-99ec2c484021', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB149DE660>]}
[0m23:21:52.401583 [info ] [MainThread]: 
[0m23:21:52.403982 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:21:52.408026 [info ] [MainThread]: 
[0m23:21:52.412378 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m23:21:52.417586 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m23:21:52.821311 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m23:21:52.824614 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m23:21:52.826963 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:21:53.409867 [debug] [ThreadPool]: SQL status: OK in 0.583 seconds
[0m23:21:53.417370 [debug] [ThreadPool]: On list_dev: Close
[0m23:21:53.421490 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m23:21:53.426460 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m23:21:53.458550 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m23:21:53.463697 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "create_dev_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m23:21:53.465741 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:21:53.470053 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m23:21:53.480913 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m23:21:53.485240 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m23:21:53.488193 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m23:21:53.493561 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m23:21:53.496519 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "create_dev_main"} */

    
    
        create schema if not exists "dev"."main"
    
[0m23:21:53.500713 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m23:21:53.504261 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m23:21:53.504261 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m23:21:53.510310 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m23:21:53.511395 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m23:21:53.515683 [debug] [ThreadPool]: On create_dev_main: Close
[0m23:21:53.541805 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev_main'
[0m23:21:53.575824 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m23:21:53.578527 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m23:21:53.581545 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:21:53.583538 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m23:21:53.586569 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m23:21:53.589030 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m23:21:53.693587 [debug] [ThreadPool]: SQL status: OK in 0.101 seconds
[0m23:21:53.698884 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m23:21:53.699581 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m23:21:53.699581 [debug] [ThreadPool]: On list_dev_main: Close
[0m23:21:53.699581 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '248ed26c-9ea0-4d0e-89f7-99ec2c484021', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB14BA5580>]}
[0m23:21:53.709103 [debug] [MainThread]: Using duckdb connection "master"
[0m23:21:53.711128 [debug] [MainThread]: On master: BEGIN
[0m23:21:53.712283 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:21:53.713298 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m23:21:53.714728 [debug] [MainThread]: On master: COMMIT
[0m23:21:53.715301 [debug] [MainThread]: Using duckdb connection "master"
[0m23:21:53.716302 [debug] [MainThread]: On master: COMMIT
[0m23:21:53.717696 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m23:21:53.733021 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-0"
[0m23:21:53.749977 [info ] [MainThread]: 1 of 11 START hook: stock_dbt_project.on-run-start.0 ........................... [RUN]
[0m23:21:53.754777 [debug] [MainThread]: Using duckdb connection "master"
[0m23:21:53.754777 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
INSTALL httpfs;
[0m23:21:53.764577 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m23:21:53.769118 [info ] [MainThread]: 1 of 11 OK hook: stock_dbt_project.on-run-start.0 .............................. [[32mOK[0m in 0.05s]
[0m23:21:53.777670 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-1"
[0m23:21:53.780984 [info ] [MainThread]: 2 of 11 START hook: stock_dbt_project.on-run-start.1 ........................... [RUN]
[0m23:21:53.786223 [debug] [MainThread]: Using duckdb connection "master"
[0m23:21:53.789703 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
INSTALL json;
[0m23:21:53.794268 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m23:21:53.798452 [info ] [MainThread]: 2 of 11 OK hook: stock_dbt_project.on-run-start.1 .............................. [[32mOK[0m in 0.03s]
[0m23:21:53.802158 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-2"
[0m23:21:53.805334 [info ] [MainThread]: 3 of 11 START hook: stock_dbt_project.on-run-start.2 ........................... [RUN]
[0m23:21:53.808502 [debug] [MainThread]: Using duckdb connection "master"
[0m23:21:53.811618 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
LOAD httpfs;
[0m23:21:53.813604 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m23:21:53.816171 [info ] [MainThread]: 3 of 11 OK hook: stock_dbt_project.on-run-start.2 .............................. [[32mOK[0m in 0.02s]
[0m23:21:53.816171 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-3"
[0m23:21:53.816171 [info ] [MainThread]: 4 of 11 START hook: stock_dbt_project.on-run-start.3 ........................... [RUN]
[0m23:21:53.825501 [debug] [MainThread]: Using duckdb connection "master"
[0m23:21:53.826494 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
LOAD json;
[0m23:21:53.828492 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m23:21:53.831494 [info ] [MainThread]: 4 of 11 OK hook: stock_dbt_project.on-run-start.3 .............................. [[32mOK[0m in 0.02s]
[0m23:21:53.833539 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-4"
[0m23:21:53.833539 [info ] [MainThread]: 5 of 11 START hook: stock_dbt_project.on-run-start.4 ........................... [RUN]
[0m23:21:53.833539 [debug] [MainThread]: Using duckdb connection "master"
[0m23:21:53.840556 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
SET s3_endpoint='http://localhost:9000';
[0m23:21:53.843767 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m23:21:53.846786 [info ] [MainThread]: 5 of 11 OK hook: stock_dbt_project.on-run-start.4 .............................. [[32mOK[0m in 0.01s]
[0m23:21:53.850607 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-5"
[0m23:21:53.851810 [info ] [MainThread]: 6 of 11 START hook: stock_dbt_project.on-run-start.5 ........................... [RUN]
[0m23:21:53.851810 [debug] [MainThread]: Using duckdb connection "master"
[0m23:21:53.856693 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
SET s3_access_key_id='minioadmin';
[0m23:21:53.859491 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m23:21:53.862509 [info ] [MainThread]: 6 of 11 OK hook: stock_dbt_project.on-run-start.5 .............................. [[32mOK[0m in 0.01s]
[0m23:21:53.866726 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-6"
[0m23:21:53.868722 [info ] [MainThread]: 7 of 11 START hook: stock_dbt_project.on-run-start.6 ........................... [RUN]
[0m23:21:53.869714 [debug] [MainThread]: Using duckdb connection "master"
[0m23:21:53.870826 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
SET s3_secret_access_key='minioadmin';
[0m23:21:53.873553 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m23:21:53.873553 [info ] [MainThread]: 7 of 11 OK hook: stock_dbt_project.on-run-start.6 .............................. [[32mOK[0m in 0.01s]
[0m23:21:53.884216 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-7"
[0m23:21:53.886063 [info ] [MainThread]: 8 of 11 START hook: stock_dbt_project.on-run-start.7 ........................... [RUN]
[0m23:21:53.888381 [debug] [MainThread]: Using duckdb connection "master"
[0m23:21:53.890119 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
SET s3_region='us-east-1';
[0m23:21:53.894823 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m23:21:53.897826 [info ] [MainThread]: 8 of 11 OK hook: stock_dbt_project.on-run-start.7 .............................. [[32mOK[0m in 0.02s]
[0m23:21:53.901866 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-8"
[0m23:21:53.903377 [info ] [MainThread]: 9 of 11 START hook: stock_dbt_project.on-run-start.8 ........................... [RUN]
[0m23:21:53.907211 [debug] [MainThread]: Using duckdb connection "master"
[0m23:21:53.910564 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
SET s3_use_ssl=false;
[0m23:21:53.913957 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m23:21:53.916828 [info ] [MainThread]: 9 of 11 OK hook: stock_dbt_project.on-run-start.8 .............................. [[32mOK[0m in 0.02s]
[0m23:21:53.920679 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-9"
[0m23:21:53.922876 [info ] [MainThread]: 10 of 11 START hook: stock_dbt_project.on-run-start.9 .......................... [RUN]
[0m23:21:53.925626 [debug] [MainThread]: Using duckdb connection "master"
[0m23:21:53.927259 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
SET s3_url_style='path';
[0m23:21:53.929274 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m23:21:53.932277 [info ] [MainThread]: 10 of 11 OK hook: stock_dbt_project.on-run-start.9 ............................. [[32mOK[0m in 0.01s]
[0m23:21:53.934331 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-10"
[0m23:21:53.934331 [info ] [MainThread]: 11 of 11 START hook: stock_dbt_project.on-run-start.10 ......................... [RUN]
[0m23:21:53.940904 [debug] [MainThread]: Using duckdb connection "master"
[0m23:21:53.943568 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
python scripts/generate_stock_model.py
[0m23:21:53.946201 [debug] [MainThread]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
python scripts/generate_stock_model.py
[0m23:21:53.948213 [debug] [MainThread]: DuckDB adapter: Rolling back transaction.
[0m23:21:53.949278 [info ] [MainThread]: 11 of 11 ERROR hook: stock_dbt_project.on-run-start.10 ......................... [[31mERROR[0m in 0.02s]
[0m23:21:53.949278 [info ] [MainThread]: 
[0m23:21:53.951721 [debug] [MainThread]: On master: Close
[0m23:21:53.961519 [debug] [Thread-1 (]: Began running node model.stock_dbt_project.stg_stock_data
[0m23:21:53.963532 [info ] [Thread-1 (]: 1 of 1 START sql view model main.stg_stock_data ................................ [RUN]
[0m23:21:53.965042 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.stock_dbt_project.stg_stock_data'
[0m23:21:53.966051 [debug] [Thread-1 (]: Began compiling node model.stock_dbt_project.stg_stock_data
[0m23:21:53.970653 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_dbt_project.stg_stock_data"
[0m23:21:53.973712 [debug] [Thread-1 (]: Began executing node model.stock_dbt_project.stg_stock_data
[0m23:21:54.065696 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_dbt_project.stg_stock_data"
[0m23:21:54.066671 [debug] [Thread-1 (]: Using duckdb connection "model.stock_dbt_project.stg_stock_data"
[0m23:21:54.066671 [debug] [Thread-1 (]: On model.stock_dbt_project.stg_stock_data: BEGIN
[0m23:21:54.066671 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m23:21:54.066671 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m23:21:54.066671 [debug] [Thread-1 (]: Using duckdb connection "model.stock_dbt_project.stg_stock_data"
[0m23:21:54.073005 [debug] [Thread-1 (]: On model.stock_dbt_project.stg_stock_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "node_id": "model.stock_dbt_project.stg_stock_data"} */

  
  create view "dev"."main"."stg_stock_data__dbt_tmp" as (
    

WITH urls AS (
    SELECT * FROM read_csv_auto('sources.txt')
),
raw AS (
    SELECT *
    FROM urls,
         read_json_auto(urls.column1)
)

SELECT
    CAST(symbol AS TEXT) AS symbol,
    CAST(datetime AS TIMESTAMP) AS datetime,
    CAST(open AS DOUBLE) AS open,
    CAST(high AS DOUBLE) AS high,
    CAST(low AS DOUBLE) AS low,
    CAST(close AS DOUBLE) AS close,
    CAST(volume AS BIGINT) AS volume
FROM raw
WHERE symbol IS NOT NULL AND datetime IS NOT NULL
  );

[0m23:21:54.080594 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "node_id": "model.stock_dbt_project.stg_stock_data"} */

  
  create view "dev"."main"."stg_stock_data__dbt_tmp" as (
    

WITH urls AS (
    SELECT * FROM read_csv_auto('sources.txt')
),
raw AS (
    SELECT *
    FROM urls,
         read_json_auto(urls.column1)
)

SELECT
    CAST(symbol AS TEXT) AS symbol,
    CAST(datetime AS TIMESTAMP) AS datetime,
    CAST(open AS DOUBLE) AS open,
    CAST(high AS DOUBLE) AS high,
    CAST(low AS DOUBLE) AS low,
    CAST(close AS DOUBLE) AS close,
    CAST(volume AS BIGINT) AS volume
FROM raw
WHERE symbol IS NOT NULL AND datetime IS NOT NULL
  );

[0m23:21:54.080594 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m23:21:54.084610 [debug] [Thread-1 (]: On model.stock_dbt_project.stg_stock_data: ROLLBACK
[0m23:21:54.098706 [debug] [Thread-1 (]: Failed to rollback 'model.stock_dbt_project.stg_stock_data'
[0m23:21:54.099994 [debug] [Thread-1 (]: On model.stock_dbt_project.stg_stock_data: Close
[0m23:21:54.107699 [debug] [Thread-1 (]: Runtime Error in model stg_stock_data (models\staging\stg_stock_data.sql)
  IO Error: No files found that match the pattern "urls.column1"
[0m23:21:54.113148 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '248ed26c-9ea0-4d0e-89f7-99ec2c484021', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB153C6300>]}
[0m23:21:54.114492 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model main.stg_stock_data ....................... [[31mERROR[0m in 0.15s]
[0m23:21:54.114492 [debug] [Thread-1 (]: Finished running node model.stock_dbt_project.stg_stock_data
[0m23:21:54.114492 [debug] [Thread-4 (]: Marking all children of 'model.stock_dbt_project.stg_stock_data' to be skipped because of status 'error'.  Reason: Runtime Error in model stg_stock_data (models\staging\stg_stock_data.sql)
  IO Error: No files found that match the pattern "urls.column1".
[0m23:21:54.123014 [debug] [MainThread]: Using duckdb connection "master"
[0m23:21:54.123014 [debug] [MainThread]: On master: BEGIN
[0m23:21:54.129257 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:21:54.131280 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m23:21:54.133273 [debug] [MainThread]: On master: COMMIT
[0m23:21:54.134277 [debug] [MainThread]: Using duckdb connection "master"
[0m23:21:54.135272 [debug] [MainThread]: On master: COMMIT
[0m23:21:54.136477 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m23:21:54.140708 [debug] [MainThread]: On master: Close
[0m23:21:54.143378 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:21:54.144918 [debug] [MainThread]: Connection 'create_dev_main' was properly closed.
[0m23:21:54.146943 [debug] [MainThread]: Connection 'list_dev_main' was properly closed.
[0m23:21:54.148384 [debug] [MainThread]: Connection 'model.stock_dbt_project.stg_stock_data' was properly closed.
[0m23:21:54.149381 [info ] [MainThread]: 
[0m23:21:54.150957 [info ] [MainThread]: Finished running 11 project hooks, 1 view model in 0 hours 0 minutes and 1.74 seconds (1.74s).
[0m23:21:54.159933 [debug] [MainThread]: Command end result
[0m23:21:54.231208 [debug] [MainThread]: Wrote artifact WritableManifest to D:\Stock_price\stock_dbt_project\target\manifest.json
[0m23:21:54.236524 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\Stock_price\stock_dbt_project\target\semantic_manifest.json
[0m23:21:54.257564 [debug] [MainThread]: Wrote artifact RunExecutionResult to D:\Stock_price\stock_dbt_project\target\run_results.json
[0m23:21:54.257564 [info ] [MainThread]: 
[0m23:21:54.262284 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m23:21:54.263802 [info ] [MainThread]: 
[0m23:21:54.265437 [error] [MainThread]:   stock_dbt_project.on-run-start.10 failed, error:
 Parser Error: syntax error at or near "python"
[0m23:21:54.267586 [info ] [MainThread]: 
[0m23:21:54.270913 [error] [MainThread]:   Runtime Error in model stg_stock_data (models\staging\stg_stock_data.sql)
  IO Error: No files found that match the pattern "urls.column1"
[0m23:21:54.273495 [info ] [MainThread]: 
[0m23:21:54.276557 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=2 SKIP=0 TOTAL=12
[0m23:21:54.281732 [debug] [MainThread]: Command `dbt run` failed at 23:21:54.280722 after 9.45 seconds
[0m23:21:54.282721 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB133B9250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB0CD69700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB134E3CE0>]}
[0m23:21:54.285254 [debug] [MainThread]: Flushing usage events
[0m23:21:55.031400 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:23:45.384141 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CC541F3D10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CC569FB530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CC5707C0E0>]}


============================== 23:23:45.402196 | 328d3d5e-c325-408f-9b19-4a5208af998e ==============================
[0m23:23:45.402196 [info ] [MainThread]: Running with dbt=1.9.4
[0m23:23:45.402196 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\loges\\.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'D:\\Stock_price\\stock_dbt_project\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --select stg_stock_data', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m23:23:46.015822 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '328d3d5e-c325-408f-9b19-4a5208af998e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CC57635850>]}
[0m23:23:46.104020 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '328d3d5e-c325-408f-9b19-4a5208af998e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CC50EC4770>]}
[0m23:23:46.113466 [info ] [MainThread]: Registered adapter: duckdb=1.9.2
[0m23:23:46.415126 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m23:23:46.734100 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:23:46.734100 [debug] [MainThread]: Partial parsing: updated file: stock_dbt_project://models\staging\stg_stock_data.sql
[0m23:23:47.481082 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.stock_dbt_project.marts
[0m23:23:47.497240 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '328d3d5e-c325-408f-9b19-4a5208af998e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CC58C84320>]}
[0m23:23:47.700415 [debug] [MainThread]: Wrote artifact WritableManifest to D:\Stock_price\stock_dbt_project\target\manifest.json
[0m23:23:47.709967 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\Stock_price\stock_dbt_project\target\semantic_manifest.json
[0m23:23:47.782609 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '328d3d5e-c325-408f-9b19-4a5208af998e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CC58AAD8B0>]}
[0m23:23:47.791263 [info ] [MainThread]: Found 5 models, 11 operations, 4 data tests, 426 macros
[0m23:23:47.792789 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '328d3d5e-c325-408f-9b19-4a5208af998e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CC58ACB590>]}
[0m23:23:47.799873 [info ] [MainThread]: 
[0m23:23:47.802710 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:23:47.804273 [info ] [MainThread]: 
[0m23:23:47.807293 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m23:23:47.810817 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m23:23:47.968975 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m23:23:47.968975 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m23:23:47.976294 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:23:48.484725 [debug] [ThreadPool]: SQL status: OK in 0.508 seconds
[0m23:23:48.493435 [debug] [ThreadPool]: On list_dev: Close
[0m23:23:48.498171 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m23:23:48.502569 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m23:23:48.539771 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m23:23:48.542490 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "create_dev_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m23:23:48.545528 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:23:48.550910 [debug] [ThreadPool]: SQL status: OK in 0.005 seconds
[0m23:23:48.558916 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m23:23:48.561458 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m23:23:48.565200 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m23:23:48.566200 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m23:23:48.570253 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "create_dev_main"} */

    
    
        create schema if not exists "dev"."main"
    
[0m23:23:48.575543 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m23:23:48.581736 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m23:23:48.583253 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m23:23:48.587227 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m23:23:48.589586 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m23:23:48.596174 [debug] [ThreadPool]: On create_dev_main: Close
[0m23:23:48.626037 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev_main'
[0m23:23:48.658506 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m23:23:48.663954 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m23:23:48.666686 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:23:48.670367 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m23:23:48.670367 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m23:23:48.676752 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m23:23:48.786745 [debug] [ThreadPool]: SQL status: OK in 0.106 seconds
[0m23:23:48.801500 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m23:23:48.813948 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m23:23:48.816728 [debug] [ThreadPool]: On list_dev_main: Close
[0m23:23:48.821820 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '328d3d5e-c325-408f-9b19-4a5208af998e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CC578B17F0>]}
[0m23:23:48.827051 [debug] [MainThread]: Using duckdb connection "master"
[0m23:23:48.830287 [debug] [MainThread]: On master: BEGIN
[0m23:23:48.832651 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:23:48.836514 [debug] [MainThread]: SQL status: OK in 0.004 seconds
[0m23:23:48.837989 [debug] [MainThread]: On master: COMMIT
[0m23:23:48.843208 [debug] [MainThread]: Using duckdb connection "master"
[0m23:23:48.845812 [debug] [MainThread]: On master: COMMIT
[0m23:23:48.848487 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m23:23:48.879602 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-0"
[0m23:23:48.907442 [info ] [MainThread]: 1 of 11 START hook: stock_dbt_project.on-run-start.0 ........................... [RUN]
[0m23:23:48.911889 [debug] [MainThread]: Using duckdb connection "master"
[0m23:23:48.914305 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
INSTALL httpfs;
[0m23:23:48.919476 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m23:23:48.926534 [info ] [MainThread]: 1 of 11 OK hook: stock_dbt_project.on-run-start.0 .............................. [[32mOK[0m in 0.08s]
[0m23:23:48.936159 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-1"
[0m23:23:48.942540 [info ] [MainThread]: 2 of 11 START hook: stock_dbt_project.on-run-start.1 ........................... [RUN]
[0m23:23:48.947661 [debug] [MainThread]: Using duckdb connection "master"
[0m23:23:48.949434 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
INSTALL json;
[0m23:23:48.953507 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m23:23:48.959208 [info ] [MainThread]: 2 of 11 OK hook: stock_dbt_project.on-run-start.1 .............................. [[32mOK[0m in 0.03s]
[0m23:23:48.966595 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-2"
[0m23:23:48.968037 [info ] [MainThread]: 3 of 11 START hook: stock_dbt_project.on-run-start.2 ........................... [RUN]
[0m23:23:48.968037 [debug] [MainThread]: Using duckdb connection "master"
[0m23:23:48.978699 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
LOAD httpfs;
[0m23:23:48.982029 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m23:23:48.986321 [info ] [MainThread]: 3 of 11 OK hook: stock_dbt_project.on-run-start.2 .............................. [[32mOK[0m in 0.02s]
[0m23:23:48.998052 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-3"
[0m23:23:49.002976 [info ] [MainThread]: 4 of 11 START hook: stock_dbt_project.on-run-start.3 ........................... [RUN]
[0m23:23:49.008369 [debug] [MainThread]: Using duckdb connection "master"
[0m23:23:49.011078 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
LOAD json;
[0m23:23:49.014664 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m23:23:49.019431 [info ] [MainThread]: 4 of 11 OK hook: stock_dbt_project.on-run-start.3 .............................. [[32mOK[0m in 0.03s]
[0m23:23:49.030512 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-4"
[0m23:23:49.034605 [info ] [MainThread]: 5 of 11 START hook: stock_dbt_project.on-run-start.4 ........................... [RUN]
[0m23:23:49.037661 [debug] [MainThread]: Using duckdb connection "master"
[0m23:23:49.040790 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
SET s3_endpoint='http://localhost:9000';
[0m23:23:49.044385 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m23:23:49.049292 [info ] [MainThread]: 5 of 11 OK hook: stock_dbt_project.on-run-start.4 .............................. [[32mOK[0m in 0.03s]
[0m23:23:49.056680 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-5"
[0m23:23:49.060451 [info ] [MainThread]: 6 of 11 START hook: stock_dbt_project.on-run-start.5 ........................... [RUN]
[0m23:23:49.062454 [debug] [MainThread]: Using duckdb connection "master"
[0m23:23:49.065999 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
SET s3_access_key_id='minioadmin';
[0m23:23:49.068597 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m23:23:49.070891 [info ] [MainThread]: 6 of 11 OK hook: stock_dbt_project.on-run-start.5 .............................. [[32mOK[0m in 0.02s]
[0m23:23:49.084886 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-6"
[0m23:23:49.092017 [info ] [MainThread]: 7 of 11 START hook: stock_dbt_project.on-run-start.6 ........................... [RUN]
[0m23:23:49.097041 [debug] [MainThread]: Using duckdb connection "master"
[0m23:23:49.099512 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
SET s3_secret_access_key='minioadmin';
[0m23:23:49.104152 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m23:23:49.111513 [info ] [MainThread]: 7 of 11 OK hook: stock_dbt_project.on-run-start.6 .............................. [[32mOK[0m in 0.04s]
[0m23:23:49.117669 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-7"
[0m23:23:49.121529 [info ] [MainThread]: 8 of 11 START hook: stock_dbt_project.on-run-start.7 ........................... [RUN]
[0m23:23:49.127066 [debug] [MainThread]: Using duckdb connection "master"
[0m23:23:49.129776 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
SET s3_region='us-east-1';
[0m23:23:49.134744 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m23:23:49.140238 [info ] [MainThread]: 8 of 11 OK hook: stock_dbt_project.on-run-start.7 .............................. [[32mOK[0m in 0.02s]
[0m23:23:49.153110 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-8"
[0m23:23:49.160892 [info ] [MainThread]: 9 of 11 START hook: stock_dbt_project.on-run-start.8 ........................... [RUN]
[0m23:23:49.164337 [debug] [MainThread]: Using duckdb connection "master"
[0m23:23:49.166082 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
SET s3_use_ssl=false;
[0m23:23:49.168615 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m23:23:49.171693 [info ] [MainThread]: 9 of 11 OK hook: stock_dbt_project.on-run-start.8 .............................. [[32mOK[0m in 0.02s]
[0m23:23:49.183877 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-9"
[0m23:23:49.188421 [info ] [MainThread]: 10 of 11 START hook: stock_dbt_project.on-run-start.9 .......................... [RUN]
[0m23:23:49.193443 [debug] [MainThread]: Using duckdb connection "master"
[0m23:23:49.197065 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
SET s3_url_style='path';
[0m23:23:49.201147 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m23:23:49.209935 [info ] [MainThread]: 10 of 11 OK hook: stock_dbt_project.on-run-start.9 ............................. [[32mOK[0m in 0.03s]
[0m23:23:49.219188 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-10"
[0m23:23:49.226728 [info ] [MainThread]: 11 of 11 START hook: stock_dbt_project.on-run-start.10 ......................... [RUN]
[0m23:23:49.232295 [debug] [MainThread]: Using duckdb connection "master"
[0m23:23:49.234920 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
python scripts/generate_stock_model.py
[0m23:23:49.238747 [debug] [MainThread]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
python scripts/generate_stock_model.py
[0m23:23:49.243530 [debug] [MainThread]: DuckDB adapter: Rolling back transaction.
[0m23:23:49.249870 [info ] [MainThread]: 11 of 11 ERROR hook: stock_dbt_project.on-run-start.10 ......................... [[31mERROR[0m in 0.03s]
[0m23:23:49.252610 [info ] [MainThread]: 
[0m23:23:49.256263 [debug] [MainThread]: On master: Close
[0m23:23:49.276800 [debug] [Thread-1 (]: Began running node model.stock_dbt_project.stg_stock_data
[0m23:23:49.279923 [info ] [Thread-1 (]: 1 of 1 START sql view model main.stg_stock_data ................................ [RUN]
[0m23:23:49.284148 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.stock_dbt_project.stg_stock_data'
[0m23:23:49.285148 [debug] [Thread-1 (]: Began compiling node model.stock_dbt_project.stg_stock_data
[0m23:23:49.310606 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_dbt_project.stg_stock_data"
[0m23:23:49.316133 [debug] [Thread-1 (]: Began executing node model.stock_dbt_project.stg_stock_data
[0m23:23:49.555612 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_dbt_project.stg_stock_data"
[0m23:23:49.564030 [debug] [Thread-1 (]: Using duckdb connection "model.stock_dbt_project.stg_stock_data"
[0m23:23:49.566952 [debug] [Thread-1 (]: On model.stock_dbt_project.stg_stock_data: BEGIN
[0m23:23:49.570525 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m23:23:49.575312 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m23:23:49.579222 [debug] [Thread-1 (]: Using duckdb connection "model.stock_dbt_project.stg_stock_data"
[0m23:23:49.587070 [debug] [Thread-1 (]: On model.stock_dbt_project.stg_stock_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "node_id": "model.stock_dbt_project.stg_stock_data"} */

  
  create view "dev"."main"."stg_stock_data__dbt_tmp" as (
    

WITH raw AS (
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/AAPL/2025/4/13/AAPL_20250413_111406_6ss1g0.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/AAPL/2025/4/13/AAPL_20250413_111507_vbodha.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/AAPL/2025/4/13/AAPL_20250413_111607_fg6ikl.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/AAPL/2025/4/13/AAPL_20250413_111707_meu1bb.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/AAPL/2025/4/17/AAPL_20250417_225502_nbggac.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/AAPL/2025/4/17/AAPL_20250417_225604_fpbwvo.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/AAPL/2025/4/17/AAPL_20250417_225706_mdcj3j.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/AAPL/2025/4/17/AAPL_20250417_235559_wnml5g.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/AMGN/2025/4/13/AMGN_20250413_111406_376tdf.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/AMGN/2025/4/13/AMGN_20250413_111707_6fyizj.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/AMGN/2025/4/13/AMGN_20250413_111807_wj4725.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/AMGN/2025/4/13/AMGN_20250413_111908_grof48.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/AMGN/2025/4/13/AMGN_20250413_112008_mqcblg.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/AMGN/2025/4/13/AMGN_20250413_112430_vzl3jo.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/AXP/2025/4/13/AXP_20250413_112043_rxe487.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/AXP/2025/4/13/AXP_20250413_112143_dy2f99.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/AXP/2025/4/13/AXP_20250413_112243_wpjnea.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/AXP/2025/4/13/AXP_20250413_112343_3ar95s.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/AXP/2025/4/13/AXP_20250413_112820_nmp10g.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/BA/2025/4/13/BA_20250413_112430_qjgzy0.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/BA/2025/4/13/BA_20250413_112530_xlerhn.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/BA/2025/4/13/BA_20250413_112630_ulftgu.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/BA/2025/4/13/BA_20250413_112730_hfrte0.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/BA/2025/4/13/BA_20250413_113208_zvt53x.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/CAT/2025/4/13/CAT_20250413_112820_v57z9v.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/CAT/2025/4/13/CAT_20250413_112920_sljvdt.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/CAT/2025/4/13/CAT_20250413_113020_hw41p1.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/CAT/2025/4/13/CAT_20250413_113120_ykrdew.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/CAT/2025/4/13/CAT_20250413_113555_97ycfk.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/CRM/2025/4/13/CRM_20250413_113208_xkovti.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/CRM/2025/4/13/CRM_20250413_113308_mgza12.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/CRM/2025/4/13/CRM_20250413_113408_9bqr6q.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/CRM/2025/4/13/CRM_20250413_113508_k34vp2.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/CRM/2025/4/13/CRM_20250413_113945_lkclxc.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/CSCO/2025/4/13/CSCO_20250413_113555_l9kwg7.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/CSCO/2025/4/13/CSCO_20250413_113655_izivyy.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/CSCO/2025/4/13/CSCO_20250413_113755_dt1x9y.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/CSCO/2025/4/13/CSCO_20250413_113855_c3r2g8.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/CSCO/2025/4/13/CSCO_20250413_114723_2fm9vb.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/CVX/2025/4/13/CVX_20250413_113945_jz58k4.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/CVX/2025/4/13/CVX_20250413_114046_wfeslb.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/CVX/2025/4/13/CVX_20250413_114146_gr7ke4.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/CVX/2025/4/13/CVX_20250413_114246_nnct9l.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/CVX/2025/4/13/CVX_20250413_114346_ft4rmb.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/DIS/2025/4/13/DIS_20250413_114346_oo2o7g.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/DIS/2025/4/13/DIS_20250413_114447_00dzv2.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/DIS/2025/4/13/DIS_20250413_114547_celsbg.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/DIS/2025/4/13/DIS_20250413_114647_l29qvy.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/DIS/2025/4/13/DIS_20250413_122154_00kf9h.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/DOW/2025/4/13/DOW_20250413_114723_5js7wg.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/DOW/2025/4/13/DOW_20250413_114823_ikbq60.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/DOW/2025/4/13/DOW_20250413_114924_v4k4vs.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/DOW/2025/4/13/DOW_20250413_115024_t1ze5o.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/DOW/2025/4/13/DOW_20250413_115124_z0yaap.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/GS/2025/4/13/GS_20250413_115124_k5wp1c.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/GS/2025/4/13/GS_20250413_115224_up2h60.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/GS/2025/4/13/GS_20250413_115324_kvaybg.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/GS/2025/4/13/GS_20250413_115424_p826ac.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/GS/2025/4/13/GS_20250413_115524_kaslf9.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/HD/2025/4/13/HD_20250413_115524_v565zl.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/HD/2025/4/13/HD_20250413_115624_m2ddoc.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/HD/2025/4/13/HD_20250413_115725_r0w0oc.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/HD/2025/4/13/HD_20250413_115825_ohauqk.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/HD/2025/4/13/HD_20250413_115925_52bquj.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/HON/2025/4/13/HON_20250413_115925_m22v5u.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/HON/2025/4/13/HON_20250413_120025_p6isvb.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/HON/2025/4/13/HON_20250413_120125_j4tlsk.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/HON/2025/4/13/HON_20250413_120225_jxmz5t.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/HON/2025/4/13/HON_20250413_120325_yjx3h3.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/IBM/2025/4/13/IBM_20250413_120326_5v31ap.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/IBM/2025/4/13/IBM_20250413_120426_v0zxjs.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/IBM/2025/4/13/IBM_20250413_120526_t0aet0.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/IBM/2025/4/13/IBM_20250413_120626_1mh4pe.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/IBM/2025/4/13/IBM_20250413_120726_q9scqg.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/INTC/2025/4/13/INTC_20250413_120726_tngyf4.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/INTC/2025/4/13/INTC_20250413_120827_pa0hww.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/INTC/2025/4/13/INTC_20250413_120927_n0bjos.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/INTC/2025/4/13/INTC_20250413_121027_6cnq4f.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/INTC/2025/4/13/INTC_20250413_121127_8gcjaq.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/JNJ/2025/4/13/JNJ_20250413_121027_d7pymv.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/JNJ/2025/4/13/JNJ_20250413_121127_1unfa3.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/JNJ/2025/4/13/JNJ_20250413_121227_0in9gv.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/JNJ/2025/4/13/JNJ_20250413_121327_n72dcw.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/JNJ/2025/4/13/JNJ_20250413_121428_77t0e9.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/JPM/2025/4/13/JPM_20250413_121428_2nx47p.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/JPM/2025/4/13/JPM_20250413_121528_lbr75v.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/JPM/2025/4/13/JPM_20250413_121628_an9e86.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/JPM/2025/4/13/JPM_20250413_121728_jbj8pq.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/JPM/2025/4/13/JPM_20250413_121828_lzta1f.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/KO/2025/4/13/KO_20250413_121828_giyj1f.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/KO/2025/4/13/KO_20250413_121929_r2lpld.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/KO/2025/4/13/KO_20250413_122029_19yvzy.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/KO/2025/4/13/KO_20250413_122129_nxv1nm.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/KO/2025/4/13/KO_20250413_123717_4aowb0.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/MCD/2025/4/13/MCD_20250413_122155_xjyi4f.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/MCD/2025/4/13/MCD_20250413_122255_zxb6im.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/MCD/2025/4/13/MCD_20250413_122355_1o2rjj.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/MCD/2025/4/13/MCD_20250413_122455_sw660e.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/MCD/2025/4/13/MCD_20250413_122555_bxprrb.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/MMM/2025/4/13/MMM_20250413_122555_v35yhq.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/MMM/2025/4/13/MMM_20250413_122655_3v0frs.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/MMM/2025/4/13/MMM_20250413_122755_yq3rsw.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/MMM/2025/4/13/MMM_20250413_122856_urd0jv.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/MMM/2025/4/13/MMM_20250413_122956_1sygy4.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/MRK/2025/4/13/MRK_20250413_122956_f3ddtt.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/MRK/2025/4/13/MRK_20250413_123056_1vzpgv.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/MRK/2025/4/13/MRK_20250413_123156_a4xt7c.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/MRK/2025/4/13/MRK_20250413_123257_24je3z.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/MRK/2025/4/13/MRK_20250413_123357_t7dxcs.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/MSFT/2025/4/13/MSFT_20250413_123357_pxhd4g.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/MSFT/2025/4/13/MSFT_20250413_123457_3lr87y.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/MSFT/2025/4/13/MSFT_20250413_123557_xcbu21.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/MSFT/2025/4/13/MSFT_20250413_123658_vsbw42.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/NKE/2025/4/13/NKE_20250413_123717_ewnsex.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/NKE/2025/4/13/NKE_20250413_123817_bh1dtd.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/NKE/2025/4/13/NKE_20250413_123917_5fp936.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/NKE/2025/4/13/NKE_20250413_124017_z26lw1.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/NKE/2025/4/13/NKE_20250413_124118_5pioe2.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/NKE/2025/4/13/NKE_20250413_124218_3qjysz.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/PG/2025/4/13/PG_20250413_124118_egc4nt.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/PG/2025/4/13/PG_20250413_124218_l9dtbw.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/PG/2025/4/13/PG_20250413_210538_qf1xkp.json')
)

SELECT
    CAST(symbol AS TEXT) AS symbol,
    CAST(datetime AS TIMESTAMP) AS datetime,
    CAST(open AS DOUBLE) AS open,
    CAST(high AS DOUBLE) AS high,
    CAST(low AS DOUBLE) AS low,
    CAST(close AS DOUBLE) AS close,
    CAST(volume AS BIGINT) AS volume
FROM raw
WHERE symbol IS NOT NULL AND datetime IS NOT NULL
  );

[0m23:23:54.119237 [debug] [Thread-1 (]: SQL status: OK in 4.529 seconds
[0m23:23:54.148853 [debug] [Thread-1 (]: Using duckdb connection "model.stock_dbt_project.stg_stock_data"
[0m23:23:54.150622 [debug] [Thread-1 (]: On model.stock_dbt_project.stg_stock_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "node_id": "model.stock_dbt_project.stg_stock_data"} */
alter view "dev"."main"."stg_stock_data" rename to "stg_stock_data__dbt_backup"
[0m23:23:54.152461 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m23:23:54.160898 [debug] [Thread-1 (]: Using duckdb connection "model.stock_dbt_project.stg_stock_data"
[0m23:23:54.162382 [debug] [Thread-1 (]: On model.stock_dbt_project.stg_stock_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "node_id": "model.stock_dbt_project.stg_stock_data"} */
alter view "dev"."main"."stg_stock_data__dbt_tmp" rename to "stg_stock_data"
[0m23:23:54.166335 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m23:23:54.212901 [debug] [Thread-1 (]: On model.stock_dbt_project.stg_stock_data: COMMIT
[0m23:23:54.215860 [debug] [Thread-1 (]: Using duckdb connection "model.stock_dbt_project.stg_stock_data"
[0m23:23:54.217591 [debug] [Thread-1 (]: On model.stock_dbt_project.stg_stock_data: COMMIT
[0m23:23:54.223631 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m23:23:54.235635 [debug] [Thread-1 (]: Using duckdb connection "model.stock_dbt_project.stg_stock_data"
[0m23:23:54.235635 [debug] [Thread-1 (]: On model.stock_dbt_project.stg_stock_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "node_id": "model.stock_dbt_project.stg_stock_data"} */
drop view if exists "dev"."main"."stg_stock_data__dbt_backup" cascade
[0m23:23:54.235635 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m23:23:54.246767 [debug] [Thread-1 (]: On model.stock_dbt_project.stg_stock_data: Close
[0m23:23:54.247191 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '328d3d5e-c325-408f-9b19-4a5208af998e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CC59407EC0>]}
[0m23:23:54.247191 [info ] [Thread-1 (]: 1 of 1 OK created sql view model main.stg_stock_data ........................... [[32mOK[0m in 4.96s]
[0m23:23:54.254702 [debug] [Thread-1 (]: Finished running node model.stock_dbt_project.stg_stock_data
[0m23:23:54.261951 [debug] [MainThread]: Using duckdb connection "master"
[0m23:23:54.264193 [debug] [MainThread]: On master: BEGIN
[0m23:23:54.265446 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:23:54.267616 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m23:23:54.269329 [debug] [MainThread]: On master: COMMIT
[0m23:23:54.270438 [debug] [MainThread]: Using duckdb connection "master"
[0m23:23:54.271535 [debug] [MainThread]: On master: COMMIT
[0m23:23:54.272076 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m23:23:54.275039 [debug] [MainThread]: On master: Close
[0m23:23:54.277062 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:23:54.279060 [debug] [MainThread]: Connection 'create_dev_main' was properly closed.
[0m23:23:54.280060 [debug] [MainThread]: Connection 'list_dev_main' was properly closed.
[0m23:23:54.281051 [debug] [MainThread]: Connection 'model.stock_dbt_project.stg_stock_data' was properly closed.
[0m23:23:54.282154 [info ] [MainThread]: 
[0m23:23:54.282154 [info ] [MainThread]: Finished running 11 project hooks, 1 view model in 0 hours 0 minutes and 6.48 seconds (6.48s).
[0m23:23:54.289233 [debug] [MainThread]: Command end result
[0m23:23:54.369663 [debug] [MainThread]: Wrote artifact WritableManifest to D:\Stock_price\stock_dbt_project\target\manifest.json
[0m23:23:54.380493 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\Stock_price\stock_dbt_project\target\semantic_manifest.json
[0m23:23:54.415521 [debug] [MainThread]: Wrote artifact RunExecutionResult to D:\Stock_price\stock_dbt_project\target\run_results.json
[0m23:23:54.417793 [info ] [MainThread]: 
[0m23:23:54.420611 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m23:23:54.420611 [info ] [MainThread]: 
[0m23:23:54.427822 [error] [MainThread]:   stock_dbt_project.on-run-start.10 failed, error:
 Parser Error: syntax error at or near "python"
[0m23:23:54.429843 [info ] [MainThread]: 
[0m23:23:54.433699 [info ] [MainThread]: Done. PASS=11 WARN=0 ERROR=1 SKIP=0 TOTAL=12
[0m23:23:54.438712 [debug] [MainThread]: Command `dbt run` failed at 23:23:54.437413 after 9.38 seconds
[0m23:23:54.441590 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CC572E2480>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CC56DC54C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CC5750F200>]}
[0m23:23:54.445408 [debug] [MainThread]: Flushing usage events
[0m23:23:55.302170 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:24:26.645290 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B95CB42BA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B9593B9100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B95C7AFBF0>]}


============================== 23:24:26.651930 | 9621dc70-44cd-4e88-b10d-8d77c8ef481e ==============================
[0m23:24:26.651930 [info ] [MainThread]: Running with dbt=1.9.4
[0m23:24:26.651930 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'D:\\Stock_price\\stock_dbt_project\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\loges\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select stg_stock_data', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:24:27.068194 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9621dc70-44cd-4e88-b10d-8d77c8ef481e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B95D080D70>]}
[0m23:24:27.201066 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9621dc70-44cd-4e88-b10d-8d77c8ef481e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B95C4B6000>]}
[0m23:24:27.218675 [info ] [MainThread]: Registered adapter: duckdb=1.9.2
[0m23:24:27.705444 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m23:24:28.237745 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m23:24:28.241746 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '9621dc70-44cd-4e88-b10d-8d77c8ef481e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B95CB42450>]}
[0m23:24:34.603565 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.stock_dbt_project.marts
[0m23:24:34.629033 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9621dc70-44cd-4e88-b10d-8d77c8ef481e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B95E8D5340>]}
[0m23:24:34.899840 [debug] [MainThread]: Wrote artifact WritableManifest to D:\Stock_price\stock_dbt_project\target\manifest.json
[0m23:24:34.906382 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\Stock_price\stock_dbt_project\target\semantic_manifest.json
[0m23:24:34.992507 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9621dc70-44cd-4e88-b10d-8d77c8ef481e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B95E3CE3F0>]}
[0m23:24:34.996528 [info ] [MainThread]: Found 5 models, 10 operations, 4 data tests, 426 macros
[0m23:24:34.999428 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9621dc70-44cd-4e88-b10d-8d77c8ef481e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B95E67C7D0>]}
[0m23:24:35.005178 [info ] [MainThread]: 
[0m23:24:35.009263 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:24:35.011999 [info ] [MainThread]: 
[0m23:24:35.014554 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m23:24:35.019231 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m23:24:35.235995 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m23:24:35.235995 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m23:24:35.235995 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:24:35.720978 [debug] [ThreadPool]: SQL status: OK in 0.476 seconds
[0m23:24:35.729722 [debug] [ThreadPool]: On list_dev: Close
[0m23:24:35.733125 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m23:24:35.735452 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m23:24:35.770483 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m23:24:35.773569 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "create_dev_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m23:24:35.776142 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:24:35.780913 [debug] [ThreadPool]: SQL status: OK in 0.005 seconds
[0m23:24:35.787585 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m23:24:35.790117 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m23:24:35.793720 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m23:24:35.793720 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m23:24:35.799450 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "create_dev_main"} */

    
    
        create schema if not exists "dev"."main"
    
[0m23:24:35.801979 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m23:24:35.803602 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m23:24:35.808861 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m23:24:35.811666 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m23:24:35.815139 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m23:24:35.817828 [debug] [ThreadPool]: On create_dev_main: Close
[0m23:24:35.848481 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev_main'
[0m23:24:35.885962 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m23:24:35.888962 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m23:24:35.891829 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:24:35.896578 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m23:24:35.899325 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m23:24:35.901371 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m23:24:36.018515 [debug] [ThreadPool]: SQL status: OK in 0.116 seconds
[0m23:24:36.023050 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m23:24:36.031056 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m23:24:36.032605 [debug] [ThreadPool]: On list_dev_main: Close
[0m23:24:36.035831 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9621dc70-44cd-4e88-b10d-8d77c8ef481e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B95E7A2510>]}
[0m23:24:36.036932 [debug] [MainThread]: Using duckdb connection "master"
[0m23:24:36.037990 [debug] [MainThread]: On master: BEGIN
[0m23:24:36.037990 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:24:36.037990 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m23:24:36.037990 [debug] [MainThread]: On master: COMMIT
[0m23:24:36.037990 [debug] [MainThread]: Using duckdb connection "master"
[0m23:24:36.046071 [debug] [MainThread]: On master: COMMIT
[0m23:24:36.048681 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m23:24:36.067318 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-0"
[0m23:24:36.093979 [info ] [MainThread]: 1 of 10 START hook: stock_dbt_project.on-run-start.0 ........................... [RUN]
[0m23:24:36.096503 [debug] [MainThread]: Using duckdb connection "master"
[0m23:24:36.099049 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
INSTALL httpfs;
[0m23:24:36.099936 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m23:24:36.103490 [info ] [MainThread]: 1 of 10 OK hook: stock_dbt_project.on-run-start.0 .............................. [[32mOK[0m in 0.05s]
[0m23:24:36.113660 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-1"
[0m23:24:36.116661 [info ] [MainThread]: 2 of 10 START hook: stock_dbt_project.on-run-start.1 ........................... [RUN]
[0m23:24:36.119597 [debug] [MainThread]: Using duckdb connection "master"
[0m23:24:36.120603 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
INSTALL json;
[0m23:24:36.124691 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m23:24:36.129604 [info ] [MainThread]: 2 of 10 OK hook: stock_dbt_project.on-run-start.1 .............................. [[32mOK[0m in 0.03s]
[0m23:24:36.136105 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-2"
[0m23:24:36.138214 [info ] [MainThread]: 3 of 10 START hook: stock_dbt_project.on-run-start.2 ........................... [RUN]
[0m23:24:36.145068 [debug] [MainThread]: Using duckdb connection "master"
[0m23:24:36.149290 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
LOAD httpfs;
[0m23:24:36.152706 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m23:24:36.154704 [info ] [MainThread]: 3 of 10 OK hook: stock_dbt_project.on-run-start.2 .............................. [[32mOK[0m in 0.02s]
[0m23:24:36.162286 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-3"
[0m23:24:36.165831 [info ] [MainThread]: 4 of 10 START hook: stock_dbt_project.on-run-start.3 ........................... [RUN]
[0m23:24:36.167826 [debug] [MainThread]: Using duckdb connection "master"
[0m23:24:36.169910 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
LOAD json;
[0m23:24:36.170831 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m23:24:36.172926 [info ] [MainThread]: 4 of 10 OK hook: stock_dbt_project.on-run-start.3 .............................. [[32mOK[0m in 0.02s]
[0m23:24:36.180657 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-4"
[0m23:24:36.182657 [info ] [MainThread]: 5 of 10 START hook: stock_dbt_project.on-run-start.4 ........................... [RUN]
[0m23:24:36.185734 [debug] [MainThread]: Using duckdb connection "master"
[0m23:24:36.185734 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
SET s3_endpoint='http://localhost:9000';
[0m23:24:36.185734 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m23:24:36.185734 [info ] [MainThread]: 5 of 10 OK hook: stock_dbt_project.on-run-start.4 .............................. [[32mOK[0m in 0.01s]
[0m23:24:36.197727 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-5"
[0m23:24:36.201256 [info ] [MainThread]: 6 of 10 START hook: stock_dbt_project.on-run-start.5 ........................... [RUN]
[0m23:24:36.203822 [debug] [MainThread]: Using duckdb connection "master"
[0m23:24:36.205071 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
SET s3_access_key_id='minioadmin';
[0m23:24:36.206608 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m23:24:36.210825 [info ] [MainThread]: 6 of 10 OK hook: stock_dbt_project.on-run-start.5 .............................. [[32mOK[0m in 0.02s]
[0m23:24:36.215838 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-6"
[0m23:24:36.219414 [info ] [MainThread]: 7 of 10 START hook: stock_dbt_project.on-run-start.6 ........................... [RUN]
[0m23:24:36.219414 [debug] [MainThread]: Using duckdb connection "master"
[0m23:24:36.223127 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
SET s3_secret_access_key='minioadmin';
[0m23:24:36.225626 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m23:24:36.229644 [info ] [MainThread]: 7 of 10 OK hook: stock_dbt_project.on-run-start.6 .............................. [[32mOK[0m in 0.01s]
[0m23:24:36.234145 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-7"
[0m23:24:36.236149 [info ] [MainThread]: 8 of 10 START hook: stock_dbt_project.on-run-start.7 ........................... [RUN]
[0m23:24:36.237234 [debug] [MainThread]: Using duckdb connection "master"
[0m23:24:36.237234 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
SET s3_region='us-east-1';
[0m23:24:36.237234 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m23:24:36.246923 [info ] [MainThread]: 8 of 10 OK hook: stock_dbt_project.on-run-start.7 .............................. [[32mOK[0m in 0.02s]
[0m23:24:36.252405 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-8"
[0m23:24:36.259431 [info ] [MainThread]: 9 of 10 START hook: stock_dbt_project.on-run-start.8 ........................... [RUN]
[0m23:24:36.263444 [debug] [MainThread]: Using duckdb connection "master"
[0m23:24:36.265340 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
SET s3_use_ssl=false;
[0m23:24:36.267923 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m23:24:36.271052 [info ] [MainThread]: 9 of 10 OK hook: stock_dbt_project.on-run-start.8 .............................. [[32mOK[0m in 0.02s]
[0m23:24:36.272791 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-9"
[0m23:24:36.281506 [info ] [MainThread]: 10 of 10 START hook: stock_dbt_project.on-run-start.9 .......................... [RUN]
[0m23:24:36.284520 [debug] [MainThread]: Using duckdb connection "master"
[0m23:24:36.286672 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
SET s3_url_style='path';
[0m23:24:36.289342 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m23:24:36.299411 [info ] [MainThread]: 10 of 10 OK hook: stock_dbt_project.on-run-start.9 ............................. [[32mOK[0m in 0.03s]
[0m23:24:36.302426 [info ] [MainThread]: 
[0m23:24:36.303422 [debug] [MainThread]: On master: Close
[0m23:24:36.316541 [debug] [Thread-1 (]: Began running node model.stock_dbt_project.stg_stock_data
[0m23:24:36.318533 [info ] [Thread-1 (]: 1 of 1 START sql view model main.stg_stock_data ................................ [RUN]
[0m23:24:36.320170 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.stock_dbt_project.stg_stock_data'
[0m23:24:36.321648 [debug] [Thread-1 (]: Began compiling node model.stock_dbt_project.stg_stock_data
[0m23:24:36.335190 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_dbt_project.stg_stock_data"
[0m23:24:36.337412 [debug] [Thread-1 (]: Began executing node model.stock_dbt_project.stg_stock_data
[0m23:24:36.436093 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_dbt_project.stg_stock_data"
[0m23:24:36.437348 [debug] [Thread-1 (]: Using duckdb connection "model.stock_dbt_project.stg_stock_data"
[0m23:24:36.441421 [debug] [Thread-1 (]: On model.stock_dbt_project.stg_stock_data: BEGIN
[0m23:24:36.443443 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m23:24:36.444545 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m23:24:36.448295 [debug] [Thread-1 (]: Using duckdb connection "model.stock_dbt_project.stg_stock_data"
[0m23:24:36.452609 [debug] [Thread-1 (]: On model.stock_dbt_project.stg_stock_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "node_id": "model.stock_dbt_project.stg_stock_data"} */

  
  create view "dev"."main"."stg_stock_data__dbt_tmp" as (
    

WITH raw AS (
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/AAPL/2025/4/13/AAPL_20250413_111406_6ss1g0.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/AAPL/2025/4/13/AAPL_20250413_111507_vbodha.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/AAPL/2025/4/13/AAPL_20250413_111607_fg6ikl.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/AAPL/2025/4/13/AAPL_20250413_111707_meu1bb.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/AAPL/2025/4/17/AAPL_20250417_225502_nbggac.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/AAPL/2025/4/17/AAPL_20250417_225604_fpbwvo.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/AAPL/2025/4/17/AAPL_20250417_225706_mdcj3j.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/AAPL/2025/4/17/AAPL_20250417_235559_wnml5g.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/AMGN/2025/4/13/AMGN_20250413_111406_376tdf.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/AMGN/2025/4/13/AMGN_20250413_111707_6fyizj.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/AMGN/2025/4/13/AMGN_20250413_111807_wj4725.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/AMGN/2025/4/13/AMGN_20250413_111908_grof48.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/AMGN/2025/4/13/AMGN_20250413_112008_mqcblg.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/AMGN/2025/4/13/AMGN_20250413_112430_vzl3jo.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/AXP/2025/4/13/AXP_20250413_112043_rxe487.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/AXP/2025/4/13/AXP_20250413_112143_dy2f99.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/AXP/2025/4/13/AXP_20250413_112243_wpjnea.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/AXP/2025/4/13/AXP_20250413_112343_3ar95s.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/AXP/2025/4/13/AXP_20250413_112820_nmp10g.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/BA/2025/4/13/BA_20250413_112430_qjgzy0.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/BA/2025/4/13/BA_20250413_112530_xlerhn.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/BA/2025/4/13/BA_20250413_112630_ulftgu.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/BA/2025/4/13/BA_20250413_112730_hfrte0.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/BA/2025/4/13/BA_20250413_113208_zvt53x.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/CAT/2025/4/13/CAT_20250413_112820_v57z9v.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/CAT/2025/4/13/CAT_20250413_112920_sljvdt.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/CAT/2025/4/13/CAT_20250413_113020_hw41p1.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/CAT/2025/4/13/CAT_20250413_113120_ykrdew.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/CAT/2025/4/13/CAT_20250413_113555_97ycfk.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/CRM/2025/4/13/CRM_20250413_113208_xkovti.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/CRM/2025/4/13/CRM_20250413_113308_mgza12.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/CRM/2025/4/13/CRM_20250413_113408_9bqr6q.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/CRM/2025/4/13/CRM_20250413_113508_k34vp2.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/CRM/2025/4/13/CRM_20250413_113945_lkclxc.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/CSCO/2025/4/13/CSCO_20250413_113555_l9kwg7.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/CSCO/2025/4/13/CSCO_20250413_113655_izivyy.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/CSCO/2025/4/13/CSCO_20250413_113755_dt1x9y.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/CSCO/2025/4/13/CSCO_20250413_113855_c3r2g8.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/CSCO/2025/4/13/CSCO_20250413_114723_2fm9vb.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/CVX/2025/4/13/CVX_20250413_113945_jz58k4.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/CVX/2025/4/13/CVX_20250413_114046_wfeslb.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/CVX/2025/4/13/CVX_20250413_114146_gr7ke4.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/CVX/2025/4/13/CVX_20250413_114246_nnct9l.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/CVX/2025/4/13/CVX_20250413_114346_ft4rmb.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/DIS/2025/4/13/DIS_20250413_114346_oo2o7g.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/DIS/2025/4/13/DIS_20250413_114447_00dzv2.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/DIS/2025/4/13/DIS_20250413_114547_celsbg.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/DIS/2025/4/13/DIS_20250413_114647_l29qvy.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/DIS/2025/4/13/DIS_20250413_122154_00kf9h.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/DOW/2025/4/13/DOW_20250413_114723_5js7wg.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/DOW/2025/4/13/DOW_20250413_114823_ikbq60.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/DOW/2025/4/13/DOW_20250413_114924_v4k4vs.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/DOW/2025/4/13/DOW_20250413_115024_t1ze5o.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/DOW/2025/4/13/DOW_20250413_115124_z0yaap.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/GS/2025/4/13/GS_20250413_115124_k5wp1c.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/GS/2025/4/13/GS_20250413_115224_up2h60.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/GS/2025/4/13/GS_20250413_115324_kvaybg.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/GS/2025/4/13/GS_20250413_115424_p826ac.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/GS/2025/4/13/GS_20250413_115524_kaslf9.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/HD/2025/4/13/HD_20250413_115524_v565zl.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/HD/2025/4/13/HD_20250413_115624_m2ddoc.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/HD/2025/4/13/HD_20250413_115725_r0w0oc.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/HD/2025/4/13/HD_20250413_115825_ohauqk.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/HD/2025/4/13/HD_20250413_115925_52bquj.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/HON/2025/4/13/HON_20250413_115925_m22v5u.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/HON/2025/4/13/HON_20250413_120025_p6isvb.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/HON/2025/4/13/HON_20250413_120125_j4tlsk.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/HON/2025/4/13/HON_20250413_120225_jxmz5t.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/HON/2025/4/13/HON_20250413_120325_yjx3h3.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/IBM/2025/4/13/IBM_20250413_120326_5v31ap.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/IBM/2025/4/13/IBM_20250413_120426_v0zxjs.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/IBM/2025/4/13/IBM_20250413_120526_t0aet0.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/IBM/2025/4/13/IBM_20250413_120626_1mh4pe.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/IBM/2025/4/13/IBM_20250413_120726_q9scqg.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/INTC/2025/4/13/INTC_20250413_120726_tngyf4.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/INTC/2025/4/13/INTC_20250413_120827_pa0hww.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/INTC/2025/4/13/INTC_20250413_120927_n0bjos.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/INTC/2025/4/13/INTC_20250413_121027_6cnq4f.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/INTC/2025/4/13/INTC_20250413_121127_8gcjaq.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/JNJ/2025/4/13/JNJ_20250413_121027_d7pymv.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/JNJ/2025/4/13/JNJ_20250413_121127_1unfa3.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/JNJ/2025/4/13/JNJ_20250413_121227_0in9gv.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/JNJ/2025/4/13/JNJ_20250413_121327_n72dcw.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/JNJ/2025/4/13/JNJ_20250413_121428_77t0e9.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/JPM/2025/4/13/JPM_20250413_121428_2nx47p.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/JPM/2025/4/13/JPM_20250413_121528_lbr75v.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/JPM/2025/4/13/JPM_20250413_121628_an9e86.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/JPM/2025/4/13/JPM_20250413_121728_jbj8pq.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/JPM/2025/4/13/JPM_20250413_121828_lzta1f.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/KO/2025/4/13/KO_20250413_121828_giyj1f.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/KO/2025/4/13/KO_20250413_121929_r2lpld.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/KO/2025/4/13/KO_20250413_122029_19yvzy.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/KO/2025/4/13/KO_20250413_122129_nxv1nm.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/KO/2025/4/13/KO_20250413_123717_4aowb0.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/MCD/2025/4/13/MCD_20250413_122155_xjyi4f.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/MCD/2025/4/13/MCD_20250413_122255_zxb6im.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/MCD/2025/4/13/MCD_20250413_122355_1o2rjj.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/MCD/2025/4/13/MCD_20250413_122455_sw660e.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/MCD/2025/4/13/MCD_20250413_122555_bxprrb.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/MMM/2025/4/13/MMM_20250413_122555_v35yhq.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/MMM/2025/4/13/MMM_20250413_122655_3v0frs.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/MMM/2025/4/13/MMM_20250413_122755_yq3rsw.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/MMM/2025/4/13/MMM_20250413_122856_urd0jv.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/MMM/2025/4/13/MMM_20250413_122956_1sygy4.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/MRK/2025/4/13/MRK_20250413_122956_f3ddtt.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/MRK/2025/4/13/MRK_20250413_123056_1vzpgv.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/MRK/2025/4/13/MRK_20250413_123156_a4xt7c.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/MRK/2025/4/13/MRK_20250413_123257_24je3z.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/MRK/2025/4/13/MRK_20250413_123357_t7dxcs.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/MSFT/2025/4/13/MSFT_20250413_123357_pxhd4g.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/MSFT/2025/4/13/MSFT_20250413_123457_3lr87y.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/MSFT/2025/4/13/MSFT_20250413_123557_xcbu21.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/MSFT/2025/4/13/MSFT_20250413_123658_vsbw42.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/NKE/2025/4/13/NKE_20250413_123717_ewnsex.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/NKE/2025/4/13/NKE_20250413_123817_bh1dtd.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/NKE/2025/4/13/NKE_20250413_123917_5fp936.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/NKE/2025/4/13/NKE_20250413_124017_z26lw1.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/NKE/2025/4/13/NKE_20250413_124118_5pioe2.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/NKE/2025/4/13/NKE_20250413_124218_3qjysz.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/PG/2025/4/13/PG_20250413_124118_egc4nt.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/PG/2025/4/13/PG_20250413_124218_l9dtbw.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/PG/2025/4/13/PG_20250413_210538_qf1xkp.json')
)

SELECT
    CAST(symbol AS TEXT) AS symbol,
    CAST(datetime AS TIMESTAMP) AS datetime,
    CAST(open AS DOUBLE) AS open,
    CAST(high AS DOUBLE) AS high,
    CAST(low AS DOUBLE) AS low,
    CAST(close AS DOUBLE) AS close,
    CAST(volume AS BIGINT) AS volume
FROM raw
WHERE symbol IS NOT NULL AND datetime IS NOT NULL
  );

[0m23:24:40.881896 [debug] [Thread-1 (]: SQL status: OK in 4.424 seconds
[0m23:24:40.920316 [debug] [Thread-1 (]: Using duckdb connection "model.stock_dbt_project.stg_stock_data"
[0m23:24:40.922638 [debug] [Thread-1 (]: On model.stock_dbt_project.stg_stock_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "node_id": "model.stock_dbt_project.stg_stock_data"} */
alter view "dev"."main"."stg_stock_data" rename to "stg_stock_data__dbt_backup"
[0m23:24:40.926670 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m23:24:40.939750 [debug] [Thread-1 (]: Using duckdb connection "model.stock_dbt_project.stg_stock_data"
[0m23:24:40.942034 [debug] [Thread-1 (]: On model.stock_dbt_project.stg_stock_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "node_id": "model.stock_dbt_project.stg_stock_data"} */
alter view "dev"."main"."stg_stock_data__dbt_tmp" rename to "stg_stock_data"
[0m23:24:40.945751 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m23:24:40.995495 [debug] [Thread-1 (]: On model.stock_dbt_project.stg_stock_data: COMMIT
[0m23:24:40.998502 [debug] [Thread-1 (]: Using duckdb connection "model.stock_dbt_project.stg_stock_data"
[0m23:24:41.001493 [debug] [Thread-1 (]: On model.stock_dbt_project.stg_stock_data: COMMIT
[0m23:24:41.008455 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m23:24:41.027980 [debug] [Thread-1 (]: Using duckdb connection "model.stock_dbt_project.stg_stock_data"
[0m23:24:41.030970 [debug] [Thread-1 (]: On model.stock_dbt_project.stg_stock_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "node_id": "model.stock_dbt_project.stg_stock_data"} */
drop view if exists "dev"."main"."stg_stock_data__dbt_backup" cascade
[0m23:24:41.037745 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m23:24:41.047131 [debug] [Thread-1 (]: On model.stock_dbt_project.stg_stock_data: Close
[0m23:24:41.056601 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9621dc70-44cd-4e88-b10d-8d77c8ef481e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B959D97CB0>]}
[0m23:24:41.059603 [info ] [Thread-1 (]: 1 of 1 OK created sql view model main.stg_stock_data ........................... [[32mOK[0m in 4.73s]
[0m23:24:41.064057 [debug] [Thread-1 (]: Finished running node model.stock_dbt_project.stg_stock_data
[0m23:24:41.068057 [debug] [MainThread]: Using duckdb connection "master"
[0m23:24:41.069055 [debug] [MainThread]: On master: BEGIN
[0m23:24:41.071062 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:24:41.074052 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m23:24:41.077068 [debug] [MainThread]: On master: COMMIT
[0m23:24:41.079624 [debug] [MainThread]: Using duckdb connection "master"
[0m23:24:41.081627 [debug] [MainThread]: On master: COMMIT
[0m23:24:41.085621 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m23:24:41.087623 [debug] [MainThread]: On master: Close
[0m23:24:41.090865 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:24:41.093639 [debug] [MainThread]: Connection 'create_dev_main' was properly closed.
[0m23:24:41.096647 [debug] [MainThread]: Connection 'list_dev_main' was properly closed.
[0m23:24:41.097647 [debug] [MainThread]: Connection 'model.stock_dbt_project.stg_stock_data' was properly closed.
[0m23:24:41.100203 [info ] [MainThread]: 
[0m23:24:41.103201 [info ] [MainThread]: Finished running 10 project hooks, 1 view model in 0 hours 0 minutes and 6.09 seconds (6.09s).
[0m23:24:41.110772 [debug] [MainThread]: Command end result
[0m23:24:41.198342 [debug] [MainThread]: Wrote artifact WritableManifest to D:\Stock_price\stock_dbt_project\target\manifest.json
[0m23:24:41.203326 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\Stock_price\stock_dbt_project\target\semantic_manifest.json
[0m23:24:41.223763 [debug] [MainThread]: Wrote artifact RunExecutionResult to D:\Stock_price\stock_dbt_project\target\run_results.json
[0m23:24:41.226764 [info ] [MainThread]: 
[0m23:24:41.229761 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:24:41.233711 [info ] [MainThread]: 
[0m23:24:41.237925 [info ] [MainThread]: Done. PASS=11 WARN=0 ERROR=0 SKIP=0 TOTAL=11
[0m23:24:41.244354 [debug] [MainThread]: Command `dbt run` succeeded at 23:24:41.244354 after 15.02 seconds
[0m23:24:41.248352 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B9593B9100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B95C4B4800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B95C4B4FE0>]}
[0m23:24:41.251358 [debug] [MainThread]: Flushing usage events
[0m23:24:41.912389 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:25:37.554652 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026148E21A00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026148DC6E10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026148E20920>]}


============================== 23:25:37.570921 | 38ac3e12-3ad1-4d66-a4e0-52eb61d11161 ==============================
[0m23:25:37.570921 [info ] [MainThread]: Running with dbt=1.9.4
[0m23:25:37.570921 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\loges\\.dbt', 'log_path': 'D:\\Stock_price\\stock_dbt_project\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m23:25:38.068663 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '38ac3e12-3ad1-4d66-a4e0-52eb61d11161', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002614A5C2840>]}
[0m23:25:38.302934 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '38ac3e12-3ad1-4d66-a4e0-52eb61d11161', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002614A607530>]}
[0m23:25:38.320176 [info ] [MainThread]: Registered adapter: duckdb=1.9.2
[0m23:25:39.491603 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m23:25:40.419692 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:25:40.420250 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:25:40.437178 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.stock_dbt_project.marts
[0m23:25:40.610537 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '38ac3e12-3ad1-4d66-a4e0-52eb61d11161', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002614927F080>]}
[0m23:25:40.743179 [debug] [MainThread]: Wrote artifact WritableManifest to D:\Stock_price\stock_dbt_project\target\manifest.json
[0m23:25:40.747425 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\Stock_price\stock_dbt_project\target\semantic_manifest.json
[0m23:25:40.792148 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '38ac3e12-3ad1-4d66-a4e0-52eb61d11161', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002614A9CCB90>]}
[0m23:25:40.793597 [info ] [MainThread]: Found 5 models, 10 operations, 4 data tests, 426 macros
[0m23:25:40.794713 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '38ac3e12-3ad1-4d66-a4e0-52eb61d11161', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002614931FC50>]}
[0m23:25:40.798748 [info ] [MainThread]: 
[0m23:25:40.799845 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:25:40.800913 [info ] [MainThread]: 
[0m23:25:40.802001 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m23:25:40.811672 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m23:25:40.933854 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m23:25:40.934865 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m23:25:40.935508 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:25:41.432667 [debug] [ThreadPool]: SQL status: OK in 0.497 seconds
[0m23:25:41.440928 [debug] [ThreadPool]: On list_dev: Close
[0m23:25:41.445538 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m23:25:41.448625 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m23:25:41.488934 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m23:25:41.492130 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "create_dev_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m23:25:41.495777 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:25:41.503612 [debug] [ThreadPool]: SQL status: OK in 0.008 seconds
[0m23:25:41.513698 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m23:25:41.515536 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m23:25:41.518347 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m23:25:41.520589 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m23:25:41.521840 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "create_dev_main"} */

    
    
        create schema if not exists "dev"."main"
    
[0m23:25:41.522953 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m23:25:41.530952 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m23:25:41.532124 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m23:25:41.535177 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m23:25:41.536285 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m23:25:41.536285 [debug] [ThreadPool]: On create_dev_main: Close
[0m23:25:41.544892 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev_main'
[0m23:25:41.566839 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m23:25:41.566839 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m23:25:41.571369 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:25:41.577984 [debug] [ThreadPool]: SQL status: OK in 0.006 seconds
[0m23:25:41.578507 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m23:25:41.582863 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m23:25:41.666826 [debug] [ThreadPool]: SQL status: OK in 0.082 seconds
[0m23:25:41.672571 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m23:25:41.682051 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m23:25:41.683829 [debug] [ThreadPool]: On list_dev_main: Close
[0m23:25:41.688010 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '38ac3e12-3ad1-4d66-a4e0-52eb61d11161', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002614A6BDF10>]}
[0m23:25:41.691554 [debug] [MainThread]: Using duckdb connection "master"
[0m23:25:41.693963 [debug] [MainThread]: On master: BEGIN
[0m23:25:41.695641 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:25:41.697982 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m23:25:41.699085 [debug] [MainThread]: On master: COMMIT
[0m23:25:41.699085 [debug] [MainThread]: Using duckdb connection "master"
[0m23:25:41.699085 [debug] [MainThread]: On master: COMMIT
[0m23:25:41.699085 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m23:25:41.720651 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-0"
[0m23:25:41.733367 [info ] [MainThread]: 1 of 10 START hook: stock_dbt_project.on-run-start.0 ........................... [RUN]
[0m23:25:41.742959 [debug] [MainThread]: Using duckdb connection "master"
[0m23:25:41.744569 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
INSTALL httpfs;
[0m23:25:41.749530 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m23:25:41.752888 [info ] [MainThread]: 1 of 10 OK hook: stock_dbt_project.on-run-start.0 .............................. [[32mOK[0m in 0.05s]
[0m23:25:41.758836 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-1"
[0m23:25:41.763196 [info ] [MainThread]: 2 of 10 START hook: stock_dbt_project.on-run-start.1 ........................... [RUN]
[0m23:25:41.766464 [debug] [MainThread]: Using duckdb connection "master"
[0m23:25:41.768472 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
INSTALL json;
[0m23:25:41.772462 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m23:25:41.778337 [info ] [MainThread]: 2 of 10 OK hook: stock_dbt_project.on-run-start.1 .............................. [[32mOK[0m in 0.02s]
[0m23:25:41.787148 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-2"
[0m23:25:41.791439 [info ] [MainThread]: 3 of 10 START hook: stock_dbt_project.on-run-start.2 ........................... [RUN]
[0m23:25:41.793982 [debug] [MainThread]: Using duckdb connection "master"
[0m23:25:41.797045 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
LOAD httpfs;
[0m23:25:41.800693 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m23:25:41.803701 [info ] [MainThread]: 3 of 10 OK hook: stock_dbt_project.on-run-start.2 .............................. [[32mOK[0m in 0.02s]
[0m23:25:41.812194 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-3"
[0m23:25:41.816564 [info ] [MainThread]: 4 of 10 START hook: stock_dbt_project.on-run-start.3 ........................... [RUN]
[0m23:25:41.819764 [debug] [MainThread]: Using duckdb connection "master"
[0m23:25:41.821919 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
LOAD json;
[0m23:25:41.824913 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m23:25:41.830545 [info ] [MainThread]: 4 of 10 OK hook: stock_dbt_project.on-run-start.3 .............................. [[32mOK[0m in 0.02s]
[0m23:25:41.837608 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-4"
[0m23:25:41.839712 [info ] [MainThread]: 5 of 10 START hook: stock_dbt_project.on-run-start.4 ........................... [RUN]
[0m23:25:41.846760 [debug] [MainThread]: Using duckdb connection "master"
[0m23:25:41.849778 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
SET s3_endpoint='http://localhost:9000';
[0m23:25:41.851896 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m23:25:41.851896 [info ] [MainThread]: 5 of 10 OK hook: stock_dbt_project.on-run-start.4 .............................. [[32mOK[0m in 0.02s]
[0m23:25:41.865135 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-5"
[0m23:25:41.869933 [info ] [MainThread]: 6 of 10 START hook: stock_dbt_project.on-run-start.5 ........................... [RUN]
[0m23:25:41.872251 [debug] [MainThread]: Using duckdb connection "master"
[0m23:25:41.874822 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
SET s3_access_key_id='minioadmin';
[0m23:25:41.880181 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m23:25:41.884533 [info ] [MainThread]: 6 of 10 OK hook: stock_dbt_project.on-run-start.5 .............................. [[32mOK[0m in 0.02s]
[0m23:25:41.893284 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-6"
[0m23:25:41.898488 [info ] [MainThread]: 7 of 10 START hook: stock_dbt_project.on-run-start.6 ........................... [RUN]
[0m23:25:41.901486 [debug] [MainThread]: Using duckdb connection "master"
[0m23:25:41.901486 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
SET s3_secret_access_key='minioadmin';
[0m23:25:41.910562 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m23:25:41.916838 [info ] [MainThread]: 7 of 10 OK hook: stock_dbt_project.on-run-start.6 .............................. [[32mOK[0m in 0.03s]
[0m23:25:41.924037 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-7"
[0m23:25:41.933767 [info ] [MainThread]: 8 of 10 START hook: stock_dbt_project.on-run-start.7 ........................... [RUN]
[0m23:25:41.937245 [debug] [MainThread]: Using duckdb connection "master"
[0m23:25:41.940243 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
SET s3_region='us-east-1';
[0m23:25:41.947267 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m23:25:41.952883 [info ] [MainThread]: 8 of 10 OK hook: stock_dbt_project.on-run-start.7 .............................. [[32mOK[0m in 0.03s]
[0m23:25:41.963419 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-8"
[0m23:25:41.968064 [info ] [MainThread]: 9 of 10 START hook: stock_dbt_project.on-run-start.8 ........................... [RUN]
[0m23:25:41.970805 [debug] [MainThread]: Using duckdb connection "master"
[0m23:25:41.972396 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
SET s3_use_ssl=false;
[0m23:25:41.976350 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m23:25:41.980901 [info ] [MainThread]: 9 of 10 OK hook: stock_dbt_project.on-run-start.8 .............................. [[32mOK[0m in 0.02s]
[0m23:25:41.991087 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-9"
[0m23:25:41.993778 [info ] [MainThread]: 10 of 10 START hook: stock_dbt_project.on-run-start.9 .......................... [RUN]
[0m23:25:41.998063 [debug] [MainThread]: Using duckdb connection "master"
[0m23:25:42.000062 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
SET s3_url_style='path';
[0m23:25:42.001090 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m23:25:42.003836 [info ] [MainThread]: 10 of 10 OK hook: stock_dbt_project.on-run-start.9 ............................. [[32mOK[0m in 0.02s]
[0m23:25:42.003836 [info ] [MainThread]: 
[0m23:25:42.007965 [debug] [MainThread]: On master: Close
[0m23:25:42.018737 [debug] [Thread-1 (]: Began running node model.stock_dbt_project.my_first_dbt_model
[0m23:25:42.022942 [info ] [Thread-1 (]: 1 of 5 START sql table model main.my_first_dbt_model ........................... [RUN]
[0m23:25:42.027715 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.stock_dbt_project.my_first_dbt_model'
[0m23:25:42.028703 [debug] [Thread-1 (]: Began compiling node model.stock_dbt_project.my_first_dbt_model
[0m23:25:42.033318 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_dbt_project.my_first_dbt_model"
[0m23:25:42.033318 [debug] [Thread-1 (]: Began executing node model.stock_dbt_project.my_first_dbt_model
[0m23:25:42.164497 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_dbt_project.my_first_dbt_model"
[0m23:25:42.167493 [debug] [Thread-1 (]: Using duckdb connection "model.stock_dbt_project.my_first_dbt_model"
[0m23:25:42.170120 [debug] [Thread-1 (]: On model.stock_dbt_project.my_first_dbt_model: BEGIN
[0m23:25:42.171913 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m23:25:42.177334 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m23:25:42.179378 [debug] [Thread-1 (]: Using duckdb connection "model.stock_dbt_project.my_first_dbt_model"
[0m23:25:42.181370 [debug] [Thread-1 (]: On model.stock_dbt_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "node_id": "model.stock_dbt_project.my_first_dbt_model"} */

  
    
    

    create  table
      "dev"."main"."my_first_dbt_model__dbt_tmp"
  
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
  
[0m23:25:42.191471 [debug] [Thread-1 (]: SQL status: OK in 0.009 seconds
[0m23:25:42.209753 [debug] [Thread-1 (]: Using duckdb connection "model.stock_dbt_project.my_first_dbt_model"
[0m23:25:42.211586 [debug] [Thread-1 (]: On model.stock_dbt_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "node_id": "model.stock_dbt_project.my_first_dbt_model"} */
alter table "dev"."main"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m23:25:42.216181 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m23:25:42.302655 [debug] [Thread-1 (]: On model.stock_dbt_project.my_first_dbt_model: COMMIT
[0m23:25:42.302655 [debug] [Thread-1 (]: Using duckdb connection "model.stock_dbt_project.my_first_dbt_model"
[0m23:25:42.302655 [debug] [Thread-1 (]: On model.stock_dbt_project.my_first_dbt_model: COMMIT
[0m23:25:42.316004 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m23:25:42.336834 [debug] [Thread-1 (]: Using duckdb connection "model.stock_dbt_project.my_first_dbt_model"
[0m23:25:42.345166 [debug] [Thread-1 (]: On model.stock_dbt_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "node_id": "model.stock_dbt_project.my_first_dbt_model"} */
drop table if exists "dev"."main"."my_first_dbt_model__dbt_backup" cascade
[0m23:25:42.356068 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m23:25:42.375999 [debug] [Thread-1 (]: On model.stock_dbt_project.my_first_dbt_model: Close
[0m23:25:42.388866 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '38ac3e12-3ad1-4d66-a4e0-52eb61d11161', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002614A605820>]}
[0m23:25:42.398539 [info ] [Thread-1 (]: 1 of 5 OK created sql table model main.my_first_dbt_model ...................... [[32mOK[0m in 0.35s]
[0m23:25:42.405397 [debug] [Thread-1 (]: Finished running node model.stock_dbt_project.my_first_dbt_model
[0m23:25:42.411090 [debug] [Thread-1 (]: Began running node model.stock_dbt_project.read_csv
[0m23:25:42.419350 [info ] [Thread-1 (]: 2 of 5 START sql table model main.read_csv ..................................... [RUN]
[0m23:25:42.424297 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.stock_dbt_project.my_first_dbt_model, now model.stock_dbt_project.read_csv)
[0m23:25:42.427726 [debug] [Thread-1 (]: Began compiling node model.stock_dbt_project.read_csv
[0m23:25:42.443917 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_dbt_project.read_csv"
[0m23:25:42.452631 [debug] [Thread-1 (]: Began executing node model.stock_dbt_project.read_csv
[0m23:25:42.469180 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_dbt_project.read_csv"
[0m23:25:42.480036 [debug] [Thread-1 (]: Using duckdb connection "model.stock_dbt_project.read_csv"
[0m23:25:42.483101 [debug] [Thread-1 (]: On model.stock_dbt_project.read_csv: BEGIN
[0m23:25:42.485646 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:25:42.490353 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m23:25:42.495434 [debug] [Thread-1 (]: Using duckdb connection "model.stock_dbt_project.read_csv"
[0m23:25:42.499378 [debug] [Thread-1 (]: On model.stock_dbt_project.read_csv: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "node_id": "model.stock_dbt_project.read_csv"} */

  
    
    

    create  table
      "dev"."main"."read_csv__dbt_tmp"
  
    as (
      



-- Read all stocks from all symbols and dates
SELECT 
    json_extract_string(value, '$.symbol') AS symbol,
    json_extract_string(value, '$.datetime') AS datetime,
    json_extract_double(value, '$.open') AS open,
    json_extract_double(value, '$.high') AS high,
    json_extract_double(value, '$.low') AS low,
    json_extract_double(value, '$.close') AS close,
    json_extract_double(value, '$.volume') AS volume
FROM 
    read_ndjson_auto('s3://my-stock-data-bucket/stocks/CVX/2025/4/13/CVX_20250413_113945_jz58k4.json')
    );
  
  
[0m23:25:44.429689 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "node_id": "model.stock_dbt_project.read_csv"} */

  
    
    

    create  table
      "dev"."main"."read_csv__dbt_tmp"
  
    as (
      



-- Read all stocks from all symbols and dates
SELECT 
    json_extract_string(value, '$.symbol') AS symbol,
    json_extract_string(value, '$.datetime') AS datetime,
    json_extract_double(value, '$.open') AS open,
    json_extract_double(value, '$.high') AS high,
    json_extract_double(value, '$.low') AS low,
    json_extract_double(value, '$.close') AS close,
    json_extract_double(value, '$.volume') AS volume
FROM 
    read_ndjson_auto('s3://my-stock-data-bucket/stocks/CVX/2025/4/13/CVX_20250413_113945_jz58k4.json')
    );
  
  
[0m23:25:44.430691 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m23:25:44.431847 [debug] [Thread-1 (]: On model.stock_dbt_project.read_csv: ROLLBACK
[0m23:25:44.444270 [debug] [Thread-1 (]: Failed to rollback 'model.stock_dbt_project.read_csv'
[0m23:25:44.446018 [debug] [Thread-1 (]: On model.stock_dbt_project.read_csv: Close
[0m23:25:44.463088 [debug] [Thread-1 (]: Runtime Error in model read_csv (models\read_csv.sql)
  HTTP Error: HTTP GET error on 'https://my-stock-data-bucket.s3.amazonaws.com/stocks/CVX/2025/4/13/CVX_20250413_113945_jz58k4.json' (HTTP 400)
[0m23:25:44.467448 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '38ac3e12-3ad1-4d66-a4e0-52eb61d11161', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002614A6BD880>]}
[0m23:25:44.473165 [error] [Thread-1 (]: 2 of 5 ERROR creating sql table model main.read_csv ............................ [[31mERROR[0m in 2.04s]
[0m23:25:44.483026 [debug] [Thread-1 (]: Finished running node model.stock_dbt_project.read_csv
[0m23:25:44.487400 [debug] [Thread-1 (]: Began running node model.stock_dbt_project.stg_stock_data
[0m23:25:44.491490 [debug] [Thread-4 (]: Marking all children of 'model.stock_dbt_project.read_csv' to be skipped because of status 'error'.  Reason: Runtime Error in model read_csv (models\read_csv.sql)
  HTTP Error: HTTP GET error on 'https://my-stock-data-bucket.s3.amazonaws.com/stocks/CVX/2025/4/13/CVX_20250413_113945_jz58k4.json' (HTTP 400).
[0m23:25:44.495643 [info ] [Thread-1 (]: 3 of 5 START sql view model main.stg_stock_data ................................ [RUN]
[0m23:25:44.504208 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.stock_dbt_project.read_csv, now model.stock_dbt_project.stg_stock_data)
[0m23:25:44.509963 [debug] [Thread-1 (]: Began compiling node model.stock_dbt_project.stg_stock_data
[0m23:25:44.530309 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_dbt_project.stg_stock_data"
[0m23:25:44.534822 [debug] [Thread-1 (]: Began executing node model.stock_dbt_project.stg_stock_data
[0m23:25:44.618724 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_dbt_project.stg_stock_data"
[0m23:25:44.621815 [debug] [Thread-1 (]: Using duckdb connection "model.stock_dbt_project.stg_stock_data"
[0m23:25:44.626663 [debug] [Thread-1 (]: On model.stock_dbt_project.stg_stock_data: BEGIN
[0m23:25:44.630201 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:25:44.633077 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m23:25:44.635126 [debug] [Thread-1 (]: Using duckdb connection "model.stock_dbt_project.stg_stock_data"
[0m23:25:44.638175 [debug] [Thread-1 (]: On model.stock_dbt_project.stg_stock_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "node_id": "model.stock_dbt_project.stg_stock_data"} */

  
  create view "dev"."main"."stg_stock_data__dbt_tmp" as (
    

WITH raw AS (
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/AAPL/2025/4/13/AAPL_20250413_111406_6ss1g0.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/AAPL/2025/4/13/AAPL_20250413_111507_vbodha.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/AAPL/2025/4/13/AAPL_20250413_111607_fg6ikl.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/AAPL/2025/4/13/AAPL_20250413_111707_meu1bb.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/AAPL/2025/4/17/AAPL_20250417_225502_nbggac.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/AAPL/2025/4/17/AAPL_20250417_225604_fpbwvo.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/AAPL/2025/4/17/AAPL_20250417_225706_mdcj3j.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/AAPL/2025/4/17/AAPL_20250417_235559_wnml5g.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/AMGN/2025/4/13/AMGN_20250413_111406_376tdf.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/AMGN/2025/4/13/AMGN_20250413_111707_6fyizj.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/AMGN/2025/4/13/AMGN_20250413_111807_wj4725.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/AMGN/2025/4/13/AMGN_20250413_111908_grof48.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/AMGN/2025/4/13/AMGN_20250413_112008_mqcblg.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/AMGN/2025/4/13/AMGN_20250413_112430_vzl3jo.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/AXP/2025/4/13/AXP_20250413_112043_rxe487.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/AXP/2025/4/13/AXP_20250413_112143_dy2f99.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/AXP/2025/4/13/AXP_20250413_112243_wpjnea.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/AXP/2025/4/13/AXP_20250413_112343_3ar95s.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/AXP/2025/4/13/AXP_20250413_112820_nmp10g.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/BA/2025/4/13/BA_20250413_112430_qjgzy0.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/BA/2025/4/13/BA_20250413_112530_xlerhn.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/BA/2025/4/13/BA_20250413_112630_ulftgu.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/BA/2025/4/13/BA_20250413_112730_hfrte0.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/BA/2025/4/13/BA_20250413_113208_zvt53x.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/CAT/2025/4/13/CAT_20250413_112820_v57z9v.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/CAT/2025/4/13/CAT_20250413_112920_sljvdt.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/CAT/2025/4/13/CAT_20250413_113020_hw41p1.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/CAT/2025/4/13/CAT_20250413_113120_ykrdew.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/CAT/2025/4/13/CAT_20250413_113555_97ycfk.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/CRM/2025/4/13/CRM_20250413_113208_xkovti.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/CRM/2025/4/13/CRM_20250413_113308_mgza12.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/CRM/2025/4/13/CRM_20250413_113408_9bqr6q.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/CRM/2025/4/13/CRM_20250413_113508_k34vp2.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/CRM/2025/4/13/CRM_20250413_113945_lkclxc.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/CSCO/2025/4/13/CSCO_20250413_113555_l9kwg7.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/CSCO/2025/4/13/CSCO_20250413_113655_izivyy.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/CSCO/2025/4/13/CSCO_20250413_113755_dt1x9y.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/CSCO/2025/4/13/CSCO_20250413_113855_c3r2g8.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/CSCO/2025/4/13/CSCO_20250413_114723_2fm9vb.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/CVX/2025/4/13/CVX_20250413_113945_jz58k4.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/CVX/2025/4/13/CVX_20250413_114046_wfeslb.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/CVX/2025/4/13/CVX_20250413_114146_gr7ke4.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/CVX/2025/4/13/CVX_20250413_114246_nnct9l.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/CVX/2025/4/13/CVX_20250413_114346_ft4rmb.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/DIS/2025/4/13/DIS_20250413_114346_oo2o7g.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/DIS/2025/4/13/DIS_20250413_114447_00dzv2.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/DIS/2025/4/13/DIS_20250413_114547_celsbg.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/DIS/2025/4/13/DIS_20250413_114647_l29qvy.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/DIS/2025/4/13/DIS_20250413_122154_00kf9h.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/DOW/2025/4/13/DOW_20250413_114723_5js7wg.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/DOW/2025/4/13/DOW_20250413_114823_ikbq60.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/DOW/2025/4/13/DOW_20250413_114924_v4k4vs.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/DOW/2025/4/13/DOW_20250413_115024_t1ze5o.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/DOW/2025/4/13/DOW_20250413_115124_z0yaap.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/GS/2025/4/13/GS_20250413_115124_k5wp1c.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/GS/2025/4/13/GS_20250413_115224_up2h60.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/GS/2025/4/13/GS_20250413_115324_kvaybg.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/GS/2025/4/13/GS_20250413_115424_p826ac.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/GS/2025/4/13/GS_20250413_115524_kaslf9.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/HD/2025/4/13/HD_20250413_115524_v565zl.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/HD/2025/4/13/HD_20250413_115624_m2ddoc.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/HD/2025/4/13/HD_20250413_115725_r0w0oc.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/HD/2025/4/13/HD_20250413_115825_ohauqk.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/HD/2025/4/13/HD_20250413_115925_52bquj.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/HON/2025/4/13/HON_20250413_115925_m22v5u.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/HON/2025/4/13/HON_20250413_120025_p6isvb.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/HON/2025/4/13/HON_20250413_120125_j4tlsk.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/HON/2025/4/13/HON_20250413_120225_jxmz5t.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/HON/2025/4/13/HON_20250413_120325_yjx3h3.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/IBM/2025/4/13/IBM_20250413_120326_5v31ap.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/IBM/2025/4/13/IBM_20250413_120426_v0zxjs.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/IBM/2025/4/13/IBM_20250413_120526_t0aet0.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/IBM/2025/4/13/IBM_20250413_120626_1mh4pe.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/IBM/2025/4/13/IBM_20250413_120726_q9scqg.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/INTC/2025/4/13/INTC_20250413_120726_tngyf4.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/INTC/2025/4/13/INTC_20250413_120827_pa0hww.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/INTC/2025/4/13/INTC_20250413_120927_n0bjos.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/INTC/2025/4/13/INTC_20250413_121027_6cnq4f.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/INTC/2025/4/13/INTC_20250413_121127_8gcjaq.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/JNJ/2025/4/13/JNJ_20250413_121027_d7pymv.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/JNJ/2025/4/13/JNJ_20250413_121127_1unfa3.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/JNJ/2025/4/13/JNJ_20250413_121227_0in9gv.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/JNJ/2025/4/13/JNJ_20250413_121327_n72dcw.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/JNJ/2025/4/13/JNJ_20250413_121428_77t0e9.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/JPM/2025/4/13/JPM_20250413_121428_2nx47p.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/JPM/2025/4/13/JPM_20250413_121528_lbr75v.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/JPM/2025/4/13/JPM_20250413_121628_an9e86.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/JPM/2025/4/13/JPM_20250413_121728_jbj8pq.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/JPM/2025/4/13/JPM_20250413_121828_lzta1f.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/KO/2025/4/13/KO_20250413_121828_giyj1f.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/KO/2025/4/13/KO_20250413_121929_r2lpld.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/KO/2025/4/13/KO_20250413_122029_19yvzy.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/KO/2025/4/13/KO_20250413_122129_nxv1nm.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/KO/2025/4/13/KO_20250413_123717_4aowb0.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/MCD/2025/4/13/MCD_20250413_122155_xjyi4f.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/MCD/2025/4/13/MCD_20250413_122255_zxb6im.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/MCD/2025/4/13/MCD_20250413_122355_1o2rjj.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/MCD/2025/4/13/MCD_20250413_122455_sw660e.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/MCD/2025/4/13/MCD_20250413_122555_bxprrb.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/MMM/2025/4/13/MMM_20250413_122555_v35yhq.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/MMM/2025/4/13/MMM_20250413_122655_3v0frs.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/MMM/2025/4/13/MMM_20250413_122755_yq3rsw.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/MMM/2025/4/13/MMM_20250413_122856_urd0jv.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/MMM/2025/4/13/MMM_20250413_122956_1sygy4.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/MRK/2025/4/13/MRK_20250413_122956_f3ddtt.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/MRK/2025/4/13/MRK_20250413_123056_1vzpgv.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/MRK/2025/4/13/MRK_20250413_123156_a4xt7c.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/MRK/2025/4/13/MRK_20250413_123257_24je3z.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/MRK/2025/4/13/MRK_20250413_123357_t7dxcs.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/MSFT/2025/4/13/MSFT_20250413_123357_pxhd4g.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/MSFT/2025/4/13/MSFT_20250413_123457_3lr87y.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/MSFT/2025/4/13/MSFT_20250413_123557_xcbu21.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/MSFT/2025/4/13/MSFT_20250413_123658_vsbw42.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/NKE/2025/4/13/NKE_20250413_123717_ewnsex.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/NKE/2025/4/13/NKE_20250413_123817_bh1dtd.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/NKE/2025/4/13/NKE_20250413_123917_5fp936.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/NKE/2025/4/13/NKE_20250413_124017_z26lw1.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/NKE/2025/4/13/NKE_20250413_124118_5pioe2.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/NKE/2025/4/13/NKE_20250413_124218_3qjysz.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/PG/2025/4/13/PG_20250413_124118_egc4nt.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/PG/2025/4/13/PG_20250413_124218_l9dtbw.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/PG/2025/4/13/PG_20250413_210538_qf1xkp.json')
)

SELECT
    CAST(symbol AS TEXT) AS symbol,
    CAST(datetime AS TIMESTAMP) AS datetime,
    CAST(open AS DOUBLE) AS open,
    CAST(high AS DOUBLE) AS high,
    CAST(low AS DOUBLE) AS low,
    CAST(close AS DOUBLE) AS close,
    CAST(volume AS BIGINT) AS volume
FROM raw
WHERE symbol IS NOT NULL AND datetime IS NOT NULL
  );

[0m23:25:49.000914 [debug] [Thread-1 (]: SQL status: OK in 4.359 seconds
[0m23:25:49.028287 [debug] [Thread-1 (]: Using duckdb connection "model.stock_dbt_project.stg_stock_data"
[0m23:25:49.031883 [debug] [Thread-1 (]: On model.stock_dbt_project.stg_stock_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "node_id": "model.stock_dbt_project.stg_stock_data"} */
alter view "dev"."main"."stg_stock_data" rename to "stg_stock_data__dbt_backup"
[0m23:25:49.038301 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m23:25:49.066733 [debug] [Thread-1 (]: Using duckdb connection "model.stock_dbt_project.stg_stock_data"
[0m23:25:49.070583 [debug] [Thread-1 (]: On model.stock_dbt_project.stg_stock_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "node_id": "model.stock_dbt_project.stg_stock_data"} */
alter view "dev"."main"."stg_stock_data__dbt_tmp" rename to "stg_stock_data"
[0m23:25:49.077962 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m23:25:49.110713 [debug] [Thread-1 (]: On model.stock_dbt_project.stg_stock_data: COMMIT
[0m23:25:49.115369 [debug] [Thread-1 (]: Using duckdb connection "model.stock_dbt_project.stg_stock_data"
[0m23:25:49.131631 [debug] [Thread-1 (]: On model.stock_dbt_project.stg_stock_data: COMMIT
[0m23:25:49.148561 [debug] [Thread-1 (]: SQL status: OK in 0.011 seconds
[0m23:25:49.166475 [debug] [Thread-1 (]: Using duckdb connection "model.stock_dbt_project.stg_stock_data"
[0m23:25:49.177010 [debug] [Thread-1 (]: On model.stock_dbt_project.stg_stock_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "node_id": "model.stock_dbt_project.stg_stock_data"} */
drop view if exists "dev"."main"."stg_stock_data__dbt_backup" cascade
[0m23:25:49.184214 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m23:25:49.197962 [debug] [Thread-1 (]: On model.stock_dbt_project.stg_stock_data: Close
[0m23:25:49.202062 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '38ac3e12-3ad1-4d66-a4e0-52eb61d11161', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002614AFF1640>]}
[0m23:25:49.210634 [info ] [Thread-1 (]: 3 of 5 OK created sql view model main.stg_stock_data ........................... [[32mOK[0m in 4.70s]
[0m23:25:49.222621 [debug] [Thread-1 (]: Finished running node model.stock_dbt_project.stg_stock_data
[0m23:25:49.231050 [debug] [Thread-1 (]: Began running node model.stock_dbt_project.my_second_dbt_model
[0m23:25:49.236331 [info ] [Thread-1 (]: 4 of 5 START sql table model main.my_second_dbt_model .......................... [RUN]
[0m23:25:49.240890 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.stock_dbt_project.stg_stock_data, now model.stock_dbt_project.my_second_dbt_model)
[0m23:25:49.244448 [debug] [Thread-1 (]: Began compiling node model.stock_dbt_project.my_second_dbt_model
[0m23:25:49.271676 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_dbt_project.my_second_dbt_model"
[0m23:25:49.295074 [debug] [Thread-1 (]: Began executing node model.stock_dbt_project.my_second_dbt_model
[0m23:25:49.327760 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_dbt_project.my_second_dbt_model"
[0m23:25:49.351891 [debug] [Thread-1 (]: Using duckdb connection "model.stock_dbt_project.my_second_dbt_model"
[0m23:25:49.355086 [debug] [Thread-1 (]: On model.stock_dbt_project.my_second_dbt_model: BEGIN
[0m23:25:49.358482 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:25:49.369027 [debug] [Thread-1 (]: SQL status: OK in 0.010 seconds
[0m23:25:49.372615 [debug] [Thread-1 (]: Using duckdb connection "model.stock_dbt_project.my_second_dbt_model"
[0m23:25:49.376224 [debug] [Thread-1 (]: On model.stock_dbt_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "node_id": "model.stock_dbt_project.my_second_dbt_model"} */

  
    
    

    create  table
      "dev"."main"."my_second_dbt_model__dbt_tmp"
  
    as (
      -- Use the `ref` function to select from other models

select *
from "dev"."main"."my_first_dbt_model"
where id = 1
    );
  
  
[0m23:25:49.418102 [debug] [Thread-1 (]: SQL status: OK in 0.035 seconds
[0m23:25:49.464189 [debug] [Thread-1 (]: Using duckdb connection "model.stock_dbt_project.my_second_dbt_model"
[0m23:25:49.473673 [debug] [Thread-1 (]: On model.stock_dbt_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "node_id": "model.stock_dbt_project.my_second_dbt_model"} */
alter table "dev"."main"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m23:25:49.482837 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m23:25:49.504596 [debug] [Thread-1 (]: On model.stock_dbt_project.my_second_dbt_model: COMMIT
[0m23:25:49.516620 [debug] [Thread-1 (]: Using duckdb connection "model.stock_dbt_project.my_second_dbt_model"
[0m23:25:49.526522 [debug] [Thread-1 (]: On model.stock_dbt_project.my_second_dbt_model: COMMIT
[0m23:25:49.533509 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m23:25:49.548451 [debug] [Thread-1 (]: Using duckdb connection "model.stock_dbt_project.my_second_dbt_model"
[0m23:25:49.552322 [debug] [Thread-1 (]: On model.stock_dbt_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "node_id": "model.stock_dbt_project.my_second_dbt_model"} */
drop table if exists "dev"."main"."my_second_dbt_model__dbt_backup" cascade
[0m23:25:49.556177 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m23:25:49.568454 [debug] [Thread-1 (]: On model.stock_dbt_project.my_second_dbt_model: Close
[0m23:25:49.572162 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '38ac3e12-3ad1-4d66-a4e0-52eb61d11161', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002614B01E360>]}
[0m23:25:49.577164 [info ] [Thread-1 (]: 4 of 5 OK created sql table model main.my_second_dbt_model ..................... [[32mOK[0m in 0.33s]
[0m23:25:49.586172 [debug] [Thread-1 (]: Finished running node model.stock_dbt_project.my_second_dbt_model
[0m23:25:49.591630 [debug] [Thread-1 (]: Began running node model.stock_dbt_project.features_stock_data
[0m23:25:49.596126 [info ] [Thread-1 (]: 5 of 5 START sql table model main.features_stock_data .......................... [RUN]
[0m23:25:49.600218 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.stock_dbt_project.my_second_dbt_model, now model.stock_dbt_project.features_stock_data)
[0m23:25:49.606916 [debug] [Thread-1 (]: Began compiling node model.stock_dbt_project.features_stock_data
[0m23:25:49.630139 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_dbt_project.features_stock_data"
[0m23:25:49.636904 [debug] [Thread-1 (]: Began executing node model.stock_dbt_project.features_stock_data
[0m23:25:49.662791 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_dbt_project.features_stock_data"
[0m23:25:49.682363 [debug] [Thread-1 (]: Using duckdb connection "model.stock_dbt_project.features_stock_data"
[0m23:25:49.686521 [debug] [Thread-1 (]: On model.stock_dbt_project.features_stock_data: BEGIN
[0m23:25:49.691710 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:25:49.693774 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m23:25:49.702095 [debug] [Thread-1 (]: Using duckdb connection "model.stock_dbt_project.features_stock_data"
[0m23:25:49.705749 [debug] [Thread-1 (]: On model.stock_dbt_project.features_stock_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "node_id": "model.stock_dbt_project.features_stock_data"} */

  
    
    

    create  table
      "dev"."main"."features_stock_data__dbt_tmp"
  
    as (
      

WITH base AS (
    SELECT
        symbol,
        datetime,
        open,
        high,
        low,
        close,
        volume,
        
        -- Previous close for daily return
        LAG(close, 1) OVER (PARTITION BY symbol ORDER BY datetime) AS prev_close,

        -- Rolling 5-period average and stddev of close
        AVG(close) OVER (
            PARTITION BY symbol 
            ORDER BY datetime 
            ROWS BETWEEN 4 PRECEDING AND CURRENT ROW
        ) AS rolling_avg_5,

        STDDEV(close) OVER (
            PARTITION BY symbol 
            ORDER BY datetime 
            ROWS BETWEEN 4 PRECEDING AND CURRENT ROW
        ) AS rolling_std_5,

        -- Daily price range
        (high - low) AS daily_range,

        -- Rolling 5-period average of volume
        AVG(volume) OVER (
            PARTITION BY symbol 
            ORDER BY datetime 
            ROWS BETWEEN 4 PRECEDING AND CURRENT ROW
        ) AS avg_volume_5
    FROM "dev"."main"."stg_stock_data"
),

features AS (
    SELECT
        *,
        
        -- Daily return percentage
        CASE 
            WHEN prev_close IS NOT NULL AND prev_close != 0 THEN 
                ((close - prev_close) / prev_close) * 100
            ELSE NULL
        END AS daily_return,

        -- Volume ratio compared to rolling average
        CASE 
            WHEN avg_volume_5 IS NOT NULL AND avg_volume_5 != 0 THEN 
                volume / avg_volume_5
            ELSE NULL
        END AS volume_ratio,

        -- Rolling volatility based on daily return
        STDDEV(
            CASE 
                WHEN prev_close IS NOT NULL AND prev_close != 0 THEN 
                    ((close - prev_close) / prev_close) * 100
                ELSE NULL
            END
        ) OVER (
            PARTITION BY symbol 
            ORDER BY datetime 
            ROWS BETWEEN 9 PRECEDING AND CURRENT ROW
        ) AS rolling_volatility_10
    FROM base
)

SELECT * FROM features
    );
  
  
[0m23:25:58.018358 [debug] [Thread-1 (]: SQL status: OK in 8.306 seconds
[0m23:25:58.031384 [debug] [Thread-1 (]: Using duckdb connection "model.stock_dbt_project.features_stock_data"
[0m23:25:58.033586 [debug] [Thread-1 (]: On model.stock_dbt_project.features_stock_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "node_id": "model.stock_dbt_project.features_stock_data"} */
alter table "dev"."main"."features_stock_data__dbt_tmp" rename to "features_stock_data"
[0m23:25:58.036228 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m23:25:58.043302 [debug] [Thread-1 (]: On model.stock_dbt_project.features_stock_data: COMMIT
[0m23:25:58.045893 [debug] [Thread-1 (]: Using duckdb connection "model.stock_dbt_project.features_stock_data"
[0m23:25:58.048354 [debug] [Thread-1 (]: On model.stock_dbt_project.features_stock_data: COMMIT
[0m23:25:58.065700 [debug] [Thread-1 (]: SQL status: OK in 0.016 seconds
[0m23:25:58.075876 [debug] [Thread-1 (]: Using duckdb connection "model.stock_dbt_project.features_stock_data"
[0m23:25:58.079407 [debug] [Thread-1 (]: On model.stock_dbt_project.features_stock_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "node_id": "model.stock_dbt_project.features_stock_data"} */
drop table if exists "dev"."main"."features_stock_data__dbt_backup" cascade
[0m23:25:58.082424 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m23:25:58.088747 [debug] [Thread-1 (]: On model.stock_dbt_project.features_stock_data: Close
[0m23:25:58.091857 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '38ac3e12-3ad1-4d66-a4e0-52eb61d11161', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002614B067710>]}
[0m23:25:58.095384 [info ] [Thread-1 (]: 5 of 5 OK created sql table model main.features_stock_data ..................... [[32mOK[0m in 8.49s]
[0m23:25:58.099118 [debug] [Thread-1 (]: Finished running node model.stock_dbt_project.features_stock_data
[0m23:25:58.103431 [debug] [MainThread]: Using duckdb connection "master"
[0m23:25:58.105447 [debug] [MainThread]: On master: BEGIN
[0m23:25:58.107442 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:25:58.109442 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m23:25:58.111453 [debug] [MainThread]: On master: COMMIT
[0m23:25:58.113564 [debug] [MainThread]: Using duckdb connection "master"
[0m23:25:58.114562 [debug] [MainThread]: On master: COMMIT
[0m23:25:58.116557 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m23:25:58.117553 [debug] [MainThread]: On master: Close
[0m23:25:58.118559 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:25:58.119997 [debug] [MainThread]: Connection 'create_dev_main' was properly closed.
[0m23:25:58.121019 [debug] [MainThread]: Connection 'list_dev_main' was properly closed.
[0m23:25:58.122014 [debug] [MainThread]: Connection 'model.stock_dbt_project.features_stock_data' was properly closed.
[0m23:25:58.124019 [info ] [MainThread]: 
[0m23:25:58.126009 [info ] [MainThread]: Finished running 10 project hooks, 4 table models, 1 view model in 0 hours 0 minutes and 17.32 seconds (17.32s).
[0m23:25:58.135079 [debug] [MainThread]: Command end result
[0m23:25:58.203674 [debug] [MainThread]: Wrote artifact WritableManifest to D:\Stock_price\stock_dbt_project\target\manifest.json
[0m23:25:58.211268 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\Stock_price\stock_dbt_project\target\semantic_manifest.json
[0m23:25:58.229706 [debug] [MainThread]: Wrote artifact RunExecutionResult to D:\Stock_price\stock_dbt_project\target\run_results.json
[0m23:25:58.231708 [info ] [MainThread]: 
[0m23:25:58.233703 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m23:25:58.234702 [info ] [MainThread]: 
[0m23:25:58.236708 [error] [MainThread]:   Runtime Error in model read_csv (models\read_csv.sql)
  HTTP Error: HTTP GET error on 'https://my-stock-data-bucket.s3.amazonaws.com/stocks/CVX/2025/4/13/CVX_20250413_113945_jz58k4.json' (HTTP 400)
[0m23:25:58.238348 [info ] [MainThread]: 
[0m23:25:58.241903 [info ] [MainThread]: Done. PASS=14 WARN=0 ERROR=1 SKIP=0 TOTAL=15
[0m23:25:58.247961 [debug] [MainThread]: Command `dbt run` failed at 23:25:58.246442 after 20.96 seconds
[0m23:25:58.251106 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026148DC6E10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000261491A16A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002614A9A7E00>]}
[0m23:25:58.253453 [debug] [MainThread]: Flushing usage events
[0m23:25:59.281781 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:38:02.007903 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016D651D6600>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016D6753F410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016D66F0FD40>]}


============================== 01:38:02.017350 | 6b0ef115-0088-4a3e-85e5-407db9374cd3 ==============================
[0m01:38:02.017350 [info ] [MainThread]: Running with dbt=1.9.4
[0m01:38:02.019584 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'D:\\Stock_price\\stock_dbt_project\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\loges\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run --select stg_stock_data', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m01:38:02.490566 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6b0ef115-0088-4a3e-85e5-407db9374cd3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016D66C2F3E0>]}
[0m01:38:02.562956 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6b0ef115-0088-4a3e-85e5-407db9374cd3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016D66CFCDA0>]}
[0m01:38:02.590486 [info ] [MainThread]: Registered adapter: duckdb=1.9.2
[0m01:38:03.084000 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m01:38:04.883962 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 0 files added, 1 files changed.
[0m01:38:04.884963 [debug] [MainThread]: Partial parsing: deleted file: stock_dbt_project://models\read_csv.sql
[0m01:38:04.886480 [debug] [MainThread]: Partial parsing: updated file: stock_dbt_project://models\features_stock_data.sql
[0m01:38:05.235295 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.stock_dbt_project.marts
[0m01:38:05.243837 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6b0ef115-0088-4a3e-85e5-407db9374cd3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016D68E1D0D0>]}
[0m01:38:05.348231 [debug] [MainThread]: Wrote artifact WritableManifest to D:\Stock_price\stock_dbt_project\target\manifest.json
[0m01:38:05.372658 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\Stock_price\stock_dbt_project\target\semantic_manifest.json
[0m01:38:05.461085 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6b0ef115-0088-4a3e-85e5-407db9374cd3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016D68F49100>]}
[0m01:38:05.461085 [info ] [MainThread]: Found 4 models, 10 operations, 4 data tests, 426 macros
[0m01:38:05.463002 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6b0ef115-0088-4a3e-85e5-407db9374cd3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016D68F37A70>]}
[0m01:38:05.466026 [info ] [MainThread]: 
[0m01:38:05.467602 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:38:05.469643 [info ] [MainThread]: 
[0m01:38:05.470607 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m01:38:05.473681 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m01:38:09.740818 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m01:38:09.742335 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m01:38:09.743344 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:38:09.947011 [debug] [ThreadPool]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m01:38:09.949032 [debug] [ThreadPool]: DuckDB adapter: Rolling back transaction.
[0m01:38:09.950017 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:38:09.950017 [debug] [MainThread]: Connection 'list_dev' was properly closed.
[0m01:38:09.951020 [info ] [MainThread]: 
[0m01:38:09.952587 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 4.48 seconds (4.48s).
[0m01:38:09.954074 [error] [MainThread]: Encountered an error:
Runtime Error
  IO Error: File is already open in 
  C:\Users\loges\miniconda3\python.exe (PID 22160)
[0m01:38:09.956656 [debug] [MainThread]: Command `dbt run` failed at 01:38:09.956143 after 8.20 seconds
[0m01:38:09.957819 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016D651D6600>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016D67714350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016D68F07CE0>]}
[0m01:38:09.958453 [debug] [MainThread]: Flushing usage events
[0m01:38:11.622925 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:44:30.163912 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ECA5339070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ECA4287B60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ECA4982B10>]}


============================== 01:44:30.175097 | 6caacf5f-2242-402d-ba93-1b533812d81b ==============================
[0m01:44:30.175097 [info ] [MainThread]: Running with dbt=1.9.4
[0m01:44:30.177260 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\loges\\.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'D:\\Stock_price\\stock_dbt_project\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select stg_stock_data', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m01:44:30.533014 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6caacf5f-2242-402d-ba93-1b533812d81b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ECA5846FC0>]}
[0m01:44:30.604609 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6caacf5f-2242-402d-ba93-1b533812d81b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ECA6A6FE90>]}
[0m01:44:30.611598 [info ] [MainThread]: Registered adapter: duckdb=1.9.2
[0m01:44:30.912546 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m01:44:31.106072 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:44:31.107073 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:44:31.116210 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.stock_dbt_project.marts
[0m01:44:31.164973 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6caacf5f-2242-402d-ba93-1b533812d81b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ECA6B673B0>]}
[0m01:44:31.268545 [debug] [MainThread]: Wrote artifact WritableManifest to D:\Stock_price\stock_dbt_project\target\manifest.json
[0m01:44:31.273550 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\Stock_price\stock_dbt_project\target\semantic_manifest.json
[0m01:44:31.325435 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6caacf5f-2242-402d-ba93-1b533812d81b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ECA6A6DE20>]}
[0m01:44:31.326938 [info ] [MainThread]: Found 4 models, 10 operations, 4 data tests, 426 macros
[0m01:44:31.328943 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6caacf5f-2242-402d-ba93-1b533812d81b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ECA6EAE450>]}
[0m01:44:31.334327 [info ] [MainThread]: 
[0m01:44:31.335624 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:44:31.336687 [info ] [MainThread]: 
[0m01:44:31.338417 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m01:44:31.340195 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m01:44:31.443403 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m01:44:31.444306 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m01:44:31.445365 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:44:31.665582 [debug] [ThreadPool]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m01:44:31.667288 [debug] [ThreadPool]: DuckDB adapter: Rolling back transaction.
[0m01:44:31.669263 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:44:31.670182 [debug] [MainThread]: Connection 'list_dev' was properly closed.
[0m01:44:31.670182 [info ] [MainThread]: 
[0m01:44:31.671171 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.33 seconds (0.33s).
[0m01:44:31.673219 [error] [MainThread]: Encountered an error:
Runtime Error
  IO Error: File is already open in 
  C:\Users\loges\miniconda3\python.exe (PID 22160)
[0m01:44:31.674168 [debug] [MainThread]: Command `dbt run` failed at 01:44:31.674168 after 1.76 seconds
[0m01:44:31.675175 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ECA5794230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ECA6E64620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ECA58AD130>]}
[0m01:44:31.676196 [debug] [MainThread]: Flushing usage events
[0m01:44:34.177239 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:45:05.479046 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012D406D81A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012D435335F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012D4317E1B0>]}


============================== 01:45:05.486123 | c01727ba-af68-46c5-a9ec-a8aeed720133 ==============================
[0m01:45:05.486123 [info ] [MainThread]: Running with dbt=1.9.4
[0m01:45:05.487151 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\loges\\.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'D:\\Stock_price\\stock_dbt_project\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run --select stg_stock_data', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m01:45:05.782780 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c01727ba-af68-46c5-a9ec-a8aeed720133', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012D43ADED20>]}
[0m01:45:05.851145 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c01727ba-af68-46c5-a9ec-a8aeed720133', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012D43B0C200>]}
[0m01:45:05.860112 [info ] [MainThread]: Registered adapter: duckdb=1.9.2
[0m01:45:06.116222 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m01:45:06.313836 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:45:06.314837 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:45:06.323192 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.stock_dbt_project.marts
[0m01:45:06.382211 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c01727ba-af68-46c5-a9ec-a8aeed720133', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012D44D954F0>]}
[0m01:45:06.511037 [debug] [MainThread]: Wrote artifact WritableManifest to D:\Stock_price\stock_dbt_project\target\manifest.json
[0m01:45:06.515885 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\Stock_price\stock_dbt_project\target\semantic_manifest.json
[0m01:45:06.555360 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c01727ba-af68-46c5-a9ec-a8aeed720133', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012D4512EBD0>]}
[0m01:45:06.555360 [info ] [MainThread]: Found 4 models, 10 operations, 4 data tests, 426 macros
[0m01:45:06.557876 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c01727ba-af68-46c5-a9ec-a8aeed720133', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012D43A63F20>]}
[0m01:45:06.559875 [info ] [MainThread]: 
[0m01:45:06.560876 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:45:06.560876 [info ] [MainThread]: 
[0m01:45:06.561874 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m01:45:06.563875 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m01:45:06.672619 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m01:45:06.673737 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m01:45:06.674945 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:45:06.871448 [debug] [ThreadPool]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m01:45:06.872469 [debug] [ThreadPool]: DuckDB adapter: Rolling back transaction.
[0m01:45:06.874397 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:45:06.874397 [debug] [MainThread]: Connection 'list_dev' was properly closed.
[0m01:45:06.875398 [info ] [MainThread]: 
[0m01:45:06.876910 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.31 seconds (0.31s).
[0m01:45:06.878948 [error] [MainThread]: Encountered an error:
Runtime Error
  IO Error: File is already open in 
  C:\Users\loges\miniconda3\python.exe (PID 22160)
[0m01:45:06.881919 [debug] [MainThread]: Command `dbt run` failed at 01:45:06.880964 after 1.61 seconds
[0m01:45:06.881919 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012D431585C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012D4512F740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012D44D95DF0>]}
[0m01:45:06.882939 [debug] [MainThread]: Flushing usage events
[0m01:45:08.113255 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:45:47.007122 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CCE7678410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CCEA995C40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CCEA995730>]}


============================== 01:45:47.020353 | d9f72ac8-074b-43b0-8b7b-b5a329e325cc ==============================
[0m01:45:47.020353 [info ] [MainThread]: Running with dbt=1.9.4
[0m01:45:47.022473 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\loges\\.dbt', 'log_path': 'D:\\Stock_price\\stock_dbt_project\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run --select stg_stock_data', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m01:45:47.431977 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd9f72ac8-074b-43b0-8b7b-b5a329e325cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CCE9EAEBD0>]}
[0m01:45:47.553351 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd9f72ac8-074b-43b0-8b7b-b5a329e325cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CCEA36EE10>]}
[0m01:45:47.559527 [info ] [MainThread]: Registered adapter: duckdb=1.9.2
[0m01:45:47.956827 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m01:45:48.174318 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:45:48.175910 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:45:48.183857 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.stock_dbt_project.marts
[0m01:45:48.234057 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd9f72ac8-074b-43b0-8b7b-b5a329e325cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CCEBD0E630>]}
[0m01:45:48.339063 [debug] [MainThread]: Wrote artifact WritableManifest to D:\Stock_price\stock_dbt_project\target\manifest.json
[0m01:45:48.341062 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\Stock_price\stock_dbt_project\target\semantic_manifest.json
[0m01:45:48.379825 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd9f72ac8-074b-43b0-8b7b-b5a329e325cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CCEBEB4230>]}
[0m01:45:48.380346 [info ] [MainThread]: Found 4 models, 10 operations, 4 data tests, 426 macros
[0m01:45:48.381885 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd9f72ac8-074b-43b0-8b7b-b5a329e325cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CCEBF46780>]}
[0m01:45:48.384533 [info ] [MainThread]: 
[0m01:45:48.386053 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:45:48.387241 [info ] [MainThread]: 
[0m01:45:48.388260 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m01:45:48.391944 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m01:45:48.514682 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m01:45:48.516291 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m01:45:48.516809 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:45:50.168471 [debug] [ThreadPool]: SQL status: OK in 1.652 seconds
[0m01:45:50.171463 [debug] [ThreadPool]: On list_dev: Close
[0m01:45:50.172478 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m01:45:50.174456 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m01:45:50.185306 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m01:45:50.186896 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "create_dev_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m01:45:50.187981 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:45:50.191974 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m01:45:50.195676 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m01:45:50.199584 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m01:45:50.201814 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m01:45:50.202848 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m01:45:50.204586 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "create_dev_main"} */

    
    
        create schema if not exists "dev"."main"
    
[0m01:45:50.208859 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m01:45:50.212119 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m01:45:50.213699 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m01:45:50.214239 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m01:45:50.215286 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m01:45:50.216805 [debug] [ThreadPool]: On create_dev_main: Close
[0m01:45:50.226077 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev_main'
[0m01:45:50.239695 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m01:45:50.242211 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m01:45:50.243228 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:45:50.243228 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m01:45:50.244734 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m01:45:50.244734 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m01:45:50.284253 [debug] [ThreadPool]: SQL status: OK in 0.038 seconds
[0m01:45:50.286768 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m01:45:50.311446 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m01:45:50.313533 [debug] [ThreadPool]: On list_dev_main: Close
[0m01:45:50.316825 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd9f72ac8-074b-43b0-8b7b-b5a329e325cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CCEC015940>]}
[0m01:45:50.317832 [debug] [MainThread]: Using duckdb connection "master"
[0m01:45:50.318929 [debug] [MainThread]: On master: BEGIN
[0m01:45:50.319991 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:45:50.320939 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m01:45:50.320939 [debug] [MainThread]: On master: COMMIT
[0m01:45:50.321942 [debug] [MainThread]: Using duckdb connection "master"
[0m01:45:50.321942 [debug] [MainThread]: On master: COMMIT
[0m01:45:50.324457 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m01:45:50.340163 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-0"
[0m01:45:50.355124 [info ] [MainThread]: 1 of 10 START hook: stock_dbt_project.on-run-start.0 ........................... [RUN]
[0m01:45:50.357225 [debug] [MainThread]: Using duckdb connection "master"
[0m01:45:50.359515 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
INSTALL httpfs;
[0m01:45:50.362974 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m01:45:50.366188 [info ] [MainThread]: 1 of 10 OK hook: stock_dbt_project.on-run-start.0 .............................. [[32mOK[0m in 0.04s]
[0m01:45:50.370890 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-1"
[0m01:45:50.374381 [info ] [MainThread]: 2 of 10 START hook: stock_dbt_project.on-run-start.1 ........................... [RUN]
[0m01:45:50.376037 [debug] [MainThread]: Using duckdb connection "master"
[0m01:45:50.377693 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
INSTALL json;
[0m01:45:50.381013 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m01:45:50.382588 [info ] [MainThread]: 2 of 10 OK hook: stock_dbt_project.on-run-start.1 .............................. [[32mOK[0m in 0.02s]
[0m01:45:50.385192 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-2"
[0m01:45:50.387299 [info ] [MainThread]: 3 of 10 START hook: stock_dbt_project.on-run-start.2 ........................... [RUN]
[0m01:45:50.388877 [debug] [MainThread]: Using duckdb connection "master"
[0m01:45:50.391401 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
LOAD httpfs;
[0m01:45:50.392948 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m01:45:50.395466 [info ] [MainThread]: 3 of 10 OK hook: stock_dbt_project.on-run-start.2 .............................. [[32mOK[0m in 0.01s]
[0m01:45:50.401572 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-3"
[0m01:45:50.403091 [info ] [MainThread]: 4 of 10 START hook: stock_dbt_project.on-run-start.3 ........................... [RUN]
[0m01:45:50.407198 [debug] [MainThread]: Using duckdb connection "master"
[0m01:45:50.407721 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
LOAD json;
[0m01:45:50.409738 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m01:45:50.411740 [info ] [MainThread]: 4 of 10 OK hook: stock_dbt_project.on-run-start.3 .............................. [[32mOK[0m in 0.01s]
[0m01:45:50.415269 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-4"
[0m01:45:50.416773 [info ] [MainThread]: 5 of 10 START hook: stock_dbt_project.on-run-start.4 ........................... [RUN]
[0m01:45:50.419293 [debug] [MainThread]: Using duckdb connection "master"
[0m01:45:50.420726 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
SET s3_endpoint='http://localhost:9000';
[0m01:45:50.422735 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m01:45:50.425735 [info ] [MainThread]: 5 of 10 OK hook: stock_dbt_project.on-run-start.4 .............................. [[32mOK[0m in 0.01s]
[0m01:45:50.431821 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-5"
[0m01:45:50.433819 [info ] [MainThread]: 6 of 10 START hook: stock_dbt_project.on-run-start.5 ........................... [RUN]
[0m01:45:50.436117 [debug] [MainThread]: Using duckdb connection "master"
[0m01:45:50.437204 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
SET s3_access_key_id='minioadmin';
[0m01:45:50.438232 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m01:45:50.440240 [info ] [MainThread]: 6 of 10 OK hook: stock_dbt_project.on-run-start.5 .............................. [[32mOK[0m in 0.01s]
[0m01:45:50.447526 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-6"
[0m01:45:50.450856 [info ] [MainThread]: 7 of 10 START hook: stock_dbt_project.on-run-start.6 ........................... [RUN]
[0m01:45:50.451866 [debug] [MainThread]: Using duckdb connection "master"
[0m01:45:50.452876 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
SET s3_secret_access_key='minioadmin';
[0m01:45:50.454880 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m01:45:50.456958 [info ] [MainThread]: 7 of 10 OK hook: stock_dbt_project.on-run-start.6 .............................. [[32mOK[0m in 0.01s]
[0m01:45:50.461498 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-7"
[0m01:45:50.465498 [info ] [MainThread]: 8 of 10 START hook: stock_dbt_project.on-run-start.7 ........................... [RUN]
[0m01:45:50.469038 [debug] [MainThread]: Using duckdb connection "master"
[0m01:45:50.470035 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
SET s3_region='us-east-1';
[0m01:45:50.471543 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m01:45:50.474064 [info ] [MainThread]: 8 of 10 OK hook: stock_dbt_project.on-run-start.7 .............................. [[32mOK[0m in 0.01s]
[0m01:45:50.477064 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-8"
[0m01:45:50.479561 [info ] [MainThread]: 9 of 10 START hook: stock_dbt_project.on-run-start.8 ........................... [RUN]
[0m01:45:50.481417 [debug] [MainThread]: Using duckdb connection "master"
[0m01:45:50.483729 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
SET s3_use_ssl=false;
[0m01:45:50.486196 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m01:45:50.489210 [info ] [MainThread]: 9 of 10 OK hook: stock_dbt_project.on-run-start.8 .............................. [[32mOK[0m in 0.01s]
[0m01:45:50.493139 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-9"
[0m01:45:50.493139 [info ] [MainThread]: 10 of 10 START hook: stock_dbt_project.on-run-start.9 .......................... [RUN]
[0m01:45:50.495673 [debug] [MainThread]: Using duckdb connection "master"
[0m01:45:50.497267 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
SET s3_url_style='path';
[0m01:45:50.499233 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m01:45:50.500251 [info ] [MainThread]: 10 of 10 OK hook: stock_dbt_project.on-run-start.9 ............................. [[32mOK[0m in 0.01s]
[0m01:45:50.502185 [info ] [MainThread]: 
[0m01:45:50.503509 [debug] [MainThread]: On master: Close
[0m01:45:50.511381 [debug] [Thread-1 (]: Began running node model.stock_dbt_project.stg_stock_data
[0m01:45:50.513401 [info ] [Thread-1 (]: 1 of 1 START sql view model main.stg_stock_data ................................ [RUN]
[0m01:45:50.514576 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.stock_dbt_project.stg_stock_data'
[0m01:45:50.516086 [debug] [Thread-1 (]: Began compiling node model.stock_dbt_project.stg_stock_data
[0m01:45:50.522696 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_dbt_project.stg_stock_data"
[0m01:45:50.524697 [debug] [Thread-1 (]: Began executing node model.stock_dbt_project.stg_stock_data
[0m01:45:50.577753 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_dbt_project.stg_stock_data"
[0m01:45:50.581336 [debug] [Thread-1 (]: Using duckdb connection "model.stock_dbt_project.stg_stock_data"
[0m01:45:50.582556 [debug] [Thread-1 (]: On model.stock_dbt_project.stg_stock_data: BEGIN
[0m01:45:50.583565 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m01:45:50.585574 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:45:50.586081 [debug] [Thread-1 (]: Using duckdb connection "model.stock_dbt_project.stg_stock_data"
[0m01:45:50.587785 [debug] [Thread-1 (]: On model.stock_dbt_project.stg_stock_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "node_id": "model.stock_dbt_project.stg_stock_data"} */

  
  create view "dev"."main"."stg_stock_data__dbt_tmp" as (
    

WITH raw AS (
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/AAPL/2025/4/13/AAPL_20250413_111406_6ss1g0.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/AAPL/2025/4/13/AAPL_20250413_111507_vbodha.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/AAPL/2025/4/13/AAPL_20250413_111607_fg6ikl.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/AAPL/2025/4/13/AAPL_20250413_111707_meu1bb.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/AAPL/2025/4/17/AAPL_20250417_225502_nbggac.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/AAPL/2025/4/17/AAPL_20250417_225604_fpbwvo.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/AAPL/2025/4/17/AAPL_20250417_225706_mdcj3j.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/AAPL/2025/4/17/AAPL_20250417_235559_wnml5g.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/AMGN/2025/4/13/AMGN_20250413_111406_376tdf.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/AMGN/2025/4/13/AMGN_20250413_111707_6fyizj.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/AMGN/2025/4/13/AMGN_20250413_111807_wj4725.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/AMGN/2025/4/13/AMGN_20250413_111908_grof48.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/AMGN/2025/4/13/AMGN_20250413_112008_mqcblg.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/AMGN/2025/4/13/AMGN_20250413_112430_vzl3jo.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/AXP/2025/4/13/AXP_20250413_112043_rxe487.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/AXP/2025/4/13/AXP_20250413_112143_dy2f99.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/AXP/2025/4/13/AXP_20250413_112243_wpjnea.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/AXP/2025/4/13/AXP_20250413_112343_3ar95s.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/AXP/2025/4/13/AXP_20250413_112820_nmp10g.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/BA/2025/4/13/BA_20250413_112430_qjgzy0.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/BA/2025/4/13/BA_20250413_112530_xlerhn.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/BA/2025/4/13/BA_20250413_112630_ulftgu.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/BA/2025/4/13/BA_20250413_112730_hfrte0.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/BA/2025/4/13/BA_20250413_113208_zvt53x.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/CAT/2025/4/13/CAT_20250413_112820_v57z9v.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/CAT/2025/4/13/CAT_20250413_112920_sljvdt.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/CAT/2025/4/13/CAT_20250413_113020_hw41p1.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/CAT/2025/4/13/CAT_20250413_113120_ykrdew.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/CAT/2025/4/13/CAT_20250413_113555_97ycfk.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/CRM/2025/4/13/CRM_20250413_113208_xkovti.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/CRM/2025/4/13/CRM_20250413_113308_mgza12.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/CRM/2025/4/13/CRM_20250413_113408_9bqr6q.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/CRM/2025/4/13/CRM_20250413_113508_k34vp2.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/CRM/2025/4/13/CRM_20250413_113945_lkclxc.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/CSCO/2025/4/13/CSCO_20250413_113555_l9kwg7.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/CSCO/2025/4/13/CSCO_20250413_113655_izivyy.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/CSCO/2025/4/13/CSCO_20250413_113755_dt1x9y.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/CSCO/2025/4/13/CSCO_20250413_113855_c3r2g8.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/CSCO/2025/4/13/CSCO_20250413_114723_2fm9vb.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/CVX/2025/4/13/CVX_20250413_113945_jz58k4.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/CVX/2025/4/13/CVX_20250413_114046_wfeslb.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/CVX/2025/4/13/CVX_20250413_114146_gr7ke4.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/CVX/2025/4/13/CVX_20250413_114246_nnct9l.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/CVX/2025/4/13/CVX_20250413_114346_ft4rmb.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/DIS/2025/4/13/DIS_20250413_114346_oo2o7g.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/DIS/2025/4/13/DIS_20250413_114447_00dzv2.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/DIS/2025/4/13/DIS_20250413_114547_celsbg.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/DIS/2025/4/13/DIS_20250413_114647_l29qvy.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/DIS/2025/4/13/DIS_20250413_122154_00kf9h.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/DOW/2025/4/13/DOW_20250413_114723_5js7wg.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/DOW/2025/4/13/DOW_20250413_114823_ikbq60.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/DOW/2025/4/13/DOW_20250413_114924_v4k4vs.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/DOW/2025/4/13/DOW_20250413_115024_t1ze5o.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/DOW/2025/4/13/DOW_20250413_115124_z0yaap.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/GS/2025/4/13/GS_20250413_115124_k5wp1c.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/GS/2025/4/13/GS_20250413_115224_up2h60.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/GS/2025/4/13/GS_20250413_115324_kvaybg.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/GS/2025/4/13/GS_20250413_115424_p826ac.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/GS/2025/4/13/GS_20250413_115524_kaslf9.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/HD/2025/4/13/HD_20250413_115524_v565zl.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/HD/2025/4/13/HD_20250413_115624_m2ddoc.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/HD/2025/4/13/HD_20250413_115725_r0w0oc.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/HD/2025/4/13/HD_20250413_115825_ohauqk.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/HD/2025/4/13/HD_20250413_115925_52bquj.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/HON/2025/4/13/HON_20250413_115925_m22v5u.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/HON/2025/4/13/HON_20250413_120025_p6isvb.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/HON/2025/4/13/HON_20250413_120125_j4tlsk.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/HON/2025/4/13/HON_20250413_120225_jxmz5t.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/HON/2025/4/13/HON_20250413_120325_yjx3h3.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/IBM/2025/4/13/IBM_20250413_120326_5v31ap.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/IBM/2025/4/13/IBM_20250413_120426_v0zxjs.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/IBM/2025/4/13/IBM_20250413_120526_t0aet0.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/IBM/2025/4/13/IBM_20250413_120626_1mh4pe.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/IBM/2025/4/13/IBM_20250413_120726_q9scqg.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/INTC/2025/4/13/INTC_20250413_120726_tngyf4.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/INTC/2025/4/13/INTC_20250413_120827_pa0hww.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/INTC/2025/4/13/INTC_20250413_120927_n0bjos.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/INTC/2025/4/13/INTC_20250413_121027_6cnq4f.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/INTC/2025/4/13/INTC_20250413_121127_8gcjaq.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/JNJ/2025/4/13/JNJ_20250413_121027_d7pymv.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/JNJ/2025/4/13/JNJ_20250413_121127_1unfa3.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/JNJ/2025/4/13/JNJ_20250413_121227_0in9gv.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/JNJ/2025/4/13/JNJ_20250413_121327_n72dcw.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/JNJ/2025/4/13/JNJ_20250413_121428_77t0e9.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/JPM/2025/4/13/JPM_20250413_121428_2nx47p.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/JPM/2025/4/13/JPM_20250413_121528_lbr75v.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/JPM/2025/4/13/JPM_20250413_121628_an9e86.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/JPM/2025/4/13/JPM_20250413_121728_jbj8pq.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/JPM/2025/4/13/JPM_20250413_121828_lzta1f.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/KO/2025/4/13/KO_20250413_121828_giyj1f.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/KO/2025/4/13/KO_20250413_121929_r2lpld.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/KO/2025/4/13/KO_20250413_122029_19yvzy.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/KO/2025/4/13/KO_20250413_122129_nxv1nm.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/KO/2025/4/13/KO_20250413_123717_4aowb0.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/MCD/2025/4/13/MCD_20250413_122155_xjyi4f.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/MCD/2025/4/13/MCD_20250413_122255_zxb6im.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/MCD/2025/4/13/MCD_20250413_122355_1o2rjj.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/MCD/2025/4/13/MCD_20250413_122455_sw660e.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/MCD/2025/4/13/MCD_20250413_122555_bxprrb.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/MMM/2025/4/13/MMM_20250413_122555_v35yhq.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/MMM/2025/4/13/MMM_20250413_122655_3v0frs.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/MMM/2025/4/13/MMM_20250413_122755_yq3rsw.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/MMM/2025/4/13/MMM_20250413_122856_urd0jv.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/MMM/2025/4/13/MMM_20250413_122956_1sygy4.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/MRK/2025/4/13/MRK_20250413_122956_f3ddtt.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/MRK/2025/4/13/MRK_20250413_123056_1vzpgv.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/MRK/2025/4/13/MRK_20250413_123156_a4xt7c.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/MRK/2025/4/13/MRK_20250413_123257_24je3z.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/MRK/2025/4/13/MRK_20250413_123357_t7dxcs.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/MSFT/2025/4/13/MSFT_20250413_123357_pxhd4g.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/MSFT/2025/4/13/MSFT_20250413_123457_3lr87y.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/MSFT/2025/4/13/MSFT_20250413_123557_xcbu21.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/MSFT/2025/4/13/MSFT_20250413_123658_vsbw42.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/NKE/2025/4/13/NKE_20250413_123717_ewnsex.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/NKE/2025/4/13/NKE_20250413_123817_bh1dtd.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/NKE/2025/4/13/NKE_20250413_123917_5fp936.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/NKE/2025/4/13/NKE_20250413_124017_z26lw1.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/NKE/2025/4/13/NKE_20250413_124118_5pioe2.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/NKE/2025/4/13/NKE_20250413_124218_3qjysz.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/PG/2025/4/13/PG_20250413_124118_egc4nt.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/PG/2025/4/13/PG_20250413_124218_l9dtbw.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/PG/2025/4/13/PG_20250413_210538_qf1xkp.json')
)

SELECT
    CAST(symbol AS TEXT) AS symbol,
    CAST(datetime AS TIMESTAMP) AS datetime,
    CAST(open AS DOUBLE) AS open,
    CAST(high AS DOUBLE) AS high,
    CAST(low AS DOUBLE) AS low,
    CAST(close AS DOUBLE) AS close,
    CAST(volume AS BIGINT) AS volume
FROM raw
WHERE symbol IS NOT NULL AND datetime IS NOT NULL
  );

[0m01:45:53.818168 [debug] [Thread-1 (]: SQL status: OK in 3.229 seconds
[0m01:45:53.826913 [debug] [Thread-1 (]: Using duckdb connection "model.stock_dbt_project.stg_stock_data"
[0m01:45:53.827921 [debug] [Thread-1 (]: On model.stock_dbt_project.stg_stock_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "node_id": "model.stock_dbt_project.stg_stock_data"} */
alter view "dev"."main"."stg_stock_data" rename to "stg_stock_data__dbt_backup"
[0m01:45:53.830918 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m01:45:53.835581 [debug] [Thread-1 (]: Using duckdb connection "model.stock_dbt_project.stg_stock_data"
[0m01:45:53.837093 [debug] [Thread-1 (]: On model.stock_dbt_project.stg_stock_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "node_id": "model.stock_dbt_project.stg_stock_data"} */
alter view "dev"."main"."stg_stock_data__dbt_tmp" rename to "stg_stock_data"
[0m01:45:53.839099 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:45:53.866770 [debug] [Thread-1 (]: On model.stock_dbt_project.stg_stock_data: COMMIT
[0m01:45:53.869012 [debug] [Thread-1 (]: Using duckdb connection "model.stock_dbt_project.stg_stock_data"
[0m01:45:53.870053 [debug] [Thread-1 (]: On model.stock_dbt_project.stg_stock_data: COMMIT
[0m01:45:53.874768 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m01:45:53.880896 [debug] [Thread-1 (]: Using duckdb connection "model.stock_dbt_project.stg_stock_data"
[0m01:45:53.881900 [debug] [Thread-1 (]: On model.stock_dbt_project.stg_stock_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "node_id": "model.stock_dbt_project.stg_stock_data"} */
drop view if exists "dev"."main"."stg_stock_data__dbt_backup" cascade
[0m01:45:53.884910 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m01:45:53.888404 [debug] [Thread-1 (]: On model.stock_dbt_project.stg_stock_data: Close
[0m01:45:53.891963 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd9f72ac8-074b-43b0-8b7b-b5a329e325cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CCEC63ECF0>]}
[0m01:45:53.893946 [info ] [Thread-1 (]: 1 of 1 OK created sql view model main.stg_stock_data ........................... [[32mOK[0m in 3.37s]
[0m01:45:53.894940 [debug] [Thread-1 (]: Finished running node model.stock_dbt_project.stg_stock_data
[0m01:45:53.897455 [debug] [MainThread]: Using duckdb connection "master"
[0m01:45:53.898461 [debug] [MainThread]: On master: BEGIN
[0m01:45:53.899471 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:45:53.900460 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m01:45:53.901470 [debug] [MainThread]: On master: COMMIT
[0m01:45:53.901470 [debug] [MainThread]: Using duckdb connection "master"
[0m01:45:53.902479 [debug] [MainThread]: On master: COMMIT
[0m01:45:53.904463 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m01:45:53.904463 [debug] [MainThread]: On master: Close
[0m01:45:53.905461 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:45:53.906965 [debug] [MainThread]: Connection 'create_dev_main' was properly closed.
[0m01:45:53.906965 [debug] [MainThread]: Connection 'list_dev_main' was properly closed.
[0m01:45:53.907970 [debug] [MainThread]: Connection 'model.stock_dbt_project.stg_stock_data' was properly closed.
[0m01:45:53.907970 [info ] [MainThread]: 
[0m01:45:53.908982 [info ] [MainThread]: Finished running 10 project hooks, 1 view model in 0 hours 0 minutes and 5.52 seconds (5.52s).
[0m01:45:53.911979 [debug] [MainThread]: Command end result
[0m01:45:53.944233 [debug] [MainThread]: Wrote artifact WritableManifest to D:\Stock_price\stock_dbt_project\target\manifest.json
[0m01:45:53.949212 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\Stock_price\stock_dbt_project\target\semantic_manifest.json
[0m01:45:53.958497 [debug] [MainThread]: Wrote artifact RunExecutionResult to D:\Stock_price\stock_dbt_project\target\run_results.json
[0m01:45:53.959498 [info ] [MainThread]: 
[0m01:45:53.960503 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:45:53.961496 [info ] [MainThread]: 
[0m01:45:53.962496 [info ] [MainThread]: Done. PASS=11 WARN=0 ERROR=0 SKIP=0 TOTAL=11
[0m01:45:53.964496 [debug] [MainThread]: Command `dbt run` succeeded at 01:45:53.963495 after 7.23 seconds
[0m01:45:53.964496 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CCEA995760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CCEA995C40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CCEA995730>]}
[0m01:45:53.965499 [debug] [MainThread]: Flushing usage events
[0m01:45:54.856932 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:46:26.170131 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017484E78260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017487CBCB00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000174881954F0>]}


============================== 01:46:26.178169 | afd78512-5a7e-428d-9c02-1988d926dd7e ==============================
[0m01:46:26.178169 [info ] [MainThread]: Running with dbt=1.9.4
[0m01:46:26.179174 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\loges\\.dbt', 'log_path': 'D:\\Stock_price\\stock_dbt_project\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run --select features_stock_data', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m01:46:26.518730 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'afd78512-5a7e-428d-9c02-1988d926dd7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017487F33860>]}
[0m01:46:26.602806 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'afd78512-5a7e-428d-9c02-1988d926dd7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017487EC45C0>]}
[0m01:46:26.608987 [info ] [MainThread]: Registered adapter: duckdb=1.9.2
[0m01:46:26.883517 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m01:46:27.189847 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:46:27.190378 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:46:27.204149 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.stock_dbt_project.marts
[0m01:46:27.301448 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'afd78512-5a7e-428d-9c02-1988d926dd7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000174878AE630>]}
[0m01:46:27.513274 [debug] [MainThread]: Wrote artifact WritableManifest to D:\Stock_price\stock_dbt_project\target\manifest.json
[0m01:46:27.517915 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\Stock_price\stock_dbt_project\target\semantic_manifest.json
[0m01:46:27.581022 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'afd78512-5a7e-428d-9c02-1988d926dd7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000174898BA390>]}
[0m01:46:27.583254 [info ] [MainThread]: Found 4 models, 10 operations, 4 data tests, 426 macros
[0m01:46:27.585023 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'afd78512-5a7e-428d-9c02-1988d926dd7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000174898B7CE0>]}
[0m01:46:27.588676 [info ] [MainThread]: 
[0m01:46:27.590273 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:46:27.590792 [info ] [MainThread]: 
[0m01:46:27.592822 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m01:46:27.595598 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m01:46:27.753243 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m01:46:27.754296 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m01:46:27.754819 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:46:27.949653 [debug] [ThreadPool]: SQL status: OK in 0.195 seconds
[0m01:46:27.952272 [debug] [ThreadPool]: On list_dev: Close
[0m01:46:27.954430 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m01:46:27.954956 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m01:46:27.965945 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m01:46:27.967551 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "create_dev_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m01:46:27.968079 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:46:27.969657 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m01:46:27.971239 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m01:46:27.972232 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m01:46:27.973283 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m01:46:27.973820 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m01:46:27.974351 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "create_dev_main"} */

    
    
        create schema if not exists "dev"."main"
    
[0m01:46:27.974876 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m01:46:27.976468 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m01:46:27.976990 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m01:46:27.976990 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m01:46:27.978591 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m01:46:27.980925 [debug] [ThreadPool]: On create_dev_main: Close
[0m01:46:27.989926 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev_main'
[0m01:46:27.999733 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m01:46:28.000792 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m01:46:28.001799 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:46:28.002944 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m01:46:28.003473 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m01:46:28.003994 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m01:46:28.033646 [debug] [ThreadPool]: SQL status: OK in 0.029 seconds
[0m01:46:28.036359 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m01:46:28.038969 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m01:46:28.040015 [debug] [ThreadPool]: On list_dev_main: Close
[0m01:46:28.043087 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'afd78512-5a7e-428d-9c02-1988d926dd7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017489E4BB00>]}
[0m01:46:28.044164 [debug] [MainThread]: Using duckdb connection "master"
[0m01:46:28.044680 [debug] [MainThread]: On master: BEGIN
[0m01:46:28.045215 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:46:28.046279 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m01:46:28.046809 [debug] [MainThread]: On master: COMMIT
[0m01:46:28.047341 [debug] [MainThread]: Using duckdb connection "master"
[0m01:46:28.048936 [debug] [MainThread]: On master: COMMIT
[0m01:46:28.050024 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m01:46:28.061313 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-0"
[0m01:46:28.076251 [info ] [MainThread]: 1 of 10 START hook: stock_dbt_project.on-run-start.0 ........................... [RUN]
[0m01:46:28.078255 [debug] [MainThread]: Using duckdb connection "master"
[0m01:46:28.079311 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
INSTALL httpfs;
[0m01:46:28.081437 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m01:46:28.084726 [info ] [MainThread]: 1 of 10 OK hook: stock_dbt_project.on-run-start.0 .............................. [[32mOK[0m in 0.03s]
[0m01:46:28.088933 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-1"
[0m01:46:28.092103 [info ] [MainThread]: 2 of 10 START hook: stock_dbt_project.on-run-start.1 ........................... [RUN]
[0m01:46:28.094269 [debug] [MainThread]: Using duckdb connection "master"
[0m01:46:28.094803 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
INSTALL json;
[0m01:46:28.096380 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m01:46:28.099120 [info ] [MainThread]: 2 of 10 OK hook: stock_dbt_project.on-run-start.1 .............................. [[32mOK[0m in 0.01s]
[0m01:46:28.105022 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-2"
[0m01:46:28.107142 [info ] [MainThread]: 3 of 10 START hook: stock_dbt_project.on-run-start.2 ........................... [RUN]
[0m01:46:28.108181 [debug] [MainThread]: Using duckdb connection "master"
[0m01:46:28.108717 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
LOAD httpfs;
[0m01:46:28.109785 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m01:46:28.111923 [info ] [MainThread]: 3 of 10 OK hook: stock_dbt_project.on-run-start.2 .............................. [[32mOK[0m in 0.01s]
[0m01:46:28.116409 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-3"
[0m01:46:28.118505 [info ] [MainThread]: 4 of 10 START hook: stock_dbt_project.on-run-start.3 ........................... [RUN]
[0m01:46:28.120114 [debug] [MainThread]: Using duckdb connection "master"
[0m01:46:28.121176 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
LOAD json;
[0m01:46:28.122216 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m01:46:28.123799 [info ] [MainThread]: 4 of 10 OK hook: stock_dbt_project.on-run-start.3 .............................. [[32mOK[0m in 0.01s]
[0m01:46:28.126941 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-4"
[0m01:46:28.128525 [info ] [MainThread]: 5 of 10 START hook: stock_dbt_project.on-run-start.4 ........................... [RUN]
[0m01:46:28.130769 [debug] [MainThread]: Using duckdb connection "master"
[0m01:46:28.132127 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
SET s3_endpoint='http://localhost:9000';
[0m01:46:28.133693 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m01:46:28.135819 [info ] [MainThread]: 5 of 10 OK hook: stock_dbt_project.on-run-start.4 .............................. [[32mOK[0m in 0.01s]
[0m01:46:28.138987 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-5"
[0m01:46:28.140561 [info ] [MainThread]: 6 of 10 START hook: stock_dbt_project.on-run-start.5 ........................... [RUN]
[0m01:46:28.141606 [debug] [MainThread]: Using duckdb connection "master"
[0m01:46:28.142645 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
SET s3_access_key_id='minioadmin';
[0m01:46:28.144214 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m01:46:28.147347 [info ] [MainThread]: 6 of 10 OK hook: stock_dbt_project.on-run-start.5 .............................. [[32mOK[0m in 0.01s]
[0m01:46:28.154300 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-6"
[0m01:46:28.155879 [info ] [MainThread]: 7 of 10 START hook: stock_dbt_project.on-run-start.6 ........................... [RUN]
[0m01:46:28.156926 [debug] [MainThread]: Using duckdb connection "master"
[0m01:46:28.157456 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
SET s3_secret_access_key='minioadmin';
[0m01:46:28.158506 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m01:46:28.160417 [info ] [MainThread]: 7 of 10 OK hook: stock_dbt_project.on-run-start.6 .............................. [[32mOK[0m in 0.01s]
[0m01:46:28.164144 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-7"
[0m01:46:28.166194 [info ] [MainThread]: 8 of 10 START hook: stock_dbt_project.on-run-start.7 ........................... [RUN]
[0m01:46:28.168196 [debug] [MainThread]: Using duckdb connection "master"
[0m01:46:28.169647 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
SET s3_region='us-east-1';
[0m01:46:28.171248 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m01:46:28.173891 [info ] [MainThread]: 8 of 10 OK hook: stock_dbt_project.on-run-start.7 .............................. [[32mOK[0m in 0.01s]
[0m01:46:28.177120 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-8"
[0m01:46:28.178728 [info ] [MainThread]: 9 of 10 START hook: stock_dbt_project.on-run-start.8 ........................... [RUN]
[0m01:46:28.182167 [debug] [MainThread]: Using duckdb connection "master"
[0m01:46:28.183236 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
SET s3_use_ssl=false;
[0m01:46:28.184827 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m01:46:28.186991 [info ] [MainThread]: 9 of 10 OK hook: stock_dbt_project.on-run-start.8 .............................. [[32mOK[0m in 0.01s]
[0m01:46:28.190144 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-9"
[0m01:46:28.191792 [info ] [MainThread]: 10 of 10 START hook: stock_dbt_project.on-run-start.9 .......................... [RUN]
[0m01:46:28.193897 [debug] [MainThread]: Using duckdb connection "master"
[0m01:46:28.195245 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
SET s3_url_style='path';
[0m01:46:28.196837 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m01:46:28.199483 [info ] [MainThread]: 10 of 10 OK hook: stock_dbt_project.on-run-start.9 ............................. [[32mOK[0m in 0.01s]
[0m01:46:28.201581 [info ] [MainThread]: 
[0m01:46:28.202676 [debug] [MainThread]: On master: Close
[0m01:46:28.209723 [debug] [Thread-1 (]: Began running node model.stock_dbt_project.features_stock_data
[0m01:46:28.211316 [info ] [Thread-1 (]: 1 of 1 START sql table model main.features_stock_data .......................... [RUN]
[0m01:46:28.212897 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.stock_dbt_project.features_stock_data'
[0m01:46:28.216042 [debug] [Thread-1 (]: Began compiling node model.stock_dbt_project.features_stock_data
[0m01:46:28.221328 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_dbt_project.features_stock_data"
[0m01:46:28.223905 [debug] [Thread-1 (]: Began executing node model.stock_dbt_project.features_stock_data
[0m01:46:28.284352 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_dbt_project.features_stock_data"
[0m01:46:28.285935 [debug] [Thread-1 (]: Using duckdb connection "model.stock_dbt_project.features_stock_data"
[0m01:46:28.287011 [debug] [Thread-1 (]: On model.stock_dbt_project.features_stock_data: BEGIN
[0m01:46:28.287550 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m01:46:28.289150 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:46:28.289678 [debug] [Thread-1 (]: Using duckdb connection "model.stock_dbt_project.features_stock_data"
[0m01:46:28.291018 [debug] [Thread-1 (]: On model.stock_dbt_project.features_stock_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "node_id": "model.stock_dbt_project.features_stock_data"} */

  
    
    

    create  table
      "dev"."main"."features_stock_data__dbt_tmp"
  
    as (
      

WITH base AS (
    SELECT
        symbol,
        datetime,
        open,
        high,
        low,
        close,
        volume,
        
        -- Previous close for daily return
        LAG(close, 1) OVER (PARTITION BY symbol ORDER BY datetime) AS prev_close,

        -- Rolling 5-period average and stddev of close
        AVG(close) OVER (
            PARTITION BY symbol 
            ORDER BY datetime 
            ROWS BETWEEN 4 PRECEDING AND CURRENT ROW
        ) AS rolling_avg_5,

        STDDEV(close) OVER (
            PARTITION BY symbol 
            ORDER BY datetime 
            ROWS BETWEEN 4 PRECEDING AND CURRENT ROW
        ) AS rolling_std_5,

        -- Daily price range
        (high - low) AS daily_range,

        -- Rolling 5-period average of volume
        AVG(volume) OVER (
            PARTITION BY symbol 
            ORDER BY datetime 
            ROWS BETWEEN 4 PRECEDING AND CURRENT ROW
        ) AS avg_volume_5
    FROM "dev"."main"."stg_stock_data"
),

features AS (
    SELECT
        *,
        
        -- Daily return percentage
        CASE 
            WHEN prev_close IS NOT NULL AND prev_close != 0 THEN 
                ((close - prev_close) / prev_close) * 100
            ELSE NULL
        END AS daily_return,

        -- Volume ratio compared to rolling average
        CASE 
            WHEN avg_volume_5 IS NOT NULL AND avg_volume_5 != 0 THEN 
                volume / avg_volume_5
            ELSE NULL
        END AS volume_ratio,

        -- Rolling volatility based on daily return
        STDDEV(
            CASE 
                WHEN prev_close IS NOT NULL AND prev_close != 0 THEN 
                    ((close - prev_close) / prev_close) * 100
                ELSE NULL
            END
        ) OVER (
            PARTITION BY symbol 
            ORDER BY datetime 
            ROWS BETWEEN 9 PRECEDING AND CURRENT ROW
        ) AS rolling_volatility_10

        -- Sector classification based on symbol 
        CASE
            WHEN symbol IN ('AAPL', 'CRM', 'CSCO', 'IBM', 'INTC', 'MSFT') THEN 'Technology'
            WHEN symbol IN ('AMGN', 'JNJ', 'MRK', 'UNH') THEN 'Healthcare'
            WHEN symbol IN ('AXP', 'GS', 'JPM', 'TRV', 'V') THEN 'Financials'
            WHEN symbol IN ('BA', 'CAT', 'HON', 'MMM') THEN 'Industrials'
            WHEN symbol IN ('CVX') THEN 'Energy'
            WHEN symbol IN ('DIS', 'VZ') THEN 'Communication Services'
            WHEN symbol IN ('DOW') THEN 'Materials'
            WHEN symbol IN ('HD', 'MCD', 'NKE') THEN 'Consumer Discretionary'
            WHEN symbol IN ('KO', 'PG', 'WMT', 'WBA') THEN 'Consumer Staples'
            ELSE 'Unknown'
        END AS sector
    FROM base
)

SELECT * FROM features
    );
  
  
[0m01:46:28.295983 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "node_id": "model.stock_dbt_project.features_stock_data"} */

  
    
    

    create  table
      "dev"."main"."features_stock_data__dbt_tmp"
  
    as (
      

WITH base AS (
    SELECT
        symbol,
        datetime,
        open,
        high,
        low,
        close,
        volume,
        
        -- Previous close for daily return
        LAG(close, 1) OVER (PARTITION BY symbol ORDER BY datetime) AS prev_close,

        -- Rolling 5-period average and stddev of close
        AVG(close) OVER (
            PARTITION BY symbol 
            ORDER BY datetime 
            ROWS BETWEEN 4 PRECEDING AND CURRENT ROW
        ) AS rolling_avg_5,

        STDDEV(close) OVER (
            PARTITION BY symbol 
            ORDER BY datetime 
            ROWS BETWEEN 4 PRECEDING AND CURRENT ROW
        ) AS rolling_std_5,

        -- Daily price range
        (high - low) AS daily_range,

        -- Rolling 5-period average of volume
        AVG(volume) OVER (
            PARTITION BY symbol 
            ORDER BY datetime 
            ROWS BETWEEN 4 PRECEDING AND CURRENT ROW
        ) AS avg_volume_5
    FROM "dev"."main"."stg_stock_data"
),

features AS (
    SELECT
        *,
        
        -- Daily return percentage
        CASE 
            WHEN prev_close IS NOT NULL AND prev_close != 0 THEN 
                ((close - prev_close) / prev_close) * 100
            ELSE NULL
        END AS daily_return,

        -- Volume ratio compared to rolling average
        CASE 
            WHEN avg_volume_5 IS NOT NULL AND avg_volume_5 != 0 THEN 
                volume / avg_volume_5
            ELSE NULL
        END AS volume_ratio,

        -- Rolling volatility based on daily return
        STDDEV(
            CASE 
                WHEN prev_close IS NOT NULL AND prev_close != 0 THEN 
                    ((close - prev_close) / prev_close) * 100
                ELSE NULL
            END
        ) OVER (
            PARTITION BY symbol 
            ORDER BY datetime 
            ROWS BETWEEN 9 PRECEDING AND CURRENT ROW
        ) AS rolling_volatility_10

        -- Sector classification based on symbol 
        CASE
            WHEN symbol IN ('AAPL', 'CRM', 'CSCO', 'IBM', 'INTC', 'MSFT') THEN 'Technology'
            WHEN symbol IN ('AMGN', 'JNJ', 'MRK', 'UNH') THEN 'Healthcare'
            WHEN symbol IN ('AXP', 'GS', 'JPM', 'TRV', 'V') THEN 'Financials'
            WHEN symbol IN ('BA', 'CAT', 'HON', 'MMM') THEN 'Industrials'
            WHEN symbol IN ('CVX') THEN 'Energy'
            WHEN symbol IN ('DIS', 'VZ') THEN 'Communication Services'
            WHEN symbol IN ('DOW') THEN 'Materials'
            WHEN symbol IN ('HD', 'MCD', 'NKE') THEN 'Consumer Discretionary'
            WHEN symbol IN ('KO', 'PG', 'WMT', 'WBA') THEN 'Consumer Staples'
            ELSE 'Unknown'
        END AS sector
    FROM base
)

SELECT * FROM features
    );
  
  
[0m01:46:28.298376 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m01:46:28.299731 [debug] [Thread-1 (]: On model.stock_dbt_project.features_stock_data: ROLLBACK
[0m01:46:28.470343 [debug] [Thread-1 (]: Failed to rollback 'model.stock_dbt_project.features_stock_data'
[0m01:46:28.471342 [debug] [Thread-1 (]: On model.stock_dbt_project.features_stock_data: Close
[0m01:46:28.474341 [debug] [Thread-1 (]: Runtime Error in model features_stock_data (models\features_stock_data.sql)
  Parser Error: syntax error at or near "CASE"
[0m01:46:28.477914 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'afd78512-5a7e-428d-9c02-1988d926dd7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017489EFAFF0>]}
[0m01:46:28.481452 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model main.features_stock_data ................. [[31mERROR[0m in 0.26s]
[0m01:46:28.482463 [debug] [Thread-1 (]: Finished running node model.stock_dbt_project.features_stock_data
[0m01:46:28.483449 [debug] [Thread-4 (]: Marking all children of 'model.stock_dbt_project.features_stock_data' to be skipped because of status 'error'.  Reason: Runtime Error in model features_stock_data (models\features_stock_data.sql)
  Parser Error: syntax error at or near "CASE".
[0m01:46:28.486472 [debug] [MainThread]: Using duckdb connection "master"
[0m01:46:28.487465 [debug] [MainThread]: On master: BEGIN
[0m01:46:28.488451 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:46:28.489449 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m01:46:28.489449 [debug] [MainThread]: On master: COMMIT
[0m01:46:28.490450 [debug] [MainThread]: Using duckdb connection "master"
[0m01:46:28.490998 [debug] [MainThread]: On master: COMMIT
[0m01:46:28.492004 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m01:46:28.492509 [debug] [MainThread]: On master: Close
[0m01:46:28.493514 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:46:28.494651 [debug] [MainThread]: Connection 'create_dev_main' was properly closed.
[0m01:46:28.495230 [debug] [MainThread]: Connection 'list_dev_main' was properly closed.
[0m01:46:28.495737 [debug] [MainThread]: Connection 'model.stock_dbt_project.features_stock_data' was properly closed.
[0m01:46:28.496270 [info ] [MainThread]: 
[0m01:46:28.497848 [info ] [MainThread]: Finished running 10 project hooks, 1 table model in 0 hours 0 minutes and 0.90 seconds (0.90s).
[0m01:46:28.501541 [debug] [MainThread]: Command end result
[0m01:46:28.530955 [debug] [MainThread]: Wrote artifact WritableManifest to D:\Stock_price\stock_dbt_project\target\manifest.json
[0m01:46:28.536530 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\Stock_price\stock_dbt_project\target\semantic_manifest.json
[0m01:46:28.543857 [debug] [MainThread]: Wrote artifact RunExecutionResult to D:\Stock_price\stock_dbt_project\target\run_results.json
[0m01:46:28.544857 [info ] [MainThread]: 
[0m01:46:28.545862 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m01:46:28.545862 [info ] [MainThread]: 
[0m01:46:28.547861 [error] [MainThread]:   Runtime Error in model features_stock_data (models\features_stock_data.sql)
  Parser Error: syntax error at or near "CASE"
[0m01:46:28.548600 [info ] [MainThread]: 
[0m01:46:28.549106 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=1 SKIP=0 TOTAL=11
[0m01:46:28.551248 [debug] [MainThread]: Command `dbt run` failed at 01:46:28.551248 after 2.60 seconds
[0m01:46:28.552258 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017487FFCEC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017488195A30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000174881954F0>]}
[0m01:46:28.552258 [debug] [MainThread]: Flushing usage events
[0m01:46:34.875172 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:32:47.278747 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018747765310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018747A8CAD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000187475E26F0>]}


============================== 19:32:47.320816 | 81ff5d27-8b30-4e85-859e-12f409cc24a2 ==============================
[0m19:32:47.320816 [info ] [MainThread]: Running with dbt=1.9.4
[0m19:32:47.329899 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\loges\\.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'D:\\Stock_price\\stock_dbt_project\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select features_stock_data', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:32:49.055908 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '81ff5d27-8b30-4e85-859e-12f409cc24a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018747132870>]}
[0m19:32:49.223019 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '81ff5d27-8b30-4e85-859e-12f409cc24a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000187470ABE00>]}
[0m19:32:49.264450 [info ] [MainThread]: Registered adapter: duckdb=1.9.2
[0m19:32:51.326487 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m19:32:59.246973 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:32:59.253436 [debug] [MainThread]: Partial parsing: updated file: stock_dbt_project://models\features_stock_data.sql
[0m19:33:02.853274 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.stock_dbt_project.marts
[0m19:33:02.913172 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '81ff5d27-8b30-4e85-859e-12f409cc24a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000187492CAA20>]}
[0m19:33:03.534928 [debug] [MainThread]: Wrote artifact WritableManifest to D:\Stock_price\stock_dbt_project\target\manifest.json
[0m19:33:03.668009 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\Stock_price\stock_dbt_project\target\semantic_manifest.json
[0m19:33:04.112675 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '81ff5d27-8b30-4e85-859e-12f409cc24a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001874912F7D0>]}
[0m19:33:04.124532 [info ] [MainThread]: Found 4 models, 10 operations, 4 data tests, 426 macros
[0m19:33:04.129751 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '81ff5d27-8b30-4e85-859e-12f409cc24a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018747F6F890>]}
[0m19:33:04.149339 [info ] [MainThread]: 
[0m19:33:04.154694 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:33:04.165123 [info ] [MainThread]: 
[0m19:33:04.181902 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m19:33:04.194920 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m19:33:24.003332 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m19:33:24.007930 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m19:33:24.010005 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:33:30.009171 [debug] [ThreadPool]: SQL status: OK in 5.999 seconds
[0m19:33:30.020064 [debug] [ThreadPool]: On list_dev: Close
[0m19:33:30.029222 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m19:33:30.032179 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m19:33:30.093465 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m19:33:30.097046 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "create_dev_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m19:33:30.100635 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:33:30.114662 [debug] [ThreadPool]: SQL status: OK in 0.013 seconds
[0m19:33:30.149590 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m19:33:30.152163 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m19:33:30.154768 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m19:33:30.157345 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m19:33:30.161014 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "create_dev_main"} */

    
    
        create schema if not exists "dev"."main"
    
[0m19:33:30.168402 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m19:33:30.175276 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m19:33:30.178415 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m19:33:30.180972 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m19:33:30.184548 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m19:33:30.188670 [debug] [ThreadPool]: On create_dev_main: Close
[0m19:33:30.280027 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev_main'
[0m19:33:30.369064 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m19:33:30.374293 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m19:33:30.384280 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:33:30.387906 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m19:33:30.392591 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m19:33:30.405720 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m19:33:30.639274 [debug] [ThreadPool]: SQL status: OK in 0.230 seconds
[0m19:33:30.650891 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m19:33:30.759719 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m19:33:30.762049 [debug] [ThreadPool]: On list_dev_main: Close
[0m19:33:30.771317 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '81ff5d27-8b30-4e85-859e-12f409cc24a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001874981D670>]}
[0m19:33:30.775161 [debug] [MainThread]: Using duckdb connection "master"
[0m19:33:30.777958 [debug] [MainThread]: On master: BEGIN
[0m19:33:30.781260 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:33:30.787849 [debug] [MainThread]: SQL status: OK in 0.006 seconds
[0m19:33:30.791432 [debug] [MainThread]: On master: COMMIT
[0m19:33:30.795397 [debug] [MainThread]: Using duckdb connection "master"
[0m19:33:30.799652 [debug] [MainThread]: On master: COMMIT
[0m19:33:30.807638 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m19:33:30.855280 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-0"
[0m19:33:30.885588 [info ] [MainThread]: 1 of 10 START hook: stock_dbt_project.on-run-start.0 ........................... [RUN]
[0m19:33:30.891722 [debug] [MainThread]: Using duckdb connection "master"
[0m19:33:30.896118 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
INSTALL httpfs;
[0m19:33:30.908864 [debug] [MainThread]: SQL status: OK in 0.004 seconds
[0m19:33:30.917081 [info ] [MainThread]: 1 of 10 OK hook: stock_dbt_project.on-run-start.0 .............................. [[32mOK[0m in 0.10s]
[0m19:33:30.933265 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-1"
[0m19:33:30.938360 [info ] [MainThread]: 2 of 10 START hook: stock_dbt_project.on-run-start.1 ........................... [RUN]
[0m19:33:30.943470 [debug] [MainThread]: Using duckdb connection "master"
[0m19:33:30.946914 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
INSTALL json;
[0m19:33:30.953194 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m19:33:30.959148 [info ] [MainThread]: 2 of 10 OK hook: stock_dbt_project.on-run-start.1 .............................. [[32mOK[0m in 0.03s]
[0m19:33:30.965775 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-2"
[0m19:33:30.969791 [info ] [MainThread]: 3 of 10 START hook: stock_dbt_project.on-run-start.2 ........................... [RUN]
[0m19:33:30.975489 [debug] [MainThread]: Using duckdb connection "master"
[0m19:33:30.978183 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
LOAD httpfs;
[0m19:33:30.981892 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m19:33:30.991151 [info ] [MainThread]: 3 of 10 OK hook: stock_dbt_project.on-run-start.2 .............................. [[32mOK[0m in 0.03s]
[0m19:33:31.013569 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-3"
[0m19:33:31.018864 [info ] [MainThread]: 4 of 10 START hook: stock_dbt_project.on-run-start.3 ........................... [RUN]
[0m19:33:31.021437 [debug] [MainThread]: Using duckdb connection "master"
[0m19:33:31.024485 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
LOAD json;
[0m19:33:31.026518 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m19:33:31.031306 [info ] [MainThread]: 4 of 10 OK hook: stock_dbt_project.on-run-start.3 .............................. [[32mOK[0m in 0.03s]
[0m19:33:31.040621 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-4"
[0m19:33:31.046632 [info ] [MainThread]: 5 of 10 START hook: stock_dbt_project.on-run-start.4 ........................... [RUN]
[0m19:33:31.049279 [debug] [MainThread]: Using duckdb connection "master"
[0m19:33:31.051841 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
SET s3_endpoint='http://localhost:9000';
[0m19:33:31.054885 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m19:33:31.059642 [info ] [MainThread]: 5 of 10 OK hook: stock_dbt_project.on-run-start.4 .............................. [[32mOK[0m in 0.03s]
[0m19:33:31.067315 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-5"
[0m19:33:31.072033 [info ] [MainThread]: 6 of 10 START hook: stock_dbt_project.on-run-start.5 ........................... [RUN]
[0m19:33:31.076185 [debug] [MainThread]: Using duckdb connection "master"
[0m19:33:31.078007 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
SET s3_access_key_id='minioadmin';
[0m19:33:31.081910 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m19:33:31.087818 [info ] [MainThread]: 6 of 10 OK hook: stock_dbt_project.on-run-start.5 .............................. [[32mOK[0m in 0.03s]
[0m19:33:31.103347 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-6"
[0m19:33:31.121480 [info ] [MainThread]: 7 of 10 START hook: stock_dbt_project.on-run-start.6 ........................... [RUN]
[0m19:33:31.127652 [debug] [MainThread]: Using duckdb connection "master"
[0m19:33:31.130736 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
SET s3_secret_access_key='minioadmin';
[0m19:33:31.135007 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m19:33:31.140884 [info ] [MainThread]: 7 of 10 OK hook: stock_dbt_project.on-run-start.6 .............................. [[32mOK[0m in 0.05s]
[0m19:33:31.151377 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-7"
[0m19:33:31.156942 [info ] [MainThread]: 8 of 10 START hook: stock_dbt_project.on-run-start.7 ........................... [RUN]
[0m19:33:31.177123 [debug] [MainThread]: Using duckdb connection "master"
[0m19:33:31.181772 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
SET s3_region='us-east-1';
[0m19:33:31.185899 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m19:33:31.192508 [info ] [MainThread]: 8 of 10 OK hook: stock_dbt_project.on-run-start.7 .............................. [[32mOK[0m in 0.05s]
[0m19:33:31.204151 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-8"
[0m19:33:31.209294 [info ] [MainThread]: 9 of 10 START hook: stock_dbt_project.on-run-start.8 ........................... [RUN]
[0m19:33:31.213670 [debug] [MainThread]: Using duckdb connection "master"
[0m19:33:31.215248 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
SET s3_use_ssl=false;
[0m19:33:31.219368 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m19:33:31.223838 [info ] [MainThread]: 9 of 10 OK hook: stock_dbt_project.on-run-start.8 .............................. [[32mOK[0m in 0.03s]
[0m19:33:31.231969 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-9"
[0m19:33:31.236101 [info ] [MainThread]: 10 of 10 START hook: stock_dbt_project.on-run-start.9 .......................... [RUN]
[0m19:33:31.239718 [debug] [MainThread]: Using duckdb connection "master"
[0m19:33:31.242746 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
SET s3_url_style='path';
[0m19:33:31.245456 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m19:33:31.251315 [info ] [MainThread]: 10 of 10 OK hook: stock_dbt_project.on-run-start.9 ............................. [[32mOK[0m in 0.02s]
[0m19:33:31.254371 [info ] [MainThread]: 
[0m19:33:31.258049 [debug] [MainThread]: On master: Close
[0m19:33:31.275041 [debug] [Thread-1 (]: Began running node model.stock_dbt_project.features_stock_data
[0m19:33:31.277640 [info ] [Thread-1 (]: 1 of 1 START sql table model main.features_stock_data .......................... [RUN]
[0m19:33:31.281329 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.stock_dbt_project.features_stock_data'
[0m19:33:31.284988 [debug] [Thread-1 (]: Began compiling node model.stock_dbt_project.features_stock_data
[0m19:33:31.303232 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_dbt_project.features_stock_data"
[0m19:33:31.307370 [debug] [Thread-1 (]: Began executing node model.stock_dbt_project.features_stock_data
[0m19:33:31.599204 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_dbt_project.features_stock_data"
[0m19:33:31.607100 [debug] [Thread-1 (]: Using duckdb connection "model.stock_dbt_project.features_stock_data"
[0m19:33:31.615360 [debug] [Thread-1 (]: On model.stock_dbt_project.features_stock_data: BEGIN
[0m19:33:31.621305 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:33:31.626264 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m19:33:31.628968 [debug] [Thread-1 (]: Using duckdb connection "model.stock_dbt_project.features_stock_data"
[0m19:33:31.636899 [debug] [Thread-1 (]: On model.stock_dbt_project.features_stock_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "node_id": "model.stock_dbt_project.features_stock_data"} */

  
    
    

    create  table
      "dev"."main"."features_stock_data__dbt_tmp"
  
    as (
      

WITH base AS (
    SELECT
        symbol,
        datetime,
        open,
        high,
        low,
        close,
        volume,
        
        -- Previous close for daily return
        LAG(close, 1) OVER (PARTITION BY symbol ORDER BY datetime) AS prev_close,

        -- Rolling 5-period average and stddev of close
        AVG(close) OVER (
            PARTITION BY symbol 
            ORDER BY datetime 
            ROWS BETWEEN 4 PRECEDING AND CURRENT ROW
        ) AS rolling_avg_5,

        STDDEV(close) OVER (
            PARTITION BY symbol 
            ORDER BY datetime 
            ROWS BETWEEN 4 PRECEDING AND CURRENT ROW
        ) AS rolling_std_5,

        -- Daily price range
        (high - low) AS daily_range,

        -- Rolling 5-period average of volume
        AVG(volume) OVER (
            PARTITION BY symbol 
            ORDER BY datetime 
            ROWS BETWEEN 4 PRECEDING AND CURRENT ROW
        ) AS avg_volume_5
    FROM "dev"."main"."stg_stock_data"
),

features AS (
    SELECT
        *,
        
        -- Daily return percentage
        CASE 
            WHEN prev_close IS NOT NULL AND prev_close != 0 THEN 
                ((close - prev_close) / prev_close) * 100
            ELSE NULL
        END AS daily_return,

        -- Volume ratio compared to rolling average
        CASE 
            WHEN avg_volume_5 IS NOT NULL AND avg_volume_5 != 0 THEN 
                volume / avg_volume_5
            ELSE NULL
        END AS volume_ratio,

        -- Rolling volatility based on daily return
        STDDEV(
            CASE 
                WHEN prev_close IS NOT NULL AND prev_close != 0 THEN 
                    ((close - prev_close) / prev_close) * 100
                ELSE NULL
            END
        ) OVER (
            PARTITION BY symbol 
            ORDER BY datetime 
            ROWS BETWEEN 9 PRECEDING AND CURRENT ROW
        ) AS rolling_volatility_10,

        -- Sector classification based on symbol 
        CASE
            WHEN symbol IN ('AAPL', 'CRM', 'CSCO', 'IBM', 'INTC', 'MSFT') THEN 'Technology'
            WHEN symbol IN ('AMGN', 'JNJ', 'MRK', 'UNH') THEN 'Healthcare'
            WHEN symbol IN ('AXP', 'GS', 'JPM', 'TRV', 'V') THEN 'Financials'
            WHEN symbol IN ('BA', 'CAT', 'HON', 'MMM') THEN 'Industrials'
            WHEN symbol IN ('CVX') THEN 'Energy'
            WHEN symbol IN ('DIS', 'VZ') THEN 'Communication Services'
            WHEN symbol IN ('DOW') THEN 'Materials'
            WHEN symbol IN ('HD', 'MCD', 'NKE') THEN 'Consumer Discretionary'
            WHEN symbol IN ('KO', 'PG', 'WMT', 'WBA') THEN 'Consumer Staples'
            ELSE 'Unknown'
        END AS sector
    FROM base
)

SELECT * FROM features
    );
  
  
[0m19:33:39.072460 [debug] [Thread-1 (]: SQL status: OK in 7.428 seconds
[0m19:33:39.090674 [debug] [Thread-1 (]: Using duckdb connection "model.stock_dbt_project.features_stock_data"
[0m19:33:39.092273 [debug] [Thread-1 (]: On model.stock_dbt_project.features_stock_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "node_id": "model.stock_dbt_project.features_stock_data"} */
alter table "dev"."main"."features_stock_data" rename to "features_stock_data__dbt_backup"
[0m19:33:39.094932 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:33:39.103645 [debug] [Thread-1 (]: Using duckdb connection "model.stock_dbt_project.features_stock_data"
[0m19:33:39.104189 [debug] [Thread-1 (]: On model.stock_dbt_project.features_stock_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "node_id": "model.stock_dbt_project.features_stock_data"} */
alter table "dev"."main"."features_stock_data__dbt_tmp" rename to "features_stock_data"
[0m19:33:39.106140 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:33:39.160185 [debug] [Thread-1 (]: On model.stock_dbt_project.features_stock_data: COMMIT
[0m19:33:39.161736 [debug] [Thread-1 (]: Using duckdb connection "model.stock_dbt_project.features_stock_data"
[0m19:33:39.162250 [debug] [Thread-1 (]: On model.stock_dbt_project.features_stock_data: COMMIT
[0m19:33:39.185517 [debug] [Thread-1 (]: SQL status: OK in 0.021 seconds
[0m19:33:39.213475 [debug] [Thread-1 (]: Using duckdb connection "model.stock_dbt_project.features_stock_data"
[0m19:33:39.215612 [debug] [Thread-1 (]: On model.stock_dbt_project.features_stock_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "node_id": "model.stock_dbt_project.features_stock_data"} */
drop table if exists "dev"."main"."features_stock_data__dbt_backup" cascade
[0m19:33:39.222320 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m19:33:39.231082 [debug] [Thread-1 (]: On model.stock_dbt_project.features_stock_data: Close
[0m19:33:39.238054 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '81ff5d27-8b30-4e85-859e-12f409cc24a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000187449B05C0>]}
[0m19:33:39.240763 [info ] [Thread-1 (]: 1 of 1 OK created sql table model main.features_stock_data ..................... [[32mOK[0m in 7.95s]
[0m19:33:39.244485 [debug] [Thread-1 (]: Finished running node model.stock_dbt_project.features_stock_data
[0m19:33:39.247741 [debug] [MainThread]: Using duckdb connection "master"
[0m19:33:39.249265 [debug] [MainThread]: On master: BEGIN
[0m19:33:39.250914 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:33:39.253353 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m19:33:39.255403 [debug] [MainThread]: On master: COMMIT
[0m19:33:39.262601 [debug] [MainThread]: Using duckdb connection "master"
[0m19:33:39.267752 [debug] [MainThread]: On master: COMMIT
[0m19:33:39.271863 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m19:33:39.274857 [debug] [MainThread]: On master: Close
[0m19:33:39.277054 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:33:39.279112 [debug] [MainThread]: Connection 'create_dev_main' was properly closed.
[0m19:33:39.280683 [debug] [MainThread]: Connection 'list_dev_main' was properly closed.
[0m19:33:39.281644 [debug] [MainThread]: Connection 'model.stock_dbt_project.features_stock_data' was properly closed.
[0m19:33:39.282658 [info ] [MainThread]: 
[0m19:33:39.284864 [info ] [MainThread]: Finished running 10 project hooks, 1 table model in 0 hours 0 minutes and 35.10 seconds (35.10s).
[0m19:33:39.292925 [debug] [MainThread]: Command end result
[0m19:33:39.544255 [debug] [MainThread]: Wrote artifact WritableManifest to D:\Stock_price\stock_dbt_project\target\manifest.json
[0m19:33:39.554847 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\Stock_price\stock_dbt_project\target\semantic_manifest.json
[0m19:33:39.634915 [debug] [MainThread]: Wrote artifact RunExecutionResult to D:\Stock_price\stock_dbt_project\target\run_results.json
[0m19:33:39.639581 [info ] [MainThread]: 
[0m19:33:39.646883 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:33:39.664311 [info ] [MainThread]: 
[0m19:33:39.678493 [info ] [MainThread]: Done. PASS=11 WARN=0 ERROR=0 SKIP=0 TOTAL=11
[0m19:33:39.689391 [debug] [MainThread]: Command `dbt run` succeeded at 19:33:39.688810 after 54.21 seconds
[0m19:33:39.695609 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018747576FF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000187447B5400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000187479607A0>]}
[0m19:33:39.700279 [debug] [MainThread]: Flushing usage events
[0m19:33:41.662813 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:39:23.411495 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C82336AED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C823F87440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C823F84B30>]}


============================== 19:39:23.431259 | 3b3f7079-2338-4da6-97aa-97059bf638f3 ==============================
[0m19:39:23.431259 [info ] [MainThread]: Running with dbt=1.9.4
[0m19:39:23.434785 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\loges\\.dbt', 'log_path': 'D:\\Stock_price\\stock_dbt_project\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --select stg_stock_data', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m19:39:24.175522 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3b3f7079-2338-4da6-97aa-97059bf638f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C8255F9DF0>]}
[0m19:39:24.291504 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3b3f7079-2338-4da6-97aa-97059bf638f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C8238A2360>]}
[0m19:39:24.301023 [info ] [MainThread]: Registered adapter: duckdb=1.9.2
[0m19:39:24.715983 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m19:39:25.195045 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:39:25.200624 [debug] [MainThread]: Partial parsing: updated file: stock_dbt_project://models\staging\stg_stock_data.sql
[0m19:39:25.949842 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.stock_dbt_project.marts
[0m19:39:25.966403 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3b3f7079-2338-4da6-97aa-97059bf638f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C8243A3470>]}
[0m19:39:26.570019 [debug] [MainThread]: Wrote artifact WritableManifest to D:\Stock_price\stock_dbt_project\target\manifest.json
[0m19:39:26.584389 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\Stock_price\stock_dbt_project\target\semantic_manifest.json
[0m19:39:26.693021 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3b3f7079-2338-4da6-97aa-97059bf638f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C825B69220>]}
[0m19:39:26.694976 [info ] [MainThread]: Found 4 models, 10 operations, 4 data tests, 426 macros
[0m19:39:26.697988 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3b3f7079-2338-4da6-97aa-97059bf638f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C825857A40>]}
[0m19:39:26.706319 [info ] [MainThread]: 
[0m19:39:26.709171 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:39:26.711385 [info ] [MainThread]: 
[0m19:39:26.714295 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m19:39:26.717698 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m19:39:26.938191 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m19:39:26.940771 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m19:39:26.941956 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:39:27.238203 [debug] [ThreadPool]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m19:39:27.240749 [debug] [ThreadPool]: DuckDB adapter: Rolling back transaction.
[0m19:39:27.244144 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:39:27.247812 [debug] [MainThread]: Connection 'list_dev' was properly closed.
[0m19:39:27.248811 [info ] [MainThread]: 
[0m19:39:27.250821 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.54 seconds (0.54s).
[0m19:39:27.254345 [error] [MainThread]: Encountered an error:
Runtime Error
  IO Error: File is already open in 
  C:\Users\loges\miniconda3\python.exe (PID 51504)
[0m19:39:27.260886 [debug] [MainThread]: Command `dbt run` failed at 19:39:27.259887 after 4.55 seconds
[0m19:39:27.262879 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C82336AED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C825B55B80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C825B2BBC0>]}
[0m19:39:27.265821 [debug] [MainThread]: Flushing usage events
[0m19:39:28.164105 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:40:04.689910 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C5DBCC8DA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C5DBCCADE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C5DBCCA570>]}


============================== 19:40:04.698452 | 7047ef86-0534-4a9b-8a24-858c4ad82f97 ==============================
[0m19:40:04.698452 [info ] [MainThread]: Running with dbt=1.9.4
[0m19:40:04.700456 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\loges\\.dbt', 'log_path': 'D:\\Stock_price\\stock_dbt_project\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --select stg_stock_data', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:40:05.326939 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7047ef86-0534-4a9b-8a24-858c4ad82f97', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C5DC1DA240>]}
[0m19:40:05.630024 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7047ef86-0534-4a9b-8a24-858c4ad82f97', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C5DC167CB0>]}
[0m19:40:05.647538 [info ] [MainThread]: Registered adapter: duckdb=1.9.2
[0m19:40:06.328399 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m19:40:07.007029 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:40:07.008030 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:40:07.021064 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.stock_dbt_project.marts
[0m19:40:07.138758 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7047ef86-0534-4a9b-8a24-858c4ad82f97', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C5DC5EEFF0>]}
[0m19:40:07.413887 [debug] [MainThread]: Wrote artifact WritableManifest to D:\Stock_price\stock_dbt_project\target\manifest.json
[0m19:40:07.420419 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\Stock_price\stock_dbt_project\target\semantic_manifest.json
[0m19:40:07.483334 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7047ef86-0534-4a9b-8a24-858c4ad82f97', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C5DD8E4740>]}
[0m19:40:07.484350 [info ] [MainThread]: Found 4 models, 10 operations, 4 data tests, 426 macros
[0m19:40:07.485354 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7047ef86-0534-4a9b-8a24-858c4ad82f97', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C5DC5EF890>]}
[0m19:40:07.488884 [info ] [MainThread]: 
[0m19:40:07.489886 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:40:07.491396 [info ] [MainThread]: 
[0m19:40:07.493542 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m19:40:07.497574 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m19:40:07.847001 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m19:40:07.848633 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m19:40:07.849734 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:40:08.135997 [debug] [ThreadPool]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m19:40:08.140994 [debug] [ThreadPool]: DuckDB adapter: Rolling back transaction.
[0m19:40:08.148635 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:40:08.153151 [debug] [MainThread]: Connection 'list_dev' was properly closed.
[0m19:40:08.158275 [info ] [MainThread]: 
[0m19:40:08.162840 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.66 seconds (0.66s).
[0m19:40:08.166973 [error] [MainThread]: Encountered an error:
Runtime Error
  IO Error: File is already open in 
  C:\Users\loges\miniconda3\python.exe (PID 51504)
[0m19:40:08.173055 [debug] [MainThread]: Command `dbt run` failed at 19:40:08.172048 after 3.78 seconds
[0m19:40:08.177178 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C5DC194560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C5DD98FD40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C5DC2000B0>]}
[0m19:40:08.182184 [debug] [MainThread]: Flushing usage events
[0m19:40:08.863552 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:42:35.551276 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D56BFABB60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D5693A30B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D56BD985C0>]}


============================== 19:42:35.574817 | d205b0a6-9d1e-4431-8f39-5cd3c0ed1f14 ==============================
[0m19:42:35.574817 [info ] [MainThread]: Running with dbt=1.9.4
[0m19:42:35.578691 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'D:\\Stock_price\\stock_dbt_project\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\loges\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run --select stg_stock_data', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:42:36.694542 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd205b0a6-9d1e-4431-8f39-5cd3c0ed1f14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D56C725430>]}
[0m19:42:36.924787 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd205b0a6-9d1e-4431-8f39-5cd3c0ed1f14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D56BBD7620>]}
[0m19:42:36.942716 [info ] [MainThread]: Registered adapter: duckdb=1.9.2
[0m19:42:38.105038 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m19:42:39.028979 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:42:39.031626 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:42:39.059242 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.stock_dbt_project.marts
[0m19:42:39.255422 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd205b0a6-9d1e-4431-8f39-5cd3c0ed1f14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D56CADF3E0>]}
[0m19:42:39.485525 [debug] [MainThread]: Wrote artifact WritableManifest to D:\Stock_price\stock_dbt_project\target\manifest.json
[0m19:42:39.490054 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\Stock_price\stock_dbt_project\target\semantic_manifest.json
[0m19:42:39.573789 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd205b0a6-9d1e-4431-8f39-5cd3c0ed1f14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D56DDFEE10>]}
[0m19:42:39.577802 [info ] [MainThread]: Found 4 models, 10 operations, 4 data tests, 426 macros
[0m19:42:39.581678 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd205b0a6-9d1e-4431-8f39-5cd3c0ed1f14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D56CA90F80>]}
[0m19:42:39.586734 [info ] [MainThread]: 
[0m19:42:39.589758 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:42:39.592759 [info ] [MainThread]: 
[0m19:42:39.595765 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m19:42:39.601291 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m19:42:39.825654 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m19:42:39.826648 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m19:42:39.827179 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:42:40.043228 [debug] [ThreadPool]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m19:42:40.046985 [debug] [ThreadPool]: DuckDB adapter: Rolling back transaction.
[0m19:42:40.050562 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:42:40.053556 [debug] [MainThread]: Connection 'list_dev' was properly closed.
[0m19:42:40.055546 [info ] [MainThread]: 
[0m19:42:40.058072 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.46 seconds (0.46s).
[0m19:42:40.061093 [error] [MainThread]: Encountered an error:
Runtime Error
  IO Error: File is already open in 
  C:\Users\loges\miniconda3\python.exe (PID 51504)
[0m19:42:40.066088 [debug] [MainThread]: Command `dbt run` failed at 19:42:40.066088 after 5.17 seconds
[0m19:42:40.068622 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D56C3EEE70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D56CADF2F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D56DDE5700>]}
[0m19:42:40.069622 [debug] [MainThread]: Flushing usage events
[0m19:42:42.706704 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:43:20.670903 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011D08F35640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011D08F35970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011D08F340E0>]}


============================== 19:43:20.704672 | 62f9efd7-155d-4a43-88b9-2535afe8dbb6 ==============================
[0m19:43:20.704672 [info ] [MainThread]: Running with dbt=1.9.4
[0m19:43:20.711212 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'D:\\Stock_price\\stock_dbt_project\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\loges\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --select stg_stock_data', 'send_anonymous_usage_stats': 'True'}
[0m19:43:22.628744 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '62f9efd7-155d-4a43-88b9-2535afe8dbb6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011D05D211C0>]}
[0m19:43:23.143644 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '62f9efd7-155d-4a43-88b9-2535afe8dbb6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011D090502F0>]}
[0m19:43:23.169434 [info ] [MainThread]: Registered adapter: duckdb=1.9.2
[0m19:43:24.546838 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m19:43:25.491226 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:43:25.496789 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:43:25.539258 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.stock_dbt_project.marts
[0m19:43:25.769387 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '62f9efd7-155d-4a43-88b9-2535afe8dbb6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011D0A2AB650>]}
[0m19:43:25.981358 [debug] [MainThread]: Wrote artifact WritableManifest to D:\Stock_price\stock_dbt_project\target\manifest.json
[0m19:43:25.986887 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\Stock_price\stock_dbt_project\target\semantic_manifest.json
[0m19:43:26.053049 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '62f9efd7-155d-4a43-88b9-2535afe8dbb6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011D0A4E4710>]}
[0m19:43:26.055342 [info ] [MainThread]: Found 4 models, 10 operations, 4 data tests, 426 macros
[0m19:43:26.056853 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '62f9efd7-155d-4a43-88b9-2535afe8dbb6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011D0A5C9010>]}
[0m19:43:26.062396 [info ] [MainThread]: 
[0m19:43:26.063394 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:43:26.065392 [info ] [MainThread]: 
[0m19:43:26.067011 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m19:43:26.070564 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m19:43:26.359374 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m19:43:26.364082 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m19:43:26.367185 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:43:27.014678 [debug] [ThreadPool]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m19:43:27.017357 [debug] [ThreadPool]: DuckDB adapter: Rolling back transaction.
[0m19:43:27.021924 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:43:27.024902 [debug] [MainThread]: Connection 'list_dev' was properly closed.
[0m19:43:27.027379 [info ] [MainThread]: 
[0m19:43:27.029730 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.96 seconds (0.96s).
[0m19:43:27.034195 [error] [MainThread]: Encountered an error:
Runtime Error
  IO Error: File is already open in 
  C:\Users\loges\miniconda3\python.exe (PID 51504)
[0m19:43:27.045815 [debug] [MainThread]: Command `dbt run` failed at 19:43:27.044507 after 6.77 seconds
[0m19:43:27.050132 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011D08F34260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011D0A49E060>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011D0A5DD9D0>]}
[0m19:43:27.056208 [debug] [MainThread]: Flushing usage events
[0m19:43:27.908382 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:44:19.882840 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002095A304350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002095D3188F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002095D158EF0>]}


============================== 19:44:19.899034 | e63eefec-7249-411d-8195-7b8815ef8f7e ==============================
[0m19:44:19.899034 [info ] [MainThread]: Running with dbt=1.9.4
[0m19:44:19.903456 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\loges\\.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'D:\\Stock_price\\stock_dbt_project\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select stg_stock_data', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:44:20.424583 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e63eefec-7249-411d-8195-7b8815ef8f7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002095CB3E120>]}
[0m19:44:20.586318 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e63eefec-7249-411d-8195-7b8815ef8f7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002095CBB80B0>]}
[0m19:44:20.592601 [info ] [MainThread]: Registered adapter: duckdb=1.9.2
[0m19:44:21.983405 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m19:44:23.203208 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:44:23.206839 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:44:23.252268 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.stock_dbt_project.marts
[0m19:44:23.600315 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e63eefec-7249-411d-8195-7b8815ef8f7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002095D3C0E00>]}
[0m19:44:24.301806 [debug] [MainThread]: Wrote artifact WritableManifest to D:\Stock_price\stock_dbt_project\target\manifest.json
[0m19:44:24.322117 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\Stock_price\stock_dbt_project\target\semantic_manifest.json
[0m19:44:24.475206 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e63eefec-7249-411d-8195-7b8815ef8f7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002095EB44EF0>]}
[0m19:44:24.479846 [info ] [MainThread]: Found 4 models, 10 operations, 4 data tests, 426 macros
[0m19:44:24.484218 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e63eefec-7249-411d-8195-7b8815ef8f7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002095E9526F0>]}
[0m19:44:24.494487 [info ] [MainThread]: 
[0m19:44:24.500257 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:44:24.504656 [info ] [MainThread]: 
[0m19:44:24.512601 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m19:44:24.521434 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m19:44:25.219173 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m19:44:25.224086 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m19:44:25.227703 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:44:25.628751 [debug] [ThreadPool]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m19:44:25.631407 [debug] [ThreadPool]: DuckDB adapter: Rolling back transaction.
[0m19:44:25.636163 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:44:25.640826 [debug] [MainThread]: Connection 'list_dev' was properly closed.
[0m19:44:25.643545 [info ] [MainThread]: 
[0m19:44:25.647642 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 1.13 seconds (1.13s).
[0m19:44:25.651037 [error] [MainThread]: Encountered an error:
Runtime Error
  IO Error: File is already open in 
  C:\Users\loges\miniconda3\python.exe (PID 51504)
[0m19:44:25.661378 [debug] [MainThread]: Command `dbt run` failed at 19:44:25.660249 after 6.31 seconds
[0m19:44:25.664512 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002095D625790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002095ECC8560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002095ECC9C40>]}
[0m19:44:25.668916 [debug] [MainThread]: Flushing usage events
[0m19:44:26.388201 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:45:35.371937 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000289EF99B6B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000289F366CAD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000289F2D12300>]}


============================== 19:45:35.379456 | 3823bd33-1c12-44ca-8e1e-abbef4a76da1 ==============================
[0m19:45:35.379456 [info ] [MainThread]: Running with dbt=1.9.4
[0m19:45:35.381456 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\loges\\.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'D:\\Stock_price\\stock_dbt_project\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --select stg_stock_data', 'send_anonymous_usage_stats': 'True'}
[0m19:45:35.893374 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3823bd33-1c12-44ca-8e1e-abbef4a76da1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000289F2D12870>]}
[0m19:45:36.005609 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3823bd33-1c12-44ca-8e1e-abbef4a76da1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000289F4AE4CE0>]}
[0m19:45:36.021337 [info ] [MainThread]: Registered adapter: duckdb=1.9.2
[0m19:45:36.683055 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m19:45:37.047779 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:45:37.048778 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:45:37.060986 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.stock_dbt_project.marts
[0m19:45:37.205915 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3823bd33-1c12-44ca-8e1e-abbef4a76da1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000289F4B82270>]}
[0m19:45:37.407358 [debug] [MainThread]: Wrote artifact WritableManifest to D:\Stock_price\stock_dbt_project\target\manifest.json
[0m19:45:37.412367 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\Stock_price\stock_dbt_project\target\semantic_manifest.json
[0m19:45:37.490987 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3823bd33-1c12-44ca-8e1e-abbef4a76da1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000289F4F1EB10>]}
[0m19:45:37.493375 [info ] [MainThread]: Found 4 models, 10 operations, 4 data tests, 426 macros
[0m19:45:37.497254 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3823bd33-1c12-44ca-8e1e-abbef4a76da1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000289F388FF50>]}
[0m19:45:37.507229 [info ] [MainThread]: 
[0m19:45:37.511803 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:45:37.516768 [info ] [MainThread]: 
[0m19:45:37.519295 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m19:45:37.532272 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m19:45:38.034498 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m19:45:38.037020 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m19:45:38.038560 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:45:38.588790 [debug] [ThreadPool]: SQL status: OK in 0.550 seconds
[0m19:45:38.595015 [debug] [ThreadPool]: On list_dev: Close
[0m19:45:38.600651 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m19:45:38.604243 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m19:45:38.637861 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m19:45:38.641295 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "create_dev_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m19:45:38.643632 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:45:38.649199 [debug] [ThreadPool]: SQL status: OK in 0.006 seconds
[0m19:45:38.656893 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m19:45:38.661438 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m19:45:38.663993 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m19:45:38.666820 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m19:45:38.669463 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "create_dev_main"} */

    
    
        create schema if not exists "dev"."main"
    
[0m19:45:38.671805 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m19:45:38.678285 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m19:45:38.680971 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m19:45:38.684437 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m19:45:38.688528 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m19:45:38.690891 [debug] [ThreadPool]: On create_dev_main: Close
[0m19:45:38.723761 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev_main'
[0m19:45:38.773685 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m19:45:38.777217 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m19:45:38.780309 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:45:38.784832 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m19:45:38.787006 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m19:45:38.788967 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m19:45:38.868954 [debug] [ThreadPool]: SQL status: OK in 0.079 seconds
[0m19:45:38.872967 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m19:45:38.878051 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m19:45:38.880046 [debug] [ThreadPool]: On list_dev_main: Close
[0m19:45:38.885285 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3823bd33-1c12-44ca-8e1e-abbef4a76da1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000289F37CD0A0>]}
[0m19:45:38.888817 [debug] [MainThread]: Using duckdb connection "master"
[0m19:45:38.889820 [debug] [MainThread]: On master: BEGIN
[0m19:45:38.893297 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:45:38.895333 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m19:45:38.898907 [debug] [MainThread]: On master: COMMIT
[0m19:45:38.900902 [debug] [MainThread]: Using duckdb connection "master"
[0m19:45:38.903901 [debug] [MainThread]: On master: COMMIT
[0m19:45:38.908012 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m19:45:38.946985 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-0"
[0m19:45:38.972660 [info ] [MainThread]: 1 of 10 START hook: stock_dbt_project.on-run-start.0 ........................... [RUN]
[0m19:45:38.975242 [debug] [MainThread]: Using duckdb connection "master"
[0m19:45:38.977756 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
INSTALL httpfs;
[0m19:45:38.982787 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m19:45:38.988517 [info ] [MainThread]: 1 of 10 OK hook: stock_dbt_project.on-run-start.0 .............................. [[32mOK[0m in 0.08s]
[0m19:45:38.999970 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-1"
[0m19:45:39.010123 [info ] [MainThread]: 2 of 10 START hook: stock_dbt_project.on-run-start.1 ........................... [RUN]
[0m19:45:39.015660 [debug] [MainThread]: Using duckdb connection "master"
[0m19:45:39.018702 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
INSTALL json;
[0m19:45:39.026183 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m19:45:39.031745 [info ] [MainThread]: 2 of 10 OK hook: stock_dbt_project.on-run-start.1 .............................. [[32mOK[0m in 0.04s]
[0m19:45:39.039334 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-2"
[0m19:45:39.044913 [info ] [MainThread]: 3 of 10 START hook: stock_dbt_project.on-run-start.2 ........................... [RUN]
[0m19:45:39.048877 [debug] [MainThread]: Using duckdb connection "master"
[0m19:45:39.051902 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
LOAD httpfs;
[0m19:45:39.055411 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m19:45:39.060592 [info ] [MainThread]: 3 of 10 OK hook: stock_dbt_project.on-run-start.2 .............................. [[32mOK[0m in 0.03s]
[0m19:45:39.069435 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-3"
[0m19:45:39.073452 [info ] [MainThread]: 4 of 10 START hook: stock_dbt_project.on-run-start.3 ........................... [RUN]
[0m19:45:39.082223 [debug] [MainThread]: Using duckdb connection "master"
[0m19:45:39.087032 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
LOAD json;
[0m19:45:39.093357 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m19:45:39.099796 [info ] [MainThread]: 4 of 10 OK hook: stock_dbt_project.on-run-start.3 .............................. [[32mOK[0m in 0.04s]
[0m19:45:39.113951 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-4"
[0m19:45:39.121834 [info ] [MainThread]: 5 of 10 START hook: stock_dbt_project.on-run-start.4 ........................... [RUN]
[0m19:45:39.125436 [debug] [MainThread]: Using duckdb connection "master"
[0m19:45:39.128539 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
SET s3_endpoint='http://localhost:9000';
[0m19:45:39.131752 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m19:45:39.140506 [info ] [MainThread]: 5 of 10 OK hook: stock_dbt_project.on-run-start.4 .............................. [[32mOK[0m in 0.03s]
[0m19:45:39.151763 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-5"
[0m19:45:39.156903 [info ] [MainThread]: 6 of 10 START hook: stock_dbt_project.on-run-start.5 ........................... [RUN]
[0m19:45:39.161914 [debug] [MainThread]: Using duckdb connection "master"
[0m19:45:39.163915 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
SET s3_access_key_id='minioadmin';
[0m19:45:39.169534 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m19:45:39.176740 [info ] [MainThread]: 6 of 10 OK hook: stock_dbt_project.on-run-start.5 .............................. [[32mOK[0m in 0.03s]
[0m19:45:39.191921 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-6"
[0m19:45:39.199727 [info ] [MainThread]: 7 of 10 START hook: stock_dbt_project.on-run-start.6 ........................... [RUN]
[0m19:45:39.206617 [debug] [MainThread]: Using duckdb connection "master"
[0m19:45:39.210815 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
SET s3_secret_access_key='minioadmin';
[0m19:45:39.215067 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m19:45:39.221319 [info ] [MainThread]: 7 of 10 OK hook: stock_dbt_project.on-run-start.6 .............................. [[32mOK[0m in 0.04s]
[0m19:45:39.228925 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-7"
[0m19:45:39.235621 [info ] [MainThread]: 8 of 10 START hook: stock_dbt_project.on-run-start.7 ........................... [RUN]
[0m19:45:39.241409 [debug] [MainThread]: Using duckdb connection "master"
[0m19:45:39.244844 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
SET s3_region='us-east-1';
[0m19:45:39.247769 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m19:45:39.254661 [info ] [MainThread]: 8 of 10 OK hook: stock_dbt_project.on-run-start.7 .............................. [[32mOK[0m in 0.03s]
[0m19:45:39.264105 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-8"
[0m19:45:39.271236 [info ] [MainThread]: 9 of 10 START hook: stock_dbt_project.on-run-start.8 ........................... [RUN]
[0m19:45:39.275694 [debug] [MainThread]: Using duckdb connection "master"
[0m19:45:39.279561 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
SET s3_use_ssl=false;
[0m19:45:39.284649 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m19:45:39.291115 [info ] [MainThread]: 9 of 10 OK hook: stock_dbt_project.on-run-start.8 .............................. [[32mOK[0m in 0.03s]
[0m19:45:39.301078 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-9"
[0m19:45:39.309909 [info ] [MainThread]: 10 of 10 START hook: stock_dbt_project.on-run-start.9 .......................... [RUN]
[0m19:45:39.314001 [debug] [MainThread]: Using duckdb connection "master"
[0m19:45:39.317159 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
SET s3_url_style='path';
[0m19:45:39.327582 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m19:45:39.331645 [info ] [MainThread]: 10 of 10 OK hook: stock_dbt_project.on-run-start.9 ............................. [[32mOK[0m in 0.04s]
[0m19:45:39.336912 [info ] [MainThread]: 
[0m19:45:39.341274 [debug] [MainThread]: On master: Close
[0m19:45:39.355148 [debug] [Thread-1 (]: Began running node model.stock_dbt_project.stg_stock_data
[0m19:45:39.358314 [info ] [Thread-1 (]: 1 of 1 START sql view model main.stg_stock_data ................................ [RUN]
[0m19:45:39.361829 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.stock_dbt_project.stg_stock_data'
[0m19:45:39.363357 [debug] [Thread-1 (]: Began compiling node model.stock_dbt_project.stg_stock_data
[0m19:45:39.390747 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_dbt_project.stg_stock_data"
[0m19:45:39.394079 [debug] [Thread-1 (]: Began executing node model.stock_dbt_project.stg_stock_data
[0m19:45:39.627867 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_dbt_project.stg_stock_data"
[0m19:45:39.633625 [debug] [Thread-1 (]: Using duckdb connection "model.stock_dbt_project.stg_stock_data"
[0m19:45:39.638015 [debug] [Thread-1 (]: On model.stock_dbt_project.stg_stock_data: BEGIN
[0m19:45:39.641132 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:45:39.644305 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m19:45:39.647252 [debug] [Thread-1 (]: Using duckdb connection "model.stock_dbt_project.stg_stock_data"
[0m19:45:39.653484 [debug] [Thread-1 (]: On model.stock_dbt_project.stg_stock_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "node_id": "model.stock_dbt_project.stg_stock_data"} */

  
  create view "dev"."main"."stg_stock_data__dbt_tmp" as (
    

WITH raw AS (
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/AAPL/2025/4/13/AAPL_20250413_111406_6ss1g0.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/AAPL/2025/4/13/AAPL_20250413_111507_vbodha.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/AAPL/2025/4/13/AAPL_20250413_111607_fg6ikl.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/AAPL/2025/4/13/AAPL_20250413_111707_meu1bb.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/AAPL/2025/4/17/AAPL_20250417_225502_nbggac.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/AAPL/2025/4/17/AAPL_20250417_225604_fpbwvo.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/AAPL/2025/4/17/AAPL_20250417_225706_mdcj3j.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/AAPL/2025/4/17/AAPL_20250417_235559_wnml5g.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/AAPL/2025/4/26/AAPL_20250426_004219_mwpj6f.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/AMGN/2025/4/13/AMGN_20250413_111406_376tdf.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/AMGN/2025/4/13/AMGN_20250413_111707_6fyizj.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/AMGN/2025/4/13/AMGN_20250413_111807_wj4725.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/AMGN/2025/4/13/AMGN_20250413_111908_grof48.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/AMGN/2025/4/13/AMGN_20250413_112008_mqcblg.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/AMGN/2025/4/13/AMGN_20250413_112430_vzl3jo.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/AXP/2025/4/13/AXP_20250413_112043_rxe487.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/AXP/2025/4/13/AXP_20250413_112143_dy2f99.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/AXP/2025/4/13/AXP_20250413_112243_wpjnea.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/AXP/2025/4/13/AXP_20250413_112343_3ar95s.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/AXP/2025/4/13/AXP_20250413_112820_nmp10g.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/AXP/2025/4/25/AXP_20250425_234418_obn9mz.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/BA/2025/4/13/BA_20250413_112430_qjgzy0.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/BA/2025/4/13/BA_20250413_112530_xlerhn.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/BA/2025/4/13/BA_20250413_112630_ulftgu.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/BA/2025/4/13/BA_20250413_112730_hfrte0.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/BA/2025/4/13/BA_20250413_113208_zvt53x.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/CAT/2025/4/13/CAT_20250413_112820_v57z9v.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/CAT/2025/4/13/CAT_20250413_112920_sljvdt.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/CAT/2025/4/13/CAT_20250413_113020_hw41p1.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/CAT/2025/4/13/CAT_20250413_113120_ykrdew.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/CAT/2025/4/13/CAT_20250413_113555_97ycfk.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/CAT/2025/4/25/CAT_20250425_234308_eat6ce.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/CAT/2025/4/25/CAT_20250425_234418_3ls2mb.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/CRM/2025/4/13/CRM_20250413_113208_xkovti.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/CRM/2025/4/13/CRM_20250413_113308_mgza12.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/CRM/2025/4/13/CRM_20250413_113408_9bqr6q.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/CRM/2025/4/13/CRM_20250413_113508_k34vp2.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/CRM/2025/4/13/CRM_20250413_113945_lkclxc.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/CRM/2025/4/25/CRM_20250425_234327_cuoq2f.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/CRM/2025/4/25/CRM_20250425_234427_sh1tth.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/CSCO/2025/4/13/CSCO_20250413_113555_l9kwg7.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/CSCO/2025/4/13/CSCO_20250413_113655_izivyy.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/CSCO/2025/4/13/CSCO_20250413_113755_dt1x9y.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/CSCO/2025/4/13/CSCO_20250413_113855_c3r2g8.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/CSCO/2025/4/13/CSCO_20250413_114723_2fm9vb.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/CSCO/2025/4/25/CSCO_20250425_234418_ic47ef.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/CSCO/2025/4/25/CSCO_20250425_234520_q0ghqd.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/CVX/2025/4/13/CVX_20250413_113945_jz58k4.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/CVX/2025/4/13/CVX_20250413_114046_wfeslb.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/CVX/2025/4/13/CVX_20250413_114146_gr7ke4.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/CVX/2025/4/13/CVX_20250413_114246_nnct9l.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/CVX/2025/4/13/CVX_20250413_114346_ft4rmb.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/CVX/2025/4/25/CVX_20250425_234427_b8g096.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/DIS/2025/4/13/DIS_20250413_114346_oo2o7g.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/DIS/2025/4/13/DIS_20250413_114447_00dzv2.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/DIS/2025/4/13/DIS_20250413_114547_celsbg.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/DIS/2025/4/13/DIS_20250413_114647_l29qvy.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/DIS/2025/4/13/DIS_20250413_122154_00kf9h.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/DIS/2025/4/25/DIS_20250425_234427_xttpg7.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/DIS/2025/4/25/DIS_20250425_234703_dazyq7.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/DOW/2025/4/13/DOW_20250413_114723_5js7wg.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/DOW/2025/4/13/DOW_20250413_114823_ikbq60.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/DOW/2025/4/13/DOW_20250413_114924_v4k4vs.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/DOW/2025/4/13/DOW_20250413_115024_t1ze5o.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/DOW/2025/4/13/DOW_20250413_115124_z0yaap.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/DOW/2025/4/25/DOW_20250425_234520_z0xwpx.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/DOW/2025/4/25/DOW_20250425_234640_i1dozz.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/GS/2025/4/13/GS_20250413_115124_k5wp1c.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/GS/2025/4/13/GS_20250413_115224_up2h60.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/GS/2025/4/13/GS_20250413_115324_kvaybg.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/GS/2025/4/13/GS_20250413_115424_p826ac.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/GS/2025/4/13/GS_20250413_115524_kaslf9.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/GS/2025/4/25/GS_20250425_234520_55r2co.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/GS/2025/4/25/GS_20250425_234640_vlqhzk.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/GS/2025/4/25/GS_20250425_235039_r86zaf.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/HD/2025/4/13/HD_20250413_115524_v565zl.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/HD/2025/4/13/HD_20250413_115624_m2ddoc.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/HD/2025/4/13/HD_20250413_115725_r0w0oc.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/HD/2025/4/13/HD_20250413_115825_ohauqk.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/HD/2025/4/13/HD_20250413_115925_52bquj.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/HD/2025/4/25/HD_20250425_235039_5cdo64.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/HON/2025/4/13/HON_20250413_115925_m22v5u.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/HON/2025/4/13/HON_20250413_120025_p6isvb.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/HON/2025/4/13/HON_20250413_120125_j4tlsk.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/HON/2025/4/13/HON_20250413_120225_jxmz5t.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/HON/2025/4/13/HON_20250413_120325_yjx3h3.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/HON/2025/4/25/HON_20250425_235039_i5yclz.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/IBM/2025/4/13/IBM_20250413_120326_5v31ap.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/IBM/2025/4/13/IBM_20250413_120426_v0zxjs.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/IBM/2025/4/13/IBM_20250413_120526_t0aet0.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/IBM/2025/4/13/IBM_20250413_120626_1mh4pe.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/IBM/2025/4/13/IBM_20250413_120726_q9scqg.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/IBM/2025/4/25/IBM_20250425_235039_8vjty5.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/INTC/2025/4/13/INTC_20250413_120726_tngyf4.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/INTC/2025/4/13/INTC_20250413_120827_pa0hww.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/INTC/2025/4/13/INTC_20250413_120927_n0bjos.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/INTC/2025/4/13/INTC_20250413_121027_6cnq4f.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/INTC/2025/4/13/INTC_20250413_121127_8gcjaq.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/INTC/2025/4/25/INTC_20250425_235039_rp8rq4.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/JNJ/2025/4/13/JNJ_20250413_121027_d7pymv.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/JNJ/2025/4/13/JNJ_20250413_121127_1unfa3.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/JNJ/2025/4/13/JNJ_20250413_121227_0in9gv.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/JNJ/2025/4/13/JNJ_20250413_121327_n72dcw.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/JNJ/2025/4/13/JNJ_20250413_121428_77t0e9.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/JNJ/2025/4/25/JNJ_20250425_235039_wk68wk.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/JPM/2025/4/13/JPM_20250413_121428_2nx47p.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/JPM/2025/4/13/JPM_20250413_121528_lbr75v.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/JPM/2025/4/13/JPM_20250413_121628_an9e86.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/JPM/2025/4/13/JPM_20250413_121728_jbj8pq.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/JPM/2025/4/13/JPM_20250413_121828_lzta1f.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/JPM/2025/4/25/JPM_20250425_234640_mk9rdq.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/JPM/2025/4/25/JPM_20250425_234813_6mlgw4.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/KO/2025/4/13/KO_20250413_121828_giyj1f.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/KO/2025/4/13/KO_20250413_121929_r2lpld.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/KO/2025/4/13/KO_20250413_122029_19yvzy.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/KO/2025/4/13/KO_20250413_122129_nxv1nm.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/KO/2025/4/13/KO_20250413_123717_4aowb0.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/KO/2025/4/25/KO_20250425_234813_tfe6zz.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/MCD/2025/4/13/MCD_20250413_122155_xjyi4f.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/MCD/2025/4/13/MCD_20250413_122255_zxb6im.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/MCD/2025/4/13/MCD_20250413_122355_1o2rjj.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/MCD/2025/4/13/MCD_20250413_122455_sw660e.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/MCD/2025/4/13/MCD_20250413_122555_bxprrb.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/MCD/2025/4/25/MCD_20250425_234703_v3zxd2.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/MCD/2025/4/25/MCD_20250425_234812_wz41kk.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/MMM/2025/4/13/MMM_20250413_122555_v35yhq.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/MMM/2025/4/13/MMM_20250413_122655_3v0frs.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/MMM/2025/4/13/MMM_20250413_122755_yq3rsw.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/MMM/2025/4/13/MMM_20250413_122856_urd0jv.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/MMM/2025/4/13/MMM_20250413_122956_1sygy4.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/MMM/2025/4/25/MMM_20250425_234812_f93hmr.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/MRK/2025/4/13/MRK_20250413_122956_f3ddtt.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/MRK/2025/4/13/MRK_20250413_123056_1vzpgv.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/MRK/2025/4/13/MRK_20250413_123156_a4xt7c.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/MRK/2025/4/13/MRK_20250413_123257_24je3z.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/MRK/2025/4/13/MRK_20250413_123357_t7dxcs.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/MRK/2025/4/25/MRK_20250425_234812_h8foyr.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/MRK/2025/4/25/MRK_20250425_234934_68pr77.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/MSFT/2025/4/13/MSFT_20250413_123357_pxhd4g.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/MSFT/2025/4/13/MSFT_20250413_123457_3lr87y.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/MSFT/2025/4/13/MSFT_20250413_123557_xcbu21.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/MSFT/2025/4/13/MSFT_20250413_123658_vsbw42.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/MSFT/2025/4/25/MSFT_20250425_234934_jq59fm.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/NKE/2025/4/13/NKE_20250413_123717_ewnsex.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/NKE/2025/4/13/NKE_20250413_123817_bh1dtd.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/NKE/2025/4/13/NKE_20250413_123917_5fp936.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/NKE/2025/4/13/NKE_20250413_124017_z26lw1.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/NKE/2025/4/13/NKE_20250413_124118_5pioe2.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/NKE/2025/4/13/NKE_20250413_124218_3qjysz.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/NKE/2025/4/25/NKE_20250425_234813_kvpqck.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/NKE/2025/4/25/NKE_20250425_234918_m0sl99.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/PG/2025/4/13/PG_20250413_124118_egc4nt.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/PG/2025/4/13/PG_20250413_124218_l9dtbw.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/PG/2025/4/13/PG_20250413_210538_qf1xkp.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/PG/2025/4/25/PG_20250425_234918_hjrmhf.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/TRV/2025/4/25/TRV_20250425_235039_45wqpb.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/V/2025/4/25/V_20250425_234918_5oj94r.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/V/2025/4/25/V_20250425_235039_l37ne1.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/VZ/2025/4/25/VZ_20250425_234934_4iwkej.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/VZ/2025/4/26/VZ_20250426_004219_5q0wv1.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/WBA/2025/4/25/WBA_20250425_235039_1pst4j.json')
    UNION ALL
    SELECT * FROM read_json_auto('http://localhost:9000/my-stock-data-bucket/stocks/WBA/2025/4/25/WBA_20250425_235221_jdahc0.json')
)

SELECT
    CAST(symbol AS TEXT) AS symbol,
    CAST(datetime AS TIMESTAMP) AS datetime,
    CAST(open AS DOUBLE) AS open,
    CAST(high AS DOUBLE) AS high,
    CAST(low AS DOUBLE) AS low,
    CAST(close AS DOUBLE) AS close,
    CAST(volume AS BIGINT) AS volume
FROM raw
WHERE symbol IS NOT NULL AND datetime IS NOT NULL
  );

[0m19:45:45.677845 [debug] [Thread-1 (]: SQL status: OK in 6.017 seconds
[0m19:45:45.726948 [debug] [Thread-1 (]: Using duckdb connection "model.stock_dbt_project.stg_stock_data"
[0m19:45:45.730545 [debug] [Thread-1 (]: On model.stock_dbt_project.stg_stock_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "node_id": "model.stock_dbt_project.stg_stock_data"} */
alter view "dev"."main"."stg_stock_data" rename to "stg_stock_data__dbt_backup"
[0m19:45:45.738686 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m19:45:45.756757 [debug] [Thread-1 (]: Using duckdb connection "model.stock_dbt_project.stg_stock_data"
[0m19:45:45.763931 [debug] [Thread-1 (]: On model.stock_dbt_project.stg_stock_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "node_id": "model.stock_dbt_project.stg_stock_data"} */
alter view "dev"."main"."stg_stock_data__dbt_tmp" rename to "stg_stock_data"
[0m19:45:45.776457 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m19:45:45.897206 [debug] [Thread-1 (]: On model.stock_dbt_project.stg_stock_data: COMMIT
[0m19:45:45.904700 [debug] [Thread-1 (]: Using duckdb connection "model.stock_dbt_project.stg_stock_data"
[0m19:45:45.909902 [debug] [Thread-1 (]: On model.stock_dbt_project.stg_stock_data: COMMIT
[0m19:45:45.927909 [debug] [Thread-1 (]: SQL status: OK in 0.014 seconds
[0m19:45:45.958694 [debug] [Thread-1 (]: Using duckdb connection "model.stock_dbt_project.stg_stock_data"
[0m19:45:45.961576 [debug] [Thread-1 (]: On model.stock_dbt_project.stg_stock_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "node_id": "model.stock_dbt_project.stg_stock_data"} */
drop view if exists "dev"."main"."stg_stock_data__dbt_backup" cascade
[0m19:45:45.968419 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m19:45:45.983234 [debug] [Thread-1 (]: On model.stock_dbt_project.stg_stock_data: Close
[0m19:45:45.993825 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3823bd33-1c12-44ca-8e1e-abbef4a76da1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000289F4F9B260>]}
[0m19:45:46.002546 [info ] [Thread-1 (]: 1 of 1 OK created sql view model main.stg_stock_data ........................... [[32mOK[0m in 6.62s]
[0m19:45:46.010097 [debug] [Thread-1 (]: Finished running node model.stock_dbt_project.stg_stock_data
[0m19:45:46.016609 [debug] [MainThread]: Using duckdb connection "master"
[0m19:45:46.019797 [debug] [MainThread]: On master: BEGIN
[0m19:45:46.023042 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:45:46.027167 [debug] [MainThread]: SQL status: OK in 0.004 seconds
[0m19:45:46.029710 [debug] [MainThread]: On master: COMMIT
[0m19:45:46.032741 [debug] [MainThread]: Using duckdb connection "master"
[0m19:45:46.035777 [debug] [MainThread]: On master: COMMIT
[0m19:45:46.042318 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m19:45:46.045907 [debug] [MainThread]: On master: Close
[0m19:45:46.049104 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:45:46.052219 [debug] [MainThread]: Connection 'create_dev_main' was properly closed.
[0m19:45:46.054366 [debug] [MainThread]: Connection 'list_dev_main' was properly closed.
[0m19:45:46.057504 [debug] [MainThread]: Connection 'model.stock_dbt_project.stg_stock_data' was properly closed.
[0m19:45:46.061029 [info ] [MainThread]: 
[0m19:45:46.065692 [info ] [MainThread]: Finished running 10 project hooks, 1 view model in 0 hours 0 minutes and 8.54 seconds (8.54s).
[0m19:45:46.076774 [debug] [MainThread]: Command end result
[0m19:45:46.169851 [debug] [MainThread]: Wrote artifact WritableManifest to D:\Stock_price\stock_dbt_project\target\manifest.json
[0m19:45:46.180154 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\Stock_price\stock_dbt_project\target\semantic_manifest.json
[0m19:45:46.219134 [debug] [MainThread]: Wrote artifact RunExecutionResult to D:\Stock_price\stock_dbt_project\target\run_results.json
[0m19:45:46.221148 [info ] [MainThread]: 
[0m19:45:46.223715 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:45:46.225722 [info ] [MainThread]: 
[0m19:45:46.228925 [info ] [MainThread]: Done. PASS=11 WARN=0 ERROR=0 SKIP=0 TOTAL=11
[0m19:45:46.233940 [debug] [MainThread]: Command `dbt run` succeeded at 19:45:46.232941 after 11.18 seconds
[0m19:45:46.235465 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000289F33F7C80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000289F2C54B30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000289F2D68E60>]}
[0m19:45:46.236982 [debug] [MainThread]: Flushing usage events
[0m19:45:46.944992 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:46:05.011130 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018DBA82E2A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018DBAE80140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018DBB01E960>]}


============================== 19:46:05.022205 | 22aa95a0-eb8a-431c-8489-8bf3f3ac90c9 ==============================
[0m19:46:05.022205 [info ] [MainThread]: Running with dbt=1.9.4
[0m19:46:05.024205 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\loges\\.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'D:\\Stock_price\\stock_dbt_project\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run --select features_stock_data', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m19:46:05.748973 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '22aa95a0-eb8a-431c-8489-8bf3f3ac90c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018DBA9122A0>]}
[0m19:46:06.022440 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '22aa95a0-eb8a-431c-8489-8bf3f3ac90c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018DBB26CFB0>]}
[0m19:46:06.052748 [info ] [MainThread]: Registered adapter: duckdb=1.9.2
[0m19:46:06.827513 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m19:46:07.420968 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:46:07.424066 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:46:07.463400 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.stock_dbt_project.marts
[0m19:46:07.721975 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '22aa95a0-eb8a-431c-8489-8bf3f3ac90c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018DBC71EB70>]}
[0m19:46:08.132360 [debug] [MainThread]: Wrote artifact WritableManifest to D:\Stock_price\stock_dbt_project\target\manifest.json
[0m19:46:08.147154 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\Stock_price\stock_dbt_project\target\semantic_manifest.json
[0m19:46:08.322125 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '22aa95a0-eb8a-431c-8489-8bf3f3ac90c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018DBCA48770>]}
[0m19:46:08.326895 [info ] [MainThread]: Found 4 models, 10 operations, 4 data tests, 426 macros
[0m19:46:08.330449 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '22aa95a0-eb8a-431c-8489-8bf3f3ac90c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018DBCA2DDF0>]}
[0m19:46:08.346077 [info ] [MainThread]: 
[0m19:46:08.353127 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:46:08.359401 [info ] [MainThread]: 
[0m19:46:08.369173 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m19:46:08.388638 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m19:46:09.114415 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m19:46:09.122453 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m19:46:09.130547 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:46:09.956584 [debug] [ThreadPool]: SQL status: OK in 0.827 seconds
[0m19:46:09.965337 [debug] [ThreadPool]: On list_dev: Close
[0m19:46:09.970847 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m19:46:09.974625 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m19:46:10.028373 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m19:46:10.031893 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "create_dev_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m19:46:10.034418 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:46:10.040907 [debug] [ThreadPool]: SQL status: OK in 0.006 seconds
[0m19:46:10.049077 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m19:46:10.052342 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m19:46:10.057148 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m19:46:10.060435 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m19:46:10.063507 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "create_dev_main"} */

    
    
        create schema if not exists "dev"."main"
    
[0m19:46:10.068583 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m19:46:10.073662 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m19:46:10.075749 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m19:46:10.078816 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m19:46:10.083019 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m19:46:10.087111 [debug] [ThreadPool]: On create_dev_main: Close
[0m19:46:10.121291 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev_main'
[0m19:46:10.171291 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m19:46:10.173774 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m19:46:10.175986 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:46:10.179525 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m19:46:10.182244 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m19:46:10.185791 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m19:46:10.330906 [debug] [ThreadPool]: SQL status: OK in 0.143 seconds
[0m19:46:10.336017 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m19:46:10.344405 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m19:46:10.346961 [debug] [ThreadPool]: On list_dev_main: Close
[0m19:46:10.355457 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '22aa95a0-eb8a-431c-8489-8bf3f3ac90c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018DBC8609B0>]}
[0m19:46:10.359651 [debug] [MainThread]: Using duckdb connection "master"
[0m19:46:10.361957 [debug] [MainThread]: On master: BEGIN
[0m19:46:10.363597 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:46:10.366418 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m19:46:10.368985 [debug] [MainThread]: On master: COMMIT
[0m19:46:10.372167 [debug] [MainThread]: Using duckdb connection "master"
[0m19:46:10.374743 [debug] [MainThread]: On master: COMMIT
[0m19:46:10.378289 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m19:46:10.421919 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-0"
[0m19:46:10.448952 [info ] [MainThread]: 1 of 10 START hook: stock_dbt_project.on-run-start.0 ........................... [RUN]
[0m19:46:10.453004 [debug] [MainThread]: Using duckdb connection "master"
[0m19:46:10.455005 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
INSTALL httpfs;
[0m19:46:10.461200 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m19:46:10.468489 [info ] [MainThread]: 1 of 10 OK hook: stock_dbt_project.on-run-start.0 .............................. [[32mOK[0m in 0.09s]
[0m19:46:10.479791 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-1"
[0m19:46:10.485820 [info ] [MainThread]: 2 of 10 START hook: stock_dbt_project.on-run-start.1 ........................... [RUN]
[0m19:46:10.490898 [debug] [MainThread]: Using duckdb connection "master"
[0m19:46:10.494552 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
INSTALL json;
[0m19:46:10.501112 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m19:46:10.508738 [info ] [MainThread]: 2 of 10 OK hook: stock_dbt_project.on-run-start.1 .............................. [[32mOK[0m in 0.03s]
[0m19:46:10.522681 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-2"
[0m19:46:10.531284 [info ] [MainThread]: 3 of 10 START hook: stock_dbt_project.on-run-start.2 ........................... [RUN]
[0m19:46:10.535303 [debug] [MainThread]: Using duckdb connection "master"
[0m19:46:10.538846 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
LOAD httpfs;
[0m19:46:10.544089 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m19:46:10.551200 [info ] [MainThread]: 3 of 10 OK hook: stock_dbt_project.on-run-start.2 .............................. [[32mOK[0m in 0.04s]
[0m19:46:10.565142 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-3"
[0m19:46:10.572126 [info ] [MainThread]: 4 of 10 START hook: stock_dbt_project.on-run-start.3 ........................... [RUN]
[0m19:46:10.575713 [debug] [MainThread]: Using duckdb connection "master"
[0m19:46:10.579451 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
LOAD json;
[0m19:46:10.585559 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m19:46:10.593102 [info ] [MainThread]: 4 of 10 OK hook: stock_dbt_project.on-run-start.3 .............................. [[32mOK[0m in 0.04s]
[0m19:46:10.609558 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-4"
[0m19:46:10.614554 [info ] [MainThread]: 5 of 10 START hook: stock_dbt_project.on-run-start.4 ........................... [RUN]
[0m19:46:10.621518 [debug] [MainThread]: Using duckdb connection "master"
[0m19:46:10.624546 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
SET s3_endpoint='http://localhost:9000';
[0m19:46:10.629343 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m19:46:10.636947 [info ] [MainThread]: 5 of 10 OK hook: stock_dbt_project.on-run-start.4 .............................. [[32mOK[0m in 0.04s]
[0m19:46:10.647407 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-5"
[0m19:46:10.653269 [info ] [MainThread]: 6 of 10 START hook: stock_dbt_project.on-run-start.5 ........................... [RUN]
[0m19:46:10.657837 [debug] [MainThread]: Using duckdb connection "master"
[0m19:46:10.662074 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
SET s3_access_key_id='minioadmin';
[0m19:46:10.666579 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m19:46:10.672542 [info ] [MainThread]: 6 of 10 OK hook: stock_dbt_project.on-run-start.5 .............................. [[32mOK[0m in 0.03s]
[0m19:46:10.687942 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-6"
[0m19:46:10.696046 [info ] [MainThread]: 7 of 10 START hook: stock_dbt_project.on-run-start.6 ........................... [RUN]
[0m19:46:10.705916 [debug] [MainThread]: Using duckdb connection "master"
[0m19:46:10.712582 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
SET s3_secret_access_key='minioadmin';
[0m19:46:10.725454 [debug] [MainThread]: SQL status: OK in 0.008 seconds
[0m19:46:10.737233 [info ] [MainThread]: 7 of 10 OK hook: stock_dbt_project.on-run-start.6 .............................. [[32mOK[0m in 0.06s]
[0m19:46:10.752812 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-7"
[0m19:46:10.757000 [info ] [MainThread]: 8 of 10 START hook: stock_dbt_project.on-run-start.7 ........................... [RUN]
[0m19:46:10.765647 [debug] [MainThread]: Using duckdb connection "master"
[0m19:46:10.772612 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
SET s3_region='us-east-1';
[0m19:46:10.780277 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m19:46:10.790292 [info ] [MainThread]: 8 of 10 OK hook: stock_dbt_project.on-run-start.7 .............................. [[32mOK[0m in 0.04s]
[0m19:46:10.808807 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-8"
[0m19:46:10.819827 [info ] [MainThread]: 9 of 10 START hook: stock_dbt_project.on-run-start.8 ........................... [RUN]
[0m19:46:10.825242 [debug] [MainThread]: Using duckdb connection "master"
[0m19:46:10.829321 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
SET s3_use_ssl=false;
[0m19:46:10.837080 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m19:46:10.844983 [info ] [MainThread]: 9 of 10 OK hook: stock_dbt_project.on-run-start.8 .............................. [[32mOK[0m in 0.05s]
[0m19:46:10.859612 [debug] [MainThread]: Writing injected SQL for node "operation.stock_dbt_project.stock_dbt_project-on-run-start-9"
[0m19:46:10.864161 [info ] [MainThread]: 10 of 10 START hook: stock_dbt_project.on-run-start.9 .......................... [RUN]
[0m19:46:10.870187 [debug] [MainThread]: Using duckdb connection "master"
[0m19:46:10.873204 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "connection_name": "master"} */
SET s3_url_style='path';
[0m19:46:10.878257 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m19:46:10.890051 [info ] [MainThread]: 10 of 10 OK hook: stock_dbt_project.on-run-start.9 ............................. [[32mOK[0m in 0.04s]
[0m19:46:10.895351 [info ] [MainThread]: 
[0m19:46:10.908598 [debug] [MainThread]: On master: Close
[0m19:46:10.938934 [debug] [Thread-1 (]: Began running node model.stock_dbt_project.features_stock_data
[0m19:46:10.943619 [info ] [Thread-1 (]: 1 of 1 START sql table model main.features_stock_data .......................... [RUN]
[0m19:46:10.950914 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.stock_dbt_project.features_stock_data'
[0m19:46:10.955438 [debug] [Thread-1 (]: Began compiling node model.stock_dbt_project.features_stock_data
[0m19:46:10.981289 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_dbt_project.features_stock_data"
[0m19:46:10.990304 [debug] [Thread-1 (]: Began executing node model.stock_dbt_project.features_stock_data
[0m19:46:11.297221 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_dbt_project.features_stock_data"
[0m19:46:11.305722 [debug] [Thread-1 (]: Using duckdb connection "model.stock_dbt_project.features_stock_data"
[0m19:46:11.312139 [debug] [Thread-1 (]: On model.stock_dbt_project.features_stock_data: BEGIN
[0m19:46:11.315968 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:46:11.323198 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m19:46:11.327283 [debug] [Thread-1 (]: Using duckdb connection "model.stock_dbt_project.features_stock_data"
[0m19:46:11.331323 [debug] [Thread-1 (]: On model.stock_dbt_project.features_stock_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "node_id": "model.stock_dbt_project.features_stock_data"} */

  
    
    

    create  table
      "dev"."main"."features_stock_data__dbt_tmp"
  
    as (
      

WITH base AS (
    SELECT
        symbol,
        datetime,
        open,
        high,
        low,
        close,
        volume,
        
        -- Previous close for daily return
        LAG(close, 1) OVER (PARTITION BY symbol ORDER BY datetime) AS prev_close,

        -- Rolling 5-period average and stddev of close
        AVG(close) OVER (
            PARTITION BY symbol 
            ORDER BY datetime 
            ROWS BETWEEN 4 PRECEDING AND CURRENT ROW
        ) AS rolling_avg_5,

        STDDEV(close) OVER (
            PARTITION BY symbol 
            ORDER BY datetime 
            ROWS BETWEEN 4 PRECEDING AND CURRENT ROW
        ) AS rolling_std_5,

        -- Daily price range
        (high - low) AS daily_range,

        -- Rolling 5-period average of volume
        AVG(volume) OVER (
            PARTITION BY symbol 
            ORDER BY datetime 
            ROWS BETWEEN 4 PRECEDING AND CURRENT ROW
        ) AS avg_volume_5
    FROM "dev"."main"."stg_stock_data"
),

features AS (
    SELECT
        *,
        
        -- Daily return percentage
        CASE 
            WHEN prev_close IS NOT NULL AND prev_close != 0 THEN 
                ((close - prev_close) / prev_close) * 100
            ELSE NULL
        END AS daily_return,

        -- Volume ratio compared to rolling average
        CASE 
            WHEN avg_volume_5 IS NOT NULL AND avg_volume_5 != 0 THEN 
                volume / avg_volume_5
            ELSE NULL
        END AS volume_ratio,

        -- Rolling volatility based on daily return
        STDDEV(
            CASE 
                WHEN prev_close IS NOT NULL AND prev_close != 0 THEN 
                    ((close - prev_close) / prev_close) * 100
                ELSE NULL
            END
        ) OVER (
            PARTITION BY symbol 
            ORDER BY datetime 
            ROWS BETWEEN 9 PRECEDING AND CURRENT ROW
        ) AS rolling_volatility_10,

        -- Sector classification based on symbol 
        CASE
            WHEN symbol IN ('AAPL', 'CRM', 'CSCO', 'IBM', 'INTC', 'MSFT') THEN 'Technology'
            WHEN symbol IN ('AMGN', 'JNJ', 'MRK', 'UNH') THEN 'Healthcare'
            WHEN symbol IN ('AXP', 'GS', 'JPM', 'TRV', 'V') THEN 'Financials'
            WHEN symbol IN ('BA', 'CAT', 'HON', 'MMM') THEN 'Industrials'
            WHEN symbol IN ('CVX') THEN 'Energy'
            WHEN symbol IN ('DIS', 'VZ') THEN 'Communication Services'
            WHEN symbol IN ('DOW') THEN 'Materials'
            WHEN symbol IN ('HD', 'MCD', 'NKE') THEN 'Consumer Discretionary'
            WHEN symbol IN ('KO', 'PG', 'WMT', 'WBA') THEN 'Consumer Staples'
            ELSE 'Unknown'
        END AS sector
    FROM base
)

SELECT * FROM features
    );
  
  
[0m19:46:20.403719 [debug] [Thread-1 (]: SQL status: OK in 9.070 seconds
[0m19:46:20.415366 [debug] [Thread-1 (]: Using duckdb connection "model.stock_dbt_project.features_stock_data"
[0m19:46:20.416877 [debug] [Thread-1 (]: On model.stock_dbt_project.features_stock_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "node_id": "model.stock_dbt_project.features_stock_data"} */
alter table "dev"."main"."features_stock_data" rename to "features_stock_data__dbt_backup"
[0m19:46:20.418887 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:46:20.424886 [debug] [Thread-1 (]: Using duckdb connection "model.stock_dbt_project.features_stock_data"
[0m19:46:20.426885 [debug] [Thread-1 (]: On model.stock_dbt_project.features_stock_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "node_id": "model.stock_dbt_project.features_stock_data"} */
alter table "dev"."main"."features_stock_data__dbt_tmp" rename to "features_stock_data"
[0m19:46:20.427958 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:46:20.461844 [debug] [Thread-1 (]: On model.stock_dbt_project.features_stock_data: COMMIT
[0m19:46:20.462948 [debug] [Thread-1 (]: Using duckdb connection "model.stock_dbt_project.features_stock_data"
[0m19:46:20.464998 [debug] [Thread-1 (]: On model.stock_dbt_project.features_stock_data: COMMIT
[0m19:46:20.510767 [debug] [Thread-1 (]: SQL status: OK in 0.044 seconds
[0m19:46:20.521795 [debug] [Thread-1 (]: Using duckdb connection "model.stock_dbt_project.features_stock_data"
[0m19:46:20.522794 [debug] [Thread-1 (]: On model.stock_dbt_project.features_stock_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stock_dbt_project", "target_name": "dev", "node_id": "model.stock_dbt_project.features_stock_data"} */
drop table if exists "dev"."main"."features_stock_data__dbt_backup" cascade
[0m19:46:20.526804 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m19:46:20.530907 [debug] [Thread-1 (]: On model.stock_dbt_project.features_stock_data: Close
[0m19:46:20.535951 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '22aa95a0-eb8a-431c-8489-8bf3f3ac90c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018DBD053080>]}
[0m19:46:20.537424 [info ] [Thread-1 (]: 1 of 1 OK created sql table model main.features_stock_data ..................... [[32mOK[0m in 9.58s]
[0m19:46:20.539438 [debug] [Thread-1 (]: Finished running node model.stock_dbt_project.features_stock_data
[0m19:46:20.542440 [debug] [MainThread]: Using duckdb connection "master"
[0m19:46:20.543433 [debug] [MainThread]: On master: BEGIN
[0m19:46:20.543962 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:46:20.547380 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m19:46:20.549755 [debug] [MainThread]: On master: COMMIT
[0m19:46:20.551428 [debug] [MainThread]: Using duckdb connection "master"
[0m19:46:20.554467 [debug] [MainThread]: On master: COMMIT
[0m19:46:20.557734 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m19:46:20.560062 [debug] [MainThread]: On master: Close
[0m19:46:20.562868 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:46:20.563956 [debug] [MainThread]: Connection 'create_dev_main' was properly closed.
[0m19:46:20.564506 [debug] [MainThread]: Connection 'list_dev_main' was properly closed.
[0m19:46:20.567089 [debug] [MainThread]: Connection 'model.stock_dbt_project.features_stock_data' was properly closed.
[0m19:46:20.570083 [info ] [MainThread]: 
[0m19:46:20.573072 [info ] [MainThread]: Finished running 10 project hooks, 1 table model in 0 hours 0 minutes and 12.20 seconds (12.20s).
[0m19:46:20.579762 [debug] [MainThread]: Command end result
[0m19:46:20.629116 [debug] [MainThread]: Wrote artifact WritableManifest to D:\Stock_price\stock_dbt_project\target\manifest.json
[0m19:46:20.637117 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\Stock_price\stock_dbt_project\target\semantic_manifest.json
[0m19:46:20.663518 [debug] [MainThread]: Wrote artifact RunExecutionResult to D:\Stock_price\stock_dbt_project\target\run_results.json
[0m19:46:20.665529 [info ] [MainThread]: 
[0m19:46:20.669047 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:46:20.671048 [info ] [MainThread]: 
[0m19:46:20.673058 [info ] [MainThread]: Done. PASS=11 WARN=0 ERROR=0 SKIP=0 TOTAL=11
[0m19:46:20.677168 [debug] [MainThread]: Command `dbt run` succeeded at 19:46:20.675532 after 16.18 seconds
[0m19:46:20.678098 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018DBA82E2A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018DBB2D0080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018DBCA306E0>]}
[0m19:46:20.679112 [debug] [MainThread]: Flushing usage events
[0m19:46:21.592434 [debug] [MainThread]: An error was encountered while trying to flush usage events
