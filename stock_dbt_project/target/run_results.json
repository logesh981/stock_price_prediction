{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.9.4", "generated_at": "2025-04-26T18:46:20.576343Z", "invocation_id": "22aa95a0-eb8a-431c-8489-8bf3f3ac90c9", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-26T18:46:10.381288Z", "completed_at": "2025-04-26T18:46:10.447933Z"}, {"name": "execute", "started_at": "2025-04-26T18:46:10.452006Z", "completed_at": "2025-04-26T18:46:10.467471Z"}], "thread_id": "main", "execution_time": 0.086183, "adapter_response": {}, "message": "stock_dbt_project.on-run-start.0 passed", "failures": 0, "unique_id": "operation.stock_dbt_project.stock_dbt_project-on-run-start-0", "compiled": true, "compiled_code": "INSTALL httpfs;", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-26T18:46:10.472612Z", "completed_at": "2025-04-26T18:46:10.484817Z"}, {"name": "execute", "started_at": "2025-04-26T18:46:10.489878Z", "completed_at": "2025-04-26T18:46:10.507173Z"}], "thread_id": "main", "execution_time": 0.034561, "adapter_response": {}, "message": "stock_dbt_project.on-run-start.1 passed", "failures": 0, "unique_id": "operation.stock_dbt_project.stock_dbt_project-on-run-start-1", "compiled": true, "compiled_code": "INSTALL json;", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-26T18:46:10.513583Z", "completed_at": "2025-04-26T18:46:10.529461Z"}, {"name": "execute", "started_at": "2025-04-26T18:46:10.535303Z", "completed_at": "2025-04-26T18:46:10.550178Z"}], "thread_id": "main", "execution_time": 0.036595, "adapter_response": {}, "message": "stock_dbt_project.on-run-start.2 passed", "failures": 0, "unique_id": "operation.stock_dbt_project.stock_dbt_project-on-run-start-2", "compiled": true, "compiled_code": "LOAD httpfs;", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-26T18:46:10.554878Z", "completed_at": "2025-04-26T18:46:10.570101Z"}, {"name": "execute", "started_at": "2025-04-26T18:46:10.574701Z", "completed_at": "2025-04-26T18:46:10.592104Z"}], "thread_id": "main", "execution_time": 0.037226, "adapter_response": {}, "message": "stock_dbt_project.on-run-start.3 passed", "failures": 0, "unique_id": "operation.stock_dbt_project.stock_dbt_project-on-run-start-3", "compiled": true, "compiled_code": "LOAD json;", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-26T18:46:10.596820Z", "completed_at": "2025-04-26T18:46:10.613418Z"}, {"name": "execute", "started_at": "2025-04-26T18:46:10.620224Z", "completed_at": "2025-04-26T18:46:10.635162Z"}], "thread_id": "main", "execution_time": 0.038342, "adapter_response": {}, "message": "stock_dbt_project.on-run-start.4 passed", "failures": 0, "unique_id": "operation.stock_dbt_project.stock_dbt_project-on-run-start-4", "compiled": true, "compiled_code": "SET s3_endpoint='http://localhost:9000';", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-26T18:46:10.640665Z", "completed_at": "2025-04-26T18:46:10.653269Z"}, {"name": "execute", "started_at": "2025-04-26T18:46:10.656903Z", "completed_at": "2025-04-26T18:46:10.671543Z"}], "thread_id": "main", "execution_time": 0.030878, "adapter_response": {}, "message": "stock_dbt_project.on-run-start.5 passed", "failures": 0, "unique_id": "operation.stock_dbt_project.stock_dbt_project-on-run-start-5", "compiled": true, "compiled_code": "SET s3_access_key_id='minioadmin';", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-26T18:46:10.676081Z", "completed_at": "2025-04-26T18:46:10.693415Z"}, {"name": "execute", "started_at": "2025-04-26T18:46:10.705338Z", "completed_at": "2025-04-26T18:46:10.732555Z"}], "thread_id": "main", "execution_time": 0.056474, "adapter_response": {}, "message": "stock_dbt_project.on-run-start.6 passed", "failures": 0, "unique_id": "operation.stock_dbt_project.stock_dbt_project-on-run-start-6", "compiled": true, "compiled_code": "SET s3_secret_access_key='minioadmin';", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-26T18:46:10.744480Z", "completed_at": "2025-04-26T18:46:10.755918Z"}, {"name": "execute", "started_at": "2025-04-26T18:46:10.764276Z", "completed_at": "2025-04-26T18:46:10.788650Z"}], "thread_id": "main", "execution_time": 0.04417, "adapter_response": {}, "message": "stock_dbt_project.on-run-start.7 passed", "failures": 0, "unique_id": "operation.stock_dbt_project.stock_dbt_project-on-run-start-7", "compiled": true, "compiled_code": "SET s3_region='us-east-1';", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-26T18:46:10.795727Z", "completed_at": "2025-04-26T18:46:10.818311Z"}, {"name": "execute", "started_at": "2025-04-26T18:46:10.824231Z", "completed_at": "2025-04-26T18:46:10.843644Z"}], "thread_id": "main", "execution_time": 0.047917, "adapter_response": {}, "message": "stock_dbt_project.on-run-start.8 passed", "failures": 0, "unique_id": "operation.stock_dbt_project.stock_dbt_project-on-run-start-8", "compiled": true, "compiled_code": "SET s3_use_ssl=false;", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-26T18:46:10.851010Z", "completed_at": "2025-04-26T18:46:10.863155Z"}, {"name": "execute", "started_at": "2025-04-26T18:46:10.869017Z", "completed_at": "2025-04-26T18:46:10.889024Z"}], "thread_id": "main", "execution_time": 0.038014, "adapter_response": {}, "message": "stock_dbt_project.on-run-start.9 passed", "failures": 0, "unique_id": "operation.stock_dbt_project.stock_dbt_project-on-run-start-9", "compiled": true, "compiled_code": "SET s3_url_style='path';", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-26T18:46:10.959452Z", "completed_at": "2025-04-26T18:46:10.988037Z"}, {"name": "execute", "started_at": "2025-04-26T18:46:10.994229Z", "completed_at": "2025-04-26T18:46:20.529906Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 9.583043813705444, "adapter_response": {"_message": "OK"}, "message": "OK", "failures": null, "unique_id": "model.stock_dbt_project.features_stock_data", "compiled": true, "compiled_code": "\n\nWITH base AS (\n    SELECT\n        symbol,\n        datetime,\n        open,\n        high,\n        low,\n        close,\n        volume,\n        \n        -- Previous close for daily return\n        LAG(close, 1) OVER (PARTITION BY symbol ORDER BY datetime) AS prev_close,\n\n        -- Rolling 5-period average and stddev of close\n        AVG(close) OVER (\n            PARTITION BY symbol \n            ORDER BY datetime \n            ROWS BETWEEN 4 PRECEDING AND CURRENT ROW\n        ) AS rolling_avg_5,\n\n        STDDEV(close) OVER (\n            PARTITION BY symbol \n            ORDER BY datetime \n            ROWS BETWEEN 4 PRECEDING AND CURRENT ROW\n        ) AS rolling_std_5,\n\n        -- Daily price range\n        (high - low) AS daily_range,\n\n        -- Rolling 5-period average of volume\n        AVG(volume) OVER (\n            PARTITION BY symbol \n            ORDER BY datetime \n            ROWS BETWEEN 4 PRECEDING AND CURRENT ROW\n        ) AS avg_volume_5\n    FROM \"dev\".\"main\".\"stg_stock_data\"\n),\n\nfeatures AS (\n    SELECT\n        *,\n        \n        -- Daily return percentage\n        CASE \n            WHEN prev_close IS NOT NULL AND prev_close != 0 THEN \n                ((close - prev_close) / prev_close) * 100\n            ELSE NULL\n        END AS daily_return,\n\n        -- Volume ratio compared to rolling average\n        CASE \n            WHEN avg_volume_5 IS NOT NULL AND avg_volume_5 != 0 THEN \n                volume / avg_volume_5\n            ELSE NULL\n        END AS volume_ratio,\n\n        -- Rolling volatility based on daily return\n        STDDEV(\n            CASE \n                WHEN prev_close IS NOT NULL AND prev_close != 0 THEN \n                    ((close - prev_close) / prev_close) * 100\n                ELSE NULL\n            END\n        ) OVER (\n            PARTITION BY symbol \n            ORDER BY datetime \n            ROWS BETWEEN 9 PRECEDING AND CURRENT ROW\n        ) AS rolling_volatility_10,\n\n        -- Sector classification based on symbol \n        CASE\n            WHEN symbol IN ('AAPL', 'CRM', 'CSCO', 'IBM', 'INTC', 'MSFT') THEN 'Technology'\n            WHEN symbol IN ('AMGN', 'JNJ', 'MRK', 'UNH') THEN 'Healthcare'\n            WHEN symbol IN ('AXP', 'GS', 'JPM', 'TRV', 'V') THEN 'Financials'\n            WHEN symbol IN ('BA', 'CAT', 'HON', 'MMM') THEN 'Industrials'\n            WHEN symbol IN ('CVX') THEN 'Energy'\n            WHEN symbol IN ('DIS', 'VZ') THEN 'Communication Services'\n            WHEN symbol IN ('DOW') THEN 'Materials'\n            WHEN symbol IN ('HD', 'MCD', 'NKE') THEN 'Consumer Discretionary'\n            WHEN symbol IN ('KO', 'PG', 'WMT', 'WBA') THEN 'Consumer Staples'\n            ELSE 'Unknown'\n        END AS sector\n    FROM base\n)\n\nSELECT * FROM features", "relation_name": "\"dev\".\"main\".\"features_stock_data\"", "batch_results": null}], "elapsed_time": 12.204064130783081, "args": {"project_dir": "D:\\Stock_price\\stock_dbt_project", "log_format": "default", "source_freshness_run_project_hooks": false, "print": true, "use_colors": true, "vars": {}, "warn_error_options": {"include": [], "exclude": []}, "favor_state": false, "log_file_max_bytes": 10485760, "log_level": "info", "cache_selected_only": false, "require_batched_execution_for_custom_microbatch_strategy": false, "use_colors_file": true, "empty": false, "skip_nodes_if_on_run_start_fails": false, "partial_parse": true, "send_anonymous_usage_stats": true, "static_parser": true, "show_resource_report": false, "state_modified_compare_vars": false, "printer_width": 80, "invocation_command": "dbt run --select features_stock_data", "indirect_selection": "eager", "quiet": false, "version_check": true, "defer": false, "log_format_file": "debug", "require_explicit_package_overrides_for_builtin_materializations": true, "require_nested_cumulative_type_params": false, "log_level_file": "debug", "which": "run", "strict_mode": false, "profiles_dir": "C:\\Users\\loges\\.dbt", "introspect": true, "partial_parse_file_diff": true, "populate_cache": true, "macro_debugging": false, "require_yaml_configuration_for_mf_time_spines": false, "select": ["features_stock_data"], "write_json": true, "log_path": "D:\\Stock_price\\stock_dbt_project\\logs", "exclude": [], "state_modified_compare_more_unrendered_values": false, "require_resource_names_without_spaces": false}}